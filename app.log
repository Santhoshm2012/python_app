2025-06-02 05:48:33,890 - d365 - INFO - Loading D365 data
2025-06-02 05:48:33,943 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:48:34,709 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e570ffdc-b9fc-4c78-ae74-4df2446e3600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:48:34 GMT'
    'Content-Length': '1753'
2025-06-02 05:48:34,737 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:48:34,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9a0ffbac-8347-4d10-ba67-18228f3a4000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:48:35 GMT'
    'Content-Length': '1651'
2025-06-02 05:48:34,948 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:48:34,949 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 05:48:34,950 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:48:35,261 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fe802e02-9830-4ec2-905e-e5b91b084d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:48:35 GMT'
    'Content-Length': '1753'
2025-06-02 05:48:35,261 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:48:35,462 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a1923596-34fc-4ae9-9d2c-da5c20993d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:48:35 GMT'
    'Content-Length': '1995'
2025-06-02 05:48:35,462 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:48:35,462 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 05:48:35,463 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:48:35,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5543627f-c916-41cf-92bb-ec9c35f23400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:48:35 GMT'
    'Content-Length': '1753'
2025-06-02 05:48:35,835 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:48:36,058 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b7987a8b-b563-4a5d-ad1d-ff747d6d2500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:48:36 GMT'
    'Content-Length': '1995'
2025-06-02 05:48:36,059 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:48:36,060 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 05:48:39,211 - d365 - INFO - Fetched 951 users from Entra ID
2025-06-02 05:48:39,212 - d365 - INFO - Found 951 users in Entra ID
2025-06-02 05:48:43,261 - d365 - INFO - Fetched 932 user records from D365
2025-06-02 05:49:16,496 - d365 - INFO - Loading D365 data
2025-06-02 05:49:16,500 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:49:16,875 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd49472d3-be37-4849-a76f-1df69fa64600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:49:17 GMT'
    'Content-Length': '1753'
2025-06-02 05:49:16,879 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:49:17,062 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e9d7c7f0-1829-4e15-bfc4-4c683f275000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:49:17 GMT'
    'Content-Length': '1651'
2025-06-02 05:49:17,063 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:49:17,063 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 05:49:19,973 - d365 - ERROR - Failed to fetch audit logs page: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:49:19,974 - d365 - ERROR - Failed to fetch D365 audit logs: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:49:19,990 - d365 - ERROR - Failed to load D365 data: No columns to parse from file
2025-06-02 05:49:24,150 - d365 - INFO - Loading D365 data
2025-06-02 05:49:24,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:49:24,541 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '52ab7ff1-00fc-41f1-b3a2-4cf06ecb4e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:49:24 GMT'
    'Content-Length': '1753'
2025-06-02 05:49:24,545 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:49:24,677 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '01715369-7c3b-40b8-96be-fecf1e984300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:49:24 GMT'
    'Content-Length': '1652'
2025-06-02 05:49:24,679 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:49:24,679 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 05:49:30,304 - d365 - ERROR - Failed to fetch audit logs page: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:49:30,304 - d365 - ERROR - Failed to fetch D365 audit logs: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:49:30,305 - d365 - ERROR - Failed to load D365 data: No columns to parse from file
2025-06-02 05:50:08,341 - d365 - INFO - Loading D365 data
2025-06-02 05:50:08,343 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:50:08,707 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5018b1c8-3ec9-4095-b43f-995a620a4d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:50:08 GMT'
    'Content-Length': '1753'
2025-06-02 05:50:08,718 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:50:08,923 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2ea8251e-da68-4a88-b1d1-40f139445c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:50:08 GMT'
    'Content-Length': '1647'
2025-06-02 05:50:08,924 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:50:08,925 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 05:50:14,500 - d365 - ERROR - Failed to fetch audit logs page: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:50:14,500 - d365 - ERROR - Failed to fetch D365 audit logs: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:50:14,503 - d365 - ERROR - Failed to load D365 data: No columns to parse from file
2025-06-02 05:55:08,070 - d365 - INFO - Loading D365 data
2025-06-02 05:55:08,076 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:55:08,873 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '51dd58d1-289b-4a19-8b7d-0603f1255100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:55:08 GMT'
    'Content-Length': '1753'
2025-06-02 05:55:08,891 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:55:09,136 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ab7e240c-d93d-4498-9650-af6d7e834300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:55:09 GMT'
    'Content-Length': '1652'
2025-06-02 05:55:09,138 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:55:09,138 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 05:55:10,712 - d365 - ERROR - Failed to fetch audit logs page: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:55:10,712 - d365 - ERROR - Failed to fetch D365 audit logs: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 05:55:10,714 - d365 - WARNING - Fallback CSV data/audit_logs.csv not found, returning empty DataFrame
2025-06-02 05:55:10,724 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 05:55:11,112 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b02c75f2-ab55-462b-a5e6-d4aed3103600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:55:10 GMT'
    'Content-Length': '1753'
2025-06-02 05:55:11,114 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 05:55:11,466 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b4b9e62a-106a-44a7-8567-73e9abbd4900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 05:55:11 GMT'
    'Content-Length': '1995'
2025-06-02 05:55:11,467 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 05:55:11,467 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:04:13,917 - d365 - ERROR - Missing required environment variables: ['KEKA_API_TOKEN']
2025-06-02 06:05:08,534 - d365 - INFO - Loading D365 data
2025-06-02 06:05:11,798 - d365 - ERROR - Failed to fetch audit logs page: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 06:05:11,798 - d365 - ERROR - Failed to fetch D365 audit logs: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 06:05:11,798 - d365 - WARNING - CSV file data/audit_logs.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:05:12,177 - d365 - ERROR - Failed to fetch sign-in logs: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/auditLogs/signIns
2025-06-02 06:05:12,178 - d365 - WARNING - CSV file data/signin_logs.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:05:12,368 - d365 - ERROR - Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:05:12,369 - d365 - ERROR - Failed to fetch user details: 500: Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:05:12,369 - d365 - WARNING - CSV file data/user_details.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:05:14,982 - d365 - ERROR - Failed to fetch D365 roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/roles?$select=roleid,name,componentstate
2025-06-02 06:05:14,982 - d365 - WARNING - CSV file data/app_roles.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:05:16,819 - d365 - ERROR - Failed to fetch D365 user roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/systemusers?$select=systemuserid,fullname,internalemailaddress,businessunitid&$expand=systemuserroles_association($select=roleid,createdon)
2025-06-02 06:05:16,820 - d365 - ERROR - Response content: 
2025-06-02 06:05:16,820 - d365 - WARNING - User role assignments may not be available in this environment. Please confirm with the admin.
2025-06-02 06:05:16,820 - d365 - WARNING - CSV file data/app_role_assignments.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:05:16,937 - d365 - ERROR - Failed to fetch conditional access policies: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies
2025-06-02 06:05:16,937 - d365 - WARNING - CSV file data/conditional_access_policies.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:05:18,600 - d365 - ERROR - Failed to fetch business units: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/businessunits?$select=businessunitid,name,parentbusinessunitid
2025-06-02 06:05:18,600 - d365 - WARNING - CSV file data/business_units.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:05:18,603 - d365 - WARNING - users_without_entra_id.csv not found, returning empty DataFrame
2025-06-02 06:05:18,605 - d365 - WARNING - users_without_d365_license.csv not found, returning empty DataFrame
2025-06-02 06:05:18,606 - d365 - INFO - Created group_memberships with 0 rows
2025-06-02 06:05:18,606 - d365 - INFO - D365 data loaded successfully
2025-06-02 06:10:50,045 - d365 - INFO - Loading D365 data
2025-06-02 06:10:54,827 - d365 - ERROR - Failed to fetch audit logs page: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 06:10:54,827 - d365 - ERROR - Failed to fetch D365 audit logs: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 06:10:54,827 - d365 - WARNING - CSV file data/audit_logs.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:10:55,190 - d365 - ERROR - Failed to fetch sign-in logs: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/auditLogs/signIns
2025-06-02 06:10:55,191 - d365 - WARNING - CSV file data/signin_logs.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:10:55,318 - d365 - ERROR - Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:10:55,319 - d365 - ERROR - Failed to fetch user details: 500: Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:10:55,319 - d365 - WARNING - CSV file data/user_details.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:10:57,557 - d365 - ERROR - Failed to fetch D365 roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/roles?$select=roleid,name,componentstate
2025-06-02 06:10:57,558 - d365 - WARNING - CSV file data/app_roles.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:11:02,426 - d365 - ERROR - Failed to fetch D365 user roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/systemusers?$select=systemuserid,fullname,internalemailaddress,businessunitid&$expand=systemuserroles_association($select=roleid,createdon)
2025-06-02 06:11:02,426 - d365 - ERROR - Response content: 
2025-06-02 06:11:02,426 - d365 - WARNING - User role assignments may not be available in this environment. Please confirm with the admin.
2025-06-02 06:11:02,426 - d365 - WARNING - CSV file data/app_role_assignments.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:11:02,581 - d365 - ERROR - Failed to fetch conditional access policies: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies
2025-06-02 06:11:02,581 - d365 - WARNING - CSV file data/conditional_access_policies.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:11:05,059 - d365 - ERROR - Failed to fetch business units: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/businessunits?$select=businessunitid,name,parentbusinessunitid
2025-06-02 06:11:05,059 - d365 - WARNING - CSV file data/business_units.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:11:05,061 - d365 - WARNING - users_without_entra_id.csv not found, returning empty DataFrame
2025-06-02 06:11:05,061 - d365 - WARNING - users_without_d365_license.csv not found, returning empty DataFrame
2025-06-02 06:11:05,062 - d365 - INFO - Created group_memberships with 0 rows
2025-06-02 06:11:05,062 - d365 - INFO - D365 data loaded successfully
2025-06-02 06:19:31,999 - d365 - INFO - Loading D365 data
2025-06-02 06:19:32,002 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:19:32,462 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a85b8ed2-57ad-4dd3-93c9-c9f647b90000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:19:32 GMT'
    'Content-Length': '1753'
2025-06-02 06:19:32,467 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:19:32,747 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5ecafb29-3a32-4814-8a98-35e0900d5100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:19:33 GMT'
    'Content-Length': '1645'
2025-06-02 06:19:32,748 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:19:32,748 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:19:32,748 - d365 - ERROR - Failed to load D365 data: name 'datetime' is not defined
2025-06-02 06:19:32,749 - d365 - ERROR - Initial data fetch failed: 500: Failed to load D365 data: name 'datetime' is not defined
2025-06-02 06:22:41,894 - d365 - INFO - Loading D365 data
2025-06-02 06:22:41,896 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:22:42,627 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd5524fe2-e174-4b45-9749-aacb08d11400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:22:42 GMT'
    'Content-Length': '1753'
2025-06-02 06:22:42,630 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:22:42,914 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '84a720eb-fe86-4c9d-bb9e-88c46d164300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:22:42 GMT'
    'Content-Length': '1647'
2025-06-02 06:22:42,915 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:22:42,915 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:22:42,915 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-04T06:22:42Z)
2025-06-02 06:22:51,161 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-02 06:22:55,674 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-02 06:23:00,054 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-02 06:23:04,303 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-02 06:23:09,398 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-02 06:23:15,180 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-02 06:23:16,541 - d365 - INFO - Progress: Fetched 31275 audit logs after 7 pages
2025-06-02 06:23:16,566 - d365 - INFO - Fetched 31275 D365 audit logs via Dataverse
2025-06-02 06:23:16,620 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-02 06:23:16,622 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:23:17,080 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '31a52703-5e91-4d6c-a9d1-28e03f812400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:23:17 GMT'
    'Content-Length': '1753'
2025-06-02 06:23:17,081 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:23:17,270 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7ab992d5-5e93-4842-9287-2630423d4600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:23:17 GMT'
    'Content-Length': '1997'
2025-06-02 06:23:17,270 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:23:17,270 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:23:17,270 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-04T06:23:17Z)
2025-06-02 06:23:17,270 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-02 06:23:26,633 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 6.4 req/min | Time: 0:00:09
2025-06-02 06:23:39,409 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 5.4 req/min | Time: 0:00:22
2025-06-02 06:23:57,874 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.4 req/min | Time: 0:00:40
2025-06-02 06:24:12,936 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 4.3 req/min | Time: 0:00:55
2025-06-02 06:24:26,272 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.3 req/min | Time: 0:01:09
2025-06-02 06:24:34,698 - d365 - INFO - Progress: 6,000 records | Pages: 6 | Requests: 6 | Rate: 4.6 req/min | Time: 0:01:17
2025-06-02 06:24:43,767 - d365 - INFO - Progress: 7,000 records | Pages: 7 | Requests: 7 | Rate: 4.9 req/min | Time: 0:01:26
2025-06-02 06:24:56,681 - d365 - INFO - Progress: 8,000 records | Pages: 8 | Requests: 8 | Rate: 4.8 req/min | Time: 0:01:39
2025-06-02 06:25:06,551 - d365 - INFO - Progress: 9,000 records | Pages: 9 | Requests: 9 | Rate: 4.9 req/min | Time: 0:01:49
2025-06-02 06:25:13,377 - d365 - INFO - Progress: 10,000 records | Pages: 10 | Requests: 10 | Rate: 5.2 req/min | Time: 0:01:56
2025-06-02 06:25:24,103 - d365 - INFO - Progress: 11,000 records | Pages: 11 | Requests: 11 | Rate: 5.2 req/min | Time: 0:02:06
2025-06-02 06:25:33,541 - d365 - INFO - Progress: 12,000 records | Pages: 12 | Requests: 12 | Rate: 5.3 req/min | Time: 0:02:16
2025-06-02 06:25:40,948 - d365 - INFO - Progress: 12,746 records | Pages: 13 | Requests: 13 | Rate: 5.4 req/min | Time: 0:02:23
2025-06-02 06:25:41,450 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-03T06:24:28Z to 2025-06-02T06:19:07Z
2025-06-02 06:25:41,575 - d365 - INFO - Fetch completed: 12,746 records in 0:02:24
2025-06-02 06:25:41,575 - d365 - INFO - Total requests made: 13
2025-06-02 06:25:41,870 - d365 - ERROR - Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:25:41,870 - d365 - ERROR - Failed to fetch user details: 500: Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:25:41,871 - d365 - WARNING - CSV file data/user_details.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:25:46,513 - d365 - ERROR - Failed to fetch D365 roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/roles?$select=roleid,name,componentstate
2025-06-02 06:25:46,513 - d365 - WARNING - CSV file data/app_roles.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:25:49,471 - d365 - ERROR - Failed to fetch D365 user roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/systemusers?$select=systemuserid,fullname,internalemailaddress,businessunitid&$expand=systemuserroles_association($select=roleid,createdon)
2025-06-02 06:25:49,471 - d365 - ERROR - Response content: 
2025-06-02 06:25:49,471 - d365 - WARNING - User role assignments may not be available in this environment. Please confirm with the admin.
2025-06-02 06:25:49,471 - d365 - WARNING - CSV file data/app_role_assignments.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:25:49,691 - d365 - ERROR - Failed to fetch conditional access policies: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies
2025-06-02 06:25:49,692 - d365 - WARNING - CSV file data/conditional_access_policies.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:25:55,398 - d365 - ERROR - Failed to fetch business units: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/businessunits?$select=businessunitid,name,parentbusinessunitid
2025-06-02 06:25:55,399 - d365 - WARNING - CSV file data/business_units.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:25:55,401 - d365 - WARNING - users_without_entra_id.csv not found, returning empty DataFrame
2025-06-02 06:25:55,402 - d365 - WARNING - users_without_d365_license.csv not found, returning empty DataFrame
2025-06-02 06:25:55,403 - d365 - INFO - Created group_memberships with 0 rows
2025-06-02 06:25:55,404 - d365 - INFO - D365 data loaded successfully
2025-06-02 06:34:21,057 - d365 - INFO - Loading D365 data
2025-06-02 06:34:21,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:34:21,502 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd9cebf41-7060-4984-8df6-49f816001300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:34:21 GMT'
    'Content-Length': '1753'
2025-06-02 06:34:21,505 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:34:21,676 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '764b77b8-8f7f-4344-9077-236e4ed80200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:34:21 GMT'
    'Content-Length': '1653'
2025-06-02 06:34:21,676 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:34:21,677 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:34:24,531 - d365 - ERROR - Failed to fetch audit logs page: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 06:34:24,531 - d365 - ERROR - Failed to fetch D365 audit logs: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/audits?$select=auditid,action,createdon,userid,objectid
2025-06-02 06:34:24,578 - d365 - INFO - Loaded 31275 audit logs from CSV
2025-06-02 06:34:24,579 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:34:24,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1857c86c-0f93-43fe-abf5-b29869895300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:34:24 GMT'
    'Content-Length': '1753'
2025-06-02 06:34:24,948 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:34:25,178 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f3496cce-c9eb-4425-9ae7-50a73b974d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:34:24 GMT'
    'Content-Length': '1991'
2025-06-02 06:34:25,179 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:34:25,179 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:35:18,022 - d365 - INFO - Loading D365 data
2025-06-02 06:35:18,024 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:35:18,318 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0893a9a2-7611-41fa-8598-004accc91200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:35:18 GMT'
    'Content-Length': '1753'
2025-06-02 06:35:18,320 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:35:18,519 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e38caf2e-bcb4-4b7e-8478-70fba7992f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:35:18 GMT'
    'Content-Length': '1647'
2025-06-02 06:35:18,520 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:35:18,520 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:35:18,520 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:35:18,816 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'abb0e9de-4cbe-4782-924a-6f2126932900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:35:18 GMT'
    'Content-Length': '1753'
2025-06-02 06:35:18,817 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:35:19,045 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'be36c10f-4e34-47c2-bde0-56de096b3a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:35:18 GMT'
    'Content-Length': '1992'
2025-06-02 06:35:19,046 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:35:19,046 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:35:19,047 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:35:19,258 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '445675ae-a282-431a-bdfb-8bdf12ae4b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:35:19 GMT'
    'Content-Length': '1753'
2025-06-02 06:35:19,259 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:35:19,474 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4c4d0f20-c064-4d3f-a673-a2fd2ef24800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:35:19 GMT'
    'Content-Length': '1989'
2025-06-02 06:35:19,475 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:35:19,475 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:35:22,071 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-02 06:35:22,071 - d365 - INFO - Found 975 users in Entra ID
2025-06-02 06:35:23,313 - d365 - INFO - Fetched 932 user records from D365
2025-06-02 06:36:35,030 - d365 - WARNING - No manager found for Azure AD ID 89a27250-0c07-4264-80bf-bcc936aebe71
2025-06-02 06:36:35,031 - d365 - ERROR - KEKA_API_TOKEN not set in environment variables
2025-06-02 06:36:40,709 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-02 06:36:40,710 - d365 - ERROR - KEKA_API_TOKEN not set in environment variables
2025-06-02 06:37:47,913 - d365 - INFO - Loading D365 data
2025-06-02 06:37:48,178 - d365 - ERROR - Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:37:48,179 - d365 - ERROR - Failed to fetch user details: 500: Failed to fetch Entra ID users: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users?$select=id,mail,userPrincipalName
2025-06-02 06:37:48,179 - d365 - WARNING - CSV file data/user_details.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:37:53,319 - d365 - ERROR - Failed to fetch D365 roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/roles?$select=roleid,name,componentstate
2025-06-02 06:37:53,319 - d365 - WARNING - CSV file data/app_roles.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:37:56,010 - d365 - ERROR - Failed to fetch D365 user roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/systemusers?$select=systemuserid,fullname,internalemailaddress,businessunitid&$expand=systemuserroles_association($select=roleid,createdon)
2025-06-02 06:37:56,011 - d365 - ERROR - Response content: 
2025-06-02 06:37:56,011 - d365 - WARNING - User role assignments may not be available in this environment. Please confirm with the admin.
2025-06-02 06:37:56,011 - d365 - WARNING - CSV file data/app_role_assignments.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:37:56,164 - d365 - ERROR - Failed to fetch conditional access policies: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies
2025-06-02 06:37:56,164 - d365 - WARNING - CSV file data/conditional_access_policies.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:38:01,430 - d365 - ERROR - Failed to fetch business units: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/businessunits?$select=businessunitid,name,parentbusinessunitid
2025-06-02 06:38:01,430 - d365 - WARNING - CSV file data/business_units.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:38:01,433 - d365 - WARNING - users_without_entra_id.csv not found, returning empty DataFrame
2025-06-02 06:38:01,434 - d365 - WARNING - users_without_d365_license.csv not found, returning empty DataFrame
2025-06-02 06:38:01,435 - d365 - INFO - Created group_memberships with 0 rows
2025-06-02 06:38:01,435 - d365 - INFO - D365 data loaded successfully
2025-06-02 06:41:35,057 - d365 - INFO - Loading D365 data
2025-06-02 06:41:35,058 - d365 - ERROR - Failed to fetch user details: fetch_entra_users() takes 0 positional arguments but 1 was given
2025-06-02 06:41:35,059 - d365 - WARNING - CSV file data/user_details.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:41:35,953 - d365 - ERROR - Failed to fetch D365 roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/roles?$select=roleid,name,componentstate
2025-06-02 06:41:35,954 - d365 - WARNING - CSV file data/app_roles.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:41:38,840 - d365 - ERROR - Failed to fetch D365 user roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/systemusers?$select=systemuserid,fullname,internalemailaddress,businessunitid&$expand=systemuserroles_association($select=roleid,createdon)
2025-06-02 06:41:38,841 - d365 - ERROR - Response content: 
2025-06-02 06:41:38,842 - d365 - WARNING - User role assignments may not be available in this environment. Please confirm with the admin.
2025-06-02 06:41:38,842 - d365 - WARNING - CSV file data/app_role_assignments.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:41:39,190 - d365 - ERROR - Failed to fetch conditional access policies: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies
2025-06-02 06:41:39,190 - d365 - WARNING - CSV file data/conditional_access_policies.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:41:44,663 - d365 - ERROR - Failed to fetch business units: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/businessunits?$select=businessunitid,name,parentbusinessunitid
2025-06-02 06:41:44,664 - d365 - WARNING - CSV file data/business_units.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:41:44,665 - d365 - WARNING - users_without_entra_id.csv not found, returning empty DataFrame
2025-06-02 06:41:44,666 - d365 - WARNING - users_without_d365_license.csv not found, returning empty DataFrame
2025-06-02 06:41:44,667 - d365 - INFO - Created group_memberships with 0 rows
2025-06-02 06:41:44,667 - d365 - INFO - D365 data loaded successfully
2025-06-02 06:42:13,064 - d365 - INFO - Loading D365 data
2025-06-02 06:42:13,067 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:42:14,675 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fff7782b-e8f1-4566-8060-dcca0e703d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:42:15 GMT'
    'Content-Length': '1753'
2025-06-02 06:42:14,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:42:14,907 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'fff7782b-e8f1-4566-8060-dcca1a703d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:42:15 GMT'
    'Content-Length': '1989'
2025-06-02 06:42:14,907 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:42:14,908 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:42:17,391 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-02 06:42:17,391 - d365 - INFO - Found 975 users in Entra ID
2025-06-02 06:42:20,551 - d365 - ERROR - Failed to fetch user details: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/systemusers?$select=systemuserid,fullname,internalemailaddress,businessunitid,parentsystemuserid,azureactivedirectoryobjectid,isdisabled
2025-06-02 06:42:20,552 - d365 - WARNING - CSV file data/user_details.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:42:26,295 - d365 - ERROR - Failed to fetch D365 roles: 401 Client Error: Unauthorized for url: https://pcsuat1.crm4.dynamics.com/api/data/v9.2/roles?$select=roleid,name,componentstate
2025-06-02 06:42:26,296 - d365 - WARNING - CSV file data/app_roles.csv is empty or does not exist, returning empty DataFrame
2025-06-02 06:45:56,865 - d365 - INFO - Loading D365 data
2025-06-02 06:45:56,866 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:45:57,262 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2a471f8b-b79d-4e60-a876-b15916634700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:45:57 GMT'
    'Content-Length': '1753'
2025-06-02 06:45:57,265 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:45:57,446 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2336fc55-2aaa-4967-8c40-893aeafc5b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:45:57 GMT'
    'Content-Length': '1648'
2025-06-02 06:45:57,447 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:45:57,447 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:45:57,447 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-04T06:45:57Z)
2025-06-02 06:46:01,897 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-02 06:46:05,566 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-02 06:46:10,353 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-02 06:46:14,440 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-02 06:46:18,603 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-02 06:46:23,022 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-02 06:46:24,325 - d365 - INFO - Progress: Fetched 31277 audit logs after 7 pages
2025-06-02 06:46:24,352 - d365 - INFO - Fetched 31277 D365 audit logs via Dataverse
2025-06-02 06:46:24,399 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-02 06:46:24,402 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:46:24,711 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b94da5c9-59f6-412c-9693-4e5c834c3500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:46:25 GMT'
    'Content-Length': '1753'
2025-06-02 06:46:24,712 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:46:24,930 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8693c904-8bb8-40e6-a76c-3aa2cb966000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:46:25 GMT'
    'Content-Length': '1992'
2025-06-02 06:46:24,930 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:46:24,930 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:46:24,930 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-04T06:46:24Z)
2025-06-02 06:46:24,930 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-02 06:46:34,899 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 6.0 req/min | Time: 0:00:09
2025-06-02 06:46:46,516 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 5.6 req/min | Time: 0:00:21
2025-06-02 06:46:56,243 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.7 req/min | Time: 0:00:31
2025-06-02 06:47:03,100 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 6.3 req/min | Time: 0:00:38
2025-06-02 06:47:11,465 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 6.4 req/min | Time: 0:00:46
2025-06-02 06:47:21,551 - d365 - INFO - Progress: 6,000 records | Pages: 6 | Requests: 6 | Rate: 6.4 req/min | Time: 0:00:56
2025-06-02 06:47:28,747 - d365 - INFO - Progress: 7,000 records | Pages: 7 | Requests: 7 | Rate: 6.6 req/min | Time: 0:01:03
2025-06-02 06:47:36,393 - d365 - INFO - Progress: 8,000 records | Pages: 8 | Requests: 8 | Rate: 6.7 req/min | Time: 0:01:11
2025-06-02 06:47:42,337 - d365 - INFO - Progress: 9,000 records | Pages: 9 | Requests: 9 | Rate: 7.0 req/min | Time: 0:01:17
2025-06-02 06:47:48,905 - d365 - INFO - Progress: 10,000 records | Pages: 10 | Requests: 10 | Rate: 7.1 req/min | Time: 0:01:23
2025-06-02 06:48:00,994 - d365 - INFO - Progress: 11,000 records | Pages: 11 | Requests: 11 | Rate: 6.9 req/min | Time: 0:01:36
2025-06-02 06:48:07,685 - d365 - INFO - Progress: 12,000 records | Pages: 12 | Requests: 12 | Rate: 7.0 req/min | Time: 0:01:42
2025-06-02 06:48:15,486 - d365 - INFO - Progress: 12,738 records | Pages: 13 | Requests: 13 | Rate: 7.1 req/min | Time: 0:01:50
2025-06-02 06:48:15,988 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-03T06:46:52Z to 2025-06-02T06:37:50Z
2025-06-02 06:48:16,099 - d365 - INFO - Fetch completed: 12,738 records in 0:01:51
2025-06-02 06:48:16,099 - d365 - INFO - Total requests made: 13
2025-06-02 06:48:16,107 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:48:16,784 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '06bf03ef-64c3-4a0f-8aea-f6dd05653700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:48:16 GMT'
    'Content-Length': '1753'
2025-06-02 06:48:16,786 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:48:17,034 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5cf2e660-b281-4835-a9f5-9870c6b14e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:48:17 GMT'
    'Content-Length': '1647'
2025-06-02 06:48:17,035 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:48:17,035 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:48:17,036 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:48:17,472 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '119ee04a-7362-461b-9ab5-d63651873d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:48:17 GMT'
    'Content-Length': '1753'
2025-06-02 06:48:17,473 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:48:17,663 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '829a5846-32c8-4f04-80d4-15ac26fc4f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:48:17 GMT'
    'Content-Length': '1997'
2025-06-02 06:48:17,664 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:48:17,664 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:48:17,665 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:48:18,038 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '57e87f2f-8871-4dff-8d04-b6f851042800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:48:18 GMT'
    'Content-Length': '1753'
2025-06-02 06:48:18,039 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:48:18,224 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'cc985518-e7b3-4cc9-8252-c96420085300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:48:18 GMT'
    'Content-Length': '1997'
2025-06-02 06:48:18,225 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:48:18,225 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:48:21,076 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-02 06:48:21,077 - d365 - INFO - Found 975 users in Entra ID
2025-06-02 06:48:22,507 - d365 - INFO - Fetched 932 user records from D365
2025-06-02 06:49:37,352 - d365 - WARNING - No manager found for Azure AD ID 89a27250-0c07-4264-80bf-bcc936aebe71
2025-06-02 06:49:37,353 - d365 - ERROR - Failed to fetch user details: name 'KEKA_API_TOKEN' is not defined
2025-06-02 06:49:37,354 - d365 - WARNING - Fallback CSV data/user_details.csv not found, returning empty DataFrame
2025-06-02 06:49:37,359 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:49:37,780 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3fc2753a-0c96-440d-bf07-a7354d0f4400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:37 GMT'
    'Content-Length': '1753'
2025-06-02 06:49:37,782 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:49:38,036 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4a3d022f-4669-4649-b8ba-167dab9d4800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:38 GMT'
    'Content-Length': '1647'
2025-06-02 06:49:38,037 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:49:38,037 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:49:39,427 - d365 - INFO - Fetched 2101 D365 security roles
2025-06-02 06:49:39,432 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-02 06:49:39,434 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:49:39,818 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e9b63d1b-0698-490b-8145-134ffea43600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:40 GMT'
    'Content-Length': '1753'
2025-06-02 06:49:39,819 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:49:40,057 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ee873426-be4c-468b-a7c3-c33cb5764900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:40 GMT'
    'Content-Length': '1652'
2025-06-02 06:49:40,057 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:49:40,058 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:49:42,241 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-02 06:49:42,245 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-02 06:49:42,246 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:49:42,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f7d93481-d2a5-405b-9fda-6a4518c14f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:43 GMT'
    'Content-Length': '1753'
2025-06-02 06:49:42,653 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:49:42,892 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a53c403c-94a0-4d11-9f47-e7f0c9932400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:43 GMT'
    'Content-Length': '1996'
2025-06-02 06:49:42,893 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:49:42,893 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 06:49:46,393 - d365 - INFO - Fetched 35 conditional access policies
2025-06-02 06:49:46,394 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-02 06:49:46,395 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 06:49:46,810 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2384930d-0964-4669-b36e-86cfe3992100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:47 GMT'
    'Content-Length': '1753'
2025-06-02 06:49:46,811 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 06:49:46,997 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'daca5146-b73b-4a99-b04c-3dba90054600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 06:49:47 GMT'
    'Content-Length': '1653'
2025-06-02 06:49:46,998 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 06:49:46,998 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 06:49:47,781 - d365 - INFO - Fetched 11 business units
2025-06-02 06:49:47,785 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-02 06:49:47,796 - d365 - INFO - D365 data loaded successfully
2025-06-02 06:49:47,797 - d365 - ERROR - Initial data fetch failed: not enough values to unpack (expected 11, got 4)
2025-06-02 07:00:36,957 - d365 - INFO - Loading D365 data
2025-06-02 07:00:36,961 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:00:37,533 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e904fc76-142a-4df3-8877-068dd8522800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:00:37 GMT'
    'Content-Length': '1753'
2025-06-02 07:00:37,540 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:00:37,761 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'be285026-07ab-426a-87ae-4717e95f4600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:00:37 GMT'
    'Content-Length': '1647'
2025-06-02 07:00:37,761 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:00:37,761 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 07:00:37,761 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-04T07:00:37Z)
2025-06-02 07:00:42,409 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-02 07:00:45,621 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-02 07:00:49,632 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-02 07:00:52,949 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-02 07:00:56,130 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-02 07:00:59,521 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-02 07:01:00,525 - d365 - INFO - Progress: Fetched 31280 audit logs after 7 pages
2025-06-02 07:01:00,554 - d365 - INFO - Fetched 31280 D365 audit logs via Dataverse
2025-06-02 07:01:00,602 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-02 07:01:00,605 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:01:01,074 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a5c06bf5-72a6-417a-bdca-c2c6863f2f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:01:00 GMT'
    'Content-Length': '1753'
2025-06-02 07:01:01,075 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:01:01,285 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8175ae38-4e0e-4f77-808a-e227aedc4d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:01:01 GMT'
    'Content-Length': '1997'
2025-06-02 07:01:01,286 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:01:01,286 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 07:01:01,287 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-04T07:01:01Z)
2025-06-02 07:01:01,287 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-02 07:01:11,634 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 5.8 req/min | Time: 0:00:10
2025-06-02 07:01:24,931 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 5.1 req/min | Time: 0:00:23
2025-06-02 07:01:38,109 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.9 req/min | Time: 0:00:36
2025-06-02 07:01:47,767 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.2 req/min | Time: 0:00:46
2025-06-02 07:01:55,225 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.6 req/min | Time: 0:00:53
2025-06-02 07:02:04,113 - d365 - INFO - Progress: 6,000 records | Pages: 6 | Requests: 6 | Rate: 5.7 req/min | Time: 0:01:02
2025-06-02 07:02:12,486 - d365 - INFO - Progress: 7,000 records | Pages: 7 | Requests: 7 | Rate: 5.9 req/min | Time: 0:01:11
2025-06-02 07:02:23,800 - d365 - INFO - Progress: 8,000 records | Pages: 8 | Requests: 8 | Rate: 5.8 req/min | Time: 0:01:22
2025-06-02 07:02:29,717 - d365 - INFO - Progress: 9,000 records | Pages: 9 | Requests: 9 | Rate: 6.1 req/min | Time: 0:01:28
2025-06-02 07:02:35,807 - d365 - INFO - Progress: 10,000 records | Pages: 10 | Requests: 10 | Rate: 6.3 req/min | Time: 0:01:34
2025-06-02 07:02:44,212 - d365 - INFO - Progress: 11,000 records | Pages: 11 | Requests: 11 | Rate: 6.4 req/min | Time: 0:01:42
2025-06-02 07:02:52,169 - d365 - INFO - Progress: 12,000 records | Pages: 12 | Requests: 12 | Rate: 6.5 req/min | Time: 0:01:50
2025-06-02 07:02:57,007 - d365 - INFO - Progress: 12,732 records | Pages: 13 | Requests: 13 | Rate: 6.7 req/min | Time: 0:01:55
2025-06-02 07:02:57,508 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-03T07:02:59Z to 2025-06-02T06:55:49Z
2025-06-02 07:02:57,622 - d365 - INFO - Fetch completed: 12,732 records in 0:01:56
2025-06-02 07:02:57,622 - d365 - INFO - Total requests made: 13
2025-06-02 07:02:57,630 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:02:58,155 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6fda1697-e8dd-4aa9-a694-b09bea484700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:02:58 GMT'
    'Content-Length': '1753'
2025-06-02 07:02:58,157 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:02:58,360 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2690c38f-fae5-420b-bfa6-1c32ae3b3900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:02:58 GMT'
    'Content-Length': '1648'
2025-06-02 07:02:58,361 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:02:58,362 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 07:02:58,363 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:02:58,627 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a5ca07e3-2e3b-4889-87b6-40c309191200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:02:58 GMT'
    'Content-Length': '1753'
2025-06-02 07:02:58,629 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:02:58,824 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e4ccb58a-e689-430d-ba17-bd03d0604400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:02:59 GMT'
    'Content-Length': '1996'
2025-06-02 07:02:58,825 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:02:58,825 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 07:02:58,826 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:02:59,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5340ee22-8f54-44f7-938a-7f540c844600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:02:59 GMT'
    'Content-Length': '1753'
2025-06-02 07:02:59,153 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:02:59,343 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '706e670a-1ea5-4fee-a34c-8396a7010400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:02:59 GMT'
    'Content-Length': '1992'
2025-06-02 07:02:59,344 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:02:59,344 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 07:03:02,185 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-02 07:03:02,186 - d365 - INFO - Found 975 users in Entra ID
2025-06-02 07:03:03,454 - d365 - INFO - Fetched 932 user records from D365
2025-06-02 07:04:17,405 - d365 - WARNING - No manager found for Azure AD ID 89a27250-0c07-4264-80bf-bcc936aebe71
2025-06-02 07:04:17,405 - d365 - WARNING - No manager found for Azure AD ID 89a27250-0c07-4264-80bf-bcc936aebe71 via Dataverse or Graph API
2025-06-02 07:04:23,024 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-02 07:04:23,025 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-02 07:05:12,339 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-02 07:05:12,340 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-02 07:05:15,273 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-02 07:05:15,274 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-02 07:05:21,145 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-02 07:05:21,145 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-02 07:06:17,615 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-02 07:06:17,618 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-02 07:06:48,779 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-02 07:06:48,780 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-02 07:07:08,657 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-02 07:07:08,658 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-02 07:07:56,672 - d365 - INFO - Filtered out 410 D365 users not present in Entra ID
2025-06-02 07:07:56,673 - d365 - INFO - Filtered out 315 D365 users without a D365 license
2025-06-02 07:07:56,673 - d365 - INFO - Final user count after filtering: 207
2025-06-02 07:07:56,675 - d365 - INFO - Fetched 207 user details after filtering
2025-06-02 07:07:56,685 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-02 07:07:56,690 - d365 - INFO - Saved 410 users without Entra ID to data/users_without_entra_id.csv
2025-06-02 07:07:56,693 - d365 - INFO - Saved 315 users without D365 license to data/users_without_d365_license.csv
2025-06-02 07:07:56,695 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:08:15,047 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:08:15,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b56d03cb-3527-4a7b-8cfa-0c98894f4d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:15 GMT'
    'Content-Length': '1753'
2025-06-02 07:08:15,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:08:15,545 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e049add5-8dd3-4468-ae8e-f71e68ea6700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:15 GMT'
    'Content-Length': '1647'
2025-06-02 07:08:15,546 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:08:15,547 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 07:08:17,073 - d365 - INFO - Fetched 2101 D365 security roles
2025-06-02 07:08:17,080 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-02 07:08:17,081 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:08:17,413 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2a656042-fadb-4c19-ac1f-44b89afb4700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:17 GMT'
    'Content-Length': '1753'
2025-06-02 07:08:17,414 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:08:17,616 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '57007e70-351d-4601-b491-976d69433100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:17 GMT'
    'Content-Length': '1651'
2025-06-02 07:08:17,618 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:08:17,618 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 07:08:19,865 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-02 07:08:19,871 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-02 07:08:19,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:08:20,177 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4a3d022f-4669-4649-b8ba-167d94594900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:20 GMT'
    'Content-Length': '1753'
2025-06-02 07:08:20,179 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:08:20,406 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '328857aa-325e-4c6d-a3f8-b8c1708f4500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:20 GMT'
    'Content-Length': '1991'
2025-06-02 07:08:20,406 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:08:20,406 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-02 07:08:23,225 - d365 - INFO - Fetched 35 conditional access policies
2025-06-02 07:08:23,230 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-02 07:08:23,231 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-02 07:08:23,465 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7bcb4072-e64f-4e69-a1d9-421345574e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:23 GMT'
    'Content-Length': '1753'
2025-06-02 07:08:23,466 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-02 07:08:23,613 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1ae19445-3b42-4690-a107-5bc6880b1300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 02 Jun 2025 07:08:23 GMT'
    'Content-Length': '1652'
2025-06-02 07:08:23,614 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-02 07:08:23,614 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-02 07:08:24,400 - d365 - INFO - Fetched 11 business units
2025-06-02 07:08:24,401 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-02 07:08:24,409 - d365 - INFO - D365 data loaded successfully
2025-06-03 07:32:45,709 - main - INFO - Loading data from CSV files
2025-06-03 07:32:45,824 - main - INFO - Loaded audit_logs with 31280 rows
2025-06-03 07:32:45,944 - main - INFO - Loaded signin_logs with 12732 rows
2025-06-03 07:32:45,953 - main - INFO - Loaded user_details with 207 rows
2025-06-03 07:32:45,964 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 07:32:45,974 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 07:32:46,047 - main - INFO - Created group_memberships with 3210 rows
2025-06-03 07:32:46,075 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 07:32:46,084 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 07:32:46,084 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['972af6ae-90d2-441e-8436-2860f812896f', '25dacb82-5251-4c72-b169-969637d4b37f', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', '005a3324-6c26-484a-be06-07d829df9a76', 'bfa5d2b9-f1ec-454e-82e1-9dad0275f657']...
2025-06-03 07:32:46,085 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['2c7a97ad-76b4-eb11-8236-000d3ab5a61f', '4050733f-13aa-eb11-8236-0022489b4c66', '87e80ea6-76b4-eb11-8236-000d3ab6406f', 'b3d4c4dc-68d3-ee11-907a-0022489ba240', 'd4e7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-03 07:32:46,085 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 07:32:49,796 - main - INFO - Generating embeddings (placeholder)
2025-06-03 07:32:56,676 - main - INFO - Running analysis (placeholder)
2025-06-03 07:33:40,863 - main - INFO - Loading data from CSV files
2025-06-03 07:33:40,907 - main - INFO - Loaded audit_logs with 31280 rows
2025-06-03 07:33:40,948 - main - INFO - Loaded signin_logs with 12732 rows
2025-06-03 07:33:40,951 - main - INFO - Loaded user_details with 207 rows
2025-06-03 07:33:40,954 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 07:33:40,957 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 07:33:40,995 - main - INFO - Created group_memberships with 3210 rows
2025-06-03 07:33:41,011 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 07:33:41,020 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 07:33:41,020 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['c1dac210-cb2b-4a68-8b6d-a78d0eab8001', '05bd23ee-2229-4eff-8de9-b0810c16a1f1', '3ac384df-adbd-464b-81e6-abcdbd1cebbc', 'f777b683-9def-4137-98a3-06e33f07fcc7', '42d1b83b-00fd-45b3-95a7-ed9c051441b7']...
2025-06-03 07:33:41,021 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['9f9e7032-84e8-ed11-a7c6-0022489b4de1', '464f568b-197d-ef11-ac21-0022489b4696', 'ac7997ad-76b4-eb11-8236-000d3ab5a61f', '41435676-ec67-ec11-8f8f-000d3ade64e5', '9ab79e09-6bc7-ed11-b597-0022489ba102']...
2025-06-03 07:33:41,021 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 07:33:44,029 - main - INFO - Generating embeddings (placeholder)
2025-06-03 07:33:46,796 - main - INFO - Running analysis (placeholder)
2025-06-03 07:40:37,823 - main - INFO - Fetching data using scripts/data_fetcher.py...
2025-06-03 07:40:37,831 - main - INFO - Data fetched successfully, now loading into memory...
2025-06-03 07:40:37,831 - main - INFO - Loading data from CSV files
2025-06-03 07:40:37,894 - main - INFO - Loaded audit_logs with 31280 rows
2025-06-03 07:40:37,956 - main - INFO - Loaded signin_logs with 12732 rows
2025-06-03 07:40:37,965 - main - INFO - Loaded user_details with 207 rows
2025-06-03 07:40:37,973 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 07:40:37,981 - main - INFO - Loaded app_role_assignments with 2101 rows
2025-06-03 07:40:38,041 - main - INFO - Created group_memberships with 3210 rows
2025-06-03 07:40:38,062 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 07:40:38,069 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 07:40:38,069 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['ccf6d52a-a45b-4d3a-810a-69bda63bec78', 'b36d70a1-f635-4f11-9be8-c9cb51b84298', 'f777b683-9def-4137-98a3-06e33f07fcc7', 'e5f47082-e16b-4429-9d36-09d4b1354a24', 'ce1ef25e-9f6a-4b20-8030-d30c630e5b1d']...
2025-06-03 07:40:38,070 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['01f87407-2a28-ee11-9966-0022489ba102', '408b16a0-76b4-eb11-8236-000d3ab6406f', 'be8b16a0-76b4-eb11-8236-000d3ab6406f', '99e7a382-f8bc-ec11-9840-0022489e2e28', '276654e0-28a4-ed11-aad1-0022489b4de1']...
2025-06-03 07:40:38,070 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 07:40:38,070 - main - INFO - Data loaded into memory successfully
2025-06-03 07:40:38,078 - main - INFO - Fetching data using scripts/data_fetcher.py...
2025-06-03 07:40:38,078 - main - INFO - Data fetched successfully, now loading into memory...
2025-06-03 07:40:38,079 - main - INFO - Loading data from CSV files
2025-06-03 07:40:38,118 - main - INFO - Loaded audit_logs with 31280 rows
2025-06-03 07:40:38,164 - main - INFO - Loaded signin_logs with 12732 rows
2025-06-03 07:40:38,167 - main - INFO - Loaded user_details with 207 rows
2025-06-03 07:40:38,170 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 07:40:38,174 - main - INFO - Loaded app_role_assignments with 2101 rows
2025-06-03 07:40:38,226 - main - INFO - Created group_memberships with 3210 rows
2025-06-03 07:40:38,245 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 07:40:38,252 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 07:40:38,252 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['ccf6d52a-a45b-4d3a-810a-69bda63bec78', 'b36d70a1-f635-4f11-9be8-c9cb51b84298', 'f777b683-9def-4137-98a3-06e33f07fcc7', 'e5f47082-e16b-4429-9d36-09d4b1354a24', 'ce1ef25e-9f6a-4b20-8030-d30c630e5b1d']...
2025-06-03 07:40:38,256 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['01f87407-2a28-ee11-9966-0022489ba102', '408b16a0-76b4-eb11-8236-000d3ab6406f', 'be8b16a0-76b4-eb11-8236-000d3ab6406f', '99e7a382-f8bc-ec11-9840-0022489e2e28', '276654e0-28a4-ed11-aad1-0022489b4de1']...
2025-06-03 07:40:38,256 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 07:40:38,257 - main - INFO - Data loaded into memory successfully
2025-06-03 07:45:46,115 - main - INFO - Fetching data using scripts/data_fetcher.py...
2025-06-03 07:45:46,116 - d365 - INFO - Loading D365 data
2025-06-03 07:45:46,123 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:45:47,720 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c51853f3-e001-4917-82e5-11a8dd4e7b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:45:46 GMT'
    'Content-Length': '1753'
2025-06-03 07:45:47,732 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:45:47,911 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0a31ca05-5896-459a-b166-93b7934f5b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:45:47 GMT'
    'Content-Length': '1648'
2025-06-03 07:45:47,912 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:45:47,912 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-03 07:45:47,912 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-05T07:45:47Z)
2025-06-03 07:45:53,488 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-03 07:45:57,166 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-03 07:46:01,262 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-03 07:46:05,541 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-03 07:46:09,969 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-03 07:46:14,120 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-03 07:46:15,300 - d365 - INFO - Progress: Fetched 31316 audit logs after 7 pages
2025-06-03 07:46:15,342 - d365 - INFO - Fetched 31316 D365 audit logs via Dataverse
2025-06-03 07:46:15,440 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-03 07:46:15,444 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:46:15,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '42942e2b-d323-49d6-9d41-aa6c5cde1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:46:14 GMT'
    'Content-Length': '1753'
2025-06-03 07:46:15,693 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:46:15,885 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2ea8251e-da68-4a88-b1d1-40f1c6ba7900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:46:15 GMT'
    'Content-Length': '1992'
2025-06-03 07:46:15,885 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:46:15,886 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-03 07:46:15,886 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-05T07:46:15Z)
2025-06-03 07:46:15,886 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-03 07:46:36,568 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 2.9 req/min | Time: 0:00:20
2025-06-03 07:46:54,070 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.1 req/min | Time: 0:00:38
2025-06-03 07:47:10,085 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 3.3 req/min | Time: 0:00:54
2025-06-03 07:47:25,852 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 3.4 req/min | Time: 0:01:09
2025-06-03 07:47:39,708 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 3.6 req/min | Time: 0:01:23
2025-06-03 07:47:49,173 - d365 - INFO - Progress: 6,000 records | Pages: 6 | Requests: 6 | Rate: 3.9 req/min | Time: 0:01:33
2025-06-03 07:47:58,555 - d365 - INFO - Progress: 7,000 records | Pages: 7 | Requests: 7 | Rate: 4.1 req/min | Time: 0:01:42
2025-06-03 07:48:13,550 - d365 - INFO - Progress: 8,000 records | Pages: 8 | Requests: 8 | Rate: 4.1 req/min | Time: 0:01:57
2025-06-03 07:48:24,832 - d365 - INFO - Progress: 9,000 records | Pages: 9 | Requests: 9 | Rate: 4.2 req/min | Time: 0:02:08
2025-06-03 07:48:33,469 - d365 - INFO - Progress: 10,000 records | Pages: 10 | Requests: 10 | Rate: 4.4 req/min | Time: 0:02:17
2025-06-03 07:48:43,276 - d365 - INFO - Progress: 11,000 records | Pages: 11 | Requests: 11 | Rate: 4.5 req/min | Time: 0:02:27
2025-06-03 07:48:54,805 - d365 - INFO - Progress: 11,917 records | Pages: 12 | Requests: 12 | Rate: 4.5 req/min | Time: 0:02:38
2025-06-03 07:48:55,306 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-04T07:47:49Z to 2025-06-03T07:36:47Z
2025-06-03 07:48:55,454 - d365 - INFO - Fetch completed: 11,917 records in 0:02:39
2025-06-03 07:48:55,454 - d365 - INFO - Total requests made: 12
2025-06-03 07:48:55,464 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:48:55,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd38be5ab-17d4-47ac-b758-4e8138320900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:48:55 GMT'
    'Content-Length': '1753'
2025-06-03 07:48:55,834 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:48:55,962 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '01715369-7c3b-40b8-96be-fecfc1976800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:48:55 GMT'
    'Content-Length': '1653'
2025-06-03 07:48:55,963 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:48:55,963 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-03 07:48:55,963 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:48:56,238 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3019616e-7e80-4826-9ae9-f744c5056c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:48:55 GMT'
    'Content-Length': '1753'
2025-06-03 07:48:56,239 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:48:56,450 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '984b9410-c4c2-4821-a2ad-ebf0c40b6800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:48:55 GMT'
    'Content-Length': '1996'
2025-06-03 07:48:56,451 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:48:56,451 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-03 07:48:56,452 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:48:56,718 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '637bf19f-c4af-48b0-ab44-f87572567200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:48:56 GMT'
    'Content-Length': '1753'
2025-06-03 07:48:56,719 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:48:56,925 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1e33ca2a-33e4-48e9-9dc0-4315120f1000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:48:56 GMT'
    'Content-Length': '1996'
2025-06-03 07:48:56,925 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:48:56,926 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-03 07:49:00,435 - d365 - INFO - Fetched 971 users from Entra ID
2025-06-03 07:49:00,436 - d365 - INFO - Found 971 users in Entra ID
2025-06-03 07:49:01,957 - d365 - INFO - Fetched 933 user records from D365
2025-06-03 07:50:23,769 - d365 - WARNING - No manager found for Azure AD ID 89a27250-0c07-4264-80bf-bcc936aebe71
2025-06-03 07:50:23,769 - d365 - WARNING - No manager found for Azure AD ID 89a27250-0c07-4264-80bf-bcc936aebe71 via Dataverse or Graph API
2025-06-03 07:50:28,647 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-03 07:50:28,647 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-03 07:51:11,205 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-03 07:51:11,206 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-03 07:51:13,667 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-03 07:51:13,667 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-03 07:51:18,831 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-03 07:51:18,831 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-03 07:52:08,714 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-03 07:52:08,715 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-03 07:52:36,284 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-03 07:52:36,284 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-03 07:52:53,323 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-03 07:52:53,323 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-03 07:53:36,365 - d365 - INFO - Filtered out 414 D365 users not present in Entra ID
2025-06-03 07:53:36,366 - d365 - INFO - Filtered out 312 D365 users without a D365 license
2025-06-03 07:53:36,366 - d365 - INFO - Final user count after filtering: 207
2025-06-03 07:53:36,367 - d365 - INFO - Fetched 207 user details after filtering
2025-06-03 07:53:36,377 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-03 07:53:36,386 - d365 - INFO - Saved 414 users without Entra ID to data/users_without_entra_id.csv
2025-06-03 07:53:36,389 - d365 - INFO - Saved 312 users without D365 license to data/users_without_d365_license.csv
2025-06-03 07:53:36,391 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:53:37,053 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '276749cd-c4b0-4b33-9462-316018251200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:36 GMT'
    'Content-Length': '1753'
2025-06-03 07:53:37,054 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:53:37,273 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3894d8ad-8573-43b4-ab3b-36f2c2441000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:37 GMT'
    'Content-Length': '1652'
2025-06-03 07:53:37,273 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:53:37,274 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-03 07:53:38,885 - d365 - INFO - Fetched 2101 D365 security roles
2025-06-03 07:53:38,894 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-03 07:53:38,895 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:53:39,235 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c64924a7-e2f2-486b-9277-4250eb355b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:38 GMT'
    'Content-Length': '1753'
2025-06-03 07:53:39,236 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:53:39,525 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b4ccb888-e078-4390-8171-2850ef857800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:39 GMT'
    'Content-Length': '1647'
2025-06-03 07:53:39,526 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:53:39,526 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-03 07:53:42,595 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-03 07:53:42,605 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-03 07:53:42,606 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:53:42,977 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '19255c72-d6c8-475a-8e99-fd2ab1401d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:41 GMT'
    'Content-Length': '1753'
2025-06-03 07:53:42,978 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:53:43,218 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '75674620-9d5b-4161-91e9-0aad95b70f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:42 GMT'
    'Content-Length': '1991'
2025-06-03 07:53:43,219 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:53:43,219 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-03 07:53:46,505 - d365 - INFO - Fetched 35 conditional access policies
2025-06-03 07:53:46,511 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-03 07:53:46,512 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
No body was attached to the request
2025-06-03 07:53:46,855 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c51853f3-e001-4917-82e5-11a86e8b7b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:45 GMT'
    'Content-Length': '1753'
2025-06-03 07:53:46,855 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.11.2 (Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36)'
A body is sent with the request
2025-06-03 07:53:47,022 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0e1c689f-21d8-46f1-bfb7-cbd59bbb1300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 03 Jun 2025 07:53:46 GMT'
    'Content-Length': '1653'
2025-06-03 07:53:47,022 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-03 07:53:47,022 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-03 07:53:47,884 - d365 - INFO - Fetched 11 business units
2025-06-03 07:53:47,886 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-03 07:53:47,892 - d365 - INFO - D365 data loaded successfully
2025-06-03 07:53:47,913 - main - INFO - Data fetched successfully, now loading into memory...
2025-06-03 07:53:47,913 - main - INFO - Loading data from CSV files
2025-06-03 07:53:47,949 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 07:53:47,987 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 07:53:47,991 - main - INFO - Loaded user_details with 207 rows
2025-06-03 07:53:47,995 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 07:53:48,000 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 07:53:48,030 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 07:53:48,046 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 07:53:48,052 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 07:53:48,052 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['905f7514-8838-4b46-80ed-cc10a32827ea', 'd716f427-0faf-4441-9cfa-96b8931e3bca', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', '56a78acc-83ae-46fa-9401-00c84e5cc4a0', '1caaa937-8018-47c2-b201-0bc7138e1d8a']...
2025-06-03 07:53:48,053 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['bce80ea6-76b4-eb11-8236-000d3ab6406f', '9cd8515e-90ac-ec11-9841-000d3adcf107', 'c2b851f4-15aa-eb11-8236-0022489b4c66', '69b5c94e-8533-ec11-b6e6-0022489bd51d', '22b08f4b-2e9d-ec11-b400-0022489cbe08']...
2025-06-03 07:53:48,053 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 07:53:48,053 - main - INFO - Data loaded into memory successfully
2025-06-03 07:59:19,913 - main - INFO - Loading data from CSV files
2025-06-03 07:59:19,953 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 07:59:19,987 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 07:59:19,990 - main - INFO - Loaded user_details with 207 rows
2025-06-03 07:59:19,993 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 07:59:19,999 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 07:59:20,030 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 07:59:20,039 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 07:59:20,045 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 07:59:20,045 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['905f7514-8838-4b46-80ed-cc10a32827ea', 'd716f427-0faf-4441-9cfa-96b8931e3bca', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', '56a78acc-83ae-46fa-9401-00c84e5cc4a0', '1caaa937-8018-47c2-b201-0bc7138e1d8a']...
2025-06-03 07:59:20,046 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['bce80ea6-76b4-eb11-8236-000d3ab6406f', '9cd8515e-90ac-ec11-9841-000d3adcf107', 'c2b851f4-15aa-eb11-8236-0022489b4c66', '69b5c94e-8533-ec11-b6e6-0022489bd51d', '22b08f4b-2e9d-ec11-b400-0022489cbe08']...
2025-06-03 07:59:20,046 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 07:59:22,789 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 07:59:22,789 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 07:59:22,825 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 07:59:28,682 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 07:59:33,079 - src.core.embeddings - INFO - Initialized Hugging Face embeddings (batch_size=                                  User ID  ...           Department
0    418cf370-1c30-ed11-9db1-000d3a65164f  ...  PCS Employees - UAE
1    3b644a99-742f-ed11-9db1-000d3a651fbe  ...  PCS Employees - UAE
2    0f8e48c4-f4c9-ec11-a7b5-000d3a653893  ...          AdminAgents
3    8353ba00-5fa3-ec11-983f-000d3a65be92  ...  PCS Employees - UAE
4    4d28cf51-83b9-ec11-983f-000d3a65c37c  ...       Air Arabia NOC
..                                    ...  ...                  ...
202  6ed9ffb0-dcf5-ef11-be1f-7c1e523678c6  ...  PCS Employees - UAE
203  cfde3263-84e7-ef11-be20-7c1e523678c6  ...            Paramount
204  77d6c7ed-db20-f011-9989-7c1e52881ff7  ...            Paramount
205  948ae67b-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users
206  2081ef81-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users

[207 rows x 10 columns])
2025-06-03 07:59:33,080 - src.core.embeddings - INFO - Embedding initialization took 10.29 seconds
2025-06-03 07:59:33,080 - src.core.embeddings - INFO - Memory usage: RSS=899.43 MB, VMS=5369.04 MB
2025-06-03 07:59:33,080 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 07:59:33,081 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 08:00:12,936 - src.core.embeddings - INFO - Text generation took 39.86 seconds
2025-06-03 08:00:12,936 - src.core.embeddings - INFO - Memory usage: RSS=925.00 MB, VMS=5390.04 MB
2025-06-03 08:00:12,936 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 08:00:15,467 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 08:00:15,467 - src.core.embeddings - INFO - Document conversion took 2.53 seconds
2025-06-03 08:00:15,467 - src.core.embeddings - INFO - Memory usage: RSS=959.55 MB, VMS=5425.04 MB
2025-06-03 08:00:15,467 - src.core.embeddings - INFO - Generating embeddings
2025-06-03 08:00:15,811 - src.core.embeddings - ERROR - Failed to generate embeddings: 'DataFrame' object cannot be interpreted as an integer
2025-06-03 08:00:15,811 - main - ERROR - Error generating embeddings: 'DataFrame' object cannot be interpreted as an integer
2025-06-03 08:10:39,777 - main - INFO - Loading data from CSV files
2025-06-03 08:10:39,903 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 08:10:39,985 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 08:10:39,991 - main - INFO - Loaded user_details with 207 rows
2025-06-03 08:10:40,000 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 08:10:40,005 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 08:10:40,077 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 08:10:40,097 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 08:10:40,108 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 08:10:40,108 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d', '43a59832-e855-4adb-be7a-b7912cb49a15', 'f930eecf-94a2-492d-a317-ab8c86b0e56c', 'f5171746-0248-4d03-8228-86376434a4e2', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268']...
2025-06-03 08:10:40,109 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['27b5c94e-8533-ec11-b6e6-0022489bd51d', 'cc6eeb08-2aaa-eb11-8236-0022489b4c66', 'c0e80ea6-76b4-eb11-8236-000d3ab6406f', 'ac7997ad-76b4-eb11-8236-000d3ab5a61f', 'bab4c94e-8533-ec11-b6e6-0022489bd51d']...
2025-06-03 08:10:40,109 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 08:10:43,516 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 08:10:43,516 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 08:10:43,531 - src.core.embeddings - ERROR - Failed to generate embeddings: batch_size must be a positive integer, got                                   User ID  ...           Department
0    418cf370-1c30-ed11-9db1-000d3a65164f  ...  PCS Employees - UAE
1    3b644a99-742f-ed11-9db1-000d3a651fbe  ...  PCS Employees - UAE
2    0f8e48c4-f4c9-ec11-a7b5-000d3a653893  ...          AdminAgents
3    8353ba00-5fa3-ec11-983f-000d3a65be92  ...  PCS Employees - UAE
4    4d28cf51-83b9-ec11-983f-000d3a65c37c  ...       Air Arabia NOC
..                                    ...  ...                  ...
202  6ed9ffb0-dcf5-ef11-be1f-7c1e523678c6  ...  PCS Employees - UAE
203  cfde3263-84e7-ef11-be20-7c1e523678c6  ...            Paramount
204  77d6c7ed-db20-f011-9989-7c1e52881ff7  ...            Paramount
205  948ae67b-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users
206  2081ef81-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users

[207 rows x 10 columns]
2025-06-03 08:10:43,532 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/embeddings.py", line 106, in generate_embeddings
    raise ValueError(f"batch_size must be a positive integer, got {batch_size}")
ValueError: batch_size must be a positive integer, got                                   User ID  ...           Department
0    418cf370-1c30-ed11-9db1-000d3a65164f  ...  PCS Employees - UAE
1    3b644a99-742f-ed11-9db1-000d3a651fbe  ...  PCS Employees - UAE
2    0f8e48c4-f4c9-ec11-a7b5-000d3a653893  ...          AdminAgents
3    8353ba00-5fa3-ec11-983f-000d3a65be92  ...  PCS Employees - UAE
4    4d28cf51-83b9-ec11-983f-000d3a65c37c  ...       Air Arabia NOC
..                                    ...  ...                  ...
202  6ed9ffb0-dcf5-ef11-be1f-7c1e523678c6  ...  PCS Employees - UAE
203  cfde3263-84e7-ef11-be20-7c1e523678c6  ...            Paramount
204  77d6c7ed-db20-f011-9989-7c1e52881ff7  ...            Paramount
205  948ae67b-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users
206  2081ef81-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users

[207 rows x 10 columns]

2025-06-03 08:10:43,533 - main - ERROR - Error generating embeddings: batch_size must be a positive integer, got                                   User ID  ...           Department
0    418cf370-1c30-ed11-9db1-000d3a65164f  ...  PCS Employees - UAE
1    3b644a99-742f-ed11-9db1-000d3a651fbe  ...  PCS Employees - UAE
2    0f8e48c4-f4c9-ec11-a7b5-000d3a653893  ...          AdminAgents
3    8353ba00-5fa3-ec11-983f-000d3a65be92  ...  PCS Employees - UAE
4    4d28cf51-83b9-ec11-983f-000d3a65c37c  ...       Air Arabia NOC
..                                    ...  ...                  ...
202  6ed9ffb0-dcf5-ef11-be1f-7c1e523678c6  ...  PCS Employees - UAE
203  cfde3263-84e7-ef11-be20-7c1e523678c6  ...            Paramount
204  77d6c7ed-db20-f011-9989-7c1e52881ff7  ...            Paramount
205  948ae67b-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users
206  2081ef81-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users

[207 rows x 10 columns]
2025-06-03 08:10:53,161 - main - INFO - Loading data from CSV files
2025-06-03 08:10:53,194 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 08:10:53,223 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 08:10:53,225 - main - INFO - Loaded user_details with 207 rows
2025-06-03 08:10:53,227 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 08:10:53,230 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 08:10:53,257 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 08:10:53,264 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 08:10:53,269 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 08:10:53,269 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d', '43a59832-e855-4adb-be7a-b7912cb49a15', 'f930eecf-94a2-492d-a317-ab8c86b0e56c', 'f5171746-0248-4d03-8228-86376434a4e2', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268']...
2025-06-03 08:10:53,270 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['27b5c94e-8533-ec11-b6e6-0022489bd51d', 'cc6eeb08-2aaa-eb11-8236-0022489b4c66', 'c0e80ea6-76b4-eb11-8236-000d3ab6406f', 'ac7997ad-76b4-eb11-8236-000d3ab5a61f', 'bab4c94e-8533-ec11-b6e6-0022489bd51d']...
2025-06-03 08:10:53,270 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 08:10:54,891 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 08:10:54,891 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 08:10:54,903 - src.core.embeddings - ERROR - Failed to generate embeddings: batch_size must be a positive integer, got                                   User ID  ...           Department
0    418cf370-1c30-ed11-9db1-000d3a65164f  ...  PCS Employees - UAE
1    3b644a99-742f-ed11-9db1-000d3a651fbe  ...  PCS Employees - UAE
2    0f8e48c4-f4c9-ec11-a7b5-000d3a653893  ...          AdminAgents
3    8353ba00-5fa3-ec11-983f-000d3a65be92  ...  PCS Employees - UAE
4    4d28cf51-83b9-ec11-983f-000d3a65c37c  ...       Air Arabia NOC
..                                    ...  ...                  ...
202  6ed9ffb0-dcf5-ef11-be1f-7c1e523678c6  ...  PCS Employees - UAE
203  cfde3263-84e7-ef11-be20-7c1e523678c6  ...            Paramount
204  77d6c7ed-db20-f011-9989-7c1e52881ff7  ...            Paramount
205  948ae67b-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users
206  2081ef81-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users

[207 rows x 10 columns]
2025-06-03 08:10:54,904 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/embeddings.py", line 106, in generate_embeddings
    raise ValueError(f"batch_size must be a positive integer, got {batch_size}")
ValueError: batch_size must be a positive integer, got                                   User ID  ...           Department
0    418cf370-1c30-ed11-9db1-000d3a65164f  ...  PCS Employees - UAE
1    3b644a99-742f-ed11-9db1-000d3a651fbe  ...  PCS Employees - UAE
2    0f8e48c4-f4c9-ec11-a7b5-000d3a653893  ...          AdminAgents
3    8353ba00-5fa3-ec11-983f-000d3a65be92  ...  PCS Employees - UAE
4    4d28cf51-83b9-ec11-983f-000d3a65c37c  ...       Air Arabia NOC
..                                    ...  ...                  ...
202  6ed9ffb0-dcf5-ef11-be1f-7c1e523678c6  ...  PCS Employees - UAE
203  cfde3263-84e7-ef11-be20-7c1e523678c6  ...            Paramount
204  77d6c7ed-db20-f011-9989-7c1e52881ff7  ...            Paramount
205  948ae67b-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users
206  2081ef81-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users

[207 rows x 10 columns]

2025-06-03 08:10:54,904 - main - ERROR - Error generating embeddings: batch_size must be a positive integer, got                                   User ID  ...           Department
0    418cf370-1c30-ed11-9db1-000d3a65164f  ...  PCS Employees - UAE
1    3b644a99-742f-ed11-9db1-000d3a651fbe  ...  PCS Employees - UAE
2    0f8e48c4-f4c9-ec11-a7b5-000d3a653893  ...          AdminAgents
3    8353ba00-5fa3-ec11-983f-000d3a65be92  ...  PCS Employees - UAE
4    4d28cf51-83b9-ec11-983f-000d3a65c37c  ...       Air Arabia NOC
..                                    ...  ...                  ...
202  6ed9ffb0-dcf5-ef11-be1f-7c1e523678c6  ...  PCS Employees - UAE
203  cfde3263-84e7-ef11-be20-7c1e523678c6  ...            Paramount
204  77d6c7ed-db20-f011-9989-7c1e52881ff7  ...            Paramount
205  948ae67b-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users
206  2081ef81-4732-f011-8c4d-7c1e52fbbdd0  ...            All Users

[207 rows x 10 columns]
2025-06-03 08:19:41,075 - main - INFO - Loading data from CSV files
2025-06-03 08:19:41,246 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 08:19:41,362 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 08:19:41,367 - main - INFO - Loaded user_details with 207 rows
2025-06-03 08:19:41,374 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 08:19:41,381 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 08:19:41,473 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 08:19:41,494 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 08:19:41,500 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 08:19:41,501 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['bc1af13e-0ffe-41a1-9e83-7166e35c3403', 'f956b637-d19e-48a5-bde4-01ab0f111c5b', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'e5f47082-e16b-4429-9d36-09d4b1354a24', '9405e3c4-34fa-4514-aa16-161cb1e01532']...
2025-06-03 08:19:41,501 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['3650733f-13aa-eb11-8236-0022489b4c66', 'ae1761c6-47f7-ed11-8849-0022489ba102', '47f47567-36c4-eb11-bacc-0022489c4a92', '473d92b3-76b4-eb11-8236-000d3ab5a61f', 'a3c67f51-1434-f011-8c4e-000d3a69161a']...
2025-06-03 08:19:41,501 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 08:19:44,690 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 08:19:44,690 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 08:19:44,690 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 08:19:44,693 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 08:19:49,467 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 08:19:54,441 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 08:19:54,441 - src.core.embeddings - INFO - Embedding initialization took 9.75 seconds
2025-06-03 08:19:54,441 - src.core.embeddings - INFO - Memory usage: RSS=876.40 MB, VMS=5371.68 MB
2025-06-03 08:19:54,442 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 08:19:54,442 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 08:19:54,450 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 08:19:54,478 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-03 08:19:55,342 - src.core.embeddings - INFO - Text generation took 0.90 seconds
2025-06-03 08:19:55,342 - src.core.embeddings - INFO - Memory usage: RSS=899.24 MB, VMS=5391.68 MB
2025-06-03 08:19:55,342 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 08:19:58,282 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 08:19:58,283 - src.core.embeddings - INFO - Document conversion took 2.94 seconds
2025-06-03 08:19:58,283 - src.core.embeddings - INFO - Memory usage: RSS=934.05 MB, VMS=5426.68 MB
2025-06-03 08:19:58,283 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 08:19:58,286 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 08:19:58,287 - src.core.embeddings - ERROR - Failed to generate embeddings: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'
2025-06-03 08:19:58,298 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/embeddings.py", line 222, in generate_embeddings
    chunk_embeddings = embeddings.embed_documents(chunk_texts)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_huggingface/embeddings/huggingface.py", line 150, in embed_documents
    return self._embed(texts, self.encode_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_huggingface/embeddings/huggingface.py", line 127, in _embed
    embeddings = self._client.encode(
                 ^^^^^^^^^^^^^^^^^^^^
TypeError: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'

2025-06-03 08:19:58,298 - main - ERROR - Error generating embeddings: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'
2025-06-03 08:21:22,675 - main - INFO - Loading data from CSV files
2025-06-03 08:21:22,711 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 08:21:22,739 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 08:21:22,741 - main - INFO - Loaded user_details with 207 rows
2025-06-03 08:21:22,744 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 08:21:22,749 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 08:21:22,777 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 08:21:22,786 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 08:21:22,793 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 08:21:22,794 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['25e4481b-88cd-43c3-8875-93a1ab52df0a', '2b68b50c-b7e1-4155-9966-4ddca2ec8afc', 'f342a152-c8aa-461e-8564-68d07d4c2604', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac']...
2025-06-03 08:21:22,794 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['6f8c1c7c-f8bc-ec11-9840-0022489e2e28', 'e968d148-8533-ec11-b6e6-0022489bd51d', 'fb64c680-0162-ed11-9561-0022489ba102', '6eaeb678-3c5c-ed11-9562-0022489a24b8', '8b5606a1-3fba-ee11-a569-0022489b4de1']...
2025-06-03 08:21:22,794 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 08:21:24,047 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 08:21:24,047 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 08:21:24,048 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 08:21:24,048 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 08:21:26,511 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 08:21:30,138 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 08:21:30,138 - src.core.embeddings - INFO - Embedding initialization took 6.09 seconds
2025-06-03 08:21:30,138 - src.core.embeddings - INFO - Memory usage: RSS=875.68 MB, VMS=5367.08 MB
2025-06-03 08:21:30,138 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 08:21:30,138 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 08:21:30,142 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 08:21:30,151 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-03 08:21:30,766 - src.core.embeddings - INFO - Text generation took 0.63 seconds
2025-06-03 08:21:30,767 - src.core.embeddings - INFO - Memory usage: RSS=900.26 MB, VMS=5388.08 MB
2025-06-03 08:21:30,767 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 08:21:33,031 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 08:21:33,031 - src.core.embeddings - INFO - Document conversion took 2.26 seconds
2025-06-03 08:21:33,031 - src.core.embeddings - INFO - Memory usage: RSS=935.07 MB, VMS=5423.08 MB
2025-06-03 08:21:33,031 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 08:21:33,034 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 08:21:49,962 - src.core.embeddings - INFO - Memory usage: RSS=1153.83 MB, VMS=6776.32 MB
2025-06-03 08:21:49,962 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-03 08:22:04,040 - src.core.embeddings - INFO - Memory usage: RSS=1257.14 MB, VMS=6879.87 MB
2025-06-03 08:22:04,040 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-03 08:22:21,001 - src.core.embeddings - INFO - Memory usage: RSS=1314.35 MB, VMS=6935.90 MB
2025-06-03 08:22:21,002 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-03 08:22:40,421 - src.core.embeddings - INFO - Memory usage: RSS=1372.92 MB, VMS=6994.90 MB
2025-06-03 08:22:40,422 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-03 08:22:56,145 - src.core.embeddings - INFO - Memory usage: RSS=1431.57 MB, VMS=7053.90 MB
2025-06-03 08:22:56,145 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-03 08:23:10,419 - src.core.embeddings - INFO - Memory usage: RSS=1492.06 MB, VMS=7114.21 MB
2025-06-03 08:23:10,420 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-03 08:23:53,213 - src.core.embeddings - INFO - Memory usage: RSS=1657.28 MB, VMS=7259.96 MB
2025-06-03 08:23:53,214 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-03 08:24:38,076 - src.core.embeddings - INFO - Memory usage: RSS=1748.09 MB, VMS=7350.45 MB
2025-06-03 08:24:38,076 - src.core.embeddings - INFO - Embedding chunk 9/9 (3233 documents)
2025-06-03 08:25:10,121 - src.core.embeddings - INFO - Memory usage: RSS=1786.92 MB, VMS=7388.94 MB
2025-06-03 08:25:10,434 - src.core.embeddings - INFO - Embedding generation took 217.40 seconds
2025-06-03 08:25:10,435 - src.core.embeddings - INFO - Memory usage: RSS=1786.92 MB, VMS=7388.94 MB
2025-06-03 08:25:10,435 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-03 08:25:11,272 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 43233 vectors
2025-06-03 08:25:11,754 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-03 08:25:12,421 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-03 08:25:12,421 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.99 seconds
2025-06-03 08:25:12,421 - src.core.embeddings - INFO - Memory usage: RSS=1480.80 MB, VMS=7125.27 MB
2025-06-03 08:25:12,498 - src.core.embeddings - INFO - Total embedding generation took 228.45 seconds
2025-06-03 08:27:02,336 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-03 08:27:02,337 - src.utils.config - INFO - Loading environment variables
2025-06-03 08:27:02,339 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-03 08:27:02,339 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 08:27:02,339 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-03 08:27:02,339 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-03 08:27:02,339 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-03 08:27:02,339 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-03 08:27:02,360 - src.core.analysis - WARNING - 'principalId' column not found in app_role_assignments. Attempting to use 'userId'.
2025-06-03 08:27:02,362 - src.core.analysis - INFO - User IDs from user_details: 207
2025-06-03 08:27:02,363 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-03 08:27:02,363 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-03 08:27:02,363 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-03 08:27:02,363 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-03 08:27:02,940 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-03 08:27:02,963 - src.core.analysis - ERROR - Error retrieving documents: 'dict' object has no attribute 'search'
Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 257, in retrieve
    docs = vectorstore.similarity_search(state["query"], k=10)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_community/vectorstores/faiss.py", line 643, in similarity_search
    docs_and_scores = self.similarity_search_with_score(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_community/vectorstores/faiss.py", line 516, in similarity_search_with_score
    docs = self.similarity_search_with_score_by_vector(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_community/vectorstores/faiss.py", line 428, in similarity_search_with_score_by_vector
    doc = self.docstore.search(_id)
          ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'search'
2025-06-03 08:27:02,968 - src.core.analysis - ERROR - Failed to run analysis: 'dict' object has no attribute 'search'
Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 701, in run_analysis
    return app.invoke({
           ^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langgraph/pregel/__init__.py", line 2719, in invoke
    for chunk in self.stream(
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langgraph/pregel/__init__.py", line 2436, in stream
    for _ in runner.tick(
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 257, in retrieve
    docs = vectorstore.similarity_search(state["query"], k=10)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_community/vectorstores/faiss.py", line 643, in similarity_search
    docs_and_scores = self.similarity_search_with_score(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_community/vectorstores/faiss.py", line 516, in similarity_search_with_score
    docs = self.similarity_search_with_score_by_vector(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_community/vectorstores/faiss.py", line 428, in similarity_search_with_score_by_vector
    doc = self.docstore.search(_id)
          ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'search'
During task with name 'retrieve' and id 'a168b50f-2c2e-b5d8-089c-4d9690f1bc5f'
2025-06-03 08:27:02,972 - main - ERROR - Error running analysis: 'dict' object has no attribute 'search'
2025-06-03 09:34:03,029 - main - INFO - Loading data from CSV files
2025-06-03 09:34:03,123 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 09:34:03,260 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 09:34:03,273 - main - INFO - Loaded user_details with 207 rows
2025-06-03 09:34:03,282 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 09:34:03,291 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 09:34:03,354 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 09:34:03,384 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 09:34:03,392 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 09:34:03,392 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['005a3324-6c26-484a-be06-07d829df9a76', '25e4481b-88cd-43c3-8875-93a1ab52df0a', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '56a78acc-83ae-46fa-9401-00c84e5cc4a0', 'bfa5d2b9-f1ec-454e-82e1-9dad0275f657']...
2025-06-03 09:34:03,392 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', '1492dbd6-9c58-ed11-9562-0022489b4de1', '69b5c94e-8533-ec11-b6e6-0022489bd51d', '59e80ea6-76b4-eb11-8236-000d3ab6406f', 'd64c239c-9b6c-ef11-a670-0022489b4696']...
2025-06-03 09:34:03,392 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 09:34:06,954 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 09:34:06,955 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 09:34:06,955 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 09:34:06,958 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 09:34:12,731 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 09:34:17,014 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 09:34:17,014 - src.core.embeddings - INFO - Embedding initialization took 10.06 seconds
2025-06-03 09:34:17,014 - src.core.embeddings - INFO - Memory usage: RSS=875.50 MB, VMS=5367.80 MB
2025-06-03 09:34:17,015 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 09:34:17,015 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 09:34:17,025 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 09:34:17,051 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-03 09:34:17,712 - src.core.embeddings - INFO - Text generation took 0.70 seconds
2025-06-03 09:34:17,715 - src.core.embeddings - INFO - Memory usage: RSS=899.92 MB, VMS=5388.80 MB
2025-06-03 09:34:17,716 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 09:34:20,691 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 09:34:20,692 - src.core.embeddings - INFO - Document conversion took 2.98 seconds
2025-06-03 09:34:20,692 - src.core.embeddings - INFO - Memory usage: RSS=934.72 MB, VMS=5422.80 MB
2025-06-03 09:34:20,692 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 09:34:20,696 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 09:34:20,697 - src.core.embeddings - ERROR - Failed to generate embeddings: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'
2025-06-03 09:34:20,699 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/embeddings.py", line 238, in generate_embeddings
    chunk_embeddings = embeddings.embed_documents(chunk_texts)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_huggingface/embeddings/huggingface.py", line 150, in embed_documents
    return self._embed(texts, self.encode_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_huggingface/embeddings/huggingface.py", line 127, in _embed
    embeddings = self._client.encode(
                 ^^^^^^^^^^^^^^^^^^^^
TypeError: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'

2025-06-03 09:34:20,699 - main - ERROR - Error generating embeddings: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'
2025-06-03 09:34:25,181 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 09:34:25,181 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 09:34:25,181 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 09:34:25,181 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 09:34:25,182 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 09:34:28,136 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 09:34:28,136 - src.core.embeddings - INFO - Embedding initialization took 2.96 seconds
2025-06-03 09:34:28,137 - src.core.embeddings - INFO - Memory usage: RSS=899.27 MB, VMS=5460.40 MB
2025-06-03 09:34:28,137 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 09:34:28,137 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 09:34:28,142 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 09:34:28,152 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-03 09:34:28,840 - src.core.embeddings - INFO - Text generation took 0.70 seconds
2025-06-03 09:34:28,840 - src.core.embeddings - INFO - Memory usage: RSS=915.77 MB, VMS=5475.40 MB
2025-06-03 09:34:28,840 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 09:34:31,415 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 09:34:31,415 - src.core.embeddings - INFO - Document conversion took 2.58 seconds
2025-06-03 09:34:31,416 - src.core.embeddings - INFO - Memory usage: RSS=949.16 MB, VMS=5443.05 MB
2025-06-03 09:34:31,416 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 09:34:31,419 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 09:34:31,420 - src.core.embeddings - ERROR - Failed to generate embeddings: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'
2025-06-03 09:34:31,421 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/embeddings.py", line 238, in generate_embeddings
    chunk_embeddings = embeddings.embed_documents(chunk_texts)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_huggingface/embeddings/huggingface.py", line 150, in embed_documents
    return self._embed(texts, self.encode_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langchain_huggingface/embeddings/huggingface.py", line 127, in _embed
    embeddings = self._client.encode(
                 ^^^^^^^^^^^^^^^^^^^^
TypeError: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'

2025-06-03 09:34:31,421 - main - ERROR - Error generating embeddings: sentence_transformers.SentenceTransformer.SentenceTransformer.encode() got multiple values for keyword argument 'show_progress_bar'
2025-06-03 09:34:57,283 - main - INFO - Loading data from CSV files
2025-06-03 09:34:57,321 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 09:34:57,347 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 09:34:57,351 - main - INFO - Loaded user_details with 207 rows
2025-06-03 09:34:57,353 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 09:34:57,356 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 09:34:57,386 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 09:34:57,394 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 09:34:57,398 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 09:34:57,398 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['46aee3ae-b46f-4737-a826-87ff31e6c3ff', 'b36d70a1-f635-4f11-9be8-c9cb51b84298', '1caaa937-8018-47c2-b201-0bc7138e1d8a', 'f342a152-c8aa-461e-8564-68d07d4c2604', '00e5df59-0081-4e43-9ae0-7c9969f698dc']...
2025-06-03 09:34:57,399 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['c4a97839-13aa-eb11-8236-0022489b4c66', '41b4c94e-8533-ec11-b6e6-0022489bd51d', '2c50733f-13aa-eb11-8236-0022489b4c66', '773868ba-6d53-ef11-bfe3-0022489b4696', '1492dbd6-9c58-ed11-9562-0022489b4de1']...
2025-06-03 09:34:57,399 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 09:34:59,126 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 09:34:59,126 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 09:34:59,126 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 09:34:59,127 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 09:35:01,802 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 09:35:05,505 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 09:35:05,505 - src.core.embeddings - INFO - Embedding initialization took 6.38 seconds
2025-06-03 09:35:05,506 - src.core.embeddings - INFO - Memory usage: RSS=876.65 MB, VMS=5368.18 MB
2025-06-03 09:35:05,506 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 09:35:05,506 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 09:35:05,511 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 09:35:05,526 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-03 09:35:06,493 - src.core.embeddings - INFO - Text generation took 0.99 seconds
2025-06-03 09:35:06,493 - src.core.embeddings - INFO - Memory usage: RSS=900.29 MB, VMS=5388.18 MB
2025-06-03 09:35:06,493 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 09:35:09,390 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 09:35:09,390 - src.core.embeddings - INFO - Document conversion took 2.90 seconds
2025-06-03 09:35:09,390 - src.core.embeddings - INFO - Memory usage: RSS=934.83 MB, VMS=5423.18 MB
2025-06-03 09:35:09,390 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 09:35:09,393 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 09:35:26,436 - src.core.embeddings - INFO - Memory usage: RSS=1183.14 MB, VMS=6810.60 MB
2025-06-03 09:35:26,436 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-03 09:35:40,514 - src.core.embeddings - INFO - Memory usage: RSS=1291.27 MB, VMS=6918.36 MB
2025-06-03 09:35:40,514 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-03 09:35:53,363 - src.core.embeddings - INFO - Memory usage: RSS=1342.68 MB, VMS=6969.49 MB
2025-06-03 09:35:53,364 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-03 09:36:06,007 - src.core.embeddings - INFO - Memory usage: RSS=1393.39 MB, VMS=7020.61 MB
2025-06-03 09:36:06,007 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-03 09:36:18,627 - src.core.embeddings - INFO - Memory usage: RSS=1449.23 MB, VMS=7076.43 MB
2025-06-03 09:36:18,627 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-03 09:36:32,320 - src.core.embeddings - INFO - Memory usage: RSS=1529.93 MB, VMS=7156.99 MB
2025-06-03 09:36:32,321 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-03 09:37:09,706 - src.core.embeddings - INFO - Memory usage: RSS=1871.74 MB, VMS=7478.68 MB
2025-06-03 09:37:09,706 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-03 09:37:52,303 - src.core.embeddings - INFO - Memory usage: RSS=1962.30 MB, VMS=7569.18 MB
2025-06-03 09:37:52,304 - src.core.embeddings - INFO - Embedding chunk 9/9 (3233 documents)
2025-06-03 09:38:19,445 - src.core.embeddings - INFO - Memory usage: RSS=2063.86 MB, VMS=7670.68 MB
2025-06-03 09:38:19,730 - src.core.embeddings - INFO - Embedding generation took 190.34 seconds
2025-06-03 09:38:19,730 - src.core.embeddings - INFO - Memory usage: RSS=2063.86 MB, VMS=7670.68 MB
2025-06-03 09:38:19,730 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-03 09:38:19,730 - src.core.embeddings - WARNING - Using FAISS.from_documents as fallback due to missing InMemoryDocstore
2025-06-03 09:42:34,735 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-03 09:42:34,745 - src.core.embeddings - INFO - FAISS vectorstore creation took 255.01 seconds
2025-06-03 09:42:34,747 - src.core.embeddings - INFO - Memory usage: RSS=2268.16 MB, VMS=7872.30 MB
2025-06-03 09:42:34,858 - src.core.embeddings - INFO - Total embedding generation took 455.73 seconds
2025-06-03 09:44:44,360 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-03 09:44:44,361 - src.utils.config - INFO - Loading environment variables
2025-06-03 09:44:44,364 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-03 09:44:44,365 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 09:44:44,365 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-03 09:44:44,365 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-03 09:44:44,365 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-03 09:44:44,365 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-03 09:44:44,399 - src.core.analysis - WARNING - 'principalId' column not found in app_role_assignments. Attempting to use 'userId'.
2025-06-03 09:44:44,402 - src.core.analysis - INFO - User IDs from user_details: 207
2025-06-03 09:44:44,403 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-03 09:44:44,403 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-03 09:44:44,403 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-03 09:44:44,403 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-03 09:44:44,896 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-03 09:44:45,020 - src.core.analysis - INFO - Starting analysis
2025-06-03 09:44:45,021 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-03 09:44:48,312 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-03 09:44:48,314 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-03 09:44:48,314 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-03 09:44:48,314 - src.analysis.anomaly_detector - INFO - User details shape: (207, 10)
2025-06-03 09:44:48,314 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 09:44:48,314 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11917, 12)
2025-06-03 09:44:48,314 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-03 09:44:48,387 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-03 09:44:48,428 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-03 09:44:48,466 - src.analysis.anomaly_detector - INFO - Successfully mapped 11917 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-03 09:44:48,473 - src.analysis.anomaly_detector - INFO - Total mapped users: 207
2025-06-03 09:44:48,474 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-03 09:44:48,474 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 0
2025-06-03 09:44:48,474 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 0
2025-06-03 09:44:48,474 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-03 09:44:48,474 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-03 09:44:48,475 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-03 09:44:48,475 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-03 09:44:48,475 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-03 09:44:48,475 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-03 09:44:48,475 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-03 09:44:48,476 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-03 09:44:48,476 - src.analysis.anomaly_detector - INFO - Too few embeddings for clustering; skipping Isolation Forest
2025-06-03 09:44:49,889 - src.analysis.anomaly_detector - INFO - Detected 59 anomalies
2025-06-03 09:44:49,889 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-03 09:44:49,889 - src.analysis.anomaly_detector - INFO - Example 1: Prem Anand Rajendran -> High sign-in frequency: 5519 sign-ins (avg: 167.8, threshold: 1634.9) (Department: Air Arabia NOC); ...
2025-06-03 09:44:49,889 - src.analysis.anomaly_detector - INFO - Example 2: Vikneshkumar Palanisamy -> High sign-in frequency: 2942 sign-ins (avg: 167.8, threshold: 1634.9) (Department: Air Arabia NOC)...
2025-06-03 09:44:49,890 - src.analysis.anomaly_detector - INFO - Example 3: Dileepkumar Kuruba -> Unusual location: Nemilichery, IN at 2025-05-13 02:00:52. Typical: Bengaluru, IN (99.1%) (Department...
2025-06-03 09:44:49,890 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-03 09:44:50,639 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-03 09:44:50,640 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-03 09:44:50,782 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 31316
2025-06-03 09:44:51,197 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-03 09:44:51,814 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-03 09:44:51,814 - src.core.analysis - INFO - Analyzing inactive users
2025-06-03 09:44:51,814 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-03 09:44:51,815 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-03 09:44:51,815 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 09:44:51,827 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-03 07:36:47+0000', tz='UTC'), Timestamp('2025-06-03 07:36:45+0000', tz='UTC'), Timestamp('2025-06-03 07:36:45+0000', tz='UTC'), Timestamp('2025-06-03 07:35:40+0000', tz='UTC'), Timestamp('2025-06-03 07:35:39+0000', tz='UTC')]
2025-06-03 09:44:51,827 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-03 09:44:51,832 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [NaT, NaT, NaT, NaT, NaT]
2025-06-03 09:44:51,832 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 31316
2025-06-03 09:44:52,358 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 207 total users.
2025-06-03 09:44:52,360 - src.core.analysis - INFO - Total unique user IDs after analysis: 520
2025-06-03 09:44:52,580 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-03 09:44:52,580 - src.core.analysis - INFO - Using chunk size: 30 for 520 users
2025-06-03 09:44:52,582 - src.core.analysis - INFO - Processing 18 chunks sequentially
2025-06-03 12:01:19,286 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-03 12:01:27,323 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-03 12:01:57,780 - main - INFO - Loading data from CSV files
2025-06-03 12:01:57,833 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 12:01:57,876 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 12:01:57,880 - main - INFO - Loaded user_details with 207 rows
2025-06-03 12:01:57,884 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 12:01:57,888 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 12:01:57,929 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 12:01:57,947 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 12:01:57,951 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 12:01:57,951 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['21c89e8c-746d-4de9-ac50-c0de034c6609', 'c0ef01d0-2de6-42d7-bc97-12aa8c61a41f', '05bd23ee-2229-4eff-8de9-b0810c16a1f1', 'ee7ab89d-7719-4787-bae3-623f27404cd8', '401b998a-bb2f-4dd4-887e-c0045a3964bf']...
2025-06-03 12:01:57,952 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['858b16a0-76b4-eb11-8236-000d3ab6406f', '577997ad-76b4-eb11-8236-000d3ab5a61f', '24e21576-f71d-ef11-840b-0022489b4696', 'dfc9fddf-a4fb-ef11-bae4-000d3ab483e3', '55b271d9-a4fb-ef11-bae4-000d3ab483e3']...
2025-06-03 12:01:57,952 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 12:02:03,566 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 12:02:03,567 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 12:02:03,567 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 12:02:03,568 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 12:02:07,606 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 12:02:11,891 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 12:02:11,891 - src.core.embeddings - INFO - Embedding initialization took 8.32 seconds
2025-06-03 12:02:11,891 - src.core.embeddings - INFO - Memory usage: RSS=868.14 MB, VMS=5368.11 MB
2025-06-03 12:02:11,891 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 12:02:11,891 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 12:02:11,897 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 12:02:11,917 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-03 12:02:12,646 - src.core.embeddings - INFO - Text generation took 0.75 seconds
2025-06-03 12:02:12,646 - src.core.embeddings - INFO - Memory usage: RSS=897.54 MB, VMS=5394.11 MB
2025-06-03 12:02:12,646 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 12:02:14,540 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 12:02:14,541 - src.core.embeddings - INFO - Document conversion took 1.89 seconds
2025-06-03 12:02:14,541 - src.core.embeddings - INFO - Memory usage: RSS=932.35 MB, VMS=5429.11 MB
2025-06-03 12:02:14,541 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 12:02:14,544 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 12:02:25,562 - src.core.embeddings - INFO - Memory usage: RSS=1087.55 MB, VMS=6714.76 MB
2025-06-03 12:02:25,562 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-03 12:02:38,371 - src.core.embeddings - INFO - Memory usage: RSS=1163.61 MB, VMS=6789.67 MB
2025-06-03 12:02:38,371 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-03 12:02:54,551 - src.core.embeddings - INFO - Memory usage: RSS=1231.03 MB, VMS=6856.22 MB
2025-06-03 12:02:54,552 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-03 12:03:08,668 - src.core.embeddings - INFO - Memory usage: RSS=1323.36 MB, VMS=6948.59 MB
2025-06-03 12:03:08,669 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-03 12:03:22,164 - src.core.embeddings - INFO - Memory usage: RSS=1372.55 MB, VMS=6997.80 MB
2025-06-03 12:03:22,164 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-03 12:03:36,080 - src.core.embeddings - INFO - Memory usage: RSS=1461.82 MB, VMS=7087.19 MB
2025-06-03 12:03:36,081 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-03 12:04:13,590 - src.core.embeddings - INFO - Memory usage: RSS=1666.58 MB, VMS=7275.47 MB
2025-06-03 12:04:13,590 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-03 12:04:55,830 - src.core.embeddings - INFO - Memory usage: RSS=1726.35 MB, VMS=7335.32 MB
2025-06-03 12:04:55,831 - src.core.embeddings - INFO - Embedding chunk 9/9 (3233 documents)
2025-06-03 12:05:27,190 - src.core.embeddings - INFO - Memory usage: RSS=1755.35 MB, VMS=7363.22 MB
2025-06-03 12:05:27,448 - src.core.embeddings - INFO - Embedding generation took 192.91 seconds
2025-06-03 12:05:27,449 - src.core.embeddings - INFO - Memory usage: RSS=1755.35 MB, VMS=7363.22 MB
2025-06-03 12:05:27,449 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-03 12:05:27,993 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 43233 vectors
2025-06-03 12:05:29,616 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-03 12:05:29,629 - src.core.embeddings - ERROR - Failed to generate embeddings: FAISS.__init__() got an unexpected keyword argument 'embedding'
2025-06-03 12:05:29,630 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/embeddings.py", line 315, in generate_embeddings
    vectorstore = FAISS(
                  ^^^^^^
TypeError: FAISS.__init__() got an unexpected keyword argument 'embedding'

2025-06-03 12:05:29,630 - main - ERROR - Error generating embeddings: FAISS.__init__() got an unexpected keyword argument 'embedding'
2025-06-03 12:09:38,564 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-03 12:09:52,412 - main - INFO - Loading data from CSV files
2025-06-03 12:09:52,476 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 12:09:52,546 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 12:09:52,550 - main - INFO - Loaded user_details with 207 rows
2025-06-03 12:09:52,555 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 12:09:52,559 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 12:09:52,590 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 12:09:52,600 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 12:09:52,605 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 12:09:52,605 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['39a7e1a9-6575-4f38-be71-e743fd54ef91', 'ccf6d52a-a45b-4d3a-810a-69bda63bec78', 'ee7ab89d-7719-4787-bae3-623f27404cd8', '905f7514-8838-4b46-80ed-cc10a32827ea', '972af6ae-90d2-441e-8436-2860f812896f']...
2025-06-03 12:09:52,606 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '577997ad-76b4-eb11-8236-000d3ab5a61f', '41b4c94e-8533-ec11-b6e6-0022489bd51d', '6b502afb-a2c2-eb11-bacc-0022489c4a92', '9d8b16a0-76b4-eb11-8236-000d3ab6406f']...
2025-06-03 12:09:52,606 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 12:09:54,092 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 12:09:54,093 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 12:09:54,093 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 12:09:54,096 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 12:09:57,990 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 12:10:02,677 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 12:10:02,677 - src.core.embeddings - INFO - Embedding initialization took 8.58 seconds
2025-06-03 12:10:02,677 - src.core.embeddings - INFO - Memory usage: RSS=867.41 MB, VMS=5358.45 MB
2025-06-03 12:10:02,677 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 12:10:02,677 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 12:10:02,681 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 12:10:02,697 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-03 12:10:03,657 - src.core.embeddings - INFO - Text generation took 0.98 seconds
2025-06-03 12:10:03,658 - src.core.embeddings - INFO - Memory usage: RSS=897.55 MB, VMS=5388.57 MB
2025-06-03 12:10:03,658 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 12:10:06,313 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 12:10:06,313 - src.core.embeddings - INFO - Document conversion took 2.66 seconds
2025-06-03 12:10:06,313 - src.core.embeddings - INFO - Memory usage: RSS=932.35 MB, VMS=5423.57 MB
2025-06-03 12:10:06,313 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 12:10:06,316 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 12:10:23,919 - src.core.embeddings - INFO - Memory usage: RSS=1146.54 MB, VMS=6765.93 MB
2025-06-03 12:10:23,920 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-03 12:10:38,839 - src.core.embeddings - INFO - Memory usage: RSS=1237.44 MB, VMS=6855.54 MB
2025-06-03 12:10:38,839 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-03 12:11:00,914 - src.core.embeddings - INFO - Memory usage: RSS=1296.22 MB, VMS=6914.54 MB
2025-06-03 12:11:00,915 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-03 12:11:22,361 - src.core.embeddings - INFO - Memory usage: RSS=1355.00 MB, VMS=6973.54 MB
2025-06-03 12:11:22,361 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-03 12:11:42,281 - src.core.embeddings - INFO - Memory usage: RSS=1400.20 MB, VMS=7017.67 MB
2025-06-03 12:11:42,281 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-03 12:11:57,976 - src.core.embeddings - INFO - Memory usage: RSS=1533.94 MB, VMS=7151.67 MB
2025-06-03 12:11:57,976 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-03 12:12:50,543 - src.core.embeddings - INFO - Memory usage: RSS=1725.51 MB, VMS=7322.73 MB
2025-06-03 12:12:50,543 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-03 12:13:40,849 - src.core.embeddings - INFO - Memory usage: RSS=1882.56 MB, VMS=7478.69 MB
2025-06-03 12:13:40,850 - src.core.embeddings - INFO - Embedding chunk 9/9 (3233 documents)
2025-06-03 12:14:12,834 - src.core.embeddings - INFO - Memory usage: RSS=1973.88 MB, VMS=7571.16 MB
2025-06-03 12:14:13,188 - src.core.embeddings - INFO - Embedding generation took 246.87 seconds
2025-06-03 12:14:13,188 - src.core.embeddings - INFO - Memory usage: RSS=1973.88 MB, VMS=7571.16 MB
2025-06-03 12:14:13,188 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-03 12:14:13,891 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 43233 vectors
2025-06-03 12:14:15,990 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-03 12:14:16,025 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-03 12:14:17,693 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-03 12:14:17,693 - src.core.embeddings - INFO - FAISS vectorstore creation took 4.51 seconds
2025-06-03 12:14:17,694 - src.core.embeddings - INFO - Memory usage: RSS=2209.84 MB, VMS=7848.49 MB
2025-06-03 12:14:17,821 - src.core.embeddings - INFO - Total embedding generation took 263.73 seconds
2025-06-03 12:16:59,367 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-03 12:16:59,368 - src.utils.config - INFO - Loading environment variables
2025-06-03 12:16:59,370 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-03 12:16:59,370 - src.core.analysis - INFO - Validating input DataFrames
2025-06-03 12:16:59,446 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 12:16:59,446 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-03 12:16:59,447 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-03 12:16:59,447 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-03 12:16:59,447 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-03 12:16:59,475 - src.core.analysis - INFO - User IDs from user_details: 207
2025-06-03 12:16:59,476 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-03 12:16:59,476 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-03 12:16:59,476 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-03 12:16:59,476 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-03 12:16:59,957 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-03 12:16:59,982 - src.core.analysis - INFO - Starting analysis
2025-06-03 12:16:59,983 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-03 12:17:03,043 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-03 12:17:03,044 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-03 12:17:03,044 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-03 12:17:03,044 - src.analysis.anomaly_detector - INFO - User details shape: (207, 10)
2025-06-03 12:17:03,044 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 12:17:03,044 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11917, 12)
2025-06-03 12:17:03,044 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-03 12:17:03,055 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-03 12:17:03,078 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-03 12:17:03,100 - src.analysis.anomaly_detector - INFO - Successfully mapped 11917 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-03 12:17:03,107 - src.analysis.anomaly_detector - INFO - Total mapped users: 207
2025-06-03 12:17:03,107 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-03 12:17:03,108 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-03 12:17:03,109 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-03 12:17:03,109 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-03 12:17:03,109 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-03 12:17:04,467 - src.analysis.anomaly_detector - INFO - Detected 59 anomalies
2025-06-03 12:17:04,467 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-03 12:17:04,467 - src.analysis.anomaly_detector - INFO - Example 1: Prem Anand Rajendran -> High sign-in frequency: 5519 sign-ins (avg: 167.8, threshold: 1634.9) (Department: Air Arabia NOC); ...
2025-06-03 12:17:04,467 - src.analysis.anomaly_detector - INFO - Example 2: Vikneshkumar Palanisamy -> High sign-in frequency: 2942 sign-ins (avg: 167.8, threshold: 1634.9) (Department: Air Arabia NOC)...
2025-06-03 12:17:04,467 - src.analysis.anomaly_detector - INFO - Example 3: Dileepkumar Kuruba -> Unusual location: Nemilichery, IN at 2025-05-13 02:00:52. Typical: Bengaluru, IN (99.1%) (Department...
2025-06-03 12:17:04,468 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-03 12:17:05,164 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-03 12:17:05,164 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-03 12:17:05,256 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-03 12:17:05,667 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-03 12:17:06,326 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-03 12:17:06,326 - src.core.analysis - INFO - Analyzing inactive users
2025-06-03 12:17:06,327 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-03 12:17:06,327 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-03 12:17:06,327 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 12:17:06,343 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-03 07:36:47+0000', tz='UTC'), Timestamp('2025-06-03 07:36:45+0000', tz='UTC'), Timestamp('2025-06-03 07:36:45+0000', tz='UTC'), Timestamp('2025-06-03 07:35:40+0000', tz='UTC'), Timestamp('2025-06-03 07:35:39+0000', tz='UTC')]
2025-06-03 12:17:06,344 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-03 12:17:06,350 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-05 22:30:13+0000', tz='UTC'), Timestamp('2025-03-05 22:30:28+0000', tz='UTC'), Timestamp('2025-03-05 22:30:34+0000', tz='UTC'), Timestamp('2025-03-05 22:30:38+0000', tz='UTC'), Timestamp('2025-03-06 00:00:48+0000', tz='UTC')]
2025-06-03 12:17:06,350 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-03 12:17:06,830 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 207 total users.
2025-06-03 12:17:06,832 - src.core.analysis - INFO - Total unique user IDs after analysis: 520
2025-06-03 12:17:06,865 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-03 12:17:06,866 - src.core.analysis - INFO - Using chunk size: 15 for 520 users
2025-06-03 12:17:06,867 - src.core.analysis - INFO - Processing 35 chunks sequentially
2025-06-03 12:17:06,867 - src.core.analysis - ERROR - Error in run_async_in_thread: Cannot run the event loop while another loop is running
2025-06-03 12:17:06,868 - src.core.analysis - ERROR - Error during analysis: Cannot run the event loop while another loop is running
Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 524, in analyze
    results = run_async_in_thread(process_findings())
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 229, in run_async_in_thread
    result = loop.run_until_complete(coro)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/asyncio/base_events.py", line 629, in run_until_complete
    self._check_running()
  File "/usr/lib/python3.11/asyncio/base_events.py", line 590, in _check_running
    raise RuntimeError(
RuntimeError: Cannot run the event loop while another loop is running
2025-06-03 12:17:06,871 - src.core.analysis - ERROR - Failed to run analysis: Cannot run the event loop while another loop is running
Traceback (most recent call last):
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 793, in run_analysis
    return app.invoke({
           ^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langgraph/pregel/__init__.py", line 2719, in invoke
    for chunk in self.stream(
  File "/home/coder/Production_Access_Review/myenv/lib/python3.11/site-packages/langgraph/pregel/__init__.py", line 2436, in stream
    for _ in runner.tick(
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 524, in analyze
    results = run_async_in_thread(process_findings())
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/Production_Access_Review/src/core/analysis.py", line 229, in run_async_in_thread
    result = loop.run_until_complete(coro)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/asyncio/base_events.py", line 629, in run_until_complete
    self._check_running()
  File "/usr/lib/python3.11/asyncio/base_events.py", line 590, in _check_running
    raise RuntimeError(
RuntimeError: Cannot run the event loop while another loop is running
During task with name 'analyze' and id 'caed6f95-2a95-0a41-9452-70687c0c450a'
2025-06-03 12:17:06,874 - main - ERROR - Error running analysis: Cannot run the event loop while another loop is running
2025-06-03 12:32:16,639 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-03 12:33:13,834 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-03 12:33:22,179 - main - INFO - Loading data from CSV files
2025-06-03 12:33:22,322 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-03 12:33:22,421 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-03 12:33:22,426 - main - INFO - Loaded user_details with 207 rows
2025-06-03 12:33:22,431 - main - INFO - Loaded app_roles with 2101 rows
2025-06-03 12:33:22,434 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-03 12:33:22,487 - main - INFO - Created group_memberships with 3212 rows
2025-06-03 12:33:22,505 - main - INFO - Created role_matrix with 2101 rows
2025-06-03 12:33:22,513 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-03 12:33:22,513 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['ee7ab89d-7719-4787-bae3-623f27404cd8', 'ceb4c75b-a009-43c6-8162-c018cddfc6e5', '8c21304f-41d0-474f-bb19-d49eba150fb0', '3fea2cb5-3aa4-4605-914c-c65359cbfa10', 'bfa5d2b9-f1ec-454e-82e1-9dad0275f657']...
2025-06-03 12:33:22,514 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['e5eff26e-b4ca-ee11-907a-0022489ba0c8', '82deb0f9-490e-ef11-9f8a-0022489b4d69', '8e775be8-1c58-ef11-bfe3-0022489b4d69', '6654db69-f71d-ef11-840b-0022489b4696', '6311eb6b-30aa-eb11-8236-0022489b4c66']...
2025-06-03 12:33:22,514 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-03 12:33:24,702 - src.core.embeddings - INFO - Starting embedding generation
2025-06-03 12:33:24,702 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-03 12:33:24,703 - src.core.embeddings - INFO - Using batch_size=64
2025-06-03 12:33:24,704 - src.core.embeddings - INFO - Using device: cpu
2025-06-03 12:33:28,372 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-03 12:33:32,584 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-03 12:33:32,584 - src.core.embeddings - INFO - Embedding initialization took 7.88 seconds
2025-06-03 12:33:32,584 - src.core.embeddings - INFO - Memory usage: RSS=875.26 MB, VMS=5372.84 MB
2025-06-03 12:33:32,585 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-03 12:33:32,585 - src.core.embeddings - INFO - Using all logs: audit_logs=31316 rows, signin_logs=11917 rows
2025-06-03 12:33:32,594 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-03 12:33:32,611 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-03 12:33:33,487 - src.core.embeddings - INFO - Text generation took 0.90 seconds
2025-06-03 12:33:33,487 - src.core.embeddings - INFO - Memory usage: RSS=905.52 MB, VMS=5398.84 MB
2025-06-03 12:33:33,487 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-03 12:33:36,568 - src.core.embeddings - INFO - Total documents to embed: 43233
2025-06-03 12:33:36,568 - src.core.embeddings - INFO - Document conversion took 3.08 seconds
2025-06-03 12:33:36,568 - src.core.embeddings - INFO - Memory usage: RSS=940.32 MB, VMS=5432.84 MB
2025-06-03 12:33:36,569 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-03 12:33:36,574 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-03 12:33:50,542 - src.core.embeddings - INFO - Memory usage: RSS=1112.60 MB, VMS=6732.04 MB
2025-06-03 12:33:50,543 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-03 12:34:03,822 - src.core.embeddings - INFO - Memory usage: RSS=1172.55 MB, VMS=6791.29 MB
2025-06-03 12:34:03,822 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-03 12:34:18,566 - src.core.embeddings - INFO - Memory usage: RSS=1266.53 MB, VMS=6885.17 MB
2025-06-03 12:34:18,567 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-03 12:34:33,424 - src.core.embeddings - INFO - Memory usage: RSS=1433.29 MB, VMS=7051.17 MB
2025-06-03 12:34:33,425 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-03 12:34:47,039 - src.core.embeddings - INFO - Memory usage: RSS=1492.33 MB, VMS=7110.17 MB
2025-06-03 12:34:47,039 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-03 12:34:59,732 - src.core.embeddings - INFO - Memory usage: RSS=1551.42 MB, VMS=7169.17 MB
2025-06-03 12:34:59,733 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-03 12:35:37,314 - src.core.embeddings - INFO - Memory usage: RSS=1687.37 MB, VMS=7284.92 MB
2025-06-03 12:35:37,315 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-03 12:36:17,589 - src.core.embeddings - INFO - Memory usage: RSS=1736.53 MB, VMS=7334.17 MB
2025-06-03 12:36:17,589 - src.core.embeddings - INFO - Embedding chunk 9/9 (3233 documents)
2025-06-03 12:36:44,093 - src.core.embeddings - INFO - Memory usage: RSS=1937.82 MB, VMS=7536.61 MB
2025-06-03 12:36:44,381 - src.core.embeddings - INFO - Embedding generation took 187.81 seconds
2025-06-03 12:36:44,381 - src.core.embeddings - INFO - Memory usage: RSS=1937.82 MB, VMS=7536.61 MB
2025-06-03 12:36:44,381 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-03 12:36:44,947 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 43233 vectors
2025-06-03 12:36:46,430 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-03 12:36:46,447 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-03 12:36:50,332 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-03 12:36:50,332 - src.core.embeddings - INFO - FAISS vectorstore creation took 5.95 seconds
2025-06-03 12:36:50,333 - src.core.embeddings - INFO - Memory usage: RSS=2111.98 MB, VMS=7751.61 MB
2025-06-03 12:36:50,357 - src.core.embeddings - INFO - Total embedding generation took 205.65 seconds
2025-06-03 12:37:36,136 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-03 12:37:36,137 - src.utils.config - INFO - Loading environment variables
2025-06-03 12:37:36,138 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-03 12:37:36,139 - src.core.analysis - INFO - Validating input DataFrames
2025-06-03 12:37:36,185 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 12:37:36,185 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-03 12:37:36,185 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-03 12:37:36,185 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-03 12:37:36,185 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-03 12:37:36,193 - src.core.analysis - INFO - User IDs from user_details: 207
2025-06-03 12:37:36,193 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-03 12:37:36,193 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-03 12:37:36,193 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-03 12:37:36,194 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-03 12:37:36,450 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-03 12:37:36,471 - src.core.analysis - INFO - Starting analysis
2025-06-03 12:37:36,471 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-03 12:37:39,232 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-03 12:37:39,233 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-03 12:37:39,233 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-03 12:37:39,233 - src.analysis.anomaly_detector - INFO - User details shape: (207, 10)
2025-06-03 12:37:39,233 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 12:37:39,233 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11917, 12)
2025-06-03 12:37:39,233 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-03 12:37:39,245 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-03 12:37:39,258 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-03 12:37:39,282 - src.analysis.anomaly_detector - INFO - Successfully mapped 11917 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-03 12:37:39,286 - src.analysis.anomaly_detector - INFO - Total mapped users: 207
2025-06-03 12:37:39,286 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-03 12:37:39,286 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-03 12:37:39,286 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-03 12:37:39,286 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-03 12:37:39,286 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-03 12:37:39,287 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-03 12:37:39,287 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-03 12:37:39,287 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-03 12:37:39,287 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-03 12:37:39,287 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-03 12:37:39,287 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-03 12:37:39,288 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-03 12:37:39,288 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-03 12:37:39,288 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-03 12:37:39,288 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-03 12:37:40,706 - src.analysis.anomaly_detector - INFO - Detected 59 anomalies
2025-06-03 12:37:40,706 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-03 12:37:40,706 - src.analysis.anomaly_detector - INFO - Example 1: Prem Anand Rajendran -> High sign-in frequency: 5519 sign-ins (avg: 167.8, threshold: 1634.9) (Department: Air Arabia NOC); ...
2025-06-03 12:37:40,706 - src.analysis.anomaly_detector - INFO - Example 2: Vikneshkumar Palanisamy -> High sign-in frequency: 2942 sign-ins (avg: 167.8, threshold: 1634.9) (Department: Air Arabia NOC)...
2025-06-03 12:37:40,706 - src.analysis.anomaly_detector - INFO - Example 3: Dileepkumar Kuruba -> Unusual location: Nemilichery, IN at 2025-05-13 02:00:52. Typical: Bengaluru, IN (99.1%) (Department...
2025-06-03 12:37:40,707 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-03 12:37:41,486 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-03 12:37:41,487 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-03 12:37:41,587 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-03 12:37:41,971 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-03 12:37:42,468 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-03 12:37:42,468 - src.core.analysis - INFO - Analyzing inactive users
2025-06-03 12:37:42,469 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-03 12:37:42,469 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-03 12:37:42,469 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-03 12:37:42,479 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-03 07:36:47+0000', tz='UTC'), Timestamp('2025-06-03 07:36:45+0000', tz='UTC'), Timestamp('2025-06-03 07:36:45+0000', tz='UTC'), Timestamp('2025-06-03 07:35:40+0000', tz='UTC'), Timestamp('2025-06-03 07:35:39+0000', tz='UTC')]
2025-06-03 12:37:42,479 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-03 12:37:42,485 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-05 22:30:13+0000', tz='UTC'), Timestamp('2025-03-05 22:30:28+0000', tz='UTC'), Timestamp('2025-03-05 22:30:34+0000', tz='UTC'), Timestamp('2025-03-05 22:30:38+0000', tz='UTC'), Timestamp('2025-03-06 00:00:48+0000', tz='UTC')]
2025-06-03 12:37:42,485 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-03 12:37:42,968 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 207 total users.
2025-06-03 12:37:42,970 - src.core.analysis - INFO - Total unique user IDs after analysis: 520
2025-06-03 12:37:43,011 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-03 12:37:43,012 - src.core.analysis - INFO - Using chunk size: 15 for 520 users
2025-06-03 12:37:43,014 - src.core.analysis - INFO - Processing 35 chunks sequentially
2025-06-03 12:37:43,017 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-03 12:37:43,017 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 16189 bytes
2025-06-03 12:38:21,232 - src.core.analysis - INFO - Findings chunk 1 completed in 38.21s
2025-06-03 12:38:21,232 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:38:51,230 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-03 12:38:51,231 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 16922 bytes
2025-06-03 12:39:35,801 - src.core.analysis - INFO - Findings chunk 2 completed in 44.57s
2025-06-03 12:39:35,802 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:40:05,798 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-03 12:40:05,800 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 16527 bytes
2025-06-03 12:40:51,381 - src.core.analysis - INFO - Findings chunk 3 completed in 45.58s
2025-06-03 12:40:51,381 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:41:21,379 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-03 12:41:21,381 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 15230 bytes
2025-06-03 12:42:01,162 - src.core.analysis - INFO - Findings chunk 4 completed in 39.78s
2025-06-03 12:42:01,162 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:42:31,162 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 5
2025-06-03 12:42:31,163 - src.core.analysis - INFO - Processing findings chunk 5 with data size: 13808 bytes
2025-06-03 12:43:15,161 - src.core.analysis - INFO - Findings chunk 5 completed in 44.00s
2025-06-03 12:43:15,162 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:43:45,160 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 6
2025-06-03 12:43:45,161 - src.core.analysis - INFO - Processing findings chunk 6 with data size: 17356 bytes
2025-06-03 12:44:23,640 - src.core.analysis - INFO - Findings chunk 6 completed in 38.48s
2025-06-03 12:44:23,640 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:44:53,638 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 7
2025-06-03 12:44:53,639 - src.core.analysis - INFO - Processing findings chunk 7 with data size: 19024 bytes
2025-06-03 12:45:12,870 - src.core.analysis - INFO - Findings chunk 7 completed in 19.23s
2025-06-03 12:45:12,870 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:45:42,870 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 8
2025-06-03 12:45:42,872 - src.core.analysis - INFO - Processing findings chunk 8 with data size: 14830 bytes
2025-06-03 12:45:52,841 - src.core.analysis - INFO - Findings chunk 8 completed in 9.97s
2025-06-03 12:45:52,841 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:46:22,840 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 9
2025-06-03 12:46:22,842 - src.core.analysis - INFO - Processing findings chunk 9 with data size: 17647 bytes
2025-06-03 12:46:38,202 - src.core.analysis - INFO - Findings chunk 9 completed in 15.36s
2025-06-03 12:46:38,202 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:47:08,200 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 10
2025-06-03 12:47:08,201 - src.core.analysis - INFO - Processing findings chunk 10 with data size: 15243 bytes
2025-06-03 12:47:57,458 - src.core.analysis - INFO - Findings chunk 10 completed in 49.26s
2025-06-03 12:47:57,458 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:48:27,458 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 11
2025-06-03 12:48:27,459 - src.core.analysis - INFO - Processing findings chunk 11 with data size: 14984 bytes
2025-06-03 12:48:45,067 - src.core.analysis - INFO - Findings chunk 11 completed in 17.61s
2025-06-03 12:48:45,067 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:49:15,067 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 12
2025-06-03 12:49:15,068 - src.core.analysis - INFO - Processing findings chunk 12 with data size: 15762 bytes
2025-06-03 12:49:27,289 - src.core.analysis - INFO - Findings chunk 12 completed in 12.22s
2025-06-03 12:49:27,290 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:49:57,288 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 13
2025-06-03 12:49:57,289 - src.core.analysis - INFO - Processing findings chunk 13 with data size: 16154 bytes
2025-06-03 12:50:35,903 - src.core.analysis - INFO - Findings chunk 13 completed in 38.61s
2025-06-03 12:50:35,903 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:51:05,902 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 14
2025-06-03 12:51:05,903 - src.core.analysis - INFO - Processing findings chunk 14 with data size: 20131 bytes
2025-06-03 12:51:53,262 - src.core.analysis - INFO - Findings chunk 14 completed in 47.36s
2025-06-03 12:51:53,262 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:52:23,261 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 15
2025-06-03 12:52:23,262 - src.core.analysis - INFO - Processing findings chunk 15 with data size: 15212 bytes
2025-06-03 12:52:51,330 - src.core.analysis - INFO - Findings chunk 15 completed in 28.07s
2025-06-03 12:52:51,331 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:53:21,332 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 16
2025-06-03 12:53:21,332 - src.core.analysis - INFO - Processing findings chunk 16 with data size: 13315 bytes
2025-06-03 12:53:32,767 - src.core.analysis - INFO - Findings chunk 16 completed in 11.44s
2025-06-03 12:53:32,768 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:54:02,767 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 17
2025-06-03 12:54:02,768 - src.core.analysis - INFO - Processing findings chunk 17 with data size: 17650 bytes
2025-06-03 12:54:44,071 - src.core.analysis - INFO - Findings chunk 17 completed in 41.30s
2025-06-03 12:54:44,071 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:55:14,070 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 18
2025-06-03 12:55:14,073 - src.core.analysis - INFO - Processing findings chunk 18 with data size: 18849 bytes
2025-06-03 12:55:59,791 - src.core.analysis - INFO - Findings chunk 18 completed in 45.72s
2025-06-03 12:55:59,791 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:56:29,790 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 19
2025-06-03 12:56:29,791 - src.core.analysis - INFO - Processing findings chunk 19 with data size: 14377 bytes
2025-06-03 12:57:32,788 - src.core.analysis - INFO - Findings chunk 19 completed in 63.00s
2025-06-03 12:57:32,789 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:58:02,786 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 20
2025-06-03 12:58:02,786 - src.core.analysis - INFO - Processing findings chunk 20 with data size: 17125 bytes
2025-06-03 12:58:50,205 - src.core.analysis - INFO - Findings chunk 20 completed in 47.42s
2025-06-03 12:58:50,206 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 12:59:20,205 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 21
2025-06-03 12:59:20,209 - src.core.analysis - INFO - Processing findings chunk 21 with data size: 19205 bytes
2025-06-03 12:59:32,747 - src.core.analysis - INFO - Findings chunk 21 completed in 12.54s
2025-06-03 12:59:32,747 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:00:02,745 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 22
2025-06-03 13:00:02,745 - src.core.analysis - INFO - Processing findings chunk 22 with data size: 14243 bytes
2025-06-03 13:00:43,800 - src.core.analysis - INFO - Findings chunk 22 completed in 41.06s
2025-06-03 13:00:43,801 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:01:13,799 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 23
2025-06-03 13:01:13,800 - src.core.analysis - INFO - Processing findings chunk 23 with data size: 16758 bytes
2025-06-03 13:01:55,602 - src.core.analysis - INFO - Findings chunk 23 completed in 41.80s
2025-06-03 13:01:55,603 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:02:25,601 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 24
2025-06-03 13:02:25,605 - src.core.analysis - INFO - Processing findings chunk 24 with data size: 15128 bytes
2025-06-03 13:03:22,616 - src.core.analysis - INFO - Findings chunk 24 completed in 57.01s
2025-06-03 13:03:22,617 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:03:52,614 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 25
2025-06-03 13:03:52,615 - src.core.analysis - INFO - Processing findings chunk 25 with data size: 15524 bytes
2025-06-03 13:04:35,008 - src.core.analysis - INFO - Findings chunk 25 completed in 42.39s
2025-06-03 13:04:35,009 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:05:05,007 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 26
2025-06-03 13:05:05,010 - src.core.analysis - INFO - Processing findings chunk 26 with data size: 15717 bytes
2025-06-03 13:05:51,758 - src.core.analysis - INFO - Findings chunk 26 completed in 46.75s
2025-06-03 13:05:51,759 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:06:21,757 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 27
2025-06-03 13:06:21,768 - src.core.analysis - INFO - Processing findings chunk 27 with data size: 19231 bytes
2025-06-03 13:06:38,863 - src.core.analysis - INFO - Findings chunk 27 completed in 17.11s
2025-06-03 13:06:38,863 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:07:08,861 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 28
2025-06-03 13:07:08,865 - src.core.analysis - INFO - Processing findings chunk 28 with data size: 18240 bytes
2025-06-03 13:07:48,209 - src.core.analysis - INFO - Findings chunk 28 completed in 39.35s
2025-06-03 13:07:48,209 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:08:18,208 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 29
2025-06-03 13:08:18,211 - src.core.analysis - INFO - Processing findings chunk 29 with data size: 14328 bytes
2025-06-03 13:09:05,320 - src.core.analysis - INFO - Findings chunk 29 completed in 47.11s
2025-06-03 13:09:05,321 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:09:35,319 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 30
2025-06-03 13:09:35,321 - src.core.analysis - INFO - Processing findings chunk 30 with data size: 16326 bytes
2025-06-03 13:10:12,211 - src.core.analysis - INFO - Findings chunk 30 completed in 36.89s
2025-06-03 13:10:12,211 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:10:42,210 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 31
2025-06-03 13:10:42,215 - src.core.analysis - INFO - Processing findings chunk 31 with data size: 14416 bytes
2025-06-03 13:11:19,612 - src.core.analysis - INFO - Findings chunk 31 completed in 37.40s
2025-06-03 13:11:19,613 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:11:49,611 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 32
2025-06-03 13:11:49,614 - src.core.analysis - INFO - Processing findings chunk 32 with data size: 15825 bytes
2025-06-03 13:12:26,187 - src.core.analysis - INFO - Findings chunk 32 completed in 36.58s
2025-06-03 13:12:26,187 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:12:56,185 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 33
2025-06-03 13:12:56,186 - src.core.analysis - INFO - Processing findings chunk 33 with data size: 15851 bytes
2025-06-03 13:13:41,244 - src.core.analysis - INFO - Findings chunk 33 completed in 45.06s
2025-06-03 13:13:41,244 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:14:11,243 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 34
2025-06-03 13:14:11,244 - src.core.analysis - INFO - Processing findings chunk 34 with data size: 16165 bytes
2025-06-03 13:14:53,265 - src.core.analysis - INFO - Findings chunk 34 completed in 42.02s
2025-06-03 13:14:53,266 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:15:23,263 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 35
2025-06-03 13:15:23,264 - src.core.analysis - INFO - Processing findings chunk 35 with data size: 13693 bytes
2025-06-03 13:16:46,825 - src.core.analysis - INFO - Findings chunk 35 completed in 83.56s
2025-06-03 13:16:46,825 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:17:16,829 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-03 13:17:16,840 - src.core.analysis - INFO - Processed 1/35 chunks (2%)
2025-06-03 13:17:16,845 - src.core.analysis - WARNING - JSON parsing error: Unterminated string starting at: line 426 column 49 (char 18794). Attempting to fix unterminated string.
2025-06-03 13:17:16,845 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "ed0e973b-e132-ef11-8409-000d3ab64ef2": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "0c199783-523b-ee11-bdf4-0022489ea33a": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "7bb23dfe-94cc-ee11-9079-000d3ab41c07": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Durga Anji": "Unusual location: Bengaluru, IN at 2025-05-27 0..."
    },
    "mismatches": {
        "0c199783-523b-ee11-bdf4-0022489ea33a": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "834f4305-8e57-ee11-be6f-000d3a669ba8": [
            "Excessive permission: PCS Marketing User. Expected for PCS Employees - UAE: None",
            "Permission 'PCS Marketing User' assigned but no activity in app 'unknown'"
        ],
        "a6502afb-a2c2-eb11-bacc-0022489c4a92": [
            "Excessive permission: Basic User. Expected for Paramount: None",
            "Excessive permission: Customer service app access. Expected for Paramount: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for Paramount: None",
            "Excessive permission: PCS Sales User. Expected for Paramount: None",
            "Excessive permission: Sales Enterprise app access. Expected for Paramount: None",
            "Permission 'Basic User' assigned but no activity in app 'unknown'",
            "Permission 'Customer service app access' assigned but no activity in app 'unknown'",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS Sales User' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "7bb23dfe-94cc-ee11-9079-000d3ab41c07": [
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS Employees - UAE: None",
            "Excessive permission: PCS Management User. Expected for PCS Employees - UAE: None",
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Excessive permission: System Administrator. Expected for PCS Employees - UAE: None",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS Management User' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'",
            "Permission 'System Administrator' assigned but no activity in app 'unknown'"
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across multiple users, particularly in PCS and Paramount roles.",
        "unused_roles": {
            "PCS-Related": [
                "PCS Employees - Saudi",
                "PCS Employees - Bahrain",
                "PCS-Dubai Culture",
                "PCS AIP Users",
                "PCS Qatar - Delivery",
                "PCS Alfanar Manual Tracker Data",
                "PCS Employees - Kuwait",
                "PCS Business Reviews",
                "PCS-Consulting Services",
                "PCSUAEBiz",
                "PCS Outsourced Team",
                "PCS-MSS-BM",
                "PCSKWT",
                "PCS-NBK Project Team",
                "PCS-Sales",
                "PCS-QAPCO-USERS",
                "PCS MATRIX",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-MSS-ALWASL",
                "PCS Qatar - Presales",
                "PCS-BRM",
                "PCS-GRC-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCSAIPOLD",
                "PCS-MSS-AIR-ARABIA",
                "PCS- Kuwait Support",
                "PCS- GII- Infosec Team",
                "PCS-LAB-USERS",
                "PCS MSS Team",
                "PCS-MSS-TAMKEEN",
                "PCS-ELSATIC-LAB-USERS",
                "PCS -LDP",
                "PCS-MSS-MBRHE",
                "PCS Technical",
                "PCS MSO XDR Monitoring Team",
                "PCS-MSS-DCAA",
                "PCS_UAE-Internal",
                "PCS-IT-ADMIN",
                "PCS XDR Monitoring",
                "PCS Admin",
                "PCS - Ajman Municipality",
                "PCS_Jumaalmajid",
                "PCS- KSA Freelancers",
                "PCS-MSS-MIRAL",
                "SOC - PCS",
                "PCS-Sentinel",
                "PCS - Outsourced Team"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Paramount Sales Team",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Intune Enrolled Users Group",
                "Paramount Audit",
                "Paramount CSR",
                "Silver-ParamountMXDR360"
            ],
            "General": [
                "IT Test",
                "Ahlan Cyber -Presales",
                "Qatar Staffing",
                "PMO",
                "MS-Channel",
                "Cloud Sec Documents",
                "IDO Meeting RAK",
                "OT-D-A-V-S",
                "BFSI and O&G",
                "Internship",
                "Sentinel Documents",
                "Intune App Testing",
                "Evanssion Visit",
                "Intune MAM Policy Exclusion",
                "Department_Management",
                "Talent Acquisition",
                "SG_Administration_Users",
                "Intune MAM light Policy",
                "SG_OT Security_Users",
                "KFCA IT-IoT Assessment",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "Presales_TechMSS",
                "AUB Project Files",
                "SG_Data Privacy_Users",
                "NBF- AIP Project",
                "License Administrator",
                "Dynamics 365 Support",
                "Alpheya_Sentinel_Siem_Admins",
                "Sentinel Cyber Defence Team",
                "GDP- Marketing blitzkrieg",
                "Business Excellence",
                "Cloud Security",
                "COO conversations",
                "Microsoft 365 Business Standard Licensed Users",
                "Teams_Group_Qatar_proposals",
                "KSA Region-Internal",
                "RLS-Project-Group",
                "Weekly Summary - Compliance",
                "Qatar OPAS",
                "Excellence Driving Centre",
                "Mashreq Archer Implementation",
                "Department_Finance",
                "SG_Consulting Services_Users",
                "FortiGate SSL VPN Access",
                "Internal Team",
                "Group_core_security",
                "Department_Cloud Services",
                "Submission of Pending TNA Forms",
                "Bahrain Support",
                "IDAM Team",
                "Salama Insurance - Consulting",
                "MSS-DCAA",
                "CybersecurityNxxT Team",
                "Qatar SOC 2 Audit",
                "Intune Compliance windows 10",
                "Emaar Data classification/AIP/FP",
                "Teams_Group_KYNDRYL",
                "FIDO",
                "MSS Security Advisory",
                "CyberNxt - Dashboard",
                "Microsoft Projects",
                "DHA Sentinel Offshore",
                "ISO Delivery",
                "Pre-Sales - Consulting",
                "SCT Project Delivery",
                "MSS-ALFANAR",
                "sales group",
                "PartnerCenter_MPNAdmin",
                "MSS SOC Team",
                "Team Kuwait Projects",
                "KIB_GRC",
                "Teams_Group_FARAH EXPERIENCES",
                "LetsDefend SOC Alerts",
                "SOC - Scope Investment",
                "DHA Offshore SOC Team",
                "DLP Test",
                "Test Team - SOC",
                "DC-SOC",
                "Project Management Office - Consulting",
                "SG_Management_Users",
                "Corporate Governing Council",
                "MOCA",
                "SG_MSS_Users",
                "IGA Project",
                "PAM Team",
                "IAM Delivery Team",
                "Infra Security BU",
                "Data Privacy",
                "Content Management Group",
                "CISCO FIFA RFP",
                "User Administrator",
                "Securus 360",
                "Resource Management",
                "Critical Infra Security- D-A-V-S",
                "AKI_SOC",
                "SG_Sales_Users",
                "Department_MSS",
                "Team MSS",
                "DATA SECURITY TEAM",
                "Department_Data Privacy",
                "NBO Project",
                "From GulfIT- QNB CLM Keyfacotr",
                "Project Status",
                "Intune Administrator",
                "Microsoft Core Team",
                "Cybersecurity NxxT Team",
                "Security Operator",
                "Miral SOC Group",
                "SG_Renewals- Core Security_Users",
                "CA002 Policy exclusion -  non admins",
                "Qatar CSR",
                "ISO 27001:2022 LA Training",
                "Appreciations Tracker",
                "Managed Security Operations Team EDGE",
                "Coresecurity/Tech Projects",
                "SOC Notification",
                "Qatar Renewals",
                "Testing",
                "Global PMO CoE",
                "Azure Information Protection Administrator",
                "Global Administrator",
                "MSS-SOC-Sentinel-India",
                "EDGE Service Delivery",
                "KSA Invoicing",
                "Department_GRC",
                "Ahlanees",
                "Security Sales Department",
                "Identity Workshop",
                "Ahlan Sales",
                "Al-Turki Holding LLC",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Department_Infrastructure Security",
                "customer facing employees",
                "SOC MBRHE",
                "BUPA Microsoft Security Project",
                "Gulf Islamic Investment (GII)",
                "CyberNxt - Talent Cloud",
                "Intune Enroll Excluded Users",
                "Finance Team",
                "Paramout-KSA",
                "Ahlan Cyber - OPAS",
                "Department_Sales",
                "Intune MAM & Defender",
                "MyITBuddy",
                "CSNxxT-Employees",
                "IAM Projects - Test",
                "Invoices | Ahlan Cyber",
                "Department_Data Security",
                "IAM - Presales",
                "HelpdeskAgents",
                "Partnership Kuwait",
                "SCS-Employee",
                "Scope Investment",
                "Billing Details",
                "SG_Staffing Solutions_Users",
                "Qatar Sales",
                "Department_Renewals - Core Security",
                "Teams_Group_MSO_EDGE",
                "CISSP Training 2021",
                "FP&A",
                "6clicks-role-Administrator",
                "Alpheya_Sentinel_Soc",
                "Qatar Finance & Admin",
                "IAM Projects",
                "Ahlan Cyber Knowledge Base",
                "Vivalearn - Integration testing",
                "Consulting-Presales",
                "SG_Cloud Services_Users",
                "Security Co-Pilot",
                "Dukhan Bank IAM assessment project",
                "Team Bahrain",
                "Presales - OT Security",
                "Daman Project",
                "Microsoft 365 Business Premium Licensed Users",
                "Weekly Sales Report",
                "The Executive Council",
                "M365 Copilot",
                "Power BI Administrator",
                "MSS-ABG",
                "Farah",
                "Woqod - Qatar Fuel",
                "Internship 2024",
                "Dubai Metro Blue Line",
                "RLS-Project Plan",
                "Pcs DLP Policy Group",
                "SG_Data Security_Users",
                "Department_IAM",
                "Team Kuwait",
                "HR-ConfidentialLabel",
                "Network Security Champs!",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "SailPoint Training",
                "DLP Flow test",
                "MRM Submission 2024",
                "Data Protection Cloud Services",
                "SG_Finance_Users",
                "MSS-EWEC-Admin",
                "DAG Group - Security Assessment",
                "STC Project",
                "Dynamics 365 Sales",
                "Communication compliance",
                "Learning Plan",
                "Team Qatar",
                "SALES TEAM - BAHRAIN",
                "Test RLS-Project plan",
                "MSS-JAMG",
                "Tamkeen-Data Classification Project",
                "Edge week and month report",
                "Qatar -Presales",
                "OT - Reading resources",
                "Staffing",
                "Mashreq Data Classification Project",
                "DEWA BCM",
                "Sentinel Projects",
                "SOC Tamkeen",
                "Global Reader",
                "altaf",
                "SentinelSME",
                "Dukhan Bank IAM Assessment",
                "Teams_Group_MSS_projects",
                "ahalnees",
                "Project1 PLAN",
                "KIB_GROUP",
                "SG_GRC_Users",
                "Target",
                "Cloud Services Team",
                "MSS-EWEC-SOC",
                "Microsoft 365 E5 Licensed Users",
                "Department_Staffing Solutions",
                "4.x- Schneider-OT",
                "SOC Banque Misr",
                "SG_IAM_Users",
                "Microsoft Elite",
                "Daily Tasks",
                "Department_Consulting Services",
                "Department_OT Security",
                "Fifa game test",
                "Sales Assistant",
                "SG_Infrastructure Security_Users",
                "Order Booking",
                "Department_Administration",
                "KAFD Project",
                "Department_Marketing",
                "Sales-UAE",
                "MSS-EDGE",
                "Office 365 Security",
                "KFCA IT IOT Assessment",
                "Microsoft Fasttrack-RFA"
            ],
            "Explanation": "These roles have no associated activity in audit or sign-in logs over the analyzed period."
        }
    },
    "inactive": {
        "0c199783-523b-ee11-bdf4-0022489ea33a": "No activity recorded in the last 30 days. Reason: User has Sales Enterprise app access but no sign-in activity.",
        "834f4305-8e57-ee11-be6f-000d3a669ba8": "No activity recorded in the last 30 days
2025-06-03 13:17:16,846 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-03 13:17:16,846 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 2 response: {}
2025-06-03 13:17:16,847 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-03 13:17:16,848 - src.core.analysis - INFO - Processed 2/35 chunks (5%)
2025-06-03 13:17:16,849 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-03 13:17:16,849 - src.core.analysis - INFO - Processed 3/35 chunks (8%)
2025-06-03 13:17:16,850 - src.core.analysis - INFO - LLM response parsed successfully for chunk 5
2025-06-03 13:17:16,851 - src.core.analysis - INFO - Processed 4/35 chunks (11%)
2025-06-03 13:17:16,851 - src.core.analysis - INFO - LLM response parsed successfully for chunk 6
2025-06-03 13:17:16,852 - src.core.analysis - INFO - Processed 5/35 chunks (14%)
2025-06-03 13:17:16,852 - src.core.analysis - INFO - LLM response parsed successfully for chunk 7
2025-06-03 13:17:16,853 - src.core.analysis - INFO - Processed 6/35 chunks (17%)
2025-06-03 13:17:16,853 - src.core.analysis - INFO - LLM response parsed successfully for chunk 8
2025-06-03 13:17:16,854 - src.core.analysis - INFO - Processed 7/35 chunks (20%)
2025-06-03 13:17:16,854 - src.core.analysis - INFO - LLM response parsed successfully for chunk 9
2025-06-03 13:17:16,854 - src.core.analysis - INFO - Processed 8/35 chunks (22%)
2025-06-03 13:17:16,854 - src.core.analysis - WARNING - JSON parsing error: Unterminated string starting at: line 393 column 49 (char 16131). Attempting to fix unterminated string.
2025-06-03 13:17:16,855 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "b850733f-13aa-eb11-8236-0022489b4c66": [],
        "d56610e3-2148-ef11-bfe2-000d3ab4cfeb": [
            "Sales Enterprise app access: No usage detected in audit logs."
        ],
        "179ee6d9-2515-f011-998a-7c1e52362954": [
            "Sales Enterprise app access: No usage detected in audit logs."
        ],
        "Ramakrishna V": [],
        "12e3b979-4a36-f011-8c4d-7c1e52362954": [],
        "b8da777f-3a60-ec11-8f8f-000d3adcc269": [],
        "f35cb77d-ac76-ee11-8179-0022489b4696": [],
        "aaf634cd-69b8-ed11-9886-0022489b4de1": [],
        "1b8accf4-f8ec-ef11-be1f-6045bddd1bad": [
            "Sales Enterprise app access: No usage detected in audit logs."
        ],
        "af3db600-dee7-ec11-bb3c-000d3ad96fe8": [],
        "14bc2270-953b-ed11-9db1-0022489ba102": [],
        "07a1bcdb-7c25-ef11-840a-000d3ab64ef2": [],
        "68b4c94e-8533-ec11-b6e6-0022489bd51d": [],
        "be8b16a0-76b4-eb11-8236-000d3ab6406f": [],
        "b548db8e-1dbc-ee11-9078-000d3ab41c07": []
    },
    "anomalies": {
        "b850733f-13aa-eb11-8236-0022489b4c66": [],
        "d56610e3-2148-ef11-bfe2-000d3ab4cfeb": [],
        "179ee6d9-2515-f011-998a-7c1e52362954": [],
        "Ramakrishna V": "Unusual location: Delhi, IN at 2025-06-02 13:58.",
        "12e3b979-4a36-f011-8c4d-7c1e52362954": [],
        "b8da777f-3a60-ec11-8f8f-000d3adcc269": [],
        "f35cb77d-ac76-ee11-8179-0022489b4696": [],
        "aaf634cd-69b8-ed11-9886-0022489b4de1": [],
        "1b8accf4-f8ec-ef11-be1f-6045bddd1bad": [],
        "af3db600-dee7-ec11-bb3c-000d3ad96fe8": [],
        "14bc2270-953b-ed11-9db1-0022489ba102": [],
        "07a1bcdb-7c25-ef11-840a-000d3ab64ef2": [],
        "68b4c94e-8533-ec11-b6e6-0022489bd51d": [],
        "be8b16a0-76b4-eb11-8236-000d3ab6406f": [],
        "b548db8e-1dbc-ee11-9078-000d3ab41c07": []
    },
    "mismatches": {
        "b850733f-13aa-eb11-8236-0022489b4c66": [],
        "d56610e3-2148-ef11-bfe2-000d3ab4cfeb": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None.",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'."
        ],
        "179ee6d9-2515-f011-998a-7c1e52362954": [
            "Excessive permission: Sales Enterprise app access. Expected for Paramount: None.",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'."
        ],
        "Ramakrishna V": [],
        "12e3b979-4a36-f011-8c4d-7c1e52362954": [],
        "b8da777f-3a60-ec11-8f8f-000d3adcc269": [],
        "f35cb77d-ac76-ee11-8179-0022489b4696": [],
        "aaf634cd-69b8-ed11-9886-0022489b4de1": [],
        "1b8accf4-f8ec-ef11-be1f-6045bddd1bad": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None.",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'."
        ],
        "af3db600-dee7-ec11-bb3c-000d3ad96fe8": [],
        "14bc2270-953b-ed11-9db1-0022489ba102": [],
        "07a1bcdb-7c25-ef11-840a-000d3ab64ef2": [],
        "68b4c94e-8533-ec11-b6e6-0022489bd51d": [],
        "be8b16a0-76b4-eb11-8236-000d3ab6406f": [],
        "b548db8e-1dbc-ee11-9078-000d3ab41c07": []
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across PCS Employees and Paramount roles, particularly 'Sales Enterprise app access'.",
        "unused_roles": {
            "PCS-Related": [
                "PCS Employees - Saudi",
                "PCS Employees - Bahrain",
                "PCS-Dubai Culture",
                "PCS AIP Users",
                "PCS Qatar - Delivery",
                "PCS Alfanar Manual Tracker Data",
                "PCS Employees - Kuwait",
                "PCS Business Reviews",
                "PCS-Consulting Services",
                "PCSUAEBiz",
                "PCS Outsourced Team",
                "PCS-MSS-BM",
                "PCSKWT",
                "PCS-NBK Project Team",
                "PCS-Sales",
                "PCS-QAPCO-USERS",
                "PCS MATRIX",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-MSS-ALWASL",
                "PCS Qatar - Presales",
                "PCS-BRM",
                "PCS-GRC-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCSAIPOLD",
                "PCS-MSS-AIR-ARABIA",
                "PCS- Kuwait Support",
                "PCS- GII- Infosec Team",
                "PCS-LAB-USERS",
                "PCS MSS Team",
                "PCS-MSS-TAMKEEN",
                "PCS-ELSATIC-LAB-USERS",
                "PCS -LDP",
                "PCS-MSS-MBRHE",
                "PCS Technical",
                "PCS MSO XDR Monitoring Team",
                "PCS-MSS-DCAA",
                "PCS_UAE-Internal",
                "PCS-IT-ADMIN",
                "PCS XDR Monitoring",
                "PCS Admin",
                "PCS - Ajman Municipality",
                "PCS_Jumaalmajid",
                "PCS- KSA Freelancers",
                "PCS-MSS-MIRAL",
                "SOC - PCS",
                "PCS-Sentinel",
                "PCS - Outsourced Team"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Paramount Sales Team",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Intune Enrolled Users Group",
                "Paramount Audit",
                "Paramount CSR",
                "Silver-ParamountMXDR360"
            ],
            "General": [
                "IT Test",
                "Ahlan Cyber -Presales",
                "Qatar Staffing",
                "PMO",
                "MS-Channel",
                "Cloud Sec Documents",
                "IDO Meeting RAK",
                "OT-D-A-V-S",
                "BFSI and O&G",
                "Internship",
                "Sentinel Documents",
                "Intune App Testing",
                "Evanssion Visit",
                "Intune MAM Policy Exclusion",
                "Department_Management",
                "Talent Acquisition",
                "SG_Administration_Users",
                "Intune MAM light Policy",
                "SG_OT Security_Users",
                "KFCA IT-IoT Assessment",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "Presales_TechMSS",
                "AUB Project Files",
                "SG_Data Privacy_Users",
                "NBF- AIP Project",
                "License Administrator",
                "Dynamics 365 Support",
                "Alpheya_Sentinel_Siem_Admins",
                "Sentinel Cyber Defence Team",
                "GDP- Marketing blitzkrieg",
                "Business Excellence",
                "Cloud Security",
                "COO conversations",
                "Microsoft 365 Business Standard Licensed Users",
                "Teams_Group_Qatar_proposals",
                "KSA Region-Internal",
                "RLS-Project-Group",
                "Weekly Summary - Compliance",
                "Qatar OPAS",
                "Excellence Driving Centre",
                "Mashreq Archer Implementation",
                "Department_Finance",
                "SG_Consulting Services_Users",
                "FortiGate SSL VPN Access",
                "Internal Team",
                "Group_core_security",
                "Department_Cloud Services",
                "Submission of Pending TNA Forms",
                "Bahrain Support",
                "IDAM Team",
                "Salama Insurance - Consulting",
                "MSS-DCAA",
                "CybersecurityNxxT Team",
                "Qatar SOC 2 Audit",
                "Intune Compliance windows 10",
                "Emaar Data classification/AIP/FP",
                "Teams_Group_KYNDRYL",
                "FIDO",
                "MSS Security Advisory",
                "CyberNxt - Dashboard",
                "Microsoft Projects",
                "DHA Sentinel Offshore",
                "ISO Delivery",
                "Pre-Sales - Consulting",
                "SCT Project Delivery",
                "MSS-ALFANAR",
                "sales group",
                "PartnerCenter_MPNAdmin",
                "MSS SOC Team",
                "Team Kuwait Projects",
                "KIB_GRC",
                "Teams_Group_FARAH EXPERIENCES",
                "LetsDefend SOC Alerts",
                "SOC - Scope Investment",
                "DHA Offshore SOC Team",
                "DLP Test",
                "Test Team - SOC",
                "DC-SOC",
                "Project Management Office - Consulting",
                "SG_Management_Users",
                "Corporate Governing Council",
                "MOCA",
                "SG_MSS_Users",
                "IGA Project",
                "PAM Team",
                "IAM Delivery Team",
                "Infra Security BU",
                "Data Privacy",
                "Content Management Group",
                "CISCO FIFA RFP",
                "User Administrator",
                "Securus 360",
                "Resource Management",
                "Critical Infra Security- D-A-V-S",
                "AKI_SOC",
                "SG_Sales_Users",
                "Department_MSS",
                "Team MSS",
                "DATA SECURITY TEAM",
                "Department_Data Privacy",
                "NBO Project",
                "From GulfIT- QNB CLM Keyfacotr",
                "Project Status",
                "Intune Administrator",
                "Microsoft Core Team",
                "Cybersecurity NxxT Team",
                "Security Operator",
                "Miral SOC Group",
                "SG_Renewals- Core Security_Users",
                "CA002 Policy exclusion -  non admins",
                "Qatar CSR",
                "ISO 27001:2022 LA Training",
                "Appreciations Tracker",
                "Managed Security Operations Team EDGE",
                "Coresecurity/Tech Projects",
                "SOC Notification",
                "Qatar Renewals",
                "Testing",
                "Global PMO CoE",
                "Azure Information Protection Administrator",
                "Global Administrator",
                "MSS-SOC-Sentinel-India",
                "EDGE Service Delivery",
                "KSA Invoicing",
                "Department_GRC",
                "Ahlanees",
                "Security Sales Department",
                "Identity Workshop",
                "Ahlan Sales",
                "Al-Turki Holding LLC",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Department_Infrastructure Security",
                "customer facing employees",
                "SOC MBRHE",
                "BUPA Microsoft Security Project",
                "Gulf Islamic Investment (GII)",
                "CyberNxt - Talent Cloud",
                "Intune Enroll Excluded Users",
                "Finance Team",
                "Paramout-KSA",
                "Ahlan Cyber - OPAS",
                "Department_Sales",
                "Intune MAM & Defender",
                "MyITBuddy",
                "CSNxxT-Employees",
                "IAM Projects - Test",
                "Invoices | Ahlan Cyber",
                "Department_Data Security",
                "IAM - Presales",
                "HelpdeskAgents",
                "Partnership Kuwait",
                "SCS-Employee",
                "Scope Investment",
                "Billing Details",
                "SG_Staffing Solutions_Users",
                "Qatar Sales",
                "Department_Renewals - Core Security",
                "Teams_Group_MSO_EDGE",
                "CISSP Training 2021",
                "FP&A",
                "6clicks-role-Administrator",
                "Alpheya_Sentinel_Soc",
                "Qatar Finance & Admin",
                "IAM Projects",
                "Ahlan Cyber Knowledge Base",
                "Vivalearn - Integration testing",
                "Consulting-Presales",
                "SG_Cloud Services_Users",
                "Security Co-Pilot",
                "Dukhan Bank IAM assessment project",
                "Team Bahrain",
                "Presales - OT Security",
                "Daman Project",
                "Microsoft 365 Business Premium Licensed Users",
                "Weekly Sales Report",
                "The Executive Council",
                "M365 Copilot",
                "Power BI Administrator",
                "MSS-ABG",
                "Farah",
                "Woqod - Qatar Fuel",
                "Internship 2024",
                "Dubai Metro Blue Line",
                "RLS-Project Plan",
                "Pcs DLP Policy Group",
                "SG_Data Security_Users",
                "Department_IAM",
                "Team Kuwait",
                "HR-ConfidentialLabel",
                "Network Security Champs!",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "SailPoint Training",
                "DLP Flow test",
                "MRM Submission 2024",
                "Data Protection Cloud Services",
                "SG_Finance_Users",
                "MSS-EWEC-Admin",
                "DAG Group - Security Assessment",
                "STC Project",
                "Dynamics 365 Sales",
                "Communication compliance",
                "Learning Plan",
                "Team Qatar",
                "SALES TEAM - BAHRAIN",
                "Test RLS-Project plan",
                "MSS-JAMG",
                "Tamkeen-Data Classification Project",
                "Edge week and month report",
                "Qatar -Presales",
                "OT - Reading resources",
                "Staffing",
                "Mashreq Data Classification Project",
                "DEWA BCM",
                "Sentinel Projects",
                "SOC Tamkeen",
                "Global Reader",
                "altaf",
                "SentinelSME",
                "Dukhan Bank IAM Assessment",
                "Teams_Group_MSS_projects",
                "ahalnees",
                "Project1 PLAN",
                "KIB_GROUP",
                "SG_GRC_Users",
                "Target",
                "Cloud Services Team",
                "MSS-EWEC-SOC",
                "Microsoft 365 E5 Licensed Users",
                "Department_Staffing Solutions",
                "4.x- Schneider-OT",
                "SOC Banque Misr",
                "SG_IAM_Users",
                "Microsoft Elite",
                "Daily Tasks",
                "Department_Consulting Services",
                "Department_OT Security",
                "Fifa game test",
                "Sales Assistant",
                "SG_Infrastructure Security_Users",
                "Order Booking",
                "Department_Administration",
                "KAFD Project",
                "Department_Marketing",
                "Sales-UAE",
                "MSS-EDGE",
                "Office 365 Security",
                "KFCA IT IOT Assessment",
                "Microsoft Fasttrack-RFA"
            ],
            "Explanation": "These roles have no associated activity in audit or sign-in logs over the analyzed period."
        }
    },
    "inactive": {
        "b850733f-13aa-eb11-8236-0022489b4c66": [],
        "d56610e3-2148-ef11-bfe2-000d3ab4cfeb": "No activity recorded in the last 30 days. Reason: User has been inactive.",
        "179ee6d9-2515-f011-998a-7c1e52362954": "No activity recorded in the last 30 days. Reason: User has been inactive.",
        "Ramakrishna V": [],
        "12e3b979-4a36-f011-8c4d-7c1e52362954": [],
        "b8da777f-3a60-ec11-8f8f-000d3adcc269": [],
        "f35cb77d-ac76-ee11-8179-0022489b4696": [],
        "aaf634cd-69b8-ed11-9886-0022489b4de1": [],
        "1b8accf4-f8ec-ef11-be1f-6045bddd1bad": "No activity recorded in the last 30 days. Reason
2025-06-03 13:17:16,855 - src.core.analysis - INFO - LLM response parsed successfully for chunk 10
2025-06-03 13:17:16,855 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 10 response: {}
2025-06-03 13:17:16,855 - src.core.analysis - INFO - LLM response parsed successfully for chunk 11
2025-06-03 13:17:16,856 - src.core.analysis - INFO - Processed 9/35 chunks (25%)
2025-06-03 13:17:16,856 - src.core.analysis - INFO - LLM response parsed successfully for chunk 12
2025-06-03 13:17:16,857 - src.core.analysis - INFO - Processed 10/35 chunks (28%)
2025-06-03 13:17:16,857 - src.core.analysis - INFO - LLM response parsed successfully for chunk 13
2025-06-03 13:17:16,857 - src.core.analysis - INFO - Processed 11/35 chunks (31%)
2025-06-03 13:17:16,858 - src.core.analysis - WARNING - JSON parsing error: Expecting value: line 420 column 48 (char 18933). Attempting to fix unterminated string.
2025-06-03 13:17:16,858 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "60321937-45b6-ec11-983f-000d3a65fbb2": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "798efc1c-7f84-ef11-ac21-000d3ab6556d": [
            "PCS Management User: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "4fe10f9a-76b4-eb11-8236-000d3ab6406f": [
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days"
        ],
        "78502afb-a2c2-eb11-bacc-0022489c4a92": [
            "Basic User: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days"
        ],
        "bfd05313-74ec-ec11-bb3d-0022489cd7be": [
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Sajal Pandey": "Unusual sign-in from unknown location: Malangwa, NP at 2025-05-09 05:00"
    },
    "mismatches": {
        "798efc1c-7f84-ef11-ac21-000d3ab6556d": [
            "Excessive permission: PCS Management User. Expected for PCS Employees - UAE: None",
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Excessive permission: System Administrator. Expected for PCS Employees - UAE: None",
            "Excessive permission: System Customizer. Expected for PCS Employees - UAE: None",
            "Permission 'PCS Management User' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'",
            "Permission 'System Administrator' assigned but no activity in app 'unknown'",
            "Permission 'System Customizer' assigned but no activity in app 'unknown'"
        ],
        "4fe10f9a-76b4-eb11-8236-000d3ab6406f": [
            "Excessive permission: Customer service app access. Expected for AdminAgents: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for AdminAgents: None",
            "Excessive permission: PCS Presales User. Expected for AdminAgents: None",
            "Excessive permission: Paramount MSS Engineer. Expected for AdminAgents: None",
            "Excessive permission: Paramount Support BU Manager. Expected for AdminAgents: None",
            "Excessive permission: Sales Enterprise app access. Expected for AdminAgents: None",
            "Excessive permission: System Administrator. Expected for AdminAgents: None",
            "Permission 'Customer service app access' assigned but no activity in app 'unknown'",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS Presales User' assigned but no activity in app 'unknown'",
            "Permission 'Paramount MSS Engineer' assigned but no activity in app 'unknown'",
            "Permission 'Paramount Support BU Manager' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'",
            "Permission 'System Administrator' assigned but no activity in app 'unknown'"
        ],
        "78502afb-a2c2-eb11-bacc-0022489c4a92": [
            "Excessive permission: Basic User. Expected for Paramount: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for Paramount: None",
            "Excessive permission: PCS Sales User. Expected for Paramount: None",
            "Excessive permission: Sales Enterprise app access. Expected for Paramount: None",
            "Permission 'Basic User' assigned but no activity in app 'unknown'",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS Sales User' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "bfd05313-74ec-ec11-bb3d-0022489cd7be": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS Technical: Dynamics 365 App for Outlook User",
            "Excessive permission: System Administrator. Expected for PCS Technical: Dynamics 365 App for Outlook User",
            "Excessive permission: System Customizer. Expected for PCS Technical: Dynamics 365 App for Outlook User",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'",
            "Permission 'System Administrator' assigned but no activity in app 'unknown'",
            "Permission 'System Customizer' assigned but no activity in app 'unknown'"
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across multiple users, particularly PCS Sales User and System Administrator roles.",
        "unused_roles": {
            "PCS-Related": [
                "PCS Employees - Saudi",
                "PCS Employees - Bahrain",
                "PCS-Dubai Culture",
                "PCS AIP Users",
                "PCS Qatar - Delivery",
                "PCS Alfanar Manual Tracker Data",
                "PCS Employees - Kuwait",
                "PCS Business Reviews",
                "PCS-Consulting Services",
                "PCSUAEBiz",
                "PCS Outsourced Team",
                "PCS-MSS-BM",
                "PCSKWT",
                "PCS-NBK Project Team",
                "PCS-Sales",
                "PCS-QAPCO-USERS",
                "PCS MATRIX",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-MSS-ALWASL",
                "PCS Qatar - Presales",
                "PCS-BRM",
                "PCS-GRC-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCSAIPOLD",
                "PCS-MSS-AIR-ARABIA",
                "PCS- Kuwait Support",
                "PCS- GII- Infosec Team",
                "PCS-LAB-USERS",
                "PCS MSS Team",
                "PCS-MSS-TAMKEEN",
                "PCS-ELSATIC-LAB-USERS",
                "PCS -LDP",
                "PCS-MSS-MBRHE",
                "PCS Technical",
                "PCS MSO XDR Monitoring Team",
                "PCS-MSS-DCAA",
                "PCS_UAE-Internal",
                "PCS-IT-ADMIN",
                "PCS XDR Monitoring",
                "PCS Admin",
                "PCS - Ajman Municipality",
                "PCS_Jumaalmajid",
                "PCS- KSA Freelancers",
                "PCS-MSS-MIRAL",
                "SOC - PCS",
                "PCS-Sentinel",
                "PCS - Outsourced Team"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Paramount Sales Team",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Intune Enrolled Users Group",
                "Paramount Audit",
                "Paramount CSR",
                "Silver-ParamountMXDR360"
            ],
            "General": [
                "IT Test",
                "Ahlan Cyber -Presales",
                "Qatar Staffing",
                "PMO",
                "MS-Channel",
                "Cloud Sec Documents",
                "IDO Meeting RAK",
                "OT-D-A-V-S",
                "BFSI and O&G",
                "Internship",
                "Sentinel Documents",
                "Intune App Testing",
                "Evanssion Visit",
                "Intune MAM Policy Exclusion",
                "Department_Management",
                "Talent Acquisition",
                "SG_Administration_Users",
                "Intune MAM light Policy",
                "SG_OT Security_Users",
                "KFCA IT-IoT Assessment",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "Presales_TechMSS",
                "AUB Project Files",
                "SG_Data Privacy_Users",
                "NBF- AIP Project",
                "License Administrator",
                "Dynamics 365 Support",
                "Alpheya_Sentinel_Siem_Admins",
                "Sentinel Cyber Defence Team",
                "GDP- Marketing blitzkrieg",
                "Business Excellence",
                "Cloud Security",
                "COO conversations",
                "Microsoft 365 Business Standard Licensed Users",
                "Teams_Group_Qatar_proposals",
                "KSA Region-Internal",
                "RLS-Project-Group",
                "Weekly Summary - Compliance",
                "Qatar OPAS",
                "Excellence Driving Centre",
                "Mashreq Archer Implementation",
                "Department_Finance",
                "SG_Consulting Services_Users",
                "FortiGate SSL VPN Access",
                "Internal Team",
                "Group_core_security",
                "Department_Cloud Services",
                "Submission of Pending TNA Forms",
                "Bahrain Support",
                "IDAM Team",
                "Salama Insurance - Consulting",
                "MSS-DCAA",
                "CybersecurityNxxT Team",
                "Qatar SOC 2 Audit",
                "Intune Compliance windows 10",
                "Emaar Data classification/AIP/FP",
                "Teams_Group_KYNDRYL",
                "FIDO",
                "MSS Security Advisory",
                "CyberNxt - Dashboard",
                "Microsoft Projects",
                "DHA Sentinel Offshore",
                "ISO Delivery",
                "Pre-Sales - Consulting",
                "SCT Project Delivery",
                "MSS-ALFANAR",
                "sales group",
                "PartnerCenter_MPNAdmin",
                "MSS SOC Team",
                "Team Kuwait Projects",
                "KIB_GRC",
                "Teams_Group_FARAH EXPERIENCES",
                "LetsDefend SOC Alerts",
                "SOC - Scope Investment",
                "DHA Offshore SOC Team",
                "DLP Test",
                "Test Team - SOC",
                "DC-SOC",
                "Project Management Office - Consulting",
                "SG_Management_Users",
                "Corporate Governing Council",
                "MOCA",
                "SG_MSS_Users",
                "IGA Project",
                "PAM Team",
                "IAM Delivery Team",
                "Infra Security BU",
                "Data Privacy",
                "Content Management Group",
                "CISCO FIFA RFP",
                "User Administrator",
                "Securus 360",
                "Resource Management",
                "Critical Infra Security- D-A-V-S",
                "AKI_SOC",
                "SG_Sales_Users",
                "Department_MSS",
                "Team MSS",
                "DATA SECURITY TEAM",
                "Department_Data Privacy",
                "NBO Project",
                "From GulfIT- QNB CLM Keyfacotr",
                "Project Status",
                "Intune Administrator",
                "Microsoft Core Team",
                "Cybersecurity NxxT Team",
                "Security Operator",
                "Miral SOC Group",
                "SG_Renewals- Core Security_Users",
                "CA002 Policy exclusion -  non admins",
                "Qatar CSR",
                "ISO 27001:2022 LA Training",
                "Appreciations Tracker",
                "Managed Security Operations Team EDGE",
                "Coresecurity/Tech Projects",
                "SOC Notification",
                "Qatar Renewals",
                "Testing",
                "Global PMO CoE",
                "Azure Information Protection Administrator",
                "Global Administrator",
                "MSS-SOC-Sentinel-India",
                "EDGE Service Delivery",
                "KSA Invoicing",
                "Department_GRC",
                "Ahlanees",
                "Security Sales Department",
                "Identity Workshop",
                "Ahlan Sales",
                "Al-Turki Holding LLC",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Department_Infrastructure Security",
                "customer facing employees",
                "SOC MBRHE",
                "BUPA Microsoft Security Project",
                "Gulf Islamic Investment (GII)",
                "CyberNxt - Talent Cloud",
                "Intune Enroll Excluded Users",
                "Finance Team",
                "Paramout-KSA",
                "Ahlan Cyber - OPAS",
                "Department_Sales",
                "Intune MAM & Defender",
                "MyITBuddy",
                "CSNxxT-Employees",
                "IAM Projects - Test",
                "Invoices | Ahlan Cyber",
                "Department_Data Security",
                "IAM - Presales",
                "HelpdeskAgents",
                "Partnership Kuwait",
                "SCS-Employee",
                "Scope Investment",
                "Billing Details",
                "SG_Staffing Solutions_Users",
                "Qatar Sales",
                "Department_Renewals - Core Security",
                "Teams_Group_MSO_EDGE",
                "CISSP Training 2021",
                "FP&A",
                "6clicks-role-Administrator",
                "Alpheya_Sentinel_Soc",
                "Qatar Finance & Admin",
                "IAM Projects",
                "Ahlan Cyber Knowledge Base",
                "Vivalearn - Integration testing",
                "Consulting-Presales",
                "SG_Cloud Services_Users",
                "Security Co-Pilot",
                "Dukhan Bank IAM assessment project",
                "Team Bahrain",
                "Presales - OT Security",
                "Daman Project",
                "Microsoft 365 Business Premium Licensed Users",
                "Weekly Sales Report",
                "The Executive Council",
                "M365 Copilot",
                "Power BI Administrator",
                "MSS-ABG",
                "Farah",
                "Woqod - Qatar Fuel",
                "Internship 2024",
                "Dubai Metro Blue Line",
                "RLS-Project Plan",
                "Pcs DLP Policy Group",
                "SG_Data Security_Users",
                "Department_IAM",
                "Team Kuwait",
                "HR-ConfidentialLabel",
                "Network Security Champs!",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "SailPoint Training",
                "DLP Flow test",
                "MRM Submission 2024",
                "Data Protection Cloud Services",
                "SG_Finance_Users",
                "MSS-EWEC-Admin",
                "DAG Group - Security Assessment",
                "STC Project",
                "Dynamics 365 Sales",
                "Communication compliance",
                "Learning Plan",
                "Team Qatar",
                "SALES TEAM - BAHRAIN",
                "Test RLS-Project plan",
                "MSS-JAMG",
                "Tamkeen-Data Classification Project",
                "Edge week and month report",
                "Qatar -Presales",
                "OT - Reading resources",
                "Staffing",
                "Mashreq Data Classification Project",
                "DEWA BCM",
                "Sentinel Projects",
                "SOC Tamkeen",
                "Global Reader",
                "altaf",
                "SentinelSME",
                "Dukhan Bank IAM Assessment",
                "Teams_Group_MSS_projects",
                "ahalnees",
                "Project1 PLAN",
                "KIB_GROUP",
                "SG_GRC_Users",
                "Target",
                "Cloud Services Team",
                "MSS-EWEC-SOC",
                "Microsoft 365 E5 Licensed Users",
                "Department_Staffing Solutions",
                "4.x- Schneider-OT",
                "SOC Banque Misr",
                "SG_IAM_Users",
                "Microsoft Elite",
                "Daily Tasks",
                "Department_Consulting Services",
                "Department_OT Security",
                "Fifa game test",
                "Sales Assistant",
                "SG_Infrastructure Security_Users",
                "Order Booking",
                "Department_Administration",
                "KAFD Project",
                "Department_Marketing",
                "Sales-UAE",
                "MSS-EDGE",
                "Office 365 Security",
                "KFCA IT IOT Assessment",
                "Microsoft Fasttrack-RFA"
            ],
            "Explanation": "These roles have no associated activity in audit or sign-in logs over the analyzed period."
        }
    },
    "inactive": {
        "60321937-45b6-ec11-983f-000d3a65fbb2": "No activity recorded in the last 30 days. Reason: User has multiple roles but no sign-in activity.",
        "798efc1c-7f84-ef11-ac21-000d3ab6556d":
2025-06-03 13:17:16,865 - src.core.analysis - INFO - LLM response parsed successfully for chunk 14
2025-06-03 13:17:16,865 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 14 response: {}
2025-06-03 13:17:16,866 - src.core.analysis - INFO - LLM response parsed successfully for chunk 15
2025-06-03 13:17:16,867 - src.core.analysis - INFO - Processed 12/35 chunks (34%)
2025-06-03 13:17:16,867 - src.core.analysis - INFO - LLM response parsed successfully for chunk 16
2025-06-03 13:17:16,868 - src.core.analysis - INFO - Processed 13/35 chunks (37%)
2025-06-03 13:17:16,868 - src.core.analysis - INFO - LLM response parsed successfully for chunk 17
2025-06-03 13:17:16,868 - src.core.analysis - INFO - Processed 14/35 chunks (40%)
2025-06-03 13:17:16,869 - src.core.analysis - INFO - LLM response parsed successfully for chunk 18
2025-06-03 13:17:16,869 - src.core.analysis - INFO - Processed 15/35 chunks (42%)
2025-06-03 13:17:16,869 - src.core.analysis - INFO - LLM response parsed successfully for chunk 19
2025-06-03 13:17:16,870 - src.core.analysis - INFO - Processed 16/35 chunks (45%)
2025-06-03 13:17:16,871 - src.core.analysis - WARNING - JSON parsing error: Expecting value: line 398 column 1 (char 16718). Attempting to fix unterminated string.
2025-06-03 13:17:16,871 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "b3e7a382-f8bc-ec11-9840-0022489e2e28": [],
        "Nihal Rajeev": [],
        "a0e80ea6-76b4-eb11-8236-000d3ab6406f": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days"
        ],
        "b77997ad-76b4-eb11-8236-000d3ab5a61f": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days"
        ],
        "0dd127ed-304d-ec11-8c62-000d3addb5d9": [
            "Sales Enterprise app access: No usage in 90 days"
        ],
        "f7e70ea6-76b4-eb11-8236-000d3ab6406f": [],
        "ffecdb91-1bbe-eb11-bacc-000d3ade3348": [],
        "Angelina Raju": [],
        "293d92b3-76b4-eb11-8236-000d3ab5a61f": [],
        "56e80ea6-76b4-eb11-8236-000d3ab6406f": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days"
        ],
        "3860b0d3-ab09-ec11-b6e6-000d3ab2577d": [],
        "9d8b16a0-76b4-eb11-8236-000d3ab6406f": [],
        "8ce10f9a-76b4-eb11-8236-000d3ab6406f": [],
        "626fe506-9bf2-eb11-94ef-000d3aba6d30": [],
        "CRM -Admin": []
    },
    "anomalies": {
        "b3e7a382-f8bc-ec11-9840-0022489e2e28": [],
        "Nihal Rajeev": "Unusual sign-in from Delhi, IN on 2025-06-01 at 19:02",
        "a0e80ea6-76b4-eb11-8236-000d3ab6406f": [],
        "b77997ad-76b4-eb11-8236-000d3ab5a61f": [],
        "0dd127ed-304d-ec11-8c62-000d3addb5d9": [],
        "f7e70ea6-76b4-eb11-8236-000d3ab6406f": [],
        "ffecdb91-1bbe-eb11-bacc-000d3ade3348": [],
        "Angelina Raju": "Unusual sign-in from Dubayy, AE on 2025-05-20 at 17:40",
        "293d92b3-76b4-eb11-8236-000d3ab5a61f": [],
        "56e80ea6-76b4-eb11-8236-000d3ab6406f": [],
        "3860b0d3-ab09-ec11-b6e6-000d3ab2577d": [],
        "9d8b16a0-76b4-eb11-8236-000d3ab6406f": [],
        "8ce10f9a-76b4-eb11-8236-000d3ab6406f": [],
        "626fe506-9bf2-eb11-94ef-000d3aba6d30": [],
        "CRM -Admin": "Unusual sign-in from Unknown, IN on 2025-05-26 at 06:00"
    },
    "mismatches": {
        "b3e7a382-f8bc-ec11-9840-0022489e2e28": [],
        "Nihal Rajeev": [],
        "a0e80ea6-76b4-eb11-8236-000d3ab6406f": [
            "Excessive permission: Customer service app access. Expected for PCS: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS: None",
            "Excessive permission: Paramount Support Associate. Expected for PCS: None"
        ],
        "b77997ad-76b4-eb11-8236-000d3ab5a61f": [
            "Excessive permission: Basic User. Expected for PCS Employees - UAE: None",
            "Excessive permission: Customer service app access. Expected for PCS Employees - UAE: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS Employees - UAE: None",
            "Excessive permission: PCS Country Manager. Expected for PCS Employees - UAE: None",
            "Excessive permission: PCS Presales User. Expected for PCS Employees - UAE: None",
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Excessive permission: System Administrator. Expected for PCS Employees - UAE: None"
        ],
        "0dd127ed-304d-ec11-8c62-000d3addb5d9": [
            "Excessive permission: Sales Enterprise app access. Expected for Paramount: None"
        ],
        "f7e70ea6-76b4-eb11-8236-000d3ab6406f": [],
        "ffecdb91-1bbe-eb11-bacc-000d3ade3348": [],
        "Angelina Raju": [],
        "293d92b3-76b4-eb11-8236-000d3ab5a61f": [],
        "56e80ea6-76b4-eb11-8236-000d3ab6406f": [
            "Excessive permission: Basic User. Expected for PCS: None",
            "Excessive permission: Customer service app access. Expected for PCS: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS: None",
            "Excessive permission: PCS Sales User. Expected for PCS: None",
            "Excessive permission: Sales Enterprise app access. Expected for PCS: None"
        ],
        "3860b0d3-ab09-ec11-b6e6-000d3ab2577d": [],
        "9d8b16a0-76b4-eb11-8236-000d3ab6406f": [],
        "8ce10f9a-76b4-eb11-8236-000d3ab6406f": [],
        "626fe506-9bf2-eb11-94ef-000d3aba6d30": [],
        "CRM -Admin": []
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across PCS and Paramount departments, indicating potential over-provisioning.",
        "unused_roles": {
            "PCS-Related": [
                "PCS Employees - Saudi",
                "PCS Employees - Bahrain",
                "PCS-Dubai Culture",
                "PCS AIP Users",
                "PCS Qatar - Delivery",
                "PCS Alfanar Manual Tracker Data",
                "PCS Employees - Kuwait",
                "PCS Business Reviews",
                "PCS-Consulting Services",
                "PCSUAEBiz",
                "PCS Outsourced Team",
                "PCS-MSS-BM",
                "PCSKWT",
                "PCS-NBK Project Team",
                "PCS-Sales",
                "PCS-QAPCO-USERS",
                "PCS MATRIX",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-MSS-ALWASL",
                "PCS Qatar - Presales",
                "PCS-BRM",
                "PCS-GRC-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCSAIPOLD",
                "PCS-MSS-AIR-ARABIA",
                "PCS- Kuwait Support",
                "PCS- GII- Infosec Team",
                "PCS-LAB-USERS",
                "PCS MSS Team",
                "PCS-MSS-TAMKEEN",
                "PCS-ELSATIC-LAB-USERS",
                "PCS -LDP",
                "PCS-MSS-MBRHE",
                "PCS Technical",
                "PCS MSO XDR Monitoring Team",
                "PCS-MSS-DCAA",
                "PCS_UAE-Internal",
                "PCS-IT-ADMIN",
                "PCS XDR Monitoring",
                "PCS Admin",
                "PCS - Ajman Municipality",
                "PCS_Jumaalmajid",
                "PCS- KSA Freelancers",
                "PCS-MSS-MIRAL",
                "SOC - PCS",
                "PCS-Sentinel",
                "PCS - Outsourced Team"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Paramount Sales Team",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Intune Enrolled Users Group",
                "Paramount Audit",
                "Paramount CSR",
                "Silver-ParamountMXDR360"
            ],
            "General": [
                "IT Test",
                "Ahlan Cyber -Presales",
                "Qatar Staffing",
                "PMO",
                "MS-Channel",
                "Cloud Sec Documents",
                "IDO Meeting RAK",
                "OT-D-A-V-S",
                "BFSI and O&G",
                "Internship",
                "Sentinel Documents",
                "Intune App Testing",
                "Evanssion Visit",
                "Intune MAM Policy Exclusion",
                "Department_Management",
                "Talent Acquisition",
                "SG_Administration_Users",
                "Intune MAM light Policy",
                "SG_OT Security_Users",
                "KFCA IT-IoT Assessment",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "Presales_TechMSS",
                "AUB Project Files",
                "SG_Data Privacy_Users",
                "NBF- AIP Project",
                "License Administrator",
                "Dynamics 365 Support",
                "Alpheya_Sentinel_Siem_Admins",
                "Sentinel Cyber Defence Team",
                "GDP- Marketing blitzkrieg",
                "Business Excellence",
                "Cloud Security",
                "COO conversations",
                "Microsoft 365 Business Standard Licensed Users",
                "Teams_Group_Qatar_proposals",
                "KSA Region-Internal",
                "RLS-Project-Group",
                "Weekly Summary - Compliance",
                "Qatar OPAS",
                "Excellence Driving Centre",
                "Mashreq Archer Implementation",
                "Department_Finance",
                "SG_Consulting Services_Users",
                "FortiGate SSL VPN Access",
                "Internal Team",
                "Group_core_security",
                "Department_Cloud Services",
                "Submission of Pending TNA Forms",
                "Bahrain Support",
                "IDAM Team",
                "Salama Insurance - Consulting",
                "MSS-DCAA",
                "CybersecurityNxxT Team",
                "Qatar SOC 2 Audit",
                "Intune Compliance windows 10",
                "Emaar Data classification/AIP/FP",
                "Teams_Group_KYNDRYL",
                "FIDO",
                "MSS Security Advisory",
                "CyberNxt - Dashboard",
                "Microsoft Projects",
                "DHA Sentinel Offshore",
                "ISO Delivery",
                "Pre-Sales - Consulting",
                "SCT Project Delivery",
                "MSS-ALFANAR",
                "sales group",
                "PartnerCenter_MPNAdmin",
                "MSS SOC Team",
                "Team Kuwait Projects",
                "KIB_GRC",
                "Teams_Group_FARAH EXPERIENCES",
                "LetsDefend SOC Alerts",
                "SOC - Scope Investment",
                "DHA Offshore SOC Team",
                "DLP Test",
                "Test Team - SOC",
                "DC-SOC",
                "Project Management Office - Consulting",
                "SG_Management_Users",
                "Corporate Governing Council",
                "MOCA",
                "SG_MSS_Users",
                "IGA Project",
                "PAM Team",
                "IAM Delivery Team",
                "Infra Security BU",
                "Data Privacy",
                "Content Management Group",
                "CISCO FIFA RFP",
                "User Administrator",
                "Securus 360",
                "Resource Management",
                "Critical Infra Security- D-A-V-S",
                "AKI_SOC",
                "SG_Sales_Users",
                "Department_MSS",
                "Team MSS",
                "DATA SECURITY TEAM",
                "Department_Data Privacy",
                "NBO Project",
                "From GulfIT- QNB CLM Keyfacotr",
                "Project Status",
                "Intune Administrator",
                "Microsoft Core Team",
                "Cybersecurity NxxT Team",
                "Security Operator",
                "Miral SOC Group",
                "SG_Renewals- Core Security_Users",
                "CA002 Policy exclusion -  non admins",
                "Qatar CSR",
                "ISO 27001:2022 LA Training",
                "Appreciations Tracker",
                "Managed Security Operations Team EDGE",
                "Coresecurity/Tech Projects",
                "SOC Notification",
                "Qatar Renewals",
                "Testing",
                "Global PMO CoE",
                "Azure Information Protection Administrator",
                "Global Administrator",
                "MSS-SOC-Sentinel-India",
                "EDGE Service Delivery",
                "KSA Invoicing",
                "Department_GRC",
                "Ahlanees",
                "Security Sales Department",
                "Identity Workshop",
                "Ahlan Sales",
                "Al-Turki Holding LLC",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Department_Infrastructure Security",
                "customer facing employees",
                "SOC MBRHE",
                "BUPA Microsoft Security Project",
                "Gulf Islamic Investment (GII)",
                "CyberNxt - Talent Cloud",
                "Intune Enroll Excluded Users",
                "Finance Team",
                "Paramout-KSA",
                "Ahlan Cyber - OPAS",
                "Department_Sales",
                "Intune MAM & Defender",
                "MyITBuddy",
                "CSNxxT-Employees",
                "IAM Projects - Test",
                "Invoices | Ahlan Cyber",
                "Department_Data Security",
                "IAM - Presales",
                "HelpdeskAgents",
                "Partnership Kuwait",
                "SCS-Employee",
                "Scope Investment",
                "Billing Details",
                "SG_Staffing Solutions_Users",
                "Qatar Sales",
                "Department_Renewals - Core Security",
                "Teams_Group_MSO_EDGE",
                "CISSP Training 2021",
                "FP&A",
                "6clicks-role-Administrator",
                "Alpheya_Sentinel_Soc",
                "Qatar Finance & Admin",
                "IAM Projects",
                "Ahlan Cyber Knowledge Base",
                "Vivalearn - Integration testing",
                "Consulting-Presales",
                "SG_Cloud Services_Users",
                "Security Co-Pilot",
                "Dukhan Bank IAM assessment project",
                "Team Bahrain",
                "Presales - OT Security",
                "Daman Project",
                "Microsoft 365 Business Premium Licensed Users",
                "Weekly Sales Report",
                "The Executive Council",
                "M365 Copilot",
                "Power BI Administrator",
                "MSS-ABG",
                "Farah",
                "Woqod - Qatar Fuel",
                "Internship 2024",
                "Dubai Metro Blue Line",
                "RLS-Project Plan",
                "Pcs DLP Policy Group",
                "SG_Data Security_Users",
                "Department_IAM",
                "Team Kuwait",
                "HR-ConfidentialLabel",
                "Network Security Champs!",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "SailPoint Training",
                "DLP Flow test",
                "MRM Submission 2024",
                "Data Protection Cloud Services",
                "SG_Finance_Users",
                "MSS-EWEC-Admin",
                "DAG Group - Security Assessment",
                "STC Project",
                "Dynamics 365 Sales",
                "Communication compliance",
                "Learning Plan",
                "Team Qatar",
                "SALES TEAM - BAHRAIN",
                "Test RLS-Project plan",
                "MSS-JAMG",
                "Tamkeen-Data Classification Project",
                "Edge week and month report",
                "Qatar -Presales",
                "OT - Reading resources",
                "Staffing",
                "Mashreq Data Classification Project",
                "DEWA BCM",
                "Sentinel Projects",
                "SOC Tamkeen",
                "Global Reader",
                "altaf",
                "SentinelSME",
                "Dukhan Bank IAM Assessment",
                "Teams_Group_MSS_projects",
                "ahalnees",
                "Project1 PLAN",
                "KIB_GROUP",
                "SG_GRC_Users",
                "Target",
                "Cloud Services Team",
                "MSS-EWEC-SOC",
                "Microsoft 365 E5 Licensed Users",
                "Department_Staffing Solutions",
                "4.x- Schneider-OT",
                "SOC Banque Misr",
                "SG_IAM_Users",
                "Microsoft Elite",
                "Daily Tasks",
                "Department_Consulting Services",
                "Department_OT Security",
                "Fifa game test",
                "Sales Assistant",
                "SG_Infrastructure Security_Users",
                "Order Booking",

2025-06-03 13:17:16,871 - src.core.analysis - INFO - LLM response parsed successfully for chunk 20
2025-06-03 13:17:16,871 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 20 response: {}
2025-06-03 13:17:16,871 - src.core.analysis - INFO - LLM response parsed successfully for chunk 21
2025-06-03 13:17:16,875 - src.core.analysis - INFO - Processed 17/35 chunks (48%)
2025-06-03 13:17:16,875 - src.core.analysis - INFO - LLM response parsed successfully for chunk 22
2025-06-03 13:17:16,875 - src.core.analysis - INFO - Processed 18/35 chunks (51%)
2025-06-03 13:17:16,876 - src.core.analysis - INFO - LLM response parsed successfully for chunk 23
2025-06-03 13:17:16,876 - src.core.analysis - INFO - Processed 19/35 chunks (54%)
2025-06-03 13:17:16,876 - src.core.analysis - WARNING - JSON parsing error: Unterminated string starting at: line 433 column 9 (char 18669). Attempting to fix unterminated string.
2025-06-03 13:17:16,876 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "552898d6-09f0-ee11-904b-6045bde0cdf4": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "608b16a0-76b4-eb11-8236-000d3ab6406f": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "bb6725e4-055e-ef11-bfe3-000d3ab4cfeb": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "e20fa1ea-3cb4-ed11-83ff-000d3adc8967": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Jaya Prakash Immadi": "Unusual location: Nadd Ash Shiba, AE at 2025-05...",
        "Juned Rana": "Unusual location: Delhi, IN at 2025-05-27 18:32..."
    },
    "mismatches": {
        "608b16a0-76b4-eb11-8236-000d3ab6406f": [
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS: None",
            "Excessive permission: PCS Country Manager. Expected for PCS: None",
            "Excessive permission: PCS Management User. Expected for PCS: None",
            "Excessive permission: Sales Enterprise app access. Expected for PCS: None",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS Country Manager' assigned but no activity in app 'unknown'",
            "Permission 'PCS Management User' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "bb6725e4-055e-ef11-bfe3-000d3ab4cfeb": [
            "Excessive permission: Sales Enterprise app access. Expected for Paramount: None",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across PCS and Paramount users, indicating potential over-provisioning.",
        "unused_roles": {
            "PCS-Related": [
                "PCS Employees - Saudi",
                "PCS Employees - Bahrain",
                "PCS-Dubai Culture",
                "PCS AIP Users",
                "PCS Qatar - Delivery",
                "PCS Alfanar Manual Tracker Data",
                "PCS Employees - Kuwait",
                "PCS Business Reviews",
                "PCS-Consulting Services",
                "PCSUAEBiz",
                "PCS Outsourced Team",
                "PCS-MSS-BM",
                "PCSKWT",
                "PCS-NBK Project Team",
                "PCS-Sales",
                "PCS-QAPCO-USERS",
                "PCS MATRIX",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-MSS-ALWASL",
                "PCS Qatar - Presales",
                "PCS-BRM",
                "PCS-GRC-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCSAIPOLD",
                "PCS-MSS-AIR-ARABIA",
                "PCS- Kuwait Support",
                "PCS- GII- Infosec Team",
                "PCS-LAB-USERS",
                "PCS MSS Team",
                "PCS-MSS-TAMKEEN",
                "PCS-ELSATIC-LAB-USERS",
                "PCS -LDP",
                "PCS-MSS-MBRHE",
                "PCS Technical",
                "PCS MSO XDR Monitoring Team",
                "PCS-MSS-DCAA",
                "PCS_UAE-Internal",
                "PCS-IT-ADMIN",
                "PCS XDR Monitoring",
                "PCS Admin",
                "PCS - Ajman Municipality",
                "PCS_Jumaalmajid",
                "PCS- KSA Freelancers",
                "PCS-MSS-MIRAL",
                "SOC - PCS",
                "PCS-Sentinel",
                "PCS - Outsourced Team"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Paramount Sales Team",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Intune Enrolled Users Group",
                "Paramount Audit",
                "Paramount CSR",
                "Silver-ParamountMXDR360"
            ],
            "General": [
                "IT Test",
                "Ahlan Cyber -Presales",
                "Qatar Staffing",
                "PMO",
                "MS-Channel",
                "Cloud Sec Documents",
                "IDO Meeting RAK",
                "OT-D-A-V-S",
                "BFSI and O&G",
                "Internship",
                "Sentinel Documents",
                "Intune App Testing",
                "Evanssion Visit",
                "Intune MAM Policy Exclusion",
                "Department_Management",
                "Talent Acquisition",
                "SG_Administration_Users",
                "Intune MAM light Policy",
                "SG_OT Security_Users",
                "KFCA IT-IoT Assessment",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "Presales_TechMSS",
                "AUB Project Files",
                "SG_Data Privacy_Users",
                "NBF- AIP Project",
                "License Administrator",
                "Dynamics 365 Support",
                "Alpheya_Sentinel_Siem_Admins",
                "Sentinel Cyber Defence Team",
                "GDP- Marketing blitzkrieg",
                "Business Excellence",
                "Cloud Security",
                "COO conversations",
                "Microsoft 365 Business Standard Licensed Users",
                "Teams_Group_Qatar_proposals",
                "KSA Region-Internal",
                "RLS-Project-Group",
                "Weekly Summary - Compliance",
                "Qatar OPAS",
                "Excellence Driving Centre",
                "Mashreq Archer Implementation",
                "Department_Finance",
                "SG_Consulting Services_Users",
                "FortiGate SSL VPN Access",
                "Internal Team",
                "Group_core_security",
                "Department_Cloud Services",
                "Submission of Pending TNA Forms",
                "Bahrain Support",
                "IDAM Team",
                "Salama Insurance - Consulting",
                "MSS-DCAA",
                "CybersecurityNxxT Team",
                "Qatar SOC 2 Audit",
                "Intune Compliance windows 10",
                "Emaar Data classification/AIP/FP",
                "Teams_Group_KYNDRYL",
                "FIDO",
                "MSS Security Advisory",
                "CyberNxt - Dashboard",
                "Microsoft Projects",
                "DHA Sentinel Offshore",
                "ISO Delivery",
                "Pre-Sales - Consulting",
                "SCT Project Delivery",
                "MSS-ALFANAR",
                "sales group",
                "PartnerCenter_MPNAdmin",
                "MSS SOC Team",
                "Team Kuwait Projects",
                "KIB_GRC",
                "Teams_Group_FARAH EXPERIENCES",
                "LetsDefend SOC Alerts",
                "SOC - Scope Investment",
                "DHA Offshore SOC Team",
                "DLP Test",
                "Test Team - SOC",
                "DC-SOC",
                "Project Management Office - Consulting",
                "SG_Management_Users",
                "Corporate Governing Council",
                "MOCA",
                "SG_MSS_Users",
                "IGA Project",
                "PAM Team",
                "IAM Delivery Team",
                "Infra Security BU",
                "Data Privacy",
                "Content Management Group",
                "CISCO FIFA RFP",
                "User Administrator",
                "Securus 360",
                "Resource Management",
                "Critical Infra Security- D-A-V-S",
                "AKI_SOC",
                "SG_Sales_Users",
                "Department_MSS",
                "Team MSS",
                "DATA SECURITY TEAM",
                "Department_Data Privacy",
                "NBO Project",
                "From GulfIT- QNB CLM Keyfacotr",
                "Project Status",
                "Intune Administrator",
                "Microsoft Core Team",
                "Cybersecurity NxxT Team",
                "Security Operator",
                "Miral SOC Group",
                "SG_Renewals- Core Security_Users",
                "CA002 Policy exclusion -  non admins",
                "Qatar CSR",
                "ISO 27001:2022 LA Training",
                "Appreciations Tracker",
                "Managed Security Operations Team EDGE",
                "Coresecurity/Tech Projects",
                "SOC Notification",
                "Qatar Renewals",
                "Testing",
                "Global PMO CoE",
                "Azure Information Protection Administrator",
                "Global Administrator",
                "MSS-SOC-Sentinel-India",
                "EDGE Service Delivery",
                "KSA Invoicing",
                "Department_GRC",
                "Ahlanees",
                "Security Sales Department",
                "Identity Workshop",
                "Ahlan Sales",
                "Al-Turki Holding LLC",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Department_Infrastructure Security",
                "customer facing employees",
                "SOC MBRHE",
                "BUPA Microsoft Security Project",
                "Gulf Islamic Investment (GII)",
                "CyberNxt - Talent Cloud",
                "Intune Enroll Excluded Users",
                "Finance Team",
                "Paramout-KSA",
                "Ahlan Cyber - OPAS",
                "Department_Sales",
                "Intune MAM & Defender",
                "MyITBuddy",
                "CSNxxT-Employees",
                "IAM Projects - Test",
                "Invoices | Ahlan Cyber",
                "Department_Data Security",
                "IAM - Presales",
                "HelpdeskAgents",
                "Partnership Kuwait",
                "SCS-Employee",
                "Scope Investment",
                "Billing Details",
                "SG_Staffing Solutions_Users",
                "Qatar Sales",
                "Department_Renewals - Core Security",
                "Teams_Group_MSO_EDGE",
                "CISSP Training 2021",
                "FP&A",
                "6clicks-role-Administrator",
                "Alpheya_Sentinel_Soc",
                "Qatar Finance & Admin",
                "IAM Projects",
                "Ahlan Cyber Knowledge Base",
                "Vivalearn - Integration testing",
                "Consulting-Presales",
                "SG_Cloud Services_Users",
                "Security Co-Pilot",
                "Dukhan Bank IAM assessment project",
                "Team Bahrain",
                "Presales - OT Security",
                "Daman Project",
                "Microsoft 365 Business Premium Licensed Users",
                "Weekly Sales Report",
                "The Executive Council",
                "M365 Copilot",
                "Power BI Administrator",
                "MSS-ABG",
                "Farah",
                "Woqod - Qatar Fuel",
                "Internship 2024",
                "Dubai Metro Blue Line",
                "RLS-Project Plan",
                "Pcs DLP Policy Group",
                "SG_Data Security_Users",
                "Department_IAM",
                "Team Kuwait",
                "HR-ConfidentialLabel",
                "Network Security Champs!",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "SailPoint Training",
                "DLP Flow test",
                "MRM Submission 2024",
                "Data Protection Cloud Services",
                "SG_Finance_Users",
                "MSS-EWEC-Admin",
                "DAG Group - Security Assessment",
                "STC Project",
                "Dynamics 365 Sales",
                "Communication compliance",
                "Learning Plan",
                "Team Qatar",
                "SALES TEAM - BAHRAIN",
                "Test RLS-Project plan",
                "MSS-JAMG",
                "Tamkeen-Data Classification Project",
                "Edge week and month report",
                "Qatar -Presales",
                "OT - Reading resources",
                "Staffing",
                "Mashreq Data Classification Project",
                "DEWA BCM",
                "Sentinel Projects",
                "SOC Tamkeen",
                "Global Reader",
                "altaf",
                "SentinelSME",
                "Dukhan Bank IAM Assessment",
                "Teams_Group_MSS_projects",
                "ahalnees",
                "Project1 PLAN",
                "KIB_GROUP",
                "SG_GRC_Users",
                "Target",
                "Cloud Services Team",
                "MSS-EWEC-SOC",
                "Microsoft 365 E5 Licensed Users",
                "Department_Staffing Solutions",
                "4.x- Schneider-OT",
                "SOC Banque Misr",
                "SG_IAM_Users",
                "Microsoft Elite",
                "Daily Tasks",
                "Department_Consulting Services",
                "Department_OT Security",
                "Fifa game test",
                "Sales Assistant",
                "SG_Infrastructure Security_Users",
                "Order Booking",
                "Department_Administration",
                "KAFD Project",
                "Department_Marketing",
                "Sales-UAE",
                "MSS-EDGE",
                "Office 365 Security",
                "KFCA IT IOT Assessment",
                "Microsoft Fasttrack-RFA"
            ],
            "Explanation": "These roles have no associated activity in audit or sign-in logs over the analyzed period."
        }
    },
    "inactive": {
        "608b16a0-76b4-eb
2025-06-03 13:17:16,886 - src.core.analysis - INFO - LLM response parsed successfully for chunk 24
2025-06-03 13:17:16,886 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 24 response: {}
2025-06-03 13:17:16,887 - src.core.analysis - INFO - LLM response parsed successfully for chunk 25
2025-06-03 13:17:16,887 - src.core.analysis - INFO - Processed 20/35 chunks (57%)
2025-06-03 13:17:16,887 - src.core.analysis - INFO - LLM response parsed successfully for chunk 26
2025-06-03 13:17:16,888 - src.core.analysis - INFO - Processed 21/35 chunks (60%)
2025-06-03 13:17:16,888 - src.core.analysis - INFO - LLM response parsed successfully for chunk 27
2025-06-03 13:17:16,888 - src.core.analysis - INFO - Processed 22/35 chunks (62%)
2025-06-03 13:17:16,889 - src.core.analysis - INFO - LLM response parsed successfully for chunk 28
2025-06-03 13:17:16,889 - src.core.analysis - INFO - Processed 23/35 chunks (65%)
2025-06-03 13:17:16,890 - src.core.analysis - INFO - LLM response parsed successfully for chunk 29
2025-06-03 13:17:16,890 - src.core.analysis - INFO - Processed 24/35 chunks (68%)
2025-06-03 13:17:16,890 - src.core.analysis - WARNING - JSON parsing error: Unterminated string starting at: line 403 column 17 (char 18055). Attempting to fix unterminated string.
2025-06-03 13:17:16,891 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "270c2437-1891-ef11-8a6a-000d3a6685a9": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "16cc8f80-9cb9-ec11-983f-000d3a65c37c": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "6850733f-13aa-eb11-8236-0022489b4c66": [],
        "e7752e5e-bbdc-ee11-904d-0022489ba240": [],
        "d018bd07-0d07-ec11-94ef-0022489c0f78": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "c8680b28-f477-ed11-81ab-0022489a24b8": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "e0ddabf2-2fbf-ee11-9079-0022489a24b8": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Amit Sharma": "Unusual location: Masqat, OM at 2025-05-22 05:1...",
        "Sridhar Adhikari": "Unusual sign-in time: 2025-05-26 23:03:04 (hour..."
    },
    "mismatches": {
        "d018bd07-0d07-ec11-94ef-0022489c0f78": [
            "Excessive permission: Customer service app access. Expected for PCS Employees - UAE: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS Employees - UAE: None",
            "Excessive permission: Paramount Support Associate. Expected for PCS Employees - UAE: None",
            "Permission 'Customer service app access' assigned but no activity in app 'unknown'",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'Paramount Support Associate' assigned but no activity in app 'unknown'"
        ],
        "4f519886-75cf-ec11-a7b5-000d3ab45df7": [
            "Excessive permission: Sales Enterprise app access. Expected for AdminAgents: None",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "1f84d15e-3f27-ec11-b6e5-000d3ade5275": [
            "Excessive permission: Environment Maker. Expected for All Users: None",
            "Permission 'Environment Maker' assigned but no activity in app 'unknown'"
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across PCS Employees and AdminAgents groups.",
        "unused_roles": {
            "PCS-Related": [
                "PCS Employees - Saudi",
                "PCS Employees - Bahrain",
                "PCS-Dubai Culture",
                "PCS AIP Users",
                "PCS Qatar - Delivery",
                "PCS Alfanar Manual Tracker Data",
                "PCS Employees - Kuwait",
                "PCS Business Reviews",
                "PCS-Consulting Services",
                "PCSUAEBiz",
                "PCS Outsourced Team",
                "PCS-MSS-BM",
                "PCSKWT",
                "PCS-NBK Project Team",
                "PCS-Sales",
                "PCS-QAPCO-USERS",
                "PCS MATRIX",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-MSS-ALWASL",
                "PCS Qatar - Presales",
                "PCS-BRM",
                "PCS-GRC-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCSAIPOLD",
                "PCS-MSS-AIR-ARABIA",
                "PCS- Kuwait Support",
                "PCS- GII- Infosec Team",
                "PCS-LAB-USERS",
                "PCS MSS Team",
                "PCS-MSS-TAMKEEN",
                "PCS-ELSATIC-LAB-USERS",
                "PCS -LDP",
                "PCS-MSS-MBRHE",
                "PCS Technical",
                "PCS MSO XDR Monitoring Team",
                "PCS-MSS-DCAA",
                "PCS_UAE-Internal",
                "PCS-IT-ADMIN",
                "PCS XDR Monitoring",
                "PCS Admin",
                "PCS - Ajman Municipality",
                "PCS_Jumaalmajid",
                "PCS- KSA Freelancers",
                "PCS-MSS-MIRAL",
                "SOC - PCS",
                "PCS-Sentinel",
                "PCS - Outsourced Team"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Paramount Sales Team",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Intune Enrolled Users Group",
                "Paramount Audit",
                "Paramount CSR",
                "Silver-ParamountMXDR360"
            ],
            "General": [
                "IT Test",
                "Ahlan Cyber -Presales",
                "Qatar Staffing",
                "PMO",
                "MS-Channel",
                "Cloud Sec Documents",
                "IDO Meeting RAK",
                "OT-D-A-V-S",
                "BFSI and O&G",
                "Internship",
                "Sentinel Documents",
                "Intune App Testing",
                "Evanssion Visit",
                "Intune MAM Policy Exclusion",
                "Department_Management",
                "Talent Acquisition",
                "SG_Administration_Users",
                "Intune MAM light Policy",
                "SG_OT Security_Users",
                "KFCA IT-IoT Assessment",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "Presales_TechMSS",
                "AUB Project Files",
                "SG_Data Privacy_Users",
                "NBF- AIP Project",
                "License Administrator",
                "Dynamics 365 Support",
                "Alpheya_Sentinel_Siem_Admins",
                "Sentinel Cyber Defence Team",
                "GDP- Marketing blitzkrieg",
                "Business Excellence",
                "Cloud Security",
                "COO conversations",
                "Microsoft 365 Business Standard Licensed Users",
                "Teams_Group_Qatar_proposals",
                "KSA Region-Internal",
                "RLS-Project-Group",
                "Weekly Summary - Compliance",
                "Qatar OPAS",
                "Excellence Driving Centre",
                "Mashreq Archer Implementation",
                "Department_Finance",
                "SG_Consulting Services_Users",
                "FortiGate SSL VPN Access",
                "Internal Team",
                "Group_core_security",
                "Department_Cloud Services",
                "Submission of Pending TNA Forms",
                "Bahrain Support",
                "IDAM Team",
                "Salama Insurance - Consulting",
                "MSS-DCAA",
                "CybersecurityNxxT Team",
                "Qatar SOC 2 Audit",
                "Intune Compliance windows 10",
                "Emaar Data classification/AIP/FP",
                "Teams_Group_KYNDRYL",
                "FIDO",
                "MSS Security Advisory",
                "CyberNxt - Dashboard",
                "Microsoft Projects",
                "DHA Sentinel Offshore",
                "ISO Delivery",
                "Pre-Sales - Consulting",
                "SCT Project Delivery",
                "MSS-ALFANAR",
                "sales group",
                "PartnerCenter_MPNAdmin",
                "MSS SOC Team",
                "Team Kuwait Projects",
                "KIB_GRC",
                "Teams_Group_FARAH EXPERIENCES",
                "LetsDefend SOC Alerts",
                "SOC - Scope Investment",
                "DHA Offshore SOC Team",
                "DLP Test",
                "Test Team - SOC",
                "DC-SOC",
                "Project Management Office - Consulting",
                "SG_Management_Users",
                "Corporate Governing Council",
                "MOCA",
                "SG_MSS_Users",
                "IGA Project",
                "PAM Team",
                "IAM Delivery Team",
                "Infra Security BU",
                "Data Privacy",
                "Content Management Group",
                "CISCO FIFA RFP",
                "User Administrator",
                "Securus 360",
                "Resource Management",
                "Critical Infra Security- D-A-V-S",
                "AKI_SOC",
                "SG_Sales_Users",
                "Department_MSS",
                "Team MSS",
                "DATA SECURITY TEAM",
                "Department_Data Privacy",
                "NBO Project",
                "From GulfIT- QNB CLM Keyfacotr",
                "Project Status",
                "Intune Administrator",
                "Microsoft Core Team",
                "Cybersecurity NxxT Team",
                "Security Operator",
                "Miral SOC Group",
                "SG_Renewals- Core Security_Users",
                "CA002 Policy exclusion -  non admins",
                "Qatar CSR",
                "ISO 27001:2022 LA Training",
                "Appreciations Tracker",
                "Managed Security Operations Team EDGE",
                "Coresecurity/Tech Projects",
                "SOC Notification",
                "Qatar Renewals",
                "Testing",
                "Global PMO CoE",
                "Azure Information Protection Administrator",
                "Global Administrator",
                "MSS-SOC-Sentinel-India",
                "EDGE Service Delivery",
                "KSA Invoicing",
                "Department_GRC",
                "Ahlanees",
                "Security Sales Department",
                "Identity Workshop",
                "Ahlan Sales",
                "Al-Turki Holding LLC",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Department_Infrastructure Security",
                "customer facing employees",
                "SOC MBRHE",
                "BUPA Microsoft Security Project",
                "Gulf Islamic Investment (GII)",
                "CyberNxt - Talent Cloud",
                "Intune Enroll Excluded Users",
                "Finance Team",
                "Paramout-KSA",
                "Ahlan Cyber - OPAS",
                "Department_Sales",
                "Intune MAM & Defender",
                "MyITBuddy",
                "CSNxxT-Employees",
                "IAM Projects - Test",
                "Invoices | Ahlan Cyber",
                "Department_Data Security",
                "IAM - Presales",
                "HelpdeskAgents",
                "Partnership Kuwait",
                "SCS-Employee",
                "Scope Investment",
                "Billing Details",
                "SG_Staffing Solutions_Users",
                "Qatar Sales",
                "Department_Renewals - Core Security",
                "Teams_Group_MSO_EDGE",
                "CISSP Training 2021",
                "FP&A",
                "6clicks-role-Administrator",
                "Alpheya_Sentinel_Soc",
                "Qatar Finance & Admin",
                "IAM Projects",
                "Ahlan Cyber Knowledge Base",
                "Vivalearn - Integration testing",
                "Consulting-Presales",
                "SG_Cloud Services_Users",
                "Security Co-Pilot",
                "Dukhan Bank IAM assessment project",
                "Team Bahrain",
                "Presales - OT Security",
                "Daman Project",
                "Microsoft 365 Business Premium Licensed Users",
                "Weekly Sales Report",
                "The Executive Council",
                "M365 Copilot",
                "Power BI Administrator",
                "MSS-ABG",
                "Farah",
                "Woqod - Qatar Fuel",
                "Internship 2024",
                "Dubai Metro Blue Line",
                "RLS-Project Plan",
                "Pcs DLP Policy Group",
                "SG_Data Security_Users",
                "Department_IAM",
                "Team Kuwait",
                "HR-ConfidentialLabel",
                "Network Security Champs!",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "SailPoint Training",
                "DLP Flow test",
                "MRM Submission 2024",
                "Data Protection Cloud Services",
                "SG_Finance_Users",
                "M
2025-06-03 13:17:16,897 - src.core.analysis - INFO - LLM response parsed successfully for chunk 30
2025-06-03 13:17:16,897 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 30 response: {}
2025-06-03 13:17:16,897 - src.core.analysis - INFO - LLM response parsed successfully for chunk 31
2025-06-03 13:17:16,898 - src.core.analysis - INFO - Processed 25/35 chunks (71%)
2025-06-03 13:17:16,898 - src.core.analysis - INFO - LLM response parsed successfully for chunk 32
2025-06-03 13:17:16,899 - src.core.analysis - INFO - Processed 26/35 chunks (74%)
2025-06-03 13:17:16,899 - src.core.analysis - INFO - LLM response parsed successfully for chunk 33
2025-06-03 13:17:16,900 - src.core.analysis - INFO - Processed 27/35 chunks (77%)
2025-06-03 13:17:16,900 - src.core.analysis - INFO - LLM response parsed successfully for chunk 34
2025-06-03 13:17:16,900 - src.core.analysis - INFO - Processed 28/35 chunks (80%)
2025-06-03 13:17:16,901 - src.core.analysis - INFO - LLM response parsed successfully for chunk 35
2025-06-03 13:17:16,901 - src.core.analysis - INFO - Processed 29/35 chunks (82%)
2025-06-03 13:17:16,901 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-03 13:17:16,902 - src.core.analysis - INFO - Sequential processing completed in 2373.89s
2025-06-03 13:17:16,902 - src.core.analysis - INFO - Successfully processed 29/35 chunks
2025-06-03 13:17:16,902 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-03 13:17:16,902 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 520 users
2025-06-03 13:17:16,935 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-03 13:17:16,937 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-03 13:17:16,952 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-03 13:17:16,953 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 19215 bytes
2025-06-03 13:17:31,073 - src.core.analysis - INFO - Recommendations chunk 1 completed in 14.12s
2025-06-03 13:17:31,073 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-03 13:18:01,073 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-03 13:18:01,076 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-03 13:18:01,076 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-04 21:09:25,941 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-04 21:14:49,347 - main - INFO - Loading data from CSV files
2025-06-04 21:14:49,432 - main - INFO - Loaded audit_logs with 31316 rows
2025-06-04 21:14:49,531 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:14:49,567 - main - INFO - Loaded user_details with 207 rows
2025-06-04 21:14:49,600 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:14:49,636 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:14:49,805 - main - INFO - Created group_memberships with 3212 rows
2025-06-04 21:14:49,836 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:14:49,848 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:14:49,849 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:14:49,851 - main - WARNING - Found 233 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:14:49,851 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:14:50,944 - main - INFO - Fetching data using scripts/data_fetcher.py...
2025-06-04 21:14:50,944 - d365 - INFO - Loading D365 data
2025-06-04 21:14:50,953 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:14:51,240 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5938425a-0d73-4273-84cf-29c4777f4000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:44:51 GMT'
    'Content-Length': '1753'
2025-06-04 21:14:51,261 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:14:51,452 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd1fdd3e8-a5df-418d-8e64-5ce1f50f1700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:44:51 GMT'
    'Content-Length': '1651'
2025-06-04 21:14:51,453 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:14:51,454 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 21:14:51,454 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-06T15:44:51Z)
2025-06-04 21:14:59,596 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-04 21:15:02,900 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-04 21:15:06,054 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-04 21:15:09,229 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-04 21:15:12,500 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-04 21:15:16,206 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-04 21:15:17,438 - d365 - INFO - Progress: Fetched 31508 audit logs after 7 pages
2025-06-04 21:15:17,517 - d365 - INFO - Fetched 31508 D365 audit logs via Dataverse
2025-06-04 21:15:17,809 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-04 21:15:17,823 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:15:18,010 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '768059c7-4ed4-408a-906f-dd3a765c4500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:18 GMT'
    'Content-Length': '1753'
2025-06-04 21:15:18,012 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:15:18,142 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '768059c7-4ed4-408a-906f-dd3a795c4500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:18 GMT'
    'Content-Length': '1996'
2025-06-04 21:15:18,144 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:15:18,145 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 21:15:18,147 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-06T15:45:18Z)
2025-06-04 21:15:18,149 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-04 21:15:38,240 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime ge 2025-03-06T15:45:18Z and appId eq 'a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a': HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-04 21:15:38,241 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime ge 2025-03-06T15:45:18Z and appId eq 'a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a': HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-04 21:15:38,242 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-04 21:15:38,285 - d365 - INFO - Loaded 11917 sign-in logs from CSV
2025-06-04 21:15:38,286 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:15:38,455 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7b4bc7e8-1c6d-4e28-ad39-fbba16a14300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:38 GMT'
    'Content-Length': '1753'
2025-06-04 21:15:38,457 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:15:38,653 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9a4fdf88-8b5c-43ef-9679-ef11574f3900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:38 GMT'
    'Content-Length': '1647'
2025-06-04 21:15:38,654 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:15:38,654 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 21:15:38,655 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:15:38,799 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e9795b9e-ab71-4269-abbb-907919294c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:38 GMT'
    'Content-Length': '1753'
2025-06-04 21:15:38,800 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:15:38,923 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2a72fe50-2304-46c3-98de-381295a84200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:38 GMT'
    'Content-Length': '1997'
2025-06-04 21:15:38,924 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:15:38,926 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 21:15:38,927 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:15:39,163 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '771a29cd-2a5b-43d8-bd34-61d9b7683800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:39 GMT'
    'Content-Length': '1753'
2025-06-04 21:15:39,164 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:15:39,273 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '72d44769-1739-4d8e-9f42-71aa15054300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:45:39 GMT'
    'Content-Length': '1997'
2025-06-04 21:15:39,274 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:15:39,274 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 21:15:41,286 - d365 - INFO - Fetched 969 users from Entra ID
2025-06-04 21:15:41,287 - d365 - INFO - Found 969 users in Entra ID
2025-06-04 21:15:42,796 - d365 - INFO - Fetched 933 user records from D365
2025-06-04 21:16:44,377 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-04 21:16:44,378 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-04 21:17:21,848 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-04 21:17:21,849 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-04 21:17:24,385 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-04 21:17:24,386 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-04 21:17:28,835 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-04 21:17:28,836 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-04 21:18:26,650 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-04 21:18:26,651 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-04 21:19:01,787 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-04 21:19:01,788 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-04 21:19:28,789 - d365 - ERROR - Failed to check D365 license for user 36860932-dfe6-4bef-ad58-3b2e3a146329: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=10)
2025-06-04 21:20:16,720 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-04 21:20:16,721 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-04 21:24:16,913 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-04 21:24:16,914 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-04 21:24:16,914 - d365 - INFO - Final user count after filtering: 205
2025-06-04 21:24:16,916 - d365 - INFO - Fetched 205 user details after filtering
2025-06-04 21:24:16,921 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-04 21:24:16,929 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-04 21:24:16,933 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-04 21:24:16,936 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:24:17,142 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'cfddb614-2211-4635-8707-cb7e784e4200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:54:16 GMT'
    'Content-Length': '1753'
2025-06-04 21:24:17,144 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:24:17,318 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '26a9d9b6-684d-4fd1-b40b-bc98a4cda600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:54:17 GMT'
    'Content-Length': '1648'
2025-06-04 21:24:17,319 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:24:17,319 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 21:24:19,744 - d365 - INFO - Fetched 2101 D365 security roles
2025-06-04 21:24:19,752 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-04 21:24:19,754 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:24:19,949 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '539ea28d-9944-4667-9897-eaa0fe0b1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:54:19 GMT'
    'Content-Length': '1753'
2025-06-04 21:24:19,950 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:24:20,149 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '75674620-9d5b-4161-91e9-0aad7ee03f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:54:19 GMT'
    'Content-Length': '1647'
2025-06-04 21:24:20,151 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:24:20,151 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 21:24:43,971 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-04 21:24:43,974 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-04 21:24:43,976 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:24:44,206 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '999af670-8483-465d-81fa-e80fd5773900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:54:44 GMT'
    'Content-Length': '1753'
2025-06-04 21:24:44,207 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:24:44,448 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c3f29031-d3a0-4eda-baed-b409088d1200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:54:44 GMT'
    'Content-Length': '1996'
2025-06-04 21:24:44,449 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:24:44,449 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 21:25:09,487 - d365 - INFO - Fetched 35 conditional access policies
2025-06-04 21:25:09,490 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-04 21:25:09,492 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:25:09,761 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '76838d4f-89ba-4451-91a5-74ede14d1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:55:09 GMT'
    'Content-Length': '1753'
2025-06-04 21:25:09,763 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:25:10,093 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2690c38f-fae5-420b-bfa6-1c3230e27d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 15:55:09 GMT'
    'Content-Length': '1647'
2025-06-04 21:25:10,094 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:25:10,094 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 21:25:11,014 - d365 - INFO - Fetched 11 business units
2025-06-04 21:25:11,017 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-04 21:25:11,020 - d365 - INFO - D365 data loaded successfully
2025-06-04 21:25:11,034 - main - ERROR - Error fetching data: Data fetch failed: Unknown error
2025-06-04 21:25:11,043 - main - INFO - Loading data from CSV files
2025-06-04 21:25:11,104 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:11,148 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:11,179 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:11,218 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:11,254 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:11,395 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:11,408 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:11,417 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:11,417 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:11,418 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:11,418 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:11,444 - main - INFO - Loading data from CSV files
2025-06-04 21:25:11,484 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:11,528 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:11,533 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:11,539 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:11,546 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:11,591 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:11,601 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:11,607 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:11,607 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:11,608 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:11,609 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:11,614 - main - INFO - Loading data from CSV files
2025-06-04 21:25:11,652 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:11,692 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:11,697 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:11,702 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:11,708 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:11,740 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:11,753 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:11,759 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:11,760 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:11,761 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:11,761 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:11,766 - main - INFO - Loading data from CSV files
2025-06-04 21:25:11,802 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:11,839 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:11,845 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:11,850 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:11,855 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:11,882 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:11,893 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:11,900 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:11,901 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:11,902 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:11,902 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:11,906 - main - INFO - Loading data from CSV files
2025-06-04 21:25:11,940 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:11,975 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:11,981 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:11,985 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:11,990 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:12,018 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:12,026 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:12,035 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:12,035 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:12,036 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:12,036 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:12,040 - main - INFO - Loading data from CSV files
2025-06-04 21:25:12,073 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:12,108 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:12,113 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:12,120 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:12,124 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:12,155 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:12,167 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:12,173 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:12,174 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:12,175 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:12,175 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:27,260 - main - INFO - Loading data from CSV files
2025-06-04 21:25:27,302 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:27,348 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:27,356 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:27,366 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:27,373 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:27,430 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:27,455 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:27,466 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:27,467 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:27,468 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:27,468 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:29,492 - main - INFO - Loading data from CSV files
2025-06-04 21:25:29,544 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:29,589 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:29,593 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:29,599 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:29,606 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:29,650 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:29,663 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:29,672 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:29,672 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:29,673 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:29,673 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:25:33,697 - main - INFO - Loading data from CSV files
2025-06-04 21:25:33,780 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:25:33,876 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:25:33,891 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:25:33,907 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:25:33,924 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:25:34,068 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:25:34,117 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:25:34,143 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:25:34,145 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:25:34,148 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:25:34,149 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:26:14,784 - main - INFO - Loading data from CSV files
2025-06-04 21:26:14,901 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:26:15,032 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:26:15,049 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:26:15,066 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:26:15,083 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:26:15,200 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:26:15,235 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:26:15,264 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:26:15,265 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:26:15,267 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:26:15,269 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:26:16,310 - main - INFO - Loading data from CSV files
2025-06-04 21:26:16,448 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:26:16,591 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:26:16,611 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:26:16,626 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:26:16,644 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:26:16,787 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:26:16,836 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:26:16,862 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:26:16,863 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:26:16,866 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:26:16,868 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:26:18,951 - main - INFO - Loading data from CSV files
2025-06-04 21:26:19,053 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:26:19,192 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:26:19,208 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:26:19,230 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:26:19,248 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:26:19,345 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:26:19,372 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:26:19,385 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:26:19,386 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:26:19,387 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:26:19,388 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:26:23,416 - main - INFO - Loading data from CSV files
2025-06-04 21:26:23,536 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:26:23,650 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:26:23,665 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:26:23,679 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:26:23,693 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:26:23,808 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:26:23,847 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:26:23,872 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:26:23,874 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:26:23,876 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:26:23,877 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:26:55,894 - main - INFO - Loading data from CSV files
2025-06-04 21:26:55,950 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:26:56,012 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:26:56,041 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:26:56,072 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:26:56,096 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:26:56,212 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:26:56,221 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:26:56,229 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:26:56,229 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:26:56,230 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:26:56,231 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:27:04,522 - main - INFO - Loading data from CSV files
2025-06-04 21:27:04,568 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:27:04,609 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:27:04,614 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:27:04,620 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:27:04,626 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:27:04,656 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:27:04,666 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:27:04,675 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:27:04,676 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:27:04,677 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:27:04,678 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:28:13,168 - main - INFO - Loading data from CSV files
2025-06-04 21:28:13,205 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:28:13,282 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:28:13,301 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:28:13,316 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:28:13,336 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:28:13,417 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:28:13,431 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:28:13,439 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:28:13,440 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:28:13,441 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:28:13,441 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:28:15,456 - main - INFO - Loading data from CSV files
2025-06-04 21:28:15,490 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:28:15,532 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:28:15,537 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:28:15,541 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:28:15,546 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:28:15,575 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:28:15,589 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:28:15,597 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:28:15,597 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:28:15,598 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:28:15,598 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:28:25,566 - main - INFO - Loading data from CSV files
2025-06-04 21:28:25,638 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:28:25,707 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:28:25,714 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:28:25,722 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:28:25,729 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:28:25,794 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:28:25,811 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:28:25,824 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:28:25,825 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:28:25,825 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:28:25,826 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:28:26,850 - main - INFO - Loading data from CSV files
2025-06-04 21:28:26,922 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:28:26,984 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:28:26,991 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:28:26,998 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:28:27,006 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:28:27,063 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:28:27,083 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:28:27,095 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:28:27,095 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:28:27,096 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:28:27,097 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:28:28,761 - src.core.embeddings - INFO - Starting embedding generation
2025-06-04 21:28:28,763 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-04 21:28:28,764 - src.core.embeddings - INFO - Using batch_size=64
2025-06-04 21:28:28,771 - src.core.embeddings - INFO - Using device: cpu
2025-06-04 21:29:13,305 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-04 21:29:17,695 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-06-04 21:29:40,895 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-04 21:29:40,896 - src.core.embeddings - INFO - Embedding initialization took 72.12 seconds
2025-06-04 21:29:40,897 - src.core.embeddings - INFO - Memory usage: RSS=369.95 MB, VMS=2699.56 MB
2025-06-04 21:29:40,897 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-04 21:29:40,898 - src.core.embeddings - INFO - Using all logs: audit_logs=31508 rows, signin_logs=11917 rows
2025-06-04 21:29:40,903 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-04 21:29:40,923 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-04 21:29:41,813 - src.core.embeddings - INFO - Text generation took 0.91 seconds
2025-06-04 21:29:41,813 - src.core.embeddings - INFO - Memory usage: RSS=399.71 MB, VMS=2729.01 MB
2025-06-04 21:29:41,814 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-04 21:29:43,609 - src.core.embeddings - INFO - Total documents to embed: 43425
2025-06-04 21:29:43,610 - src.core.embeddings - INFO - Document conversion took 1.80 seconds
2025-06-04 21:29:43,611 - src.core.embeddings - INFO - Memory usage: RSS=434.76 MB, VMS=2764.07 MB
2025-06-04 21:29:43,611 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-04 21:29:43,613 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-04 21:29:56,620 - src.core.embeddings - INFO - Memory usage: RSS=599.18 MB, VMS=2946.39 MB
2025-06-04 21:29:56,621 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-04 21:30:08,344 - src.core.embeddings - INFO - Memory usage: RSS=674.38 MB, VMS=3021.33 MB
2025-06-04 21:30:08,345 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-04 21:30:19,973 - src.core.embeddings - INFO - Memory usage: RSS=748.94 MB, VMS=3095.79 MB
2025-06-04 21:30:19,973 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-04 21:30:32,227 - src.core.embeddings - INFO - Memory usage: RSS=822.95 MB, VMS=3169.24 MB
2025-06-04 21:30:32,227 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-04 21:30:43,121 - src.core.embeddings - INFO - Memory usage: RSS=896.81 MB, VMS=3243.64 MB
2025-06-04 21:30:43,122 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-04 21:30:54,502 - src.core.embeddings - INFO - Memory usage: RSS=970.29 MB, VMS=3317.67 MB
2025-06-04 21:30:54,503 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-04 21:31:22,371 - src.core.embeddings - INFO - Memory usage: RSS=1229.08 MB, VMS=3574.53 MB
2025-06-04 21:31:22,372 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-04 21:31:58,950 - src.core.embeddings - INFO - Memory usage: RSS=1304.27 MB, VMS=3650.51 MB
2025-06-04 21:31:58,951 - src.core.embeddings - INFO - Embedding chunk 9/9 (3425 documents)
2025-06-04 21:32:23,850 - src.core.embeddings - INFO - Memory usage: RSS=1356.51 MB, VMS=3754.76 MB
2025-06-04 21:32:24,155 - src.core.embeddings - INFO - Embedding generation took 160.54 seconds
2025-06-04 21:32:24,156 - src.core.embeddings - INFO - Memory usage: RSS=1356.51 MB, VMS=3754.76 MB
2025-06-04 21:32:24,157 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-04 21:32:24,855 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 43425 vectors
2025-06-04 21:32:26,409 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-04 21:32:26,431 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-04 21:32:27,690 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-04 21:32:27,691 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.53 seconds
2025-06-04 21:32:27,692 - src.core.embeddings - INFO - Memory usage: RSS=1593.35 MB, VMS=4129.88 MB
2025-06-04 21:32:27,704 - src.core.embeddings - INFO - Total embedding generation took 238.94 seconds
2025-06-04 21:32:27,765 - main - INFO - Loading data from CSV files
2025-06-04 21:32:27,935 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:32:28,037 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:32:28,084 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:32:28,123 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:32:28,160 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:32:28,336 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:32:28,372 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:32:28,386 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:32:28,386 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:32:28,388 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:32:28,388 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:32:32,407 - main - INFO - Loading data from CSV files
2025-06-04 21:32:32,471 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:32:32,544 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:32:32,552 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:32:32,561 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:32:32,568 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:32:33,058 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:32:33,073 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:32:33,084 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:32:33,084 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:32:33,085 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:32:33,086 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:38:31,113 - main - INFO - Loading data from CSV files
2025-06-04 21:38:31,173 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:38:31,255 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:38:31,265 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:38:31,276 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:38:31,285 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:38:31,381 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:38:31,459 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:38:31,484 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:38:31,491 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:38:31,494 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:38:31,494 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:38:33,329 - main - INFO - Loading data from CSV files
2025-06-04 21:38:33,366 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:38:33,409 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:38:33,415 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:38:33,421 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:38:33,427 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:38:33,458 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:38:33,469 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:38:33,482 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:38:33,483 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:38:33,484 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:38:33,485 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:38:42,308 - main - INFO - Loading data from CSV files
2025-06-04 21:38:42,345 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:38:42,384 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:38:42,388 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:38:42,394 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:38:42,399 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:38:42,428 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:38:42,439 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:38:42,447 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:38:42,448 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:38:42,449 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:38:42,449 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:39:06,694 - main - INFO - Loading data from CSV files
2025-06-04 21:39:06,744 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:39:06,789 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:39:06,796 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:39:06,804 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:39:06,809 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:39:06,848 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:39:06,862 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:39:06,870 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:39:06,871 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:39:06,872 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:39:06,872 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:40:16,766 - main - INFO - Loading data from CSV files
2025-06-04 21:40:16,806 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:40:16,846 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:40:16,852 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:40:16,859 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:40:16,864 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:40:16,896 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:40:16,911 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:40:16,920 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:40:16,921 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:40:16,922 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:40:16,923 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:44:19,404 - main - INFO - Loading data from CSV files
2025-06-04 21:44:19,494 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:44:19,591 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:44:19,619 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:44:19,648 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:44:19,676 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:44:19,810 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:44:19,829 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:44:19,840 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:44:19,841 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:44:19,842 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:44:19,843 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:44:37,143 - main - INFO - Loading data from CSV files
2025-06-04 21:44:37,200 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:44:37,261 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:44:37,270 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:44:37,276 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:44:37,283 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:44:37,338 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:44:37,353 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:44:37,364 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:44:37,365 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:44:37,366 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:44:37,366 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:44:43,857 - main - INFO - Loading data from CSV files
2025-06-04 21:44:43,914 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:44:43,986 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:44:43,993 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:44:44,002 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:44:44,010 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:44:44,070 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:44:44,092 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:44:44,106 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:44:44,107 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:44:44,109 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:44:44,110 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:44:45,130 - main - INFO - Loading data from CSV files
2025-06-04 21:44:45,215 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:44:45,304 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:44:45,312 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:44:45,319 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:44:45,326 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:44:45,397 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:44:45,415 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:44:45,426 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:44:45,427 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:44:45,428 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:44:45,428 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:44:47,442 - main - INFO - Loading data from CSV files
2025-06-04 21:44:47,494 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:44:47,555 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:44:47,561 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:44:47,569 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:44:47,582 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:44:47,647 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:44:47,662 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:44:47,675 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:44:47,675 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:44:47,676 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:44:47,676 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:44:51,695 - main - INFO - Loading data from CSV files
2025-06-04 21:44:51,748 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:44:51,804 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:44:51,811 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:44:51,820 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:44:51,827 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:44:51,884 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:44:51,900 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:44:51,913 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:44:51,914 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:44:51,915 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:44:51,916 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:48:08,149 - main - INFO - Loading data from CSV files
2025-06-04 21:48:08,186 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:48:08,242 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:48:08,250 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:48:08,260 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:48:08,270 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:48:08,341 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:48:08,358 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:48:08,370 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:48:08,371 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:48:08,375 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:48:08,376 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:08,977 - main - INFO - Loading data from CSV files
2025-06-04 21:52:09,021 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:09,069 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:09,074 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:09,080 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:09,086 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:09,124 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:09,142 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:09,151 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:09,152 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:09,153 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:09,153 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:11,174 - main - INFO - Loading data from CSV files
2025-06-04 21:52:11,210 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:11,249 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:11,254 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:11,258 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:11,263 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:11,296 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:11,307 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:11,318 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:11,318 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:11,320 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:11,320 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:12,039 - main - INFO - Loading data from CSV files
2025-06-04 21:52:12,106 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:12,183 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:12,197 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:12,206 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:12,214 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:12,283 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:12,313 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:12,334 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:12,335 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:12,337 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:12,338 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:13,368 - main - INFO - Loading data from CSV files
2025-06-04 21:52:13,430 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:13,494 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:13,501 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:13,508 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:13,514 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:13,572 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:13,592 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:13,610 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:13,610 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:13,612 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:13,612 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:15,653 - main - INFO - Loading data from CSV files
2025-06-04 21:52:15,705 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:15,766 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:15,772 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:15,781 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:15,790 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:15,849 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:15,865 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:15,875 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:15,876 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:15,876 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:15,877 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:19,893 - main - INFO - Loading data from CSV files
2025-06-04 21:52:19,945 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:20,001 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:20,008 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:20,016 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:20,023 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:20,072 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:20,092 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:20,106 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:20,106 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:20,108 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:20,110 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:25,064 - main - INFO - Loading data from CSV files
2025-06-04 21:52:25,142 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:25,200 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:25,208 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:25,217 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:25,224 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:25,282 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:25,297 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:25,308 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:25,309 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:25,310 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:25,311 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:26,328 - main - INFO - Loading data from CSV files
2025-06-04 21:52:26,381 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:26,438 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:26,444 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:26,450 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:26,457 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:26,506 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:26,521 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:26,532 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:26,532 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:26,533 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:26,534 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:28,551 - main - INFO - Loading data from CSV files
2025-06-04 21:52:28,607 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:28,666 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:28,674 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:28,684 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:28,693 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:28,741 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:28,757 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:28,767 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:28,767 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:28,768 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:28,769 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:32,791 - main - INFO - Loading data from CSV files
2025-06-04 21:52:32,851 - main - INFO - Loaded audit_logs with 31508 rows
2025-06-04 21:52:32,925 - main - INFO - Loaded signin_logs with 11917 rows
2025-06-04 21:52:32,932 - main - INFO - Loaded user_details with 205 rows
2025-06-04 21:52:32,939 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 21:52:32,947 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 21:52:32,999 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 21:52:33,018 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 21:52:33,028 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 21:52:33,029 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 21:52:33,030 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 21:52:33,031 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 21:52:33,040 - main - INFO - Fetching data using scripts/data_fetcher.py...
2025-06-04 21:52:33,041 - d365 - INFO - Loading D365 data
2025-06-04 21:52:33,070 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:52:33,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2e3e44ab-c48c-44c1-8e3c-f63787fc7e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:22:33 GMT'
    'Content-Length': '1753'
2025-06-04 21:52:33,485 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:52:33,731 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '27719408-67be-49ff-9975-3d19697b1600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:22:33 GMT'
    'Content-Length': '1647'
2025-06-04 21:52:33,733 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:52:33,733 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 21:52:33,734 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-06T16:22:33Z)
2025-06-04 21:52:37,952 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-04 21:52:40,952 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-04 21:52:44,286 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-04 21:52:47,450 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-04 21:52:50,512 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-04 21:52:53,435 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-04 21:52:54,683 - d365 - INFO - Progress: Fetched 31505 audit logs after 7 pages
2025-06-04 21:52:54,715 - d365 - INFO - Fetched 31505 D365 audit logs via Dataverse
2025-06-04 21:52:54,832 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-04 21:52:54,839 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:52:55,121 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ba740982-fbf6-476e-bf9d-7f4ffa321700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:22:55 GMT'
    'Content-Length': '1753'
2025-06-04 21:52:55,122 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:52:55,333 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e5060c1d-41cc-4a10-8dbe-c647f7331400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:22:55 GMT'
    'Content-Length': '1991'
2025-06-04 21:52:55,335 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:52:55,337 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 21:52:55,338 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-06T16:22:55Z)
2025-06-04 21:52:55,338 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-04 21:53:10,264 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 4.0 req/min | Time: 0:00:14
2025-06-04 21:53:28,744 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.6 req/min | Time: 0:00:33
2025-06-04 21:53:48,998 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 3.4 req/min | Time: 0:00:53
2025-06-04 21:54:06,165 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 3.4 req/min | Time: 0:01:10
2025-06-04 21:54:22,729 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 3.4 req/min | Time: 0:01:27
2025-06-04 21:54:32,722 - d365 - INFO - Progress: 6,000 records | Pages: 6 | Requests: 6 | Rate: 3.7 req/min | Time: 0:01:37
2025-06-04 21:54:40,685 - d365 - INFO - Progress: 7,000 records | Pages: 7 | Requests: 7 | Rate: 4.0 req/min | Time: 0:01:45
2025-06-04 21:54:49,404 - d365 - INFO - Progress: 8,000 records | Pages: 8 | Requests: 8 | Rate: 4.2 req/min | Time: 0:01:54
2025-06-04 21:54:57,109 - d365 - INFO - Progress: 9,000 records | Pages: 9 | Requests: 9 | Rate: 4.4 req/min | Time: 0:02:01
2025-06-04 21:55:07,931 - d365 - INFO - Progress: 10,000 records | Pages: 10 | Requests: 10 | Rate: 4.5 req/min | Time: 0:02:12
2025-06-04 21:55:15,553 - d365 - INFO - Progress: 11,000 records | Pages: 11 | Requests: 11 | Rate: 4.7 req/min | Time: 0:02:20
2025-06-04 21:55:20,574 - d365 - INFO - Progress: 11,204 records | Pages: 12 | Requests: 12 | Rate: 5.0 req/min | Time: 0:02:25
2025-06-04 21:55:21,075 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-05T16:25:31Z to 2025-06-04T16:13:56Z
2025-06-04 21:55:21,175 - d365 - INFO - Fetch completed: 11,204 records in 0:02:25
2025-06-04 21:55:21,175 - d365 - INFO - Total requests made: 12
2025-06-04 21:55:21,181 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:55:21,576 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e408a3da-7aef-4148-9023-a952406a3f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:25:21 GMT'
    'Content-Length': '1753'
2025-06-04 21:55:21,577 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:55:21,765 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e093d494-5704-4543-9e14-9c8e97d02800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:25:21 GMT'
    'Content-Length': '1647'
2025-06-04 21:55:21,766 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:55:21,766 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 21:55:21,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:55:22,100 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ae407d79-ec92-46c5-be8c-90e223000500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:25:22 GMT'
    'Content-Length': '1753'
2025-06-04 21:55:22,102 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:55:22,326 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2bfd7627-5832-430f-a832-7cfbec2e7600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:25:22 GMT'
    'Content-Length': '1992'
2025-06-04 21:55:22,328 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:55:22,329 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 21:55:22,330 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 21:55:22,640 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '135b846c-c760-4665-89e2-93e44e0c7800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:25:23 GMT'
    'Content-Length': '1753'
2025-06-04 21:55:22,641 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 21:55:22,889 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7be701d5-794d-43ea-8d51-98fc84c91300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:25:23 GMT'
    'Content-Length': '1989'
2025-06-04 21:55:22,890 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 21:55:22,891 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 21:55:46,034 - d365 - INFO - Fetched 969 users from Entra ID
2025-06-04 21:55:46,035 - d365 - INFO - Found 969 users in Entra ID
2025-06-04 21:55:47,608 - d365 - INFO - Fetched 933 user records from D365
2025-06-04 22:02:07,897 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-04 22:02:07,899 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-04 22:05:51,426 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-04 22:05:51,427 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-04 22:06:35,929 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-04 22:06:35,930 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-04 22:07:11,474 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-04 22:07:11,475 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-04 22:09:05,745 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-04 22:09:05,746 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-04 22:09:28,695 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-04 22:09:28,696 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-04 22:09:42,753 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-04 22:09:42,754 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-04 22:11:14,454 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-04 22:11:14,455 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-04 22:11:14,455 - d365 - INFO - Final user count after filtering: 205
2025-06-04 22:11:14,456 - d365 - INFO - Fetched 205 user details after filtering
2025-06-04 22:11:14,462 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-04 22:11:14,472 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-04 22:11:14,475 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-04 22:11:14,477 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 22:11:14,709 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '34393804-1d17-42ab-88b9-49496d1c0100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:15 GMT'
    'Content-Length': '1753'
2025-06-04 22:11:14,710 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 22:11:14,934 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd112432c-e28b-421d-ae62-04215eca2400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:15 GMT'
    'Content-Length': '1647'
2025-06-04 22:11:14,936 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 22:11:14,936 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 22:11:16,300 - d365 - INFO - Fetched 2101 D365 security roles
2025-06-04 22:11:16,307 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-04 22:11:16,308 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 22:11:16,567 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b4bcf4c6-d242-4eb1-923a-f9bb8ce41000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:16 GMT'
    'Content-Length': '1753'
2025-06-04 22:11:16,570 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 22:11:16,786 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ba4f19be-f937-4738-b559-a86842551600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:17 GMT'
    'Content-Length': '1651'
2025-06-04 22:11:16,787 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 22:11:16,788 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 22:11:19,684 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-04 22:11:19,688 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-04 22:11:19,690 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 22:11:19,959 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '06e61c32-91bb-42d0-926b-7ef24f984300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:19 GMT'
    'Content-Length': '1753'
2025-06-04 22:11:19,960 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 22:11:20,116 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '428461a4-da9b-426e-9c66-20ec41684600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:20 GMT'
    'Content-Length': '1997'
2025-06-04 22:11:20,117 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 22:11:20,118 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-04 22:11:22,388 - d365 - INFO - Fetched 35 conditional access policies
2025-06-04 22:11:22,394 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-04 22:11:22,395 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-04 22:11:22,599 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9197142c-d6a7-4770-9792-c5ccb6980f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:22 GMT'
    'Content-Length': '1753'
2025-06-04 22:11:22,600 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-04 22:11:22,809 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '077feae4-2f15-449c-a5c8-b19c7bb61600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 04 Jun 2025 16:41:22 GMT'
    'Content-Length': '1652'
2025-06-04 22:11:22,810 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-04 22:11:22,810 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-04 22:11:23,480 - d365 - INFO - Fetched 11 business units
2025-06-04 22:11:23,482 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-04 22:11:23,484 - d365 - INFO - D365 data loaded successfully
2025-06-04 22:11:23,499 - main - ERROR - Error fetching data: Data fetch failed: Unknown error
2025-06-04 22:11:57,386 - src.core.embeddings - INFO - Starting embedding generation
2025-06-04 22:11:57,387 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-04 22:11:57,387 - src.core.embeddings - INFO - Using batch_size=64
2025-06-04 22:11:57,388 - src.core.embeddings - INFO - Using device: cpu
2025-06-04 22:11:57,484 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-04 22:12:01,546 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-04 22:12:01,546 - src.core.embeddings - INFO - Embedding initialization took 4.16 seconds
2025-06-04 22:12:01,549 - src.core.embeddings - INFO - Memory usage: RSS=139.93 MB, VMS=3920.20 MB
2025-06-04 22:12:01,550 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-04 22:12:01,550 - src.core.embeddings - INFO - Using all logs: audit_logs=31508 rows, signin_logs=11917 rows
2025-06-04 22:12:01,566 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-04 22:12:01,605 - src.core.embeddings - INFO - Precomputed location history in 0.04 seconds
2025-06-04 22:12:02,420 - src.core.embeddings - INFO - Text generation took 0.87 seconds
2025-06-04 22:12:02,421 - src.core.embeddings - INFO - Memory usage: RSS=154.96 MB, VMS=3921.20 MB
2025-06-04 22:12:02,421 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-04 22:12:07,709 - src.core.embeddings - INFO - Total documents to embed: 43425
2025-06-04 22:12:07,710 - src.core.embeddings - INFO - Document conversion took 5.29 seconds
2025-06-04 22:12:07,710 - src.core.embeddings - INFO - Memory usage: RSS=1101.75 MB, VMS=3943.25 MB
2025-06-04 22:12:07,711 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-04 22:12:07,713 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-04 22:12:19,965 - src.core.embeddings - INFO - Memory usage: RSS=1256.12 MB, VMS=4005.17 MB
2025-06-04 22:12:19,965 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-04 22:12:31,878 - src.core.embeddings - INFO - Memory usage: RSS=1329.90 MB, VMS=4078.43 MB
2025-06-04 22:12:31,879 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-04 22:12:44,684 - src.core.embeddings - INFO - Memory usage: RSS=1404.47 MB, VMS=4152.24 MB
2025-06-04 22:12:44,685 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-04 22:12:56,499 - src.core.embeddings - INFO - Memory usage: RSS=1478.09 MB, VMS=4225.05 MB
2025-06-04 22:12:56,500 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-04 22:13:08,331 - src.core.embeddings - INFO - Memory usage: RSS=1551.15 MB, VMS=4298.34 MB
2025-06-04 22:13:08,332 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-04 22:13:20,434 - src.core.embeddings - INFO - Memory usage: RSS=1624.92 MB, VMS=4372.14 MB
2025-06-04 22:13:20,437 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-04 22:13:51,412 - src.core.embeddings - INFO - Memory usage: RSS=1880.19 MB, VMS=4618.81 MB
2025-06-04 22:13:51,412 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-04 22:14:26,205 - src.core.embeddings - INFO - Memory usage: RSS=1955.15 MB, VMS=4693.48 MB
2025-06-04 22:14:26,206 - src.core.embeddings - INFO - Embedding chunk 9/9 (3425 documents)
2025-06-04 22:14:51,023 - src.core.embeddings - INFO - Memory usage: RSS=2007.95 MB, VMS=4744.46 MB
2025-06-04 22:14:51,504 - src.core.embeddings - INFO - Embedding generation took 163.79 seconds
2025-06-04 22:14:51,504 - src.core.embeddings - INFO - Memory usage: RSS=2007.95 MB, VMS=4744.46 MB
2025-06-04 22:14:51,505 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-04 22:14:52,411 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 43425 vectors
2025-06-04 22:14:53,515 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-04 22:14:53,532 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-04 22:14:54,703 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-04 22:14:54,704 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.20 seconds
2025-06-04 22:14:54,705 - src.core.embeddings - INFO - Memory usage: RSS=2247.32 MB, VMS=4992.03 MB
2025-06-04 22:14:54,718 - src.core.embeddings - INFO - Total embedding generation took 177.33 seconds
2025-06-04 22:17:33,122 - main - INFO - Loading data from CSV files
2025-06-04 22:17:33,178 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:17:33,230 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:17:33,262 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:17:33,293 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:17:33,327 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:17:33,451 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:17:33,464 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:17:33,474 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:17:33,474 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:17:33,475 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:17:33,476 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:18:07,563 - main - INFO - Loading data from CSV files
2025-06-04 22:18:07,600 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:18:07,641 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:18:07,646 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:18:07,652 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:18:07,658 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:18:07,689 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:18:07,700 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:18:07,708 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:18:07,708 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:18:07,709 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:18:07,709 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:18:46,755 - main - INFO - Loading data from CSV files
2025-06-04 22:18:46,799 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:18:46,839 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:18:46,844 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:18:46,849 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:18:46,854 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:18:46,887 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:18:46,898 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:18:46,906 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:18:46,906 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:18:46,907 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:18:46,907 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:05,749 - main - INFO - Loading data from CSV files
2025-06-04 22:21:05,810 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:05,880 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:05,891 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:05,898 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:05,906 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:05,983 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:06,011 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:06,024 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:06,024 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:06,026 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:06,026 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:08,384 - main - INFO - Loading data from CSV files
2025-06-04 22:21:08,434 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:08,479 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:08,484 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:08,489 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:08,494 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:08,537 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:08,556 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:08,565 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:08,565 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:08,567 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:08,568 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:09,589 - main - INFO - Loading data from CSV files
2025-06-04 22:21:09,647 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:09,729 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:09,737 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:09,749 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:09,764 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:09,837 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:09,855 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:09,873 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:09,874 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:09,875 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:09,876 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:11,912 - main - INFO - Loading data from CSV files
2025-06-04 22:21:11,987 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:12,055 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:12,063 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:12,072 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:12,080 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:12,157 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:12,178 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:12,192 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:12,192 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:12,193 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:12,194 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:16,218 - main - INFO - Loading data from CSV files
2025-06-04 22:21:16,301 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:16,397 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:16,404 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:16,414 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:16,422 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:16,483 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:16,510 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:16,524 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:16,525 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:16,526 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:16,527 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:18,951 - main - INFO - Loading data from CSV files
2025-06-04 22:21:19,019 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:19,083 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:19,090 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:19,098 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:19,105 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:19,160 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:19,178 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:19,191 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:19,191 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:19,193 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:19,194 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:21,275 - main - INFO - Loading data from CSV files
2025-06-04 22:21:21,342 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:21,402 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:21,409 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:21,416 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:21,425 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:21,484 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:21,502 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:21,515 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:21,515 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:21,516 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:21,517 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:22,535 - main - INFO - Loading data from CSV files
2025-06-04 22:21:22,597 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:22,661 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:22,668 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:22,676 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:22,683 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:22,743 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:22,762 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:22,778 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:22,779 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:22,780 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:22,781 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:24,807 - main - INFO - Loading data from CSV files
2025-06-04 22:21:24,867 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:24,928 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:24,935 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:24,945 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:24,956 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:25,016 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:25,034 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:25,045 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:25,046 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:25,047 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:25,047 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:29,058 - main - INFO - Loading data from CSV files
2025-06-04 22:21:29,119 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:29,195 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:29,206 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:29,215 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:29,227 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:29,403 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:29,467 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:29,496 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:29,498 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:29,500 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:29,501 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:29,928 - main - INFO - Loading data from CSV files
2025-06-04 22:21:29,997 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:30,064 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:30,072 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:30,079 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:30,087 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:30,143 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:30,162 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:30,176 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:30,177 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:30,178 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:30,179 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:31,200 - main - INFO - Loading data from CSV files
2025-06-04 22:21:31,253 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:31,336 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:31,345 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:31,355 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:31,365 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:31,441 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:31,463 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:31,475 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:31,476 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:31,477 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:31,477 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:33,506 - main - INFO - Loading data from CSV files
2025-06-04 22:21:33,592 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:33,657 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:33,664 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:33,672 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:33,679 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:33,740 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:33,761 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:33,779 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:33,781 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:33,783 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:33,784 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:37,800 - main - INFO - Loading data from CSV files
2025-06-04 22:21:37,858 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:37,920 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:37,929 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:37,938 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:37,948 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:38,020 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:38,041 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:38,053 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:38,054 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:38,055 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:38,056 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:41,774 - main - INFO - Loading data from CSV files
2025-06-04 22:21:41,835 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:41,902 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:41,909 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:41,921 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:41,932 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:42,013 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:42,031 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:42,043 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:42,043 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:42,044 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:42,045 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:43,066 - main - INFO - Loading data from CSV files
2025-06-04 22:21:43,138 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:43,207 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:43,215 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:43,225 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:43,232 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:43,288 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:43,306 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:43,319 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:43,320 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:43,321 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:43,321 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:45,339 - main - INFO - Loading data from CSV files
2025-06-04 22:21:45,394 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:45,468 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:45,476 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:45,483 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:45,490 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:45,555 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:45,574 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:45,591 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:45,592 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:45,594 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:45,595 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:21:49,616 - main - INFO - Loading data from CSV files
2025-06-04 22:21:49,669 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:21:49,729 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:21:49,736 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:21:49,743 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:21:49,750 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:21:49,831 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:21:49,856 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:21:49,874 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:21:49,874 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:21:49,876 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:21:49,876 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:23:52,793 - main - INFO - Loading data from CSV files
2025-06-04 22:23:52,822 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:23:52,849 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:23:52,853 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:23:52,856 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:23:52,860 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:23:52,880 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:23:52,887 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:23:52,892 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:23:52,892 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:23:52,893 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:23:52,893 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:23:53,908 - main - INFO - Loading data from CSV files
2025-06-04 22:23:53,960 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:23:54,020 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:23:54,028 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:23:54,038 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:23:54,047 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:23:54,103 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:23:54,122 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:23:54,134 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:23:54,135 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:23:54,136 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:23:54,136 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:23:56,149 - main - INFO - Loading data from CSV files
2025-06-04 22:23:56,208 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:23:56,267 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:23:56,273 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:23:56,279 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:23:56,286 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:23:56,350 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:23:56,392 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:23:56,408 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:23:56,408 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:23:56,410 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:23:56,411 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:24:00,453 - main - INFO - Loading data from CSV files
2025-06-04 22:24:00,508 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:24:00,575 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:24:00,582 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:24:00,588 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:24:00,596 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:24:00,658 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:24:00,681 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:24:00,693 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:24:00,693 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:24:00,694 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:24:00,695 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:35:32,512 - main - INFO - Loading data from CSV files
2025-06-04 22:35:32,581 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:35:32,632 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:35:32,665 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:35:32,692 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:35:32,725 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:35:32,811 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:35:32,822 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:35:32,829 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:35:32,829 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:35:32,830 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:35:32,831 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:35:50,861 - src.core.embeddings - INFO - Starting embedding generation
2025-06-04 22:35:50,864 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-04 22:35:50,864 - src.core.embeddings - INFO - Using batch_size=64
2025-06-04 22:35:50,871 - src.core.embeddings - INFO - Using device: cpu
2025-06-04 22:35:50,944 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-04 22:35:54,894 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-04 22:35:54,894 - src.core.embeddings - INFO - Embedding initialization took 4.02 seconds
2025-06-04 22:35:54,899 - src.core.embeddings - INFO - Memory usage: RSS=139.06 MB, VMS=4024.00 MB
2025-06-04 22:35:54,899 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-04 22:35:54,900 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-04 22:35:54,908 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-04 22:35:54,946 - src.core.embeddings - INFO - Precomputed location history in 0.04 seconds
2025-06-04 22:35:59,060 - src.core.embeddings - INFO - Text generation took 4.16 seconds
2025-06-04 22:35:59,061 - src.core.embeddings - INFO - Memory usage: RSS=1104.69 MB, VMS=3956.12 MB
2025-06-04 22:35:59,061 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-04 22:36:01,221 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-04 22:36:01,221 - src.core.embeddings - INFO - Document conversion took 2.16 seconds
2025-06-04 22:36:01,222 - src.core.embeddings - INFO - Memory usage: RSS=1132.43 MB, VMS=3956.60 MB
2025-06-04 22:36:01,222 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-04 22:36:01,227 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-04 22:36:14,728 - src.core.embeddings - INFO - Memory usage: RSS=1274.29 MB, VMS=4017.52 MB
2025-06-04 22:36:14,729 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-04 22:36:32,176 - src.core.embeddings - INFO - Memory usage: RSS=1343.96 MB, VMS=4082.36 MB
2025-06-04 22:36:32,176 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-04 22:36:50,003 - src.core.embeddings - INFO - Memory usage: RSS=1398.95 MB, VMS=4156.29 MB
2025-06-04 22:36:50,004 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-04 22:37:08,367 - src.core.embeddings - INFO - Memory usage: RSS=1472.48 MB, VMS=4229.66 MB
2025-06-04 22:37:08,368 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-04 22:37:25,460 - src.core.embeddings - INFO - Memory usage: RSS=1545.98 MB, VMS=4302.93 MB
2025-06-04 22:37:25,461 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-04 22:37:41,570 - src.core.embeddings - INFO - Memory usage: RSS=1620.11 MB, VMS=4376.19 MB
2025-06-04 22:37:41,571 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-04 22:38:25,299 - src.core.embeddings - INFO - Memory usage: RSS=1867.73 MB, VMS=4622.25 MB
2025-06-04 22:38:25,301 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-04 22:39:29,534 - src.core.embeddings - INFO - Memory usage: RSS=1936.53 MB, VMS=4695.68 MB
2025-06-04 22:39:29,535 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-04 22:39:57,737 - src.core.embeddings - INFO - Memory usage: RSS=1975.80 MB, VMS=4735.80 MB
2025-06-04 22:39:58,249 - src.core.embeddings - INFO - Embedding generation took 237.03 seconds
2025-06-04 22:39:58,250 - src.core.embeddings - INFO - Memory usage: RSS=1975.80 MB, VMS=4735.80 MB
2025-06-04 22:39:58,250 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-04 22:39:59,203 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-04 22:40:00,526 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-04 22:40:00,559 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-04 22:40:01,818 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-04 22:40:01,819 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.57 seconds
2025-06-04 22:40:01,822 - src.core.embeddings - INFO - Memory usage: RSS=2194.13 MB, VMS=4968.61 MB
2025-06-04 22:40:01,878 - src.core.embeddings - INFO - Total embedding generation took 251.02 seconds
2025-06-04 22:40:02,686 - main - INFO - Loading data from CSV files
2025-06-04 22:40:02,768 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:40:02,823 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:40:02,832 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:40:02,843 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:40:02,856 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:40:02,934 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:40:02,976 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:40:02,986 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:40:02,987 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:40:02,989 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:40:02,989 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:40:03,032 - main - INFO - Loading data from CSV files
2025-06-04 22:40:03,085 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:40:03,138 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:40:03,145 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:40:03,154 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:40:03,159 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:40:03,194 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:40:03,207 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:40:03,217 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:40:03,217 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:40:03,218 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:40:03,219 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:42:23,893 - main - INFO - Loading data from CSV files
2025-06-04 22:42:23,955 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:42:24,016 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:42:24,046 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:42:24,078 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:42:24,109 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:42:24,230 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:42:24,246 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:42:24,255 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:42:24,256 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:42:24,257 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:42:24,257 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:42:25,935 - main - INFO - Loading data from CSV files
2025-06-04 22:42:25,979 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:42:26,027 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:42:26,033 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:42:26,043 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:42:26,048 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:42:26,099 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:42:26,110 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:42:26,118 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:42:26,119 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:42:26,120 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:42:26,120 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:42:27,141 - main - INFO - Loading data from CSV files
2025-06-04 22:42:27,179 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:42:27,220 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:42:27,227 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:42:27,233 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:42:27,237 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:42:27,265 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:42:27,277 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:42:27,283 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:42:27,283 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:42:27,284 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:42:27,285 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:42:29,302 - main - INFO - Loading data from CSV files
2025-06-04 22:42:29,433 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:42:29,572 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:42:29,589 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:42:29,606 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:42:29,623 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:42:29,747 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:42:29,787 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:42:29,812 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:42:29,814 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:42:29,817 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:42:29,818 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 22:42:33,846 - main - INFO - Loading data from CSV files
2025-06-04 22:42:33,979 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 22:42:34,121 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 22:42:34,137 - main - INFO - Loaded user_details with 205 rows
2025-06-04 22:42:34,157 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 22:42:34,176 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 22:42:34,308 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 22:42:34,351 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 22:42:34,377 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 22:42:34,378 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 22:42:34,380 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 22:42:34,381 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 23:37:22,559 - main - INFO - Loading data from CSV files
2025-06-04 23:37:23,242 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 23:37:23,558 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 23:37:23,639 - main - INFO - Loaded user_details with 205 rows
2025-06-04 23:37:23,701 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 23:37:23,765 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 23:37:24,329 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 23:37:24,492 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 23:37:24,531 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 23:37:24,533 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 23:37:24,537 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 23:37:24,539 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 23:37:25,891 - main - INFO - Loading data from CSV files
2025-06-04 23:37:26,017 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 23:37:26,171 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 23:37:26,189 - main - INFO - Loaded user_details with 205 rows
2025-06-04 23:37:26,206 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 23:37:26,225 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 23:37:26,363 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 23:37:26,408 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 23:37:26,432 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 23:37:26,433 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 23:37:26,436 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 23:37:26,437 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-04 23:37:28,475 - main - INFO - Loading data from CSV files
2025-06-04 23:37:28,550 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-04 23:37:28,633 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-04 23:37:28,644 - main - INFO - Loaded user_details with 205 rows
2025-06-04 23:37:28,652 - main - INFO - Loaded app_roles with 2101 rows
2025-06-04 23:37:28,668 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-04 23:37:28,779 - main - INFO - Created group_memberships with 3222 rows
2025-06-04 23:37:28,824 - main - INFO - Created role_matrix with 2101 rows
2025-06-04 23:37:28,847 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-04 23:37:28,848 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-04 23:37:28,851 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-04 23:37:28,853 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 09:18:24,132 - main - INFO - Loading data from CSV files
2025-06-05 09:18:24,405 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 09:18:24,528 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 09:18:24,578 - main - INFO - Loaded user_details with 205 rows
2025-06-05 09:18:24,602 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 09:18:24,635 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 09:18:24,844 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 09:18:24,897 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 09:18:24,907 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 09:18:24,908 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-05 09:18:24,909 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-05 09:18:24,910 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 09:18:26,041 - main - INFO - Loading data from CSV files
2025-06-05 09:18:26,083 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 09:18:26,123 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 09:18:26,128 - main - INFO - Loaded user_details with 205 rows
2025-06-05 09:18:26,132 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 09:18:26,139 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 09:18:26,179 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 09:18:26,192 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 09:18:26,200 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 09:18:26,202 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-05 09:18:26,203 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-05 09:18:26,203 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 09:18:28,216 - main - INFO - Loading data from CSV files
2025-06-05 09:18:28,268 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 09:18:28,318 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 09:18:28,325 - main - INFO - Loaded user_details with 205 rows
2025-06-05 09:18:28,330 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 09:18:28,337 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 09:18:28,383 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 09:18:28,399 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 09:18:28,410 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 09:18:28,411 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', '6a29c514-afdf-4cb4-b21b-408e2791b5cc', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', '3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d']...
2025-06-05 09:18:28,412 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['63e7a382-f8bc-ec11-9840-0022489e2e28', 'd67997ad-76b4-eb11-8236-000d3ab5a61f', 'cecee0d8-ab09-ec11-b6e6-000d3ab1f3c0', '86348f11-f775-ef11-a670-0022489b4de1', '12c77f51-1434-f011-8c4e-000d3a69161a']...
2025-06-05 09:18:28,412 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 09:21:49,980 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-05 09:22:15,038 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-05 09:23:35,975 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-05 09:37:54,511 - main - INFO - Loading data from CSV files
2025-06-05 09:37:54,906 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 09:37:55,030 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 09:37:55,072 - main - INFO - Loaded user_details with 205 rows
2025-06-05 09:37:55,095 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 09:37:55,130 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 09:37:55,563 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 09:37:55,651 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 09:37:55,669 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 09:37:55,670 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 09:37:55,671 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 09:37:55,672 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 09:53:50,151 - main - INFO - Loading data from CSV files
2025-06-05 09:53:50,283 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 09:53:50,358 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 09:53:50,389 - main - INFO - Loaded user_details with 205 rows
2025-06-05 09:53:50,418 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 09:53:50,446 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 09:53:50,637 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 09:53:50,687 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 09:53:50,696 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 09:53:50,697 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 09:53:50,699 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 09:53:50,699 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 09:59:08,571 - main - INFO - Loading data from CSV files
2025-06-05 09:59:08,644 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 09:59:08,744 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 09:59:08,759 - main - INFO - Loaded user_details with 205 rows
2025-06-05 09:59:08,769 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 09:59:08,780 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 09:59:08,873 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 09:59:08,895 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 09:59:08,906 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 09:59:08,906 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 09:59:08,907 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 09:59:08,908 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:03,450 - main - INFO - Loading data from CSV files
2025-06-05 10:02:03,517 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:03,580 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:03,589 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:03,596 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:03,606 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:03,661 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:03,678 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:03,689 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:03,689 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:03,691 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:03,692 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:05,719 - main - INFO - Loading data from CSV files
2025-06-05 10:02:05,782 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:05,844 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:05,851 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:05,858 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:05,865 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:05,926 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:05,945 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:05,957 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:05,958 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:05,960 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:05,961 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:11,076 - main - INFO - Loading data from CSV files
2025-06-05 10:02:11,164 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:11,243 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:11,256 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:11,266 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:11,278 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:11,375 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:11,404 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:11,418 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:11,419 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:11,420 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:11,421 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:12,450 - main - INFO - Loading data from CSV files
2025-06-05 10:02:12,536 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:12,609 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:12,619 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:12,630 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:12,641 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:12,707 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:12,729 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:12,742 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:12,742 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:12,743 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:12,744 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:14,769 - main - INFO - Loading data from CSV files
2025-06-05 10:02:14,840 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:14,901 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:14,909 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:14,917 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:14,925 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:14,978 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:14,996 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:15,008 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:15,009 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:15,010 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:15,011 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:19,032 - main - INFO - Loading data from CSV files
2025-06-05 10:02:19,101 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:19,161 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:19,169 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:19,181 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:19,195 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:19,267 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:19,293 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:19,306 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:19,306 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:19,307 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:19,308 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:49,637 - main - INFO - Loading data from CSV files
2025-06-05 10:02:49,691 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:49,760 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:49,770 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:49,777 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:49,786 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:49,843 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:49,861 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:49,873 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:49,874 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:49,875 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:49,875 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:50,895 - main - INFO - Loading data from CSV files
2025-06-05 10:02:50,948 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:51,007 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:51,017 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:51,023 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:51,031 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:51,081 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:51,107 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:51,119 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:51,120 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:51,122 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:51,123 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:53,146 - main - INFO - Loading data from CSV files
2025-06-05 10:02:53,223 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:53,290 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:53,296 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:53,303 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:53,309 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:53,361 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:53,376 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:53,386 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:53,387 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:53,388 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:53,389 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:02:57,413 - main - INFO - Loading data from CSV files
2025-06-05 10:02:57,476 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:02:57,542 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:02:57,549 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:02:57,557 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:02:57,564 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:02:57,632 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:02:57,652 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:02:57,664 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:02:57,665 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:02:57,666 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:02:57,666 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:01,544 - main - INFO - Loading data from CSV files
2025-06-05 10:03:01,600 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:01,671 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:01,680 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:01,690 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:01,698 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:01,757 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:01,777 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:01,789 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:01,790 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:01,791 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:01,791 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:02,824 - main - INFO - Loading data from CSV files
2025-06-05 10:03:02,878 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:02,958 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:02,968 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:02,974 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:02,981 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:03,050 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:03,068 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:03,081 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:03,082 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:03,084 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:03,085 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:05,109 - main - INFO - Loading data from CSV files
2025-06-05 10:03:05,174 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:05,244 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:05,253 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:05,263 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:05,272 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:05,335 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:05,359 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:05,374 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:05,374 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:05,376 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:05,376 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:09,409 - main - INFO - Loading data from CSV files
2025-06-05 10:03:09,466 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:09,532 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:09,540 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:09,548 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:09,556 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:09,616 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:09,634 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:09,646 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:09,647 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:09,649 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:09,650 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:27,699 - main - INFO - Loading data from CSV files
2025-06-05 10:03:27,771 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:27,831 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:27,839 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:27,845 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:27,854 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:27,912 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:27,934 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:27,951 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:27,951 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:27,953 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:27,954 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:28,979 - main - INFO - Loading data from CSV files
2025-06-05 10:03:29,041 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:29,108 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:29,115 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:29,124 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:29,134 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:29,205 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:29,224 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:29,236 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:29,236 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:29,237 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:29,238 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:31,258 - main - INFO - Loading data from CSV files
2025-06-05 10:03:31,311 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:31,364 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:31,373 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:31,381 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:31,392 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:31,450 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:31,466 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:31,478 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:31,479 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:31,482 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:31,482 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:35,502 - main - INFO - Loading data from CSV files
2025-06-05 10:03:35,558 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:35,619 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:35,625 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:35,632 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:35,639 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:35,694 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:35,714 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:35,727 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:35,728 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:35,729 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:35,730 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:39,603 - main - INFO - Loading data from CSV files
2025-06-05 10:03:39,663 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:39,728 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:39,734 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:39,741 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:39,748 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:39,802 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:39,817 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:39,828 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:39,829 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:39,830 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:39,831 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:40,858 - main - INFO - Loading data from CSV files
2025-06-05 10:03:40,908 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:40,960 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:40,967 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:40,974 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:40,981 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:41,046 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:41,064 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:41,077 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:41,077 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:41,078 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:41,079 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:43,100 - main - INFO - Loading data from CSV files
2025-06-05 10:03:43,153 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:43,213 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:43,220 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:43,227 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:43,237 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:43,285 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:43,301 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:43,315 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:43,316 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:43,317 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:43,318 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:03:47,337 - main - INFO - Loading data from CSV files
2025-06-05 10:03:47,386 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:03:47,440 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:03:47,446 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:03:47,452 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:03:47,459 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:03:47,507 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:03:47,527 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:03:47,542 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:03:47,542 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:03:47,544 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:03:47,544 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:05,752 - main - INFO - Loading data from CSV files
2025-06-05 10:04:05,801 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:05,854 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:05,862 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:05,870 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:05,876 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:05,933 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:05,952 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:05,964 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:05,965 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:05,967 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:05,968 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:06,993 - main - INFO - Loading data from CSV files
2025-06-05 10:04:07,047 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:07,107 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:07,114 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:07,121 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:07,133 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:07,185 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:07,207 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:07,221 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:07,222 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:07,223 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:07,224 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:09,245 - main - INFO - Loading data from CSV files
2025-06-05 10:04:09,295 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:09,362 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:09,370 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:09,380 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:09,389 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:09,441 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:09,457 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:09,472 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:09,473 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:09,475 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:09,475 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:13,503 - main - INFO - Loading data from CSV files
2025-06-05 10:04:13,579 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:13,656 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:13,663 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:13,672 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:13,681 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:13,742 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:13,761 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:13,772 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:13,772 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:13,773 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:13,774 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:17,582 - main - INFO - Loading data from CSV files
2025-06-05 10:04:17,631 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:17,688 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:17,694 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:17,700 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:17,707 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:17,755 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:17,773 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:17,783 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:17,784 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:17,785 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:17,785 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:18,810 - main - INFO - Loading data from CSV files
2025-06-05 10:04:18,858 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:18,912 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:18,918 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:18,925 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:18,932 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:18,992 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:19,015 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:19,030 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:19,031 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:19,032 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:19,032 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:21,052 - main - INFO - Loading data from CSV files
2025-06-05 10:04:21,104 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:21,176 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:21,183 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:21,190 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:21,198 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:21,251 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:21,265 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:21,275 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:21,276 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:21,277 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:21,277 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:25,299 - main - INFO - Loading data from CSV files
2025-06-05 10:04:25,361 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:25,437 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:25,444 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:25,452 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:25,459 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:25,512 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:25,533 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:25,543 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:25,544 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:25,545 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:25,546 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:43,798 - main - INFO - Loading data from CSV files
2025-06-05 10:04:43,863 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:43,930 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:43,939 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:43,948 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:43,956 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:44,015 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:44,046 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:44,061 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:44,062 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:44,064 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:44,064 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:45,101 - main - INFO - Loading data from CSV files
2025-06-05 10:04:45,163 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:45,224 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:45,231 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:45,237 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:45,245 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:45,302 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:45,322 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:45,334 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:45,335 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:45,336 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:45,337 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:47,357 - main - INFO - Loading data from CSV files
2025-06-05 10:04:47,412 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:47,468 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:47,473 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:47,482 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:47,493 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:47,549 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:47,568 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:47,581 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:47,581 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:47,582 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:47,583 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:51,612 - main - INFO - Loading data from CSV files
2025-06-05 10:04:51,672 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:51,752 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:51,758 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:51,766 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:51,776 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:51,845 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:51,865 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:51,875 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:51,875 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:51,876 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:51,877 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:53,232 - main - INFO - Loading data from CSV files
2025-06-05 10:04:53,313 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:53,398 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:53,405 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:53,413 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:53,419 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:53,476 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:53,491 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:53,503 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:53,504 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:53,505 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:53,505 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:54,522 - main - INFO - Loading data from CSV files
2025-06-05 10:04:54,578 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:54,638 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:54,644 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:54,651 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:54,660 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:54,724 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:54,742 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:54,759 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:54,760 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:54,761 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:54,762 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:55,576 - main - INFO - Loading data from CSV files
2025-06-05 10:04:55,647 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:55,715 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:55,722 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:55,729 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:55,736 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:55,787 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:55,803 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:55,815 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:55,815 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:55,816 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:55,817 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:56,790 - main - INFO - Loading data from CSV files
2025-06-05 10:04:56,868 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:56,951 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:56,957 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:56,966 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:56,975 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:57,044 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:57,069 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:57,080 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:57,082 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:57,083 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:57,084 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:57,097 - main - INFO - Loading data from CSV files
2025-06-05 10:04:57,156 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:57,222 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:57,229 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:57,237 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:57,244 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:57,296 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:57,312 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:57,322 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:57,322 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:57,323 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:57,324 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:04:59,364 - main - INFO - Loading data from CSV files
2025-06-05 10:04:59,443 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:04:59,513 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:04:59,523 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:04:59,533 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:04:59,541 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:04:59,614 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:04:59,631 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:04:59,642 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:04:59,643 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:04:59,644 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:04:59,644 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:01,105 - main - INFO - Loading data from CSV files
2025-06-05 10:05:01,162 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:01,216 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:01,222 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:01,228 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:01,235 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:01,294 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:01,312 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:01,323 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:01,323 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:01,324 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:01,325 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:03,667 - main - INFO - Loading data from CSV files
2025-06-05 10:05:03,717 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:03,773 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:03,780 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:03,786 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:03,792 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:03,852 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:03,870 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:03,883 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:03,884 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:03,885 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:03,886 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:06,347 - main - INFO - Loading data from CSV files
2025-06-05 10:05:06,404 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:06,465 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:06,474 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:06,484 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:06,494 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:06,570 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:06,586 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:06,600 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:06,600 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:06,601 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:06,602 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:07,636 - main - INFO - Loading data from CSV files
2025-06-05 10:05:07,686 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:07,759 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:07,765 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:07,771 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:07,780 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:07,837 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:07,853 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:07,864 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:07,865 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:07,866 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:07,867 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:09,895 - main - INFO - Loading data from CSV files
2025-06-05 10:05:09,953 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:10,018 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:10,027 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:10,035 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:10,046 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:10,103 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:10,131 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:10,147 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:10,147 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:10,148 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:10,149 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:14,172 - main - INFO - Loading data from CSV files
2025-06-05 10:05:14,241 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:14,312 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:14,318 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:14,325 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:14,331 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:14,383 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:14,402 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:14,413 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:14,414 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:14,415 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:14,415 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:19,432 - main - INFO - Loading data from CSV files
2025-06-05 10:05:19,485 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:19,540 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:19,546 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:19,552 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:19,558 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:19,612 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:19,635 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:19,649 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:19,650 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:19,651 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:19,651 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:33,918 - main - INFO - Loading data from CSV files
2025-06-05 10:05:33,986 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:34,045 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:34,052 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:34,057 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:34,064 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:34,121 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:34,138 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:34,150 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:34,151 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:34,152 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:34,152 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:35,181 - main - INFO - Loading data from CSV files
2025-06-05 10:05:35,250 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:35,328 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:35,337 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:35,347 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:35,357 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:35,418 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:35,436 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:35,450 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:35,451 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:35,454 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:35,455 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:37,475 - main - INFO - Loading data from CSV files
2025-06-05 10:05:37,532 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:37,591 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:37,599 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:37,608 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:37,616 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:37,665 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:37,683 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:37,698 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:37,699 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:37,700 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:37,701 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:05:41,729 - main - INFO - Loading data from CSV files
2025-06-05 10:05:41,781 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:05:41,857 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:05:41,863 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:05:41,870 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:05:41,877 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:05:41,926 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:05:41,942 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:05:41,954 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:05:41,954 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:05:41,956 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:05:41,957 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:12,045 - main - INFO - Loading data from CSV files
2025-06-05 10:06:12,181 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:12,282 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:12,292 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:12,301 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:12,309 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:12,369 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:12,386 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:12,397 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:12,397 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:12,398 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:12,399 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:13,432 - main - INFO - Loading data from CSV files
2025-06-05 10:06:13,509 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:13,583 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:13,593 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:13,603 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:13,617 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:13,680 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:13,695 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:13,705 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:13,706 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:13,707 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:13,707 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:15,732 - main - INFO - Loading data from CSV files
2025-06-05 10:06:15,812 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:15,868 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:15,875 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:15,881 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:15,888 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:15,949 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:15,972 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:15,989 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:15,990 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:15,991 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:15,992 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:20,722 - main - INFO - Loading data from CSV files
2025-06-05 10:06:20,796 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:20,856 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:20,862 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:20,867 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:20,874 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:20,947 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:20,969 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:20,983 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:20,984 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:20,986 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:20,986 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:22,019 - main - INFO - Loading data from CSV files
2025-06-05 10:06:22,096 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:22,161 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:22,167 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:22,175 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:22,183 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:22,262 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:22,287 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:22,303 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:22,304 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:22,305 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:22,306 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:24,332 - main - INFO - Loading data from CSV files
2025-06-05 10:06:24,387 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:24,461 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:24,467 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:24,475 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:24,482 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:24,552 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:24,569 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:24,583 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:24,585 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:24,586 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:24,587 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:28,615 - main - INFO - Loading data from CSV files
2025-06-05 10:06:28,666 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:28,730 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:28,741 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:28,749 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:28,758 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:28,823 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:28,842 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:28,855 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:28,856 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:28,857 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:28,858 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:51,546 - main - INFO - Loading data from CSV files
2025-06-05 10:06:51,623 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:51,692 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:51,699 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:51,705 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:51,712 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:51,759 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:51,774 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:51,785 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:51,786 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:51,787 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:51,787 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:52,808 - main - INFO - Loading data from CSV files
2025-06-05 10:06:52,859 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:52,935 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:52,945 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:52,956 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:52,966 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:53,045 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:53,067 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:53,082 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:53,083 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:53,084 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:53,084 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:54,011 - main - INFO - Loading data from CSV files
2025-06-05 10:06:54,073 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:54,144 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:54,153 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:54,161 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:54,171 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:54,244 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:54,261 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:54,273 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:54,274 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:54,275 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:54,276 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:55,120 - main - INFO - Loading data from CSV files
2025-06-05 10:06:55,177 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:55,233 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:55,240 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:55,246 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:55,252 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:55,307 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:55,322 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:55,334 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:55,335 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:55,336 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:55,337 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:55,347 - main - INFO - Loading data from CSV files
2025-06-05 10:06:55,400 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:55,458 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:55,464 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:55,471 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:55,477 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:55,526 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:55,540 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:55,553 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:55,554 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:55,555 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:55,555 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:57,584 - main - INFO - Loading data from CSV files
2025-06-05 10:06:57,636 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:57,689 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:57,695 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:57,702 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:57,712 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:57,766 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:57,787 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:57,800 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:57,801 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:57,802 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:57,803 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:06:59,357 - main - INFO - Loading data from CSV files
2025-06-05 10:06:59,420 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:06:59,482 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:06:59,490 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:06:59,499 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:06:59,510 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:06:59,568 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:06:59,583 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:06:59,594 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:06:59,594 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:06:59,595 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:06:59,596 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:01,833 - main - INFO - Loading data from CSV files
2025-06-05 10:07:01,887 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:01,959 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:01,966 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:01,975 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:01,982 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:02,051 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:02,072 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:02,088 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:02,089 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:02,090 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:02,091 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:29,625 - main - INFO - Loading data from CSV files
2025-06-05 10:07:29,679 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:29,739 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:29,745 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:29,751 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:29,758 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:29,835 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:29,849 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:29,860 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:29,860 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:29,862 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:29,862 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:31,061 - main - INFO - Loading data from CSV files
2025-06-05 10:07:31,126 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:31,219 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:31,231 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:31,243 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:31,256 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:31,353 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:31,376 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:31,388 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:31,388 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:31,389 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:31,390 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:32,120 - main - INFO - Loading data from CSV files
2025-06-05 10:07:32,176 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:32,244 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:32,251 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:32,259 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:32,269 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:32,320 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:32,338 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:32,357 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:32,358 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:32,359 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:32,360 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:33,392 - main - INFO - Loading data from CSV files
2025-06-05 10:07:33,442 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:33,500 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:33,509 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:33,516 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:33,522 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:33,582 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:33,598 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:33,611 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:33,612 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:33,614 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:33,614 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:33,628 - main - INFO - Loading data from CSV files
2025-06-05 10:07:33,708 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:33,767 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:33,773 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:33,779 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:33,786 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:33,849 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:33,864 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:33,876 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:33,876 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:33,878 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:33,879 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:35,637 - main - INFO - Loading data from CSV files
2025-06-05 10:07:35,693 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:35,759 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:35,765 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:35,772 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:35,778 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:35,828 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:35,847 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:35,859 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:35,860 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:35,862 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:35,863 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:37,903 - main - INFO - Loading data from CSV files
2025-06-05 10:07:37,974 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:38,070 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:38,077 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:38,087 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:38,102 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:38,188 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:38,206 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:38,218 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:38,218 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:38,219 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:38,220 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:07:39,888 - main - INFO - Loading data from CSV files
2025-06-05 10:07:39,964 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:07:40,045 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:07:40,052 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:07:40,059 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:07:40,066 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:07:40,129 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:07:40,146 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:07:40,158 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:07:40,159 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:07:40,160 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:07:40,160 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:08,255 - main - INFO - Loading data from CSV files
2025-06-05 10:08:08,331 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:08,399 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:08,405 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:08,411 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:08,418 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:08,468 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:08,485 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:08,497 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:08,498 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:08,499 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:08,500 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:09,525 - main - INFO - Loading data from CSV files
2025-06-05 10:08:09,584 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:09,642 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:09,649 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:09,658 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:09,666 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:09,719 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:09,740 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:09,757 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:09,758 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:09,759 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:09,760 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:10,178 - main - INFO - Loading data from CSV files
2025-06-05 10:08:10,228 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:10,284 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:10,290 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:10,297 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:10,305 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:10,376 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:10,392 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:10,404 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:10,404 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:10,405 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:10,406 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:11,441 - main - INFO - Loading data from CSV files
2025-06-05 10:08:11,492 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:11,550 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:11,557 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:11,564 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:11,573 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:11,626 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:11,642 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:11,653 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:11,653 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:11,654 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:11,655 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:11,781 - main - INFO - Loading data from CSV files
2025-06-05 10:08:11,846 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:11,923 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:11,929 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:11,936 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:11,942 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:11,990 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:12,007 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:12,020 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:12,021 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:12,022 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:12,022 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:13,682 - main - INFO - Loading data from CSV files
2025-06-05 10:08:13,769 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:13,845 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:13,852 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:13,860 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:13,867 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:13,923 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:13,943 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:13,956 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:13,957 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:13,958 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:13,959 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:16,040 - main - INFO - Loading data from CSV files
2025-06-05 10:08:16,127 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:16,207 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:16,215 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:16,224 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:16,233 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:16,303 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:16,323 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:16,339 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:16,339 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:16,341 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:16,342 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:17,988 - main - INFO - Loading data from CSV files
2025-06-05 10:08:18,041 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:18,097 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:18,107 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:18,117 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:18,129 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:18,179 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:18,194 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:18,206 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:18,207 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:18,208 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:18,209 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:46,685 - main - INFO - Loading data from CSV files
2025-06-05 10:08:46,735 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:46,790 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:46,797 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:46,805 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:46,814 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:46,876 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:46,898 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:46,908 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:46,909 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:46,910 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:46,910 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:47,930 - main - INFO - Loading data from CSV files
2025-06-05 10:08:47,987 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:48,046 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:48,052 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:48,059 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:48,067 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:48,128 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:48,144 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:48,156 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:48,156 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:48,158 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:48,158 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:48,240 - main - INFO - Loading data from CSV files
2025-06-05 10:08:48,300 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:48,371 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:48,378 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:48,385 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:48,392 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:48,443 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:48,458 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:48,468 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:48,469 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:48,470 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:48,470 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:49,499 - main - INFO - Loading data from CSV files
2025-06-05 10:08:49,562 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:49,624 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:49,630 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:49,637 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:49,643 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:49,695 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:49,722 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:49,739 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:49,740 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:49,742 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:49,742 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:50,179 - main - INFO - Loading data from CSV files
2025-06-05 10:08:50,239 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:50,299 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:50,306 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:50,314 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:50,321 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:50,391 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:50,412 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:50,425 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:50,425 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:50,426 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:50,427 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:51,776 - main - INFO - Loading data from CSV files
2025-06-05 10:08:51,852 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:51,910 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:51,916 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:51,922 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:51,929 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:51,979 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:52,001 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:52,016 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:52,017 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:52,018 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:52,019 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:54,457 - main - INFO - Loading data from CSV files
2025-06-05 10:08:54,508 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:54,576 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:54,584 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:54,594 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:54,603 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:54,661 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:54,676 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:54,687 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:54,688 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:54,689 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:54,690 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:08:56,048 - main - INFO - Loading data from CSV files
2025-06-05 10:08:56,102 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:08:56,180 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:08:56,187 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:08:56,193 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:08:56,202 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:08:56,267 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:08:56,285 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:08:56,297 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:08:56,298 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:08:56,299 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:08:56,300 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:24,709 - main - INFO - Loading data from CSV files
2025-06-05 10:09:24,778 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:24,838 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:24,845 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:24,851 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:24,858 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:24,924 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:24,946 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:24,959 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:24,960 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:24,961 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:24,961 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:25,987 - main - INFO - Loading data from CSV files
2025-06-05 10:09:26,038 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:26,097 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:26,103 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:26,111 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:26,122 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:26,184 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:26,200 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:26,212 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:26,213 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:26,214 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:26,214 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:26,327 - main - INFO - Loading data from CSV files
2025-06-05 10:09:26,378 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:26,435 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:26,441 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:26,448 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:26,456 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:26,530 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:26,550 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:26,563 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:26,564 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:26,565 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:26,565 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:27,590 - main - INFO - Loading data from CSV files
2025-06-05 10:09:27,655 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:27,712 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:27,718 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:27,725 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:27,732 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:27,788 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:27,803 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:27,813 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:27,814 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:27,815 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:27,816 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:28,238 - main - INFO - Loading data from CSV files
2025-06-05 10:09:28,289 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:28,344 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:28,350 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:28,357 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:28,363 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:28,414 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:28,435 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:28,447 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:28,448 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:28,449 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:28,450 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:29,845 - main - INFO - Loading data from CSV files
2025-06-05 10:09:29,904 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:29,973 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:29,980 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:29,986 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:29,993 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:30,053 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:30,071 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:30,087 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:30,088 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:30,090 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:30,091 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:32,472 - main - INFO - Loading data from CSV files
2025-06-05 10:09:32,522 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:32,594 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:32,603 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:32,613 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:32,624 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:32,683 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:32,699 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:32,714 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:32,714 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:32,716 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:32,716 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:09:34,116 - main - INFO - Loading data from CSV files
2025-06-05 10:09:34,168 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:09:34,224 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:09:34,230 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:09:34,236 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:09:34,243 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:09:34,293 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:09:34,308 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:09:34,326 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:09:34,327 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:09:34,329 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:09:34,330 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:03,055 - main - INFO - Loading data from CSV files
2025-06-05 10:10:03,120 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:03,174 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:03,182 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:03,190 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:03,199 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:03,257 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:03,273 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:03,283 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:03,284 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:03,285 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:03,286 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:04,303 - main - INFO - Loading data from CSV files
2025-06-05 10:10:04,357 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:04,413 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:04,419 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:04,426 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:04,433 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:04,478 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:04,492 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:04,504 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:04,504 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:04,505 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:04,506 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:04,516 - main - INFO - Loading data from CSV files
2025-06-05 10:10:04,575 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:04,643 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:04,650 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:04,656 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:04,663 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:04,713 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:04,728 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:04,739 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:04,739 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:04,740 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:04,741 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:05,765 - main - INFO - Loading data from CSV files
2025-06-05 10:10:05,817 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:05,883 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:05,890 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:05,897 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:05,906 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:05,969 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:05,984 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:05,998 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:05,999 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:06,000 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:06,001 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:06,537 - main - INFO - Loading data from CSV files
2025-06-05 10:10:06,592 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:06,674 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:06,684 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:06,693 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:06,701 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:06,759 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:06,774 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:06,784 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:06,785 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:06,786 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:06,786 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:08,031 - main - INFO - Loading data from CSV files
2025-06-05 10:10:08,088 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:08,149 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:08,156 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:08,161 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:08,169 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:08,228 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:08,242 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:08,254 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:08,255 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:08,256 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:08,256 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:10,812 - main - INFO - Loading data from CSV files
2025-06-05 10:10:10,894 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:10,963 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:10,970 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:10,976 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:10,982 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:11,031 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:11,046 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:11,059 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:11,059 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:11,060 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:11,061 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:12,273 - main - INFO - Loading data from CSV files
2025-06-05 10:10:12,361 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:12,436 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:12,445 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:12,453 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:12,460 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:12,510 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:12,526 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:12,537 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:12,538 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:12,539 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:12,539 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:43,571 - main - INFO - Loading data from CSV files
2025-06-05 10:10:43,644 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:43,709 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:43,718 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:43,728 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:43,737 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:43,805 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:43,825 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:43,841 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:43,842 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:43,843 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:43,845 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:43,859 - main - INFO - Loading data from CSV files
2025-06-05 10:10:43,916 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:43,975 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:43,984 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:43,993 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:44,003 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:44,081 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:44,105 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:44,122 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:44,123 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:44,124 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:44,125 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:44,869 - main - INFO - Loading data from CSV files
2025-06-05 10:10:44,960 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:45,050 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:45,056 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:45,064 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:45,071 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:45,126 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:45,141 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:45,154 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:45,154 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:45,155 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:45,156 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:45,168 - main - INFO - Loading data from CSV files
2025-06-05 10:10:45,220 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:45,286 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:45,292 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:45,298 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:45,305 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:45,357 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:45,373 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:45,383 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:45,384 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:45,385 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:45,385 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:47,191 - main - INFO - Loading data from CSV files
2025-06-05 10:10:47,250 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:47,318 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:47,327 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:47,335 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:47,342 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:47,399 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:47,416 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:47,432 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:47,433 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:47,434 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:47,435 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:47,450 - main - INFO - Loading data from CSV files
2025-06-05 10:10:47,529 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:47,594 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:47,601 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:47,609 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:47,617 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:47,686 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:47,706 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:47,722 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:47,723 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:47,725 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:47,726 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:51,462 - main - INFO - Loading data from CSV files
2025-06-05 10:10:51,538 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:51,608 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:51,614 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:51,621 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:51,627 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:51,696 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:51,718 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:51,734 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:51,735 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:51,736 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:51,737 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:10:51,755 - main - INFO - Loading data from CSV files
2025-06-05 10:10:51,820 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:10:51,882 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:10:51,888 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:10:51,896 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:10:51,905 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:10:51,971 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:10:51,993 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:10:52,005 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:10:52,006 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:10:52,007 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:10:52,008 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:21,759 - main - INFO - Loading data from CSV files
2025-06-05 10:11:21,827 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:21,882 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:21,889 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:21,895 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:21,902 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:21,960 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:21,985 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:22,000 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:22,001 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:22,002 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:22,003 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:22,042 - main - INFO - Loading data from CSV files
2025-06-05 10:11:22,097 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:22,150 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:22,157 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:22,163 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:22,169 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:22,236 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:22,261 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:22,278 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:22,279 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:22,280 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:22,281 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:23,031 - main - INFO - Loading data from CSV files
2025-06-05 10:11:23,085 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:23,159 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:23,169 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:23,180 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:23,190 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:23,255 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:23,271 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:23,283 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:23,283 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:23,284 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:23,285 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:23,313 - main - INFO - Loading data from CSV files
2025-06-05 10:11:23,372 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:23,443 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:23,449 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:23,458 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:23,464 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:23,526 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:23,543 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:23,554 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:23,554 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:23,555 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:23,556 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:25,305 - main - INFO - Loading data from CSV files
2025-06-05 10:11:25,355 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:25,415 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:25,425 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:25,435 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:25,444 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:25,510 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:25,533 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:25,547 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:25,548 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:25,549 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:25,550 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:25,585 - main - INFO - Loading data from CSV files
2025-06-05 10:11:25,649 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:25,719 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:25,726 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:25,732 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:25,739 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:25,789 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:25,805 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:25,817 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:25,818 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:25,819 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:25,820 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:29,589 - main - INFO - Loading data from CSV files
2025-06-05 10:11:29,656 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:29,732 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:29,740 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:29,749 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:29,758 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:29,819 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:29,839 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:29,855 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:29,855 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:29,856 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:29,857 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:29,870 - main - INFO - Loading data from CSV files
2025-06-05 10:11:29,938 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:30,011 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:30,020 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:30,028 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:30,036 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:30,090 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:30,106 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:30,121 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:30,122 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:30,123 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:30,123 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:43,441 - main - INFO - Loading data from CSV files
2025-06-05 10:11:43,494 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:43,568 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:43,576 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:43,583 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:43,591 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:43,638 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:43,652 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:43,665 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:43,666 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:43,667 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:43,668 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:44,692 - main - INFO - Loading data from CSV files
2025-06-05 10:11:44,745 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:44,799 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:44,806 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:44,812 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:44,818 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:44,867 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:44,881 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:44,894 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:44,894 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:44,895 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:44,896 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:46,916 - main - INFO - Loading data from CSV files
2025-06-05 10:11:46,971 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:47,033 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:47,041 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:47,050 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:47,060 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:47,131 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:47,148 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:47,161 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:47,162 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:47,163 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:47,164 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:51,183 - main - INFO - Loading data from CSV files
2025-06-05 10:11:51,238 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:51,311 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:51,319 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:51,327 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:51,335 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:51,404 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:51,421 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:51,434 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:51,435 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:51,436 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:51,437 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:55,497 - main - INFO - Loading data from CSV files
2025-06-05 10:11:55,570 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:55,634 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:55,640 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:55,646 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:55,652 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:55,702 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:55,718 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:55,734 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:55,735 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:55,736 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:55,737 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:56,763 - main - INFO - Loading data from CSV files
2025-06-05 10:11:56,845 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:56,928 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:56,935 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:56,944 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:56,951 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:57,012 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:57,033 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:57,048 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:57,049 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:57,050 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:57,051 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:11:59,082 - main - INFO - Loading data from CSV files
2025-06-05 10:11:59,155 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:11:59,236 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:11:59,243 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:11:59,250 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:11:59,256 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:11:59,306 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:11:59,327 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:11:59,341 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:11:59,342 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:11:59,343 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:11:59,344 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:03,372 - main - INFO - Loading data from CSV files
2025-06-05 10:12:03,423 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:12:03,475 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:12:03,481 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:12:03,489 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:12:03,498 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:12:03,565 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:12:03,579 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:12:03,590 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:12:03,590 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:12:03,591 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:12:03,592 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:20,648 - main - INFO - Loading data from CSV files
2025-06-05 10:12:20,711 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:12:20,769 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:12:20,776 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:12:20,783 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:12:20,791 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:12:20,848 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:12:20,866 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:12:20,877 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:12:20,878 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:12:20,879 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:12:20,879 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:21,914 - main - INFO - Loading data from CSV files
2025-06-05 10:12:21,963 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:12:22,018 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:12:22,025 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:12:22,031 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:12:22,038 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:12:22,106 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:12:22,121 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:12:22,137 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:12:22,138 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:12:22,139 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:12:22,140 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:24,160 - main - INFO - Loading data from CSV files
2025-06-05 10:12:24,213 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:12:24,276 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:12:24,283 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:12:24,295 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:12:24,305 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:12:24,370 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:12:24,384 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:12:24,396 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:12:24,397 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:12:24,398 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:12:24,398 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:28,439 - main - INFO - Loading data from CSV files
2025-06-05 10:12:28,493 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:12:28,560 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:12:28,566 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:12:28,574 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:12:28,581 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:12:28,632 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:12:28,647 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:12:28,657 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:12:28,658 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:12:28,658 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:12:28,659 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:58,679 - main - INFO - Loading data from CSV files
2025-06-05 10:12:58,729 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:12:58,796 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:12:58,803 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:12:58,815 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:12:58,824 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:12:58,891 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:12:58,906 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:12:58,918 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:12:58,919 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:12:58,919 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:12:58,920 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:59,084 - main - INFO - Loading data from CSV files
2025-06-05 10:12:59,151 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:12:59,208 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:12:59,215 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:12:59,221 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:12:59,227 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:12:59,275 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:12:59,290 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:12:59,299 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:12:59,300 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:12:59,301 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:12:59,301 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:12:59,952 - main - INFO - Loading data from CSV files
2025-06-05 10:13:00,020 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:00,086 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:00,092 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:00,100 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:00,109 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:00,192 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:00,214 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:00,230 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:00,231 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:00,232 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:00,233 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:00,323 - main - INFO - Loading data from CSV files
2025-06-05 10:13:00,372 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:00,432 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:00,440 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:00,449 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:00,456 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:00,506 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:00,521 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:00,534 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:00,535 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:00,536 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:00,537 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:02,256 - main - INFO - Loading data from CSV files
2025-06-05 10:13:02,311 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:02,371 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:02,378 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:02,385 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:02,393 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:02,448 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:02,464 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:02,478 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:02,479 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:02,480 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:02,481 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:02,568 - main - INFO - Loading data from CSV files
2025-06-05 10:13:02,630 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:02,682 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:02,690 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:02,698 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:02,705 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:02,758 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:02,780 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:02,800 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:02,801 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:02,802 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:02,803 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:06,520 - main - INFO - Loading data from CSV files
2025-06-05 10:13:06,574 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:06,663 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:06,672 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:06,680 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:06,690 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:06,753 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:06,772 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:06,785 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:06,786 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:06,788 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:06,788 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:09,594 - main - INFO - Loading data from CSV files
2025-06-05 10:13:09,695 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:09,774 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:09,783 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:09,792 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:09,803 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:09,889 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:09,909 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:09,921 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:09,922 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:09,923 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:09,924 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:10,957 - main - INFO - Loading data from CSV files
2025-06-05 10:13:11,035 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:11,106 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:11,111 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:11,117 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:11,124 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:11,176 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:11,197 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:11,212 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:11,213 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:11,214 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:11,215 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:13,238 - main - INFO - Loading data from CSV files
2025-06-05 10:13:13,296 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:13,366 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:13,375 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:13,385 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:13,392 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:13,452 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:13,468 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:13,486 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:13,487 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:13,488 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:13,489 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:17,528 - main - INFO - Loading data from CSV files
2025-06-05 10:13:17,600 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:17,673 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:17,680 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:17,687 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:17,695 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:17,769 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:17,793 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:17,810 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:17,811 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:17,812 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:17,813 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:36,814 - main - INFO - Loading data from CSV files
2025-06-05 10:13:36,870 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:36,949 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:36,958 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:36,964 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:36,970 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:37,023 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:37,037 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:37,048 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:37,049 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:37,050 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:37,050 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:38,082 - main - INFO - Loading data from CSV files
2025-06-05 10:13:38,139 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:38,192 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:38,198 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:38,204 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:38,210 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:38,261 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:38,275 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:38,286 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:38,287 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:38,288 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:38,288 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:40,318 - main - INFO - Loading data from CSV files
2025-06-05 10:13:40,383 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:40,443 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:40,451 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:40,460 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:40,471 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:40,542 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:40,558 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:40,568 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:40,569 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:40,570 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:40,571 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:44,593 - main - INFO - Loading data from CSV files
2025-06-05 10:13:44,651 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:44,721 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:44,727 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:44,734 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:44,741 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:44,800 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:44,814 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:44,825 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:44,826 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:44,827 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:44,827 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:47,851 - main - INFO - Loading data from CSV files
2025-06-05 10:13:47,922 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:47,987 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:47,994 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:48,003 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:48,012 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:48,090 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:48,106 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:48,119 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:48,120 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:48,121 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:48,122 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:54,539 - main - INFO - Loading data from CSV files
2025-06-05 10:13:54,591 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:54,649 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:54,657 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:54,666 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:54,675 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:54,727 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:54,746 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:54,758 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:54,759 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:54,760 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:54,761 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:54,771 - main - INFO - Loading data from CSV files
2025-06-05 10:13:54,839 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:54,901 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:54,907 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:54,913 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:54,922 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:54,986 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:55,004 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:55,020 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:55,021 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:55,023 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:55,023 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:55,788 - main - INFO - Loading data from CSV files
2025-06-05 10:13:55,840 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:55,919 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:55,926 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:55,932 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:55,939 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:55,995 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:56,012 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:56,023 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:56,024 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:56,025 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:56,025 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:57,050 - main - INFO - Loading data from CSV files
2025-06-05 10:13:57,112 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:57,185 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:57,192 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:57,198 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:57,205 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:57,262 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:57,279 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:57,291 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:57,292 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:57,293 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:57,294 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:13:58,061 - main - INFO - Loading data from CSV files
2025-06-05 10:13:58,110 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:13:58,167 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:13:58,173 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:13:58,180 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:13:58,187 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:13:58,240 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:13:58,257 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:13:58,270 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:13:58,271 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:13:58,272 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:13:58,272 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:01,323 - main - INFO - Loading data from CSV files
2025-06-05 10:14:01,372 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:01,434 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:01,442 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:01,450 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:01,459 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:01,514 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:01,536 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:01,550 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:01,550 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:01,551 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:01,552 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:02,498 - main - INFO - Loading data from CSV files
2025-06-05 10:14:02,565 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:02,622 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:02,629 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:02,635 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:02,642 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:02,711 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:02,732 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:02,745 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:02,746 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:02,747 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:02,748 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:02,757 - main - INFO - Loading data from CSV files
2025-06-05 10:14:02,837 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:02,921 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:02,940 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:02,952 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:02,963 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:03,021 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:03,041 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:03,056 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:03,056 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:03,057 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:03,058 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:03,774 - main - INFO - Loading data from CSV files
2025-06-05 10:14:03,828 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:03,888 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:03,894 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:03,902 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:03,910 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:03,993 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:04,011 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:04,022 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:04,022 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:04,023 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:04,024 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:06,292 - main - INFO - Loading data from CSV files
2025-06-05 10:14:06,361 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:06,428 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:06,435 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:06,441 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:06,448 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:06,494 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:06,509 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:06,520 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:06,520 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:06,521 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:06,522 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:06,536 - main - INFO - Loading data from CSV files
2025-06-05 10:14:06,592 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:06,648 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:06,655 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:06,663 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:06,671 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:06,736 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:06,756 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:06,769 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:06,769 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:06,771 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:06,771 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:07,803 - main - INFO - Loading data from CSV files
2025-06-05 10:14:07,913 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:08,014 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:08,023 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:08,031 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:08,038 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:08,094 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:08,111 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:08,124 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:08,124 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:08,125 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:08,126 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:10,153 - main - INFO - Loading data from CSV files
2025-06-05 10:14:10,213 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:10,298 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:10,306 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:10,313 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:10,320 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:10,372 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:10,389 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:10,400 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:10,401 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:10,402 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:10,402 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:10,561 - main - INFO - Loading data from CSV files
2025-06-05 10:14:10,636 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:10,716 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:10,727 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:10,736 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:10,744 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:10,822 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:10,844 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:10,859 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:10,860 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:10,861 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:10,862 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:11,443 - main - INFO - Loading data from CSV files
2025-06-05 10:14:11,517 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:11,591 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:11,599 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:11,606 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:11,615 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:11,679 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:11,695 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:11,707 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:11,708 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:11,710 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:11,710 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:12,741 - main - INFO - Loading data from CSV files
2025-06-05 10:14:12,793 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:12,849 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:12,857 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:12,867 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:12,876 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:12,937 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:12,958 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:12,970 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:12,971 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:12,972 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:12,972 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:14,428 - main - INFO - Loading data from CSV files
2025-06-05 10:14:14,493 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:14,557 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:14,564 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:14,572 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:14,579 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:14,636 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:14,650 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:14,662 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:14,662 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:14,663 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:14,664 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:14,987 - main - INFO - Loading data from CSV files
2025-06-05 10:14:15,043 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:15,110 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:15,117 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:15,124 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:15,130 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:15,186 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:15,202 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:15,216 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:15,217 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:15,218 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:15,219 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:19,097 - main - INFO - Loading data from CSV files
2025-06-05 10:14:19,196 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:19,283 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:19,292 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:19,302 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:19,312 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:19,396 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:19,420 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:19,434 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:19,435 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:19,436 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:19,437 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:19,450 - main - INFO - Loading data from CSV files
2025-06-05 10:14:19,536 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:19,618 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:19,625 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:19,633 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:19,641 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:19,703 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:19,725 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:19,738 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:19,739 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:19,740 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:19,741 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:20,473 - main - INFO - Loading data from CSV files
2025-06-05 10:14:20,525 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:20,588 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:20,596 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:20,604 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:20,611 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:20,680 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:20,698 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:20,709 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:20,710 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:20,712 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:20,712 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:23,954 - main - INFO - Loading data from CSV files
2025-06-05 10:14:24,030 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:24,089 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:24,096 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:24,103 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:24,110 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:24,160 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:24,177 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:24,187 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:24,188 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:24,189 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:24,190 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:24,198 - main - INFO - Loading data from CSV files
2025-06-05 10:14:24,254 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:24,325 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:24,333 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:24,340 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:24,348 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:24,416 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:24,435 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:24,448 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:24,449 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:24,450 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:24,451 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:25,216 - main - INFO - Loading data from CSV files
2025-06-05 10:14:25,292 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:25,379 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:25,386 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:25,393 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:25,402 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:25,456 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:25,475 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:25,489 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:25,490 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:25,491 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:25,491 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:27,520 - main - INFO - Loading data from CSV files
2025-06-05 10:14:27,575 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:27,630 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:27,637 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:27,643 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:27,654 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:27,711 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:27,730 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:27,741 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:27,742 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:27,743 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:27,744 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:28,473 - main - INFO - Loading data from CSV files
2025-06-05 10:14:28,523 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:28,586 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:28,594 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:28,600 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:28,607 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:28,657 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:28,681 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:28,698 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:28,699 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:28,701 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:28,702 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:33,656 - main - INFO - Loading data from CSV files
2025-06-05 10:14:33,735 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:33,801 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:33,810 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:33,820 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:33,831 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:33,888 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:33,903 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:33,915 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:33,915 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:33,916 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:33,916 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:33,927 - main - INFO - Loading data from CSV files
2025-06-05 10:14:33,986 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:34,044 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:34,051 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:34,058 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:34,066 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:34,138 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:34,155 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:34,164 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:34,165 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:34,166 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:34,166 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:35,184 - main - INFO - Loading data from CSV files
2025-06-05 10:14:35,238 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:35,318 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:35,325 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:35,334 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:35,341 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:35,396 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:35,420 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:35,433 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:35,433 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:35,434 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:35,435 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:39,184 - main - INFO - Loading data from CSV files
2025-06-05 10:14:39,260 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:39,319 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:39,327 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:39,338 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:39,352 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:39,406 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:39,428 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:39,441 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:39,442 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:39,443 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:39,444 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:39,456 - main - INFO - Loading data from CSV files
2025-06-05 10:14:39,533 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:39,598 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:39,605 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:39,614 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:39,623 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:39,687 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:39,705 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:39,718 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:39,719 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:39,720 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:39,720 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:40,751 - main - INFO - Loading data from CSV files
2025-06-05 10:14:40,804 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:40,875 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:40,881 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:40,888 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:40,895 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:40,945 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:40,960 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:40,971 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:40,972 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:40,973 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:40,973 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:42,992 - main - INFO - Loading data from CSV files
2025-06-05 10:14:43,048 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:43,112 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:43,120 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:43,129 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:43,138 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:43,196 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:43,210 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:43,222 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:43,223 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:43,224 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:43,224 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:43,473 - main - INFO - Loading data from CSV files
2025-06-05 10:14:43,526 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:43,592 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:43,601 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:43,608 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:43,615 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:43,672 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:43,696 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:43,708 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:43,708 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:43,709 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:43,710 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:44,835 - main - INFO - Loading data from CSV files
2025-06-05 10:14:44,918 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:45,003 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:45,009 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:45,016 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:45,022 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:45,088 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:45,108 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:45,124 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:45,125 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:45,126 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:45,127 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:46,153 - main - INFO - Loading data from CSV files
2025-06-05 10:14:46,206 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:46,285 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:46,294 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:46,302 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:46,308 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:46,359 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:46,377 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:46,388 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:46,388 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:46,389 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:46,390 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:47,244 - main - INFO - Loading data from CSV files
2025-06-05 10:14:47,300 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:47,370 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:47,376 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:47,386 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:47,392 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:47,449 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:47,465 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:47,476 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:47,477 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:47,478 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:47,478 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:48,409 - main - INFO - Loading data from CSV files
2025-06-05 10:14:48,491 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:48,576 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:48,586 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:48,595 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:48,603 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:48,652 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:48,667 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:48,677 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:48,678 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:48,679 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:48,680 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:14:52,698 - main - INFO - Loading data from CSV files
2025-06-05 10:14:52,749 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:14:52,814 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:14:52,821 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:14:52,827 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:14:52,836 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:14:52,901 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:14:52,921 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:14:52,933 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:14:52,933 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:14:52,935 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:14:52,935 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:06,525 - main - INFO - Loading data from CSV files
2025-06-05 10:15:06,598 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:06,657 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:06,663 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:06,670 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:06,678 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:06,730 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:06,745 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:06,756 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:06,756 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:06,757 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:06,758 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:06,768 - main - INFO - Loading data from CSV files
2025-06-05 10:15:06,821 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:06,884 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:06,890 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:06,897 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:06,903 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:06,956 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:06,977 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:06,991 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:06,992 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:06,993 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:06,994 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:07,776 - main - INFO - Loading data from CSV files
2025-06-05 10:15:07,834 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:07,904 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:07,910 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:07,917 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:07,924 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:07,987 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:08,007 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:08,020 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:08,022 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:08,023 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:08,023 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:08,036 - main - INFO - Loading data from CSV files
2025-06-05 10:15:08,106 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:08,184 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:08,190 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:08,197 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:08,206 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:08,262 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:08,277 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:08,289 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:08,290 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:08,291 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:08,292 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:10,502 - main - INFO - Loading data from CSV files
2025-06-05 10:15:10,581 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:10,639 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:10,647 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:10,654 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:10,661 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:10,738 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:10,756 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:10,767 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:10,768 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:10,769 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:10,769 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:10,778 - main - INFO - Loading data from CSV files
2025-06-05 10:15:10,849 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:10,938 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:10,947 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:10,954 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:10,962 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:11,014 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:11,030 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:11,043 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:11,044 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:11,045 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:11,045 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:14,792 - main - INFO - Loading data from CSV files
2025-06-05 10:15:14,845 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:14,901 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:14,907 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:14,915 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:14,924 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:14,996 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:15,013 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:15,025 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:15,026 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:15,027 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:15,028 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:15,073 - main - INFO - Loading data from CSV files
2025-06-05 10:15:15,141 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:15,199 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:15,205 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:15,212 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:15,218 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:15,269 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:15,284 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:15,295 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:15,295 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:15,296 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:15,297 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:40,965 - main - INFO - Loading data from CSV files
2025-06-05 10:15:41,049 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:41,125 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:41,134 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:41,144 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:41,152 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:41,226 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:41,251 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:41,264 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:41,264 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:41,265 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:41,266 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:41,280 - main - INFO - Loading data from CSV files
2025-06-05 10:15:41,358 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:41,429 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:41,437 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:41,445 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:41,455 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:41,527 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:41,544 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:41,555 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:41,556 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:41,557 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:41,557 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:42,295 - main - INFO - Loading data from CSV files
2025-06-05 10:15:42,377 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:42,444 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:42,455 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:42,466 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:42,475 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:42,540 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:42,563 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:42,579 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:42,580 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:42,581 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:42,582 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:15:42,598 - main - INFO - Loading data from CSV files
2025-06-05 10:15:42,680 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:15:42,757 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:15:42,766 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:15:42,776 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:15:42,786 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:15:42,851 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:15:42,869 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:15:42,880 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:15:42,880 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:15:42,882 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:15:42,883 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:12,425 - main - INFO - Loading data from CSV files
2025-06-05 10:16:12,493 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:12,581 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:12,591 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:12,600 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:12,609 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:12,670 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:14,834 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:14,845 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:14,846 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:14,847 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:14,848 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:14,862 - main - INFO - Loading data from CSV files
2025-06-05 10:16:14,936 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:15,017 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:15,026 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:15,036 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:15,046 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:15,138 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:15,155 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:15,166 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:15,166 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:15,168 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:15,168 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:19,189 - main - INFO - Loading data from CSV files
2025-06-05 10:16:19,283 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:19,378 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:19,391 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:19,404 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:19,416 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:19,501 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:19,529 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:19,547 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:19,548 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:19,549 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:19,550 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:19,576 - main - INFO - Loading data from CSV files
2025-06-05 10:16:19,668 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:19,758 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:19,766 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:19,774 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:19,783 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:19,851 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:19,875 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:19,891 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:19,891 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:19,893 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:19,893 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:27,360 - main - INFO - Loading data from CSV files
2025-06-05 10:16:27,418 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:27,492 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:27,502 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:27,511 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:27,521 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:27,587 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:27,604 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:27,618 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:27,618 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:27,620 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:27,621 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:28,658 - main - INFO - Loading data from CSV files
2025-06-05 10:16:28,710 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:28,782 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:28,788 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:28,796 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:28,802 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:28,859 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:28,876 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:28,888 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:28,889 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:28,890 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:28,891 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:30,918 - main - INFO - Loading data from CSV files
2025-06-05 10:16:30,969 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:31,024 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:31,031 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:31,038 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:31,046 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:31,103 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:31,125 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:31,138 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:31,139 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:31,140 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:31,141 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:31,610 - main - INFO - Loading data from CSV files
2025-06-05 10:16:31,690 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:31,749 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:31,755 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:31,763 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:31,770 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:31,823 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:31,847 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:31,863 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:31,864 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:31,866 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:31,867 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:32,901 - main - INFO - Loading data from CSV files
2025-06-05 10:16:32,977 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:33,046 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:33,053 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:33,061 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:33,070 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:33,137 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:33,155 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:33,166 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:33,167 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:33,168 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:33,168 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:35,166 - main - INFO - Loading data from CSV files
2025-06-05 10:16:35,235 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:35,301 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:35,307 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:35,314 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:35,321 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:35,383 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:35,399 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:35,409 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:35,410 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:35,411 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:35,412 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:35,427 - main - INFO - Loading data from CSV files
2025-06-05 10:16:35,486 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:35,569 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:35,582 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:35,592 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:35,604 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:35,664 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:35,680 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:35,691 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:35,691 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:35,692 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:35,693 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:39,718 - main - INFO - Loading data from CSV files
2025-06-05 10:16:39,770 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:39,847 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:39,857 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:39,867 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:39,877 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:39,940 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:39,956 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:39,967 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:39,968 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:39,969 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:39,970 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:43,813 - main - INFO - Loading data from CSV files
2025-06-05 10:16:43,869 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:43,933 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:43,944 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:43,957 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:43,967 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:44,026 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:44,040 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:44,052 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:44,053 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:44,054 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:44,054 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:45,079 - main - INFO - Loading data from CSV files
2025-06-05 10:16:45,132 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:45,191 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:45,202 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:45,211 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:45,221 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:45,287 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:45,309 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:45,321 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:45,322 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:45,323 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:45,324 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:46,818 - main - INFO - Loading data from CSV files
2025-06-05 10:16:46,890 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:46,962 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:46,977 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:46,986 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:46,999 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:47,076 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:47,095 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:47,108 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:47,109 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:47,110 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:47,110 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:47,348 - main - INFO - Loading data from CSV files
2025-06-05 10:16:47,401 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:47,457 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:47,463 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:47,470 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:47,477 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:47,526 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:47,541 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:47,551 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:47,552 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:47,553 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:47,553 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:48,139 - main - INFO - Loading data from CSV files
2025-06-05 10:16:48,205 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:48,259 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:48,265 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:48,271 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:48,277 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:48,335 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:48,361 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:48,376 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:48,377 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:48,379 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:48,379 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:50,406 - main - INFO - Loading data from CSV files
2025-06-05 10:16:50,458 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:50,513 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:50,519 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:50,526 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:50,532 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:50,582 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:50,600 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:50,612 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:50,613 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:50,614 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:50,614 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:51,576 - main - INFO - Loading data from CSV files
2025-06-05 10:16:51,627 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:51,701 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:51,707 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:51,714 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:51,719 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:51,768 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:51,785 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:51,802 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:51,802 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:51,804 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:51,805 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:55,596 - main - INFO - Loading data from CSV files
2025-06-05 10:16:55,649 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:55,712 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:55,720 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:55,727 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:55,735 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:55,805 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:55,822 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:55,833 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:55,834 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:55,835 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:55,835 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:56,865 - main - INFO - Loading data from CSV files
2025-06-05 10:16:56,938 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:57,000 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:57,010 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:57,018 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:57,027 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:57,079 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:57,098 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:57,109 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:57,110 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:57,111 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:57,111 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:16:59,142 - main - INFO - Loading data from CSV files
2025-06-05 10:16:59,192 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:16:59,249 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:16:59,256 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:16:59,262 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:16:59,269 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:16:59,318 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:16:59,333 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:16:59,344 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:16:59,345 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:16:59,346 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:16:59,347 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:03,374 - main - INFO - Loading data from CSV files
2025-06-05 10:17:03,425 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:03,502 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:03,513 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:03,526 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:03,538 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:03,597 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:03,613 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:03,625 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:03,625 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:03,627 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:03,627 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:21,850 - main - INFO - Loading data from CSV files
2025-06-05 10:17:21,923 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:21,997 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:22,007 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:22,016 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:22,025 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:22,081 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:22,098 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:22,109 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:22,109 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:22,111 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:22,111 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:23,142 - main - INFO - Loading data from CSV files
2025-06-05 10:17:23,195 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:23,251 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:23,257 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:23,264 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:23,270 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:23,318 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:23,332 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:23,343 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:23,344 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:23,345 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:23,346 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:25,372 - main - INFO - Loading data from CSV files
2025-06-05 10:17:25,437 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:25,500 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:25,507 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:25,516 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:25,525 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:25,597 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:25,620 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:25,632 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:25,633 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:25,634 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:25,634 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:29,775 - main - INFO - Loading data from CSV files
2025-06-05 10:17:29,857 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:29,914 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:29,920 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:29,927 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:29,934 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:30,001 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:30,023 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:30,035 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:30,035 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:30,036 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:30,037 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:33,657 - main - INFO - Loading data from CSV files
2025-06-05 10:17:33,722 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:33,783 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:33,792 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:33,801 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:33,809 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:33,859 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:33,875 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:33,885 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:33,885 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:33,887 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:33,887 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:34,919 - main - INFO - Loading data from CSV files
2025-06-05 10:17:34,977 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:35,046 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:35,054 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:35,062 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:35,072 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:35,138 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:35,154 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:35,165 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:35,165 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:35,167 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:35,167 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:37,190 - main - INFO - Loading data from CSV files
2025-06-05 10:17:37,247 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:37,314 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:37,322 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:37,329 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:37,337 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:37,391 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:37,406 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:37,418 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:37,418 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:37,419 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:37,420 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 10:17:41,448 - main - INFO - Loading data from CSV files
2025-06-05 10:17:41,506 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 10:17:41,564 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 10:17:41,573 - main - INFO - Loaded user_details with 205 rows
2025-06-05 10:17:41,582 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 10:17:41,591 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 10:17:41,648 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 10:17:41,667 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 10:17:41,678 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 10:17:41,679 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f342a152-c8aa-461e-8564-68d07d4c2604', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-05 10:17:41,680 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb878ab9-76b4-eb11-8236-000d3ab5a61f', '70e80ea6-76b4-eb11-8236-000d3ab6406f', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '6ee7a382-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 10:17:41,680 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 15:12:17,585 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-05 15:12:49,183 - main - INFO - Loading data from CSV files
2025-06-05 15:12:49,361 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 15:12:49,534 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 15:12:49,568 - main - INFO - Loaded user_details with 205 rows
2025-06-05 15:12:49,624 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 15:12:49,673 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 15:12:49,887 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 15:12:49,935 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 15:12:49,959 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 15:12:49,960 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['52614237-42ce-44ca-a731-4567d6dcace2', 'f5171746-0248-4d03-8228-86376434a4e2', '38638d06-9c44-418f-8be6-2247be5924ec', '2e186776-244e-4c01-a4d4-97102c86ff32', '25e4481b-88cd-43c3-8875-93a1ab52df0a']...
2025-06-05 15:12:49,962 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['57b5c94e-8533-ec11-b6e6-0022489bd51d', '0e3c92b3-76b4-eb11-8236-000d3ab5a61f', 'f837ec5b-39da-eb11-bacb-000d3ab17fbc', 'a18b16a0-76b4-eb11-8236-000d3ab6406f', 'a280aa88-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 15:12:49,962 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 15:22:10,823 - main - INFO - Loading data from CSV files
2025-06-05 15:22:11,155 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 15:22:11,289 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 15:22:11,321 - main - INFO - Loaded user_details with 205 rows
2025-06-05 15:22:11,338 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 15:22:11,357 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 15:22:11,647 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 15:22:11,756 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 15:22:11,773 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 15:22:11,774 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['52614237-42ce-44ca-a731-4567d6dcace2', 'f5171746-0248-4d03-8228-86376434a4e2', '38638d06-9c44-418f-8be6-2247be5924ec', '2e186776-244e-4c01-a4d4-97102c86ff32', '25e4481b-88cd-43c3-8875-93a1ab52df0a']...
2025-06-05 15:22:11,779 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['57b5c94e-8533-ec11-b6e6-0022489bd51d', '0e3c92b3-76b4-eb11-8236-000d3ab5a61f', 'f837ec5b-39da-eb11-bacb-000d3ab17fbc', 'a18b16a0-76b4-eb11-8236-000d3ab6406f', 'a280aa88-f8bc-ec11-9840-0022489e2e28']...
2025-06-05 15:22:11,780 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 15:56:44,706 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-05 15:57:59,446 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-05 16:02:36,767 - main - INFO - Loading data from CSV files
2025-06-05 16:02:36,891 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 16:02:37,021 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 16:02:37,058 - main - INFO - Loaded user_details with 205 rows
2025-06-05 16:02:37,088 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 16:02:37,120 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 16:02:37,300 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 16:02:37,346 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 16:02:37,368 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 16:02:37,369 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 16:02:37,371 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 16:02:37,372 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 16:02:39,727 - main - INFO - Loading data from CSV files
2025-06-05 16:02:39,844 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 16:02:39,968 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 16:02:39,981 - main - INFO - Loaded user_details with 205 rows
2025-06-05 16:02:39,995 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 16:02:40,011 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 16:02:40,116 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 16:02:40,148 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 16:02:40,170 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 16:02:40,171 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 16:02:40,172 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 16:02:40,173 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 16:02:44,215 - main - INFO - Loading data from CSV files
2025-06-05 16:02:44,336 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 16:02:44,476 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 16:02:44,496 - main - INFO - Loaded user_details with 205 rows
2025-06-05 16:02:44,517 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 16:02:44,540 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 16:02:44,687 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 16:02:44,730 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 16:02:44,757 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 16:02:44,758 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 16:02:44,761 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 16:02:44,762 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 16:22:21,848 - main - INFO - Loading data from CSV files
2025-06-05 16:22:22,028 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 16:22:22,192 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 16:22:22,246 - main - INFO - Loaded user_details with 205 rows
2025-06-05 16:22:22,285 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 16:22:22,338 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 16:22:22,625 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 16:22:22,697 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 16:22:22,725 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 16:22:22,727 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 16:22:22,730 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 16:22:22,731 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 16:52:29,705 - main - INFO - Loading data from CSV files
2025-06-05 16:52:30,089 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 16:52:30,273 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 16:52:30,325 - main - INFO - Loaded user_details with 205 rows
2025-06-05 16:52:30,357 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 16:52:30,391 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 16:52:30,673 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 16:52:30,774 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 16:52:30,790 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 16:52:30,791 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 16:52:30,793 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 16:52:30,794 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 17:22:37,871 - main - INFO - Loading data from CSV files
2025-06-05 17:22:38,183 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 17:22:38,320 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 17:22:38,339 - main - INFO - Loaded user_details with 205 rows
2025-06-05 17:22:38,360 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 17:22:38,413 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 17:22:38,738 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 17:22:38,802 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 17:22:38,814 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 17:22:38,815 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 17:22:38,817 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 17:22:38,818 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 18:22:49,056 - main - INFO - Loading data from CSV files
2025-06-05 18:22:49,333 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 18:22:49,504 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 18:22:49,557 - main - INFO - Loaded user_details with 205 rows
2025-06-05 18:22:49,591 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 18:22:49,633 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 18:22:49,905 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 18:22:49,970 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 18:22:49,991 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 18:22:49,992 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 18:22:49,995 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 18:22:49,995 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 18:53:03,689 - main - INFO - Loading data from CSV files
2025-06-05 18:53:03,881 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 18:53:03,987 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 18:53:04,017 - main - INFO - Loaded user_details with 205 rows
2025-06-05 18:53:04,044 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 18:53:04,072 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 18:53:04,234 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 18:53:04,277 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 18:53:04,285 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 18:53:04,286 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 18:53:04,288 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 18:53:04,288 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 19:23:13,113 - main - INFO - Loading data from CSV files
2025-06-05 19:23:13,249 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 19:23:13,333 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 19:23:13,361 - main - INFO - Loaded user_details with 205 rows
2025-06-05 19:23:13,388 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 19:23:13,418 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 19:23:13,576 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 19:23:13,601 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 19:23:13,613 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 19:23:13,613 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 19:23:13,616 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 19:23:13,616 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 19:53:30,924 - main - INFO - Loading data from CSV files
2025-06-05 19:53:31,201 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 19:53:31,387 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 19:53:31,452 - main - INFO - Loaded user_details with 205 rows
2025-06-05 19:53:31,505 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 19:53:31,561 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 19:53:31,855 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 19:53:31,919 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 19:53:31,935 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 19:53:31,935 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 19:53:31,938 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 19:53:31,939 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 20:23:41,235 - main - INFO - Loading data from CSV files
2025-06-05 20:23:41,884 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 20:23:42,155 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 20:23:42,222 - main - INFO - Loaded user_details with 205 rows
2025-06-05 20:23:42,293 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 20:23:42,353 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 20:23:42,809 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 20:23:42,952 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 20:23:42,971 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 20:23:42,971 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 20:23:42,975 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 20:23:42,977 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-05 22:24:49,809 - main - INFO - Loading data from CSV files
2025-06-05 22:24:50,008 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-05 22:24:50,162 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-05 22:24:50,186 - main - INFO - Loaded user_details with 205 rows
2025-06-05 22:24:50,206 - main - INFO - Loaded app_roles with 2101 rows
2025-06-05 22:24:50,230 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-05 22:24:50,412 - main - INFO - Created group_memberships with 3222 rows
2025-06-05 22:24:50,463 - main - INFO - Created role_matrix with 2101 rows
2025-06-05 22:24:50,488 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-05 22:24:50,490 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['d1df6d9c-9e84-4709-b859-4c5da3a5b3ee', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '8d5429c6-df27-449e-baca-523753e23005', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '56a78acc-83ae-46fa-9401-00c84e5cc4a0']...
2025-06-05 22:24:50,493 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['623c92b3-76b4-eb11-8236-000d3ab5a61f', 'b548db8e-1dbc-ee11-9078-000d3ab41c07', '97e80ea6-76b4-eb11-8236-000d3ab6406f', 'c26691c2-1d1f-ee11-9966-000d3adc8967', '183d92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-05 22:24:50,494 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-06 11:50:31,571 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-06 12:36:40,606 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-06 12:39:49,372 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-06 17:35:05,878 - main - INFO - Loading data from CSV files
2025-06-06 17:35:06,396 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-06 17:35:06,496 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-06 17:35:06,540 - main - INFO - Loaded user_details with 205 rows
2025-06-06 17:35:06,578 - main - INFO - Loaded app_roles with 2101 rows
2025-06-06 17:35:06,616 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-06 17:35:06,997 - main - INFO - Created group_memberships with 3222 rows
2025-06-06 17:35:07,067 - main - INFO - Created role_matrix with 2101 rows
2025-06-06 17:35:07,080 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-06 17:35:07,080 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['828a0c6f-7972-442a-afd6-d0a6e2f0057c', '25dacb82-5251-4c72-b169-969637d4b37f', '2b68b50c-b7e1-4155-9966-4ddca2ec8afc', '9405e3c4-34fa-4514-aa16-161cb1e01532', '25e4481b-88cd-43c3-8875-93a1ab52df0a']...
2025-06-06 17:35:07,082 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['92b516af-7f0f-ed11-b83c-000d3ab9e773', '9f9e7032-84e8-ed11-a7c6-0022489b4de1', '6de80ea6-76b4-eb11-8236-000d3ab6406f', 'e5eff26e-b4ca-ee11-907a-0022489ba0c8', '6c2d2195-c58c-ed11-81ad-000d3adc8967']...
2025-06-06 17:35:07,083 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-06 18:05:14,459 - main - INFO - Loading data from CSV files
2025-06-06 18:05:14,648 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-06 18:05:14,718 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-06 18:05:14,738 - main - INFO - Loaded user_details with 205 rows
2025-06-06 18:05:14,749 - main - INFO - Loaded app_roles with 2101 rows
2025-06-06 18:05:14,767 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-06 18:05:14,889 - main - INFO - Created group_memberships with 3222 rows
2025-06-06 18:05:14,946 - main - INFO - Created role_matrix with 2101 rows
2025-06-06 18:05:14,961 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-06 18:05:14,963 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['828a0c6f-7972-442a-afd6-d0a6e2f0057c', '25dacb82-5251-4c72-b169-969637d4b37f', '2b68b50c-b7e1-4155-9966-4ddca2ec8afc', '9405e3c4-34fa-4514-aa16-161cb1e01532', '25e4481b-88cd-43c3-8875-93a1ab52df0a']...
2025-06-06 18:05:14,966 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['92b516af-7f0f-ed11-b83c-000d3ab9e773', '9f9e7032-84e8-ed11-a7c6-0022489b4de1', '6de80ea6-76b4-eb11-8236-000d3ab6406f', 'e5eff26e-b4ca-ee11-907a-0022489ba0c8', '6c2d2195-c58c-ed11-81ad-000d3adc8967']...
2025-06-06 18:05:14,967 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-06 18:35:28,120 - main - INFO - Loading data from CSV files
2025-06-06 18:35:28,420 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-06 18:35:28,527 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-06 18:35:28,566 - main - INFO - Loaded user_details with 205 rows
2025-06-06 18:35:28,595 - main - INFO - Loaded app_roles with 2101 rows
2025-06-06 18:35:28,628 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-06 18:35:28,841 - main - INFO - Created group_memberships with 3222 rows
2025-06-06 18:35:28,906 - main - INFO - Created role_matrix with 2101 rows
2025-06-06 18:35:28,919 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-06 18:35:28,920 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['828a0c6f-7972-442a-afd6-d0a6e2f0057c', '25dacb82-5251-4c72-b169-969637d4b37f', '2b68b50c-b7e1-4155-9966-4ddca2ec8afc', '9405e3c4-34fa-4514-aa16-161cb1e01532', '25e4481b-88cd-43c3-8875-93a1ab52df0a']...
2025-06-06 18:35:28,922 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['92b516af-7f0f-ed11-b83c-000d3ab9e773', '9f9e7032-84e8-ed11-a7c6-0022489b4de1', '6de80ea6-76b4-eb11-8236-000d3ab6406f', 'e5eff26e-b4ca-ee11-907a-0022489ba0c8', '6c2d2195-c58c-ed11-81ad-000d3adc8967']...
2025-06-06 18:35:28,923 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-09 10:41:47,451 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 10:51:28,936 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 10:57:15,549 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:11:31,245 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:18:43,061 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:26:51,570 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:27:04,015 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:27:16,445 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:27:25,103 - main - INFO - Loading data from CSV files
2025-06-09 11:27:25,192 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-09 11:27:25,269 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-09 11:27:25,291 - main - INFO - Loaded user_details with 205 rows
2025-06-09 11:27:25,315 - main - INFO - Loaded app_roles with 2101 rows
2025-06-09 11:27:25,340 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-09 11:27:25,485 - main - INFO - Created group_memberships with 3222 rows
2025-06-09 11:27:25,518 - main - INFO - Created role_matrix with 2101 rows
2025-06-09 11:27:25,530 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-09 11:27:25,531 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['f930eecf-94a2-492d-a317-ab8c86b0e56c', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', 'e5f47082-e16b-4429-9d36-09d4b1354a24', '46aee3ae-b46f-4737-a826-87ff31e6c3ff', '8c21304f-41d0-474f-bb19-d49eba150fb0']...
2025-06-09 11:27:25,534 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['98029ad4-4c21-f011-998b-000d3a69167e', '86348f11-f775-ef11-a670-0022489b4de1', '7711d021-9240-ec11-8c62-0022489cba62', '6e8b16a0-76b4-eb11-8236-000d3ab6406f', 'a6878ab9-76b4-eb11-8236-000d3ab5a61f']...
2025-06-09 11:27:25,535 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-09 11:32:32,907 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:32:59,520 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:35:11,116 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:35:50,087 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:41:12,288 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:41:39,352 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:43:13,748 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:44:20,503 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:45:26,164 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:46:50,228 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:47:24,838 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:47:51,893 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:48:39,034 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:48:43,751 - main - INFO - Loading data from CSV files
2025-06-09 11:48:43,826 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-09 11:48:43,895 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-09 11:48:43,923 - main - INFO - Loaded user_details with 205 rows
2025-06-09 11:48:43,948 - main - INFO - Loaded app_roles with 2101 rows
2025-06-09 11:48:43,977 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-09 11:48:44,117 - main - INFO - Created group_memberships with 3222 rows
2025-06-09 11:48:44,146 - main - INFO - Created role_matrix with 2101 rows
2025-06-09 11:48:44,156 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-09 11:48:44,156 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'f930eecf-94a2-492d-a317-ab8c86b0e56c', '401b998a-bb2f-4dd4-887e-c0045a3964bf', '22f074a3-f331-4ba5-a5c3-aa0e8af9b61e', 'bfa5d2b9-f1ec-454e-82e1-9dad0275f657']...
2025-06-09 11:48:44,158 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['64a962c2-ab09-ec11-b6e6-000d3ab1f3c0', '6b502afb-a2c2-eb11-bacc-0022489c4a92', 'c78b16a0-76b4-eb11-8236-000d3ab6406f', '5abb2fd2-f4a3-ed11-aad1-0022489ba102', '9050733f-13aa-eb11-8236-0022489b4c66']...
2025-06-09 11:48:44,158 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-09 11:49:56,306 - main - INFO - Loading data from CSV files
2025-06-09 11:49:56,344 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-09 11:49:56,390 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-09 11:49:56,398 - main - INFO - Loaded user_details with 205 rows
2025-06-09 11:49:56,406 - main - INFO - Loaded app_roles with 2101 rows
2025-06-09 11:49:56,414 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-09 11:49:56,453 - main - INFO - Created group_memberships with 3222 rows
2025-06-09 11:49:56,467 - main - INFO - Created role_matrix with 2101 rows
2025-06-09 11:49:56,473 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-09 11:49:56,474 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'f930eecf-94a2-492d-a317-ab8c86b0e56c', '401b998a-bb2f-4dd4-887e-c0045a3964bf', '22f074a3-f331-4ba5-a5c3-aa0e8af9b61e', 'bfa5d2b9-f1ec-454e-82e1-9dad0275f657']...
2025-06-09 11:49:56,475 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['64a962c2-ab09-ec11-b6e6-000d3ab1f3c0', '6b502afb-a2c2-eb11-bacc-0022489c4a92', 'c78b16a0-76b4-eb11-8236-000d3ab6406f', '5abb2fd2-f4a3-ed11-aad1-0022489ba102', '9050733f-13aa-eb11-8236-0022489b4c66']...
2025-06-09 11:49:56,475 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-09 11:50:26,797 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 11:50:26,797 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 11:50:26,798 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 11:50:26,799 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 11:51:06,845 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 11:51:12,276 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 11:51:12,276 - src.core.embeddings - INFO - Embedding initialization took 45.48 seconds
2025-06-09 11:51:12,277 - src.core.embeddings - INFO - Memory usage: RSS=513.45 MB, VMS=2701.54 MB
2025-06-09 11:51:12,278 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 11:51:12,278 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 11:51:12,286 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 11:51:12,308 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 11:51:13,268 - src.core.embeddings - INFO - Text generation took 0.99 seconds
2025-06-09 11:51:13,269 - src.core.embeddings - INFO - Memory usage: RSS=543.48 MB, VMS=2730.95 MB
2025-06-09 11:51:13,269 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 11:51:15,760 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 11:51:15,760 - src.core.embeddings - INFO - Document conversion took 2.49 seconds
2025-06-09 11:51:15,761 - src.core.embeddings - INFO - Memory usage: RSS=577.80 MB, VMS=2765.01 MB
2025-06-09 11:51:15,762 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 11:51:15,765 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 11:51:30,438 - src.core.embeddings - INFO - Memory usage: RSS=741.04 MB, VMS=2947.64 MB
2025-06-09 11:51:30,439 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 11:51:44,047 - src.core.embeddings - INFO - Memory usage: RSS=816.08 MB, VMS=3022.61 MB
2025-06-09 11:51:44,048 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 11:51:57,133 - src.core.embeddings - INFO - Memory usage: RSS=891.18 MB, VMS=3097.68 MB
2025-06-09 11:51:57,134 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 11:52:11,031 - src.core.embeddings - INFO - Memory usage: RSS=965.42 MB, VMS=3172.30 MB
2025-06-09 11:52:11,032 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 11:52:25,118 - src.core.embeddings - INFO - Memory usage: RSS=1039.31 MB, VMS=3245.81 MB
2025-06-09 11:52:25,119 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 11:52:40,745 - src.core.embeddings - INFO - Memory usage: RSS=1112.41 MB, VMS=3319.72 MB
2025-06-09 11:52:40,746 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 11:53:13,208 - src.core.embeddings - INFO - Memory usage: RSS=1369.39 MB, VMS=3575.16 MB
2025-06-09 11:53:13,209 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 11:53:52,992 - src.core.embeddings - INFO - Memory usage: RSS=1446.78 MB, VMS=3652.62 MB
2025-06-09 11:53:52,992 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 11:54:15,367 - src.core.embeddings - INFO - Memory usage: RSS=1484.34 MB, VMS=3693.08 MB
2025-06-09 11:54:15,720 - src.core.embeddings - INFO - Embedding generation took 179.96 seconds
2025-06-09 11:54:15,721 - src.core.embeddings - INFO - Memory usage: RSS=1484.34 MB, VMS=3693.08 MB
2025-06-09 11:54:15,721 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 11:54:16,669 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 11:54:18,091 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 11:54:18,115 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 11:54:19,281 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-09 11:54:19,282 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.56 seconds
2025-06-09 11:54:19,282 - src.core.embeddings - INFO - Memory usage: RSS=1705.45 MB, VMS=4053.88 MB
2025-06-09 11:54:19,294 - src.core.embeddings - INFO - Total embedding generation took 232.50 seconds
2025-06-09 11:55:56,626 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:57:58,675 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:58:21,286 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 11:58:25,555 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\Paramount_Access_Review\data
2025-06-09 11:58:39,290 - main - INFO - Loading data from CSV files
2025-06-09 11:58:39,340 - main - INFO - Loaded audit_logs with 31505 rows
2025-06-09 11:58:39,386 - main - INFO - Loaded signin_logs with 11204 rows
2025-06-09 11:58:39,395 - main - INFO - Loaded user_details with 205 rows
2025-06-09 11:58:39,405 - main - INFO - Loaded app_roles with 2101 rows
2025-06-09 11:58:39,415 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-09 11:58:39,484 - main - INFO - Created group_memberships with 3222 rows
2025-06-09 11:58:39,500 - main - INFO - Created role_matrix with 2101 rows
2025-06-09 11:58:39,509 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-09 11:58:39,509 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['b57b029f-ea18-44a1-aad4-df795c4bf226', '52614237-42ce-44ca-a731-4567d6dcace2', 'a04bb954-ce22-4ac6-8dda-170d68cd3dff', '3fea2cb5-3aa4-4605-914c-c65359cbfa10', 'e5f47082-e16b-4429-9d36-09d4b1354a24']...
2025-06-09 11:58:39,510 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['f35cb77d-ac76-ee11-8179-0022489b4696', 'ae50733f-13aa-eb11-8236-0022489b4c66', '7250733f-13aa-eb11-8236-0022489b4c66', 'd4e7a382-f8bc-ec11-9840-0022489e2e28', '64a962c2-ab09-ec11-b6e6-000d3ab1f3c0']...
2025-06-09 11:58:39,511 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-09 11:58:41,861 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 11:58:41,861 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 11:58:41,862 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 11:58:41,862 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 11:58:48,820 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 11:58:55,936 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 11:58:55,937 - src.core.embeddings - INFO - Embedding initialization took 14.07 seconds
2025-06-09 11:58:55,938 - src.core.embeddings - INFO - Memory usage: RSS=514.76 MB, VMS=2703.60 MB
2025-06-09 11:58:55,938 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 11:58:55,940 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 11:58:55,949 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 11:58:55,965 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 11:58:57,080 - src.core.embeddings - INFO - Text generation took 1.14 seconds
2025-06-09 11:58:57,081 - src.core.embeddings - INFO - Memory usage: RSS=543.16 MB, VMS=2731.29 MB
2025-06-09 11:58:57,081 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 11:59:02,821 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 11:59:02,823 - src.core.embeddings - INFO - Document conversion took 5.74 seconds
2025-06-09 11:59:02,824 - src.core.embeddings - INFO - Memory usage: RSS=577.41 MB, VMS=2765.35 MB
2025-06-09 11:59:02,826 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 11:59:02,835 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 11:59:40,343 - src.core.embeddings - INFO - Memory usage: RSS=740.43 MB, VMS=2948.60 MB
2025-06-09 11:59:40,343 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 12:00:14,347 - src.core.embeddings - INFO - Memory usage: RSS=816.20 MB, VMS=3023.93 MB
2025-06-09 12:00:14,348 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 12:00:39,210 - src.core.embeddings - INFO - Memory usage: RSS=890.57 MB, VMS=3098.39 MB
2025-06-09 12:00:39,211 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 12:00:53,566 - src.core.embeddings - INFO - Memory usage: RSS=964.46 MB, VMS=3172.73 MB
2025-06-09 12:00:53,566 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 12:01:07,869 - src.core.embeddings - INFO - Memory usage: RSS=1037.94 MB, VMS=3245.92 MB
2025-06-09 12:01:07,870 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 12:01:22,948 - src.core.embeddings - INFO - Memory usage: RSS=1111.85 MB, VMS=3320.42 MB
2025-06-09 12:01:22,948 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 12:01:56,702 - src.core.embeddings - INFO - Memory usage: RSS=1370.75 MB, VMS=3576.89 MB
2025-06-09 12:01:56,703 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 12:02:41,566 - src.core.embeddings - INFO - Memory usage: RSS=1257.26 MB, VMS=3652.91 MB
2025-06-09 12:02:41,567 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 12:03:03,572 - src.core.embeddings - INFO - Memory usage: RSS=1296.19 MB, VMS=3693.09 MB
2025-06-09 12:03:03,917 - src.core.embeddings - INFO - Embedding generation took 241.09 seconds
2025-06-09 12:03:03,918 - src.core.embeddings - INFO - Memory usage: RSS=1296.19 MB, VMS=3693.09 MB
2025-06-09 12:03:03,919 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 12:03:04,830 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 12:03:06,248 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 12:03:06,276 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 12:03:07,190 - src.core.embeddings - INFO - Saved FAISS vectorstore to disk
2025-06-09 12:03:07,190 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.27 seconds
2025-06-09 12:03:07,191 - src.core.embeddings - INFO - Memory usage: RSS=1514.07 MB, VMS=4056.72 MB
2025-06-09 12:03:07,235 - src.core.embeddings - INFO - Total embedding generation took 265.37 seconds
2025-06-09 12:11:46,703 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\Paramount_Access_Review\data
2025-06-09 12:13:44,818 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:15:30,406 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:15:34,941 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\Paramount_Access_Review\data
2025-06-09 12:15:35,206 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 12:15:35,207 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 12:15:35,207 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 12:15:35,208 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 12:16:17,402 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 12:16:59,912 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 12:16:59,912 - src.core.embeddings - INFO - Embedding initialization took 84.70 seconds
2025-06-09 12:16:59,913 - src.core.embeddings - INFO - Memory usage: RSS=511.86 MB, VMS=2696.97 MB
2025-06-09 12:16:59,913 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 12:16:59,914 - src.core.embeddings - INFO - Using all logs: audit_logs=31590 rows, signin_logs=18070 rows
2025-06-09 12:16:59,918 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 12:16:59,953 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-09 12:16:59,954 - src.core.embeddings - ERROR - Failed to generate embeddings: 'User ID'
2025-06-09 12:17:00,079 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'User ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\embeddings.py", line 168, in generate_embeddings
    user_departments = dict(zip(user_details["User ID"].astype(str), user_details.get("Department", "Unknown")))
                                ~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'User ID'

2025-06-09 12:17:11,906 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\Paramount_Access_Review\data
2025-06-09 12:17:12,339 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 12:17:12,340 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 12:17:12,340 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 12:17:12,341 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 12:17:12,342 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 12:17:15,471 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 12:17:15,471 - src.core.embeddings - INFO - Embedding initialization took 3.13 seconds
2025-06-09 12:17:15,472 - src.core.embeddings - INFO - Memory usage: RSS=537.19 MB, VMS=2788.57 MB
2025-06-09 12:17:15,472 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 12:17:15,473 - src.core.embeddings - INFO - Using all logs: audit_logs=31590 rows, signin_logs=18070 rows
2025-06-09 12:17:15,476 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 12:17:15,493 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 12:17:15,494 - src.core.embeddings - ERROR - Failed to generate embeddings: 'User ID'
2025-06-09 12:17:15,496 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'User ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\embeddings.py", line 168, in generate_embeddings
    user_departments = dict(zip(user_details["User ID"].astype(str), user_details.get("Department", "Unknown")))
                                ~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'User ID'

2025-06-09 12:18:09,430 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:18:40,605 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\Paramount_Access_Review\data
2025-06-09 12:18:40,945 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 12:18:40,945 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 12:18:40,946 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 12:18:40,947 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 12:18:52,488 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 12:18:57,285 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 12:18:57,286 - src.core.embeddings - INFO - Embedding initialization took 16.34 seconds
2025-06-09 12:18:57,287 - src.core.embeddings - INFO - Memory usage: RSS=511.98 MB, VMS=2697.45 MB
2025-06-09 12:18:57,287 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 12:18:57,288 - src.core.embeddings - INFO - Using all logs: audit_logs=31590 rows, signin_logs=18070 rows
2025-06-09 12:18:57,290 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 12:18:57,309 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 12:18:57,310 - src.core.embeddings - ERROR - Failed to generate embeddings: 'User ID'
2025-06-09 12:18:57,316 - src.core.embeddings - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'User ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\embeddings.py", line 168, in generate_embeddings
    user_departments = dict(zip(user_details["User ID"].astype(str), user_details.get("Department", "Unknown")))
                                ~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'User ID'

2025-06-09 12:20:45,375 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:21:06,286 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:22:21,917 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:23:53,316 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:23:58,230 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 12:23:58,512 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 12:23:58,513 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 12:23:58,513 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 12:23:58,514 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 12:24:04,268 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 12:24:11,863 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 12:24:11,864 - src.core.embeddings - INFO - Embedding initialization took 13.35 seconds
2025-06-09 12:24:11,864 - src.core.embeddings - INFO - Memory usage: RSS=512.14 MB, VMS=2696.71 MB
2025-06-09 12:24:11,865 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 12:24:11,866 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 12:24:11,872 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 12:24:11,895 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 12:24:14,314 - src.core.embeddings - INFO - Text generation took 2.45 seconds
2025-06-09 12:24:14,317 - src.core.embeddings - INFO - Memory usage: RSS=541.39 MB, VMS=2725.63 MB
2025-06-09 12:24:14,319 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 12:24:20,195 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 12:24:20,196 - src.core.embeddings - INFO - Document conversion took 5.88 seconds
2025-06-09 12:24:20,196 - src.core.embeddings - INFO - Memory usage: RSS=577.55 MB, VMS=2762.70 MB
2025-06-09 12:24:20,197 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 12:24:20,200 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 12:24:54,152 - src.core.embeddings - INFO - Memory usage: RSS=738.65 MB, VMS=2942.24 MB
2025-06-09 12:24:54,153 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 12:25:08,579 - src.core.embeddings - INFO - Memory usage: RSS=814.05 MB, VMS=3017.34 MB
2025-06-09 12:25:08,580 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 12:25:22,224 - src.core.embeddings - INFO - Memory usage: RSS=889.17 MB, VMS=3091.98 MB
2025-06-09 12:25:22,225 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 12:25:41,128 - src.core.embeddings - INFO - Memory usage: RSS=962.49 MB, VMS=3165.97 MB
2025-06-09 12:25:41,129 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 12:26:04,274 - src.core.embeddings - INFO - Memory usage: RSS=952.39 MB, VMS=3240.52 MB
2025-06-09 12:26:04,275 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 12:26:39,921 - src.core.embeddings - INFO - Memory usage: RSS=1025.68 MB, VMS=3313.06 MB
2025-06-09 12:26:39,922 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 12:28:39,652 - src.core.embeddings - INFO - Memory usage: RSS=946.23 MB, VMS=3333.95 MB
2025-06-09 12:28:39,656 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 12:31:05,298 - src.core.embeddings - INFO - Memory usage: RSS=1131.23 MB, VMS=3564.55 MB
2025-06-09 12:31:05,299 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 12:32:22,883 - src.core.embeddings - INFO - Memory usage: RSS=1164.05 MB, VMS=3585.46 MB
2025-06-09 12:32:23,345 - src.core.embeddings - INFO - Embedding generation took 483.15 seconds
2025-06-09 12:32:23,346 - src.core.embeddings - INFO - Memory usage: RSS=1164.05 MB, VMS=3585.46 MB
2025-06-09 12:32:23,347 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 12:32:25,055 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 12:32:27,287 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 12:32:27,337 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 12:32:27,338 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 12:32:27,339 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.99 seconds
2025-06-09 12:32:27,341 - src.core.embeddings - INFO - Memory usage: RSS=1386.58 MB, VMS=3941.91 MB
2025-06-09 12:32:27,441 - src.core.embeddings - INFO - Total embedding generation took 508.93 seconds
2025-06-09 12:34:46,104 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:35:09,568 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:35:12,834 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 12:35:13,018 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 12:35:13,019 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 12:35:13,020 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 12:35:13,021 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 12:35:40,042 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 12:35:44,877 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 12:35:44,878 - src.core.embeddings - INFO - Embedding initialization took 31.86 seconds
2025-06-09 12:35:44,879 - src.core.embeddings - INFO - Memory usage: RSS=511.14 MB, VMS=2699.29 MB
2025-06-09 12:35:44,879 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 12:35:44,880 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 12:35:44,882 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 12:35:44,894 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-09 12:35:45,569 - src.core.embeddings - INFO - Text generation took 0.69 seconds
2025-06-09 12:35:45,569 - src.core.embeddings - INFO - Memory usage: RSS=540.68 MB, VMS=2728.43 MB
2025-06-09 12:35:45,570 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 12:35:47,531 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 12:35:47,531 - src.core.embeddings - INFO - Document conversion took 1.96 seconds
2025-06-09 12:35:47,532 - src.core.embeddings - INFO - Memory usage: RSS=576.84 MB, VMS=2764.50 MB
2025-06-09 12:35:47,532 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 12:35:47,536 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 12:36:00,002 - src.core.embeddings - INFO - Memory usage: RSS=739.46 MB, VMS=2946.34 MB
2025-06-09 12:36:00,003 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 12:36:12,892 - src.core.embeddings - INFO - Memory usage: RSS=814.55 MB, VMS=3021.22 MB
2025-06-09 12:36:12,893 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 12:36:25,257 - src.core.embeddings - INFO - Memory usage: RSS=889.60 MB, VMS=3095.99 MB
2025-06-09 12:36:25,258 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 12:36:55,107 - src.core.embeddings - INFO - Memory usage: RSS=962.82 MB, VMS=3169.80 MB
2025-06-09 12:36:55,108 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 12:37:31,320 - src.core.embeddings - INFO - Memory usage: RSS=1036.71 MB, VMS=3243.32 MB
2025-06-09 12:37:31,321 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 12:38:21,254 - src.core.embeddings - INFO - Memory usage: RSS=1110.25 MB, VMS=3317.50 MB
2025-06-09 12:38:21,255 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 12:40:11,598 - src.core.embeddings - INFO - Memory usage: RSS=1196.95 MB, VMS=3400.89 MB
2025-06-09 12:40:11,599 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 12:42:01,166 - src.core.embeddings - INFO - Memory usage: RSS=1339.38 MB, VMS=3569.70 MB
2025-06-09 12:42:01,166 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 12:43:06,837 - src.core.embeddings - INFO - Memory usage: RSS=1261.58 MB, VMS=3590.61 MB
2025-06-09 12:43:07,309 - src.core.embeddings - INFO - Embedding generation took 439.77 seconds
2025-06-09 12:43:07,310 - src.core.embeddings - INFO - Memory usage: RSS=1261.58 MB, VMS=3590.61 MB
2025-06-09 12:43:07,310 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 12:43:08,856 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 12:43:11,189 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 12:43:11,214 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 12:43:11,215 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 12:43:11,216 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.90 seconds
2025-06-09 12:43:11,217 - src.core.embeddings - INFO - Memory usage: RSS=1477.52 MB, VMS=3944.33 MB
2025-06-09 12:43:11,242 - src.core.embeddings - INFO - Total embedding generation took 478.22 seconds
2025-06-09 12:43:11,307 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 12:43:11,308 - src.utils.config - INFO - Loading environment variables
2025-06-09 12:43:11,311 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 12:43:11,312 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 12:43:11,494 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId']
2025-06-09 12:43:11,494 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 12:43:11,495 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 12:43:11,496 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 12:43:11,498 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 12:43:11,507 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 12:43:11,509 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 12:43:11,509 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 12:43:11,512 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 12:43:11,512 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 12:43:14,578 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 12:43:14,617 - src.core.analysis - INFO - Starting analysis
2025-06-09 12:43:14,619 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 12:43:20,257 - src.analysis.access_pattern - ERROR - Error analyzing access patterns: 'Groups'
2025-06-09 12:43:20,257 - src.core.analysis - ERROR - Error during analysis: 'Groups'
Traceback (most recent call last):
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2034, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Yaser.F\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Groups'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 323, in analyze
    underutilized = analyze_access_patterns(
        state["context"],
    ...<5 lines>...
        state["signin_logs"]
    )
  File "D:\Production\backend\src\analysis\access_pattern.py", line 57, in analyze_access_patterns
    groups = row["Groups"].split(", ") if row["Groups"] else []
                                          ~~~^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Groups'
2025-06-09 12:47:30,841 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 12:47:58,356 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 12:47:58,668 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 12:47:58,669 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 12:47:58,670 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 12:47:58,670 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 12:48:55,654 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 12:49:02,963 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 12:49:02,964 - src.core.embeddings - INFO - Embedding initialization took 64.29 seconds
2025-06-09 12:49:02,967 - src.core.embeddings - INFO - Memory usage: RSS=504.26 MB, VMS=2699.10 MB
2025-06-09 12:49:02,968 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 12:49:02,970 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 12:49:02,975 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 12:49:03,009 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-09 12:49:05,064 - src.core.embeddings - INFO - Text generation took 2.09 seconds
2025-06-09 12:49:05,064 - src.core.embeddings - INFO - Memory usage: RSS=533.57 MB, VMS=2728.01 MB
2025-06-09 12:49:05,065 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 12:49:10,171 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 12:49:10,173 - src.core.embeddings - INFO - Document conversion took 5.11 seconds
2025-06-09 12:49:10,174 - src.core.embeddings - INFO - Memory usage: RSS=569.72 MB, VMS=2764.08 MB
2025-06-09 12:49:10,175 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 12:49:10,179 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 12:49:59,073 - src.core.embeddings - INFO - Memory usage: RSS=676.42 MB, VMS=2883.82 MB
2025-06-09 12:49:59,074 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 12:50:48,917 - src.core.embeddings - INFO - Memory usage: RSS=755.55 MB, VMS=2963.26 MB
2025-06-09 12:50:48,918 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 12:51:46,482 - src.core.embeddings - INFO - Memory usage: RSS=822.53 MB, VMS=3030.07 MB
2025-06-09 12:51:46,485 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 12:52:38,454 - src.core.embeddings - INFO - Memory usage: RSS=895.30 MB, VMS=3104.06 MB
2025-06-09 12:52:38,455 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 12:53:24,929 - src.core.embeddings - INFO - Memory usage: RSS=976.75 MB, VMS=3184.89 MB
2025-06-09 12:53:24,929 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 12:54:10,600 - src.core.embeddings - INFO - Memory usage: RSS=1100.78 MB, VMS=3315.72 MB
2025-06-09 12:54:10,601 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 12:54:45,571 - src.core.embeddings - INFO - Memory usage: RSS=1320.33 MB, VMS=3532.57 MB
2025-06-09 12:54:45,572 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 12:55:23,189 - src.core.embeddings - INFO - Memory usage: RSS=1430.01 MB, VMS=3641.61 MB
2025-06-09 12:55:23,189 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 12:55:45,379 - src.core.embeddings - INFO - Memory usage: RSS=1470.16 MB, VMS=3681.96 MB
2025-06-09 12:55:45,809 - src.core.embeddings - INFO - Embedding generation took 395.63 seconds
2025-06-09 12:55:45,810 - src.core.embeddings - INFO - Memory usage: RSS=1470.16 MB, VMS=3681.96 MB
2025-06-09 12:55:45,810 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 12:55:46,972 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 12:55:48,644 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 12:55:48,670 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 12:55:48,671 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 12:55:48,672 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.86 seconds
2025-06-09 12:55:48,673 - src.core.embeddings - INFO - Memory usage: RSS=1685.42 MB, VMS=4036.23 MB
2025-06-09 12:55:48,684 - src.core.embeddings - INFO - Total embedding generation took 470.02 seconds
2025-06-09 12:55:48,735 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 12:55:48,736 - src.utils.config - INFO - Loading environment variables
2025-06-09 12:55:48,739 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 12:55:48,740 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 12:55:48,840 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId']
2025-06-09 12:55:48,841 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 12:55:48,841 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 12:55:48,842 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 12:55:48,842 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 12:55:48,847 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 12:55:48,848 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 12:55:48,849 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 12:55:48,849 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 12:55:48,850 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 12:55:50,691 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 12:55:50,716 - src.core.analysis - INFO - Starting analysis
2025-06-09 12:55:50,717 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 12:55:53,219 - src.analysis.access_pattern - ERROR - Error analyzing access patterns: 'Groups'
2025-06-09 12:55:53,220 - src.core.analysis - ERROR - Error during analysis: 'Groups'
Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Groups'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 323, in analyze
    underutilized = analyze_access_patterns(
        state["context"],
    ...<5 lines>...
        state["signin_logs"]
    )
  File "D:\Production\backend\src\analysis\access_pattern.py", line 57, in analyze_access_patterns
    groups = row["Groups"].split(", ") if row["Groups"] else []
                                          ~~~^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Groups'
2025-06-09 12:55:53,397 - src.core.analysis - ERROR - Failed to run analysis: 'Groups'
Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Groups'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 769, in run_analysis
    result = await app.ainvoke({
             ^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    })
    ^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2788, in ainvoke
    async for chunk in self.astream(
    ...<19 lines>...
            chunks.append(chunk)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2655, in astream
    async for _ in runner.atick(
    ...<7 lines>...
            yield o
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\runner.py", line 294, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\retry.py", line 136, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 672, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
        step.ainvoke(input, config, **kwargs), context=context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 440, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Production\backend\src\core\analysis.py", line 323, in analyze
    underutilized = analyze_access_patterns(
        state["context"],
    ...<5 lines>...
        state["signin_logs"]
    )
  File "D:\Production\backend\src\analysis\access_pattern.py", line 57, in analyze_access_patterns
    groups = row["Groups"].split(", ") if row["Groups"] else []
                                          ~~~^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Groups'
During task with name 'analyze' and id '58608b53-8dc1-ea44-0cb2-dff01a374001'
2025-06-09 12:58:14,347 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 13:02:03,984 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 13:02:33,121 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 13:02:36,939 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 13:02:37,158 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 13:02:37,158 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 13:02:37,159 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 13:02:37,160 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 13:03:20,464 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 13:03:27,291 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 13:03:27,292 - src.core.embeddings - INFO - Embedding initialization took 50.13 seconds
2025-06-09 13:03:27,292 - src.core.embeddings - INFO - Memory usage: RSS=509.98 MB, VMS=2698.46 MB
2025-06-09 13:03:27,293 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 13:03:27,293 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 13:03:27,296 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 13:03:27,317 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 13:03:28,263 - src.core.embeddings - INFO - Text generation took 0.97 seconds
2025-06-09 13:03:28,264 - src.core.embeddings - INFO - Memory usage: RSS=538.98 MB, VMS=2727.14 MB
2025-06-09 13:03:28,265 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 13:03:30,494 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 13:03:30,494 - src.core.embeddings - INFO - Document conversion took 2.23 seconds
2025-06-09 13:03:30,495 - src.core.embeddings - INFO - Memory usage: RSS=575.18 MB, VMS=2763.21 MB
2025-06-09 13:03:30,495 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 13:03:30,498 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 13:03:49,559 - src.core.embeddings - INFO - Memory usage: RSS=737.84 MB, VMS=2945.00 MB
2025-06-09 13:03:49,560 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 13:04:13,975 - src.core.embeddings - INFO - Memory usage: RSS=809.35 MB, VMS=3016.27 MB
2025-06-09 13:04:13,976 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 13:04:29,267 - src.core.embeddings - INFO - Memory usage: RSS=887.39 MB, VMS=3094.20 MB
2025-06-09 13:04:29,268 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 13:04:49,870 - src.core.embeddings - INFO - Memory usage: RSS=961.01 MB, VMS=3167.34 MB
2025-06-09 13:04:49,870 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 13:05:20,772 - src.core.embeddings - INFO - Memory usage: RSS=1034.66 MB, VMS=3241.74 MB
2025-06-09 13:05:20,772 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 13:05:55,702 - src.core.embeddings - INFO - Memory usage: RSS=1088.79 MB, VMS=3315.86 MB
2025-06-09 13:05:55,705 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 13:07:25,033 - src.core.embeddings - INFO - Memory usage: RSS=946.07 MB, VMS=3339.42 MB
2025-06-09 13:07:25,034 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 13:09:42,434 - src.core.embeddings - INFO - Memory usage: RSS=1147.04 MB, VMS=3563.39 MB
2025-06-09 13:09:42,435 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 13:10:40,012 - src.core.embeddings - INFO - Memory usage: RSS=1172.87 MB, VMS=3588.31 MB
2025-06-09 13:10:40,566 - src.core.embeddings - INFO - Embedding generation took 430.07 seconds
2025-06-09 13:10:40,567 - src.core.embeddings - INFO - Memory usage: RSS=1171.88 MB, VMS=3588.31 MB
2025-06-09 13:10:40,570 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 13:10:42,300 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 13:10:45,327 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 13:10:45,373 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 13:10:45,375 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 13:10:45,376 - src.core.embeddings - INFO - FAISS vectorstore creation took 4.81 seconds
2025-06-09 13:10:45,377 - src.core.embeddings - INFO - Memory usage: RSS=1391.89 MB, VMS=3942.23 MB
2025-06-09 13:10:45,452 - src.core.embeddings - INFO - Total embedding generation took 488.29 seconds
2025-06-09 13:10:45,519 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 13:10:45,520 - src.utils.config - INFO - Loading environment variables
2025-06-09 13:10:45,527 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 13:10:45,528 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 13:10:45,888 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 13:10:45,889 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 13:10:45,890 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 13:10:45,891 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 13:10:45,891 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 13:10:45,904 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 13:10:45,905 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 13:10:45,905 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 13:10:45,906 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 13:10:45,907 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 13:10:50,603 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 13:10:50,667 - src.core.analysis - INFO - Starting analysis
2025-06-09 13:10:50,668 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 13:10:56,663 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 13:10:56,664 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 13:10:56,665 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 13:10:56,665 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 13:10:56,666 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 13:10:56,666 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 13:10:56,667 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 13:10:56,689 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 13:10:56,731 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 13:10:56,797 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 13:10:56,806 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 13:10:56,807 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 13:10:56,808 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 13:10:56,809 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 13:10:56,811 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 13:10:56,812 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 13:10:56,814 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 13:10:56,815 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 13:10:56,816 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 13:10:56,817 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 13:10:56,817 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 13:10:56,818 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 13:10:56,818 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 13:10:56,819 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 13:10:56,819 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 13:10:56,820 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 13:11:01,213 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 13:11:01,213 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 13:11:01,214 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 13:11:01,214 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 13:11:01,215 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 13:11:01,216 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 13:11:03,459 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 13:11:03,460 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 13:11:03,713 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 13:11:03,825 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 13:11:05,234 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 13:11:05,235 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 13:11:05,237 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 13:11:05,238 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 13:11:05,238 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 13:11:05,264 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 13:11:05,265 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 13:11:05,282 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 13:11:05,283 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 13:11:08,334 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 13:11:08,336 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 13:11:08,380 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 13:11:08,381 - src.core.analysis - INFO - Using chunk size: 15 for 537 users
2025-06-09 13:11:08,383 - src.core.analysis - INFO - Processing 36 chunks sequentially
2025-06-09 13:11:08,388 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 13:11:08,389 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 16537 bytes
2025-06-09 13:11:52,674 - src.core.analysis - INFO - Findings chunk 1 completed in 44.29s
2025-06-09 13:11:52,675 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:12:22,681 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 13:12:22,683 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 14728 bytes
2025-06-09 13:12:33,989 - src.core.analysis - INFO - Findings chunk 2 completed in 11.31s
2025-06-09 13:12:33,990 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:13:04,003 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 13:13:04,004 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 18213 bytes
2025-06-09 13:13:18,943 - src.core.analysis - INFO - Findings chunk 3 completed in 14.94s
2025-06-09 13:13:18,944 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:13:48,956 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-09 13:13:48,957 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 14628 bytes
2025-06-09 13:14:24,453 - src.core.analysis - INFO - Findings chunk 4 completed in 35.50s
2025-06-09 13:14:24,453 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:14:54,469 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 5
2025-06-09 13:14:54,470 - src.core.analysis - INFO - Processing findings chunk 5 with data size: 16690 bytes
2025-06-09 13:15:35,733 - src.core.analysis - INFO - Findings chunk 5 completed in 41.26s
2025-06-09 13:15:35,734 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:16:05,744 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 6
2025-06-09 13:16:05,745 - src.core.analysis - INFO - Processing findings chunk 6 with data size: 16556 bytes
2025-06-09 13:16:45,069 - src.core.analysis - INFO - Findings chunk 6 completed in 39.32s
2025-06-09 13:16:45,069 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:17:15,071 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 7
2025-06-09 13:17:15,075 - src.core.analysis - INFO - Processing findings chunk 7 with data size: 18483 bytes
2025-06-09 13:17:41,846 - src.core.analysis - INFO - Findings chunk 7 completed in 26.77s
2025-06-09 13:17:41,847 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:18:11,850 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 8
2025-06-09 13:18:11,851 - src.core.analysis - INFO - Processing findings chunk 8 with data size: 16770 bytes
2025-06-09 13:18:27,917 - src.core.analysis - INFO - Findings chunk 8 completed in 16.07s
2025-06-09 13:18:27,918 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:18:57,924 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 9
2025-06-09 13:18:57,926 - src.core.analysis - INFO - Processing findings chunk 9 with data size: 15945 bytes
2025-06-09 13:19:11,856 - src.core.analysis - INFO - Findings chunk 9 completed in 13.93s
2025-06-09 13:19:11,856 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:19:41,861 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 10
2025-06-09 13:19:41,864 - src.core.analysis - INFO - Processing findings chunk 10 with data size: 16251 bytes
2025-06-09 13:19:59,232 - src.core.analysis - INFO - Findings chunk 10 completed in 17.37s
2025-06-09 13:19:59,232 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:20:29,248 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 11
2025-06-09 13:20:29,249 - src.core.analysis - INFO - Processing findings chunk 11 with data size: 17156 bytes
2025-06-09 13:20:40,675 - src.core.analysis - INFO - Findings chunk 11 completed in 11.43s
2025-06-09 13:20:40,676 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:21:10,689 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 12
2025-06-09 13:21:10,690 - src.core.analysis - INFO - Processing findings chunk 12 with data size: 15633 bytes
2025-06-09 13:21:46,339 - src.core.analysis - INFO - Findings chunk 12 completed in 35.65s
2025-06-09 13:21:46,339 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:22:16,347 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 13
2025-06-09 13:22:16,348 - src.core.analysis - INFO - Processing findings chunk 13 with data size: 13481 bytes
2025-06-09 13:22:50,869 - src.core.analysis - INFO - Findings chunk 13 completed in 34.52s
2025-06-09 13:22:50,870 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:23:20,878 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 14
2025-06-09 13:23:20,879 - src.core.analysis - INFO - Processing findings chunk 14 with data size: 13397 bytes
2025-06-09 13:23:58,718 - src.core.analysis - INFO - Findings chunk 14 completed in 37.84s
2025-06-09 13:23:58,719 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:24:28,731 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 15
2025-06-09 13:24:28,732 - src.core.analysis - INFO - Processing findings chunk 15 with data size: 21859 bytes
2025-06-09 13:24:48,773 - src.core.analysis - INFO - Findings chunk 15 completed in 20.04s
2025-06-09 13:24:48,774 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:25:18,779 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 16
2025-06-09 13:25:18,780 - src.core.analysis - INFO - Processing findings chunk 16 with data size: 17117 bytes
2025-06-09 13:25:30,798 - src.core.analysis - INFO - Findings chunk 16 completed in 12.02s
2025-06-09 13:25:30,798 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:26:00,802 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 17
2025-06-09 13:26:00,808 - src.core.analysis - INFO - Processing findings chunk 17 with data size: 17175 bytes
2025-06-09 13:26:40,108 - src.core.analysis - INFO - Findings chunk 17 completed in 39.30s
2025-06-09 13:26:40,109 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:27:10,116 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 18
2025-06-09 13:27:10,117 - src.core.analysis - INFO - Processing findings chunk 18 with data size: 15329 bytes
2025-06-09 13:28:02,512 - src.core.analysis - INFO - Findings chunk 18 completed in 52.39s
2025-06-09 13:28:02,513 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:28:32,514 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 19
2025-06-09 13:28:32,515 - src.core.analysis - INFO - Processing findings chunk 19 with data size: 18467 bytes
2025-06-09 13:28:52,056 - src.core.analysis - INFO - Findings chunk 19 completed in 19.54s
2025-06-09 13:28:52,056 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:29:22,071 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 20
2025-06-09 13:29:22,072 - src.core.analysis - INFO - Processing findings chunk 20 with data size: 15607 bytes
2025-06-09 13:29:33,364 - src.core.analysis - INFO - Findings chunk 20 completed in 11.29s
2025-06-09 13:29:33,366 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:30:03,370 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 21
2025-06-09 13:30:03,371 - src.core.analysis - INFO - Processing findings chunk 21 with data size: 15276 bytes
2025-06-09 13:30:24,136 - src.core.analysis - INFO - Findings chunk 21 completed in 20.77s
2025-06-09 13:30:24,137 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:30:54,153 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 22
2025-06-09 13:30:54,156 - src.core.analysis - INFO - Processing findings chunk 22 with data size: 14166 bytes
2025-06-09 13:31:38,983 - src.core.analysis - INFO - Findings chunk 22 completed in 44.83s
2025-06-09 13:31:38,984 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:32:08,986 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 23
2025-06-09 13:32:08,990 - src.core.analysis - INFO - Processing findings chunk 23 with data size: 16963 bytes
2025-06-09 13:32:31,923 - src.core.analysis - INFO - Findings chunk 23 completed in 22.94s
2025-06-09 13:32:31,923 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:33:01,925 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 24
2025-06-09 13:33:01,929 - src.core.analysis - INFO - Processing findings chunk 24 with data size: 14403 bytes
2025-06-09 13:33:13,557 - src.core.analysis - INFO - Findings chunk 24 completed in 11.63s
2025-06-09 13:33:13,558 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:33:43,561 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 25
2025-06-09 13:33:43,564 - src.core.analysis - INFO - Processing findings chunk 25 with data size: 15870 bytes
2025-06-09 13:33:58,781 - src.core.analysis - INFO - Findings chunk 25 completed in 15.22s
2025-06-09 13:33:58,782 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:34:28,784 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 26
2025-06-09 13:34:28,785 - src.core.analysis - INFO - Processing findings chunk 26 with data size: 13428 bytes
2025-06-09 13:34:44,542 - src.core.analysis - INFO - Findings chunk 26 completed in 15.76s
2025-06-09 13:34:44,542 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:35:14,549 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 27
2025-06-09 13:35:14,551 - src.core.analysis - INFO - Processing findings chunk 27 with data size: 16440 bytes
2025-06-09 13:35:26,187 - src.core.analysis - INFO - Findings chunk 27 completed in 11.64s
2025-06-09 13:35:26,188 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:35:56,198 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 28
2025-06-09 13:35:56,200 - src.core.analysis - INFO - Processing findings chunk 28 with data size: 18751 bytes
2025-06-09 13:36:17,666 - src.core.analysis - INFO - Findings chunk 28 completed in 21.47s
2025-06-09 13:36:17,667 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:36:47,680 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 29
2025-06-09 13:36:47,683 - src.core.analysis - INFO - Processing findings chunk 29 with data size: 15139 bytes
2025-06-09 13:37:23,253 - src.core.analysis - INFO - Findings chunk 29 completed in 35.57s
2025-06-09 13:37:23,253 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:37:53,266 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 30
2025-06-09 13:37:53,267 - src.core.analysis - INFO - Processing findings chunk 30 with data size: 15886 bytes
2025-06-09 13:38:36,439 - src.core.analysis - INFO - Findings chunk 30 completed in 43.17s
2025-06-09 13:38:36,440 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:39:06,453 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 31
2025-06-09 13:39:06,454 - src.core.analysis - INFO - Processing findings chunk 31 with data size: 14407 bytes
2025-06-09 13:39:49,794 - src.core.analysis - INFO - Findings chunk 31 completed in 43.34s
2025-06-09 13:39:49,794 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:40:19,797 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 32
2025-06-09 13:40:19,801 - src.core.analysis - INFO - Processing findings chunk 32 with data size: 13829 bytes
2025-06-09 13:41:15,738 - src.core.analysis - INFO - Findings chunk 32 completed in 55.94s
2025-06-09 13:41:15,738 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:41:45,744 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 33
2025-06-09 13:41:45,748 - src.core.analysis - INFO - Processing findings chunk 33 with data size: 15367 bytes
2025-06-09 13:42:45,183 - src.core.analysis - INFO - Findings chunk 33 completed in 59.44s
2025-06-09 13:42:45,184 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:43:15,197 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 34
2025-06-09 13:43:15,198 - src.core.analysis - INFO - Processing findings chunk 34 with data size: 17135 bytes
2025-06-09 13:43:38,427 - src.core.analysis - INFO - Findings chunk 34 completed in 23.23s
2025-06-09 13:43:38,427 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:44:08,437 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 35
2025-06-09 13:44:08,437 - src.core.analysis - INFO - Processing findings chunk 35 with data size: 14683 bytes
2025-06-09 13:44:49,266 - src.core.analysis - INFO - Findings chunk 35 completed in 40.83s
2025-06-09 13:44:49,267 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:45:19,271 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 36
2025-06-09 13:45:19,272 - src.core.analysis - INFO - Processing findings chunk 36 with data size: 15171 bytes
2025-06-09 13:45:30,874 - src.core.analysis - INFO - Findings chunk 36 completed in 11.60s
2025-06-09 13:45:30,875 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:46:00,900 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 13:46:00,908 - src.core.analysis - INFO - Processed 1/36 chunks (2%)
2025-06-09 13:46:00,909 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 13:46:00,909 - src.core.analysis - INFO - Processed 2/36 chunks (5%)
2025-06-09 13:46:00,910 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 13:46:00,911 - src.core.analysis - INFO - Processed 3/36 chunks (8%)
2025-06-09 13:46:00,911 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-09 13:46:00,912 - src.core.analysis - INFO - Processed 4/36 chunks (11%)
2025-06-09 13:46:00,913 - src.core.analysis - INFO - LLM response parsed successfully for chunk 5
2025-06-09 13:46:00,914 - src.core.analysis - INFO - Processed 5/36 chunks (13%)
2025-06-09 13:46:00,914 - src.core.analysis - INFO - LLM response parsed successfully for chunk 6
2025-06-09 13:46:00,915 - src.core.analysis - INFO - Processed 6/36 chunks (16%)
2025-06-09 13:46:00,916 - src.core.analysis - INFO - LLM response parsed successfully for chunk 7
2025-06-09 13:46:00,916 - src.core.analysis - INFO - Processed 7/36 chunks (19%)
2025-06-09 13:46:00,917 - src.core.analysis - INFO - LLM response parsed successfully for chunk 8
2025-06-09 13:46:00,917 - src.core.analysis - INFO - Processed 8/36 chunks (22%)
2025-06-09 13:46:00,918 - src.core.analysis - INFO - LLM response parsed successfully for chunk 9
2025-06-09 13:46:00,919 - src.core.analysis - INFO - Processed 9/36 chunks (25%)
2025-06-09 13:46:00,919 - src.core.analysis - INFO - LLM response parsed successfully for chunk 10
2025-06-09 13:46:00,920 - src.core.analysis - INFO - Processed 10/36 chunks (27%)
2025-06-09 13:46:00,920 - src.core.analysis - INFO - LLM response parsed successfully for chunk 11
2025-06-09 13:46:00,921 - src.core.analysis - INFO - Processed 11/36 chunks (30%)
2025-06-09 13:46:00,922 - src.core.analysis - INFO - LLM response parsed successfully for chunk 12
2025-06-09 13:46:00,922 - src.core.analysis - INFO - Processed 12/36 chunks (33%)
2025-06-09 13:46:00,923 - src.core.analysis - INFO - LLM response parsed successfully for chunk 13
2025-06-09 13:46:00,923 - src.core.analysis - INFO - Processed 13/36 chunks (36%)
2025-06-09 13:46:00,924 - src.core.analysis - INFO - LLM response parsed successfully for chunk 14
2025-06-09 13:46:00,925 - src.core.analysis - INFO - Processed 14/36 chunks (38%)
2025-06-09 13:46:00,925 - src.core.analysis - INFO - LLM response parsed successfully for chunk 15
2025-06-09 13:46:00,926 - src.core.analysis - INFO - Processed 15/36 chunks (41%)
2025-06-09 13:46:00,927 - src.core.analysis - INFO - LLM response parsed successfully for chunk 16
2025-06-09 13:46:00,927 - src.core.analysis - INFO - Processed 16/36 chunks (44%)
2025-06-09 13:46:00,928 - src.core.analysis - INFO - LLM response parsed successfully for chunk 17
2025-06-09 13:46:00,928 - src.core.analysis - INFO - Processed 17/36 chunks (47%)
2025-06-09 13:46:00,935 - src.core.analysis - WARNING - JSON parsing error: Unterminated string starting at: line 403 column 17 (char 18177). Attempting to fix unterminated string.
2025-06-09 13:46:00,938 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "19a3a1ac-6d27-ed11-9db1-000d3adaff3c": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "5bcb8f80-9cb9-ec11-983f-000d3a65c37c": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "a6502afb-a2c2-eb11-bacc-0022489c4a92": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "e123b6b4-0e8a-ef11-ac21-000d3a6685a9": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "c4f22425-b87e-ec11-8d21-0022489be1a8": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Mohammed Shibu": "Unusual location: Gurgaon, IN at 2025-05-26 14:...",
        "Mohit Kumar Saini": "Unusual sign-in time: 2025-05-31 23:55:31 (hour...",
        "Subramanian P #": "Unusual location: Mumbai, IN at 2025-05-07 10:2...",
        "Anbreen Azim": "Unusual location: Muhaysnah, AE at 2025-05-26 0..."
    },
    "mismatches": {
        "a6502afb-a2c2-eb11-bacc-0022489c4a92": [
            "Excessive permission: Basic User. Expected for Paramount: None",
            "Excessive permission: Customer service app access. Expected for Paramount: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for Paramount: None",
            "Excessive permission: PCS Sales User. Expected for Paramount: None",
            "Excessive permission: Sales Enterprise app access. Expected for Paramount: None",
            "Permission 'Basic User' assigned but no activity in app 'unknown'",
            "Permission 'Customer service app access' assigned but no activity in app 'unknown'",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS Sales User' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "c4f22425-b87e-ec11-8d21-0022489be1a8": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Excessive permission: System Administrator. Expected for PCS Employees - UAE: None",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'",
            "Permission 'System Administrator' assigned but no activity in app 'unknown'"
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across multiple users, particularly in PCS and Paramount roles.",
        "unused_roles": {
            "PCS-Related": [
                "PCS XDR Monitoring",
                "PCS-GRC-LAB-USERS",
                "PCS-IT-ADMIN",
                "PCS Alfanar Manual Tracker Data",
                "PCS-Sales",
                "PCS AIP Users",
                "PCS-MSS-TAMKEEN",
                "PCS-NBK Project Team",
                "PCS Employees - Bahrain",
                "PCS_Jumaalmajid",
                "PCS-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCS-QAPCO-USERS",
                "PCS-BRM",
                "SOC - PCS",
                "PCS Business Reviews",
                "PCSKWT",
                "PCS- KSA Freelancers",
                "PCS - Outsourced Team",
                "PCS Qatar - Delivery",
                "PCS-MSS-AIR-ARABIA",
                "PCS_UAE-Internal",
                "PCS-MSS-ALWASL",
                "PCS-Consulting Services",
                "PCS-MSS-BM",
                "PCSUAEBiz",
                "PCS -LDP",
                "PCS Outsourced Team",
                "PCS Employees - Saudi",
                "PCS MSS Team",
                "PCS Technical",
                "PCS- GII- Infosec Team",
                "PCS - Ajman Municipality",
                "PCS-MSS-MBRHE",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-Dubai Culture",
                "PCS Qatar - Presales",
                "PCS Employees - Kuwait",
                "PCS- Kuwait Support",
                "PCS-MSS-DCAA",
                "PCS MATRIX",
                "PCS MSO XDR Monitoring Team",
                "PCS-ELSATIC-LAB-USERS",
                "PCS-Sentinel",
                "PCS-MSS-MIRAL",
                "PCS Admin",
                "PCSAIPOLD"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Silver-ParamountMXDR360",
                "Paramount CSR",
                "Paramount Audit",
                "Paramount Intune Enrolled Users Group",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Sales Team"
            ],
            "General": [
                "Department_Cloud Services",
                "Sales Assistant",
                "Intune Administrator",
                "DHA Sentinel Offshore",
                "Intune Compliance windows 10",
                "AKI_SOC",
                "Intune MAM light Policy",
                "Department_MSS",
                "Global PMO CoE",
                "CyberNxt - Talent Cloud",
                "Dynamics 365 Support",
                "altaf",
                "Appreciations Tracker",
                "IGA Project",
                "PAM Team",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "MSS-SOC-Sentinel-India",
                "Department_Marketing",
                "KFCA IT IOT Assessment",
                "IT Test",
                "Testing",
                "Department_Consulting Services",
                "Sentinel Cyber Defence Team",
                "Presales - OT Security",
                "SCT Project Delivery",
                "Sentinel Projects",
                "Woqod - Qatar Fuel",
                "CyberNxt - Dashboard",
                "Content Management Group",
                "Qatar CSR",
                "Coresecurity/Tech Projects",
                "MRM Submission 2024",
                "Department_Renewals - Core Security",
                "SG_Data Security_Users",
                "Security Operator",
                "Invoices | Ahlan Cyber",
                "BFSI and O&G",
                "Evanssion Visit",
                "Sharing Weekly Internal PPT",
                "Weekly Sales Report",
                "SG_IAM_Users",
                "Internship 2024",
                "NBO Project",
                "Learning Plan",
                "MSS SOC Team",
                "KSA Invoicing",
                "M365 Copilot",
                "IAM Projects - Test",
                "Team MSS",
                "Staffing",
                "Azure Information Protection Administrator",
                "EDGE Service Delivery",
                "DHA Offshore SOC Team",
                "Qatar Sales",
                "OT-D-A-V-S",
                "Cloud Sec Documents",
                "Business Excellence",
                "6clicks-role-Administrator",
                "ahalnees",
                "Order Booking",
                "Security Co-Pilot",
                "Vivalearn - Integration testing",
                "Resource Management",
                "Microsoft 365 Business Premium Licensed Users",
                "IAM Delivery Team",
                "Department_Data Privacy",
                "FortiGate SSL VPN Access",
                "Department_Administration",
                "SCS-Employee",
                "Cybersecurity NxxT Team",
                "SALES TEAM - BAHRAIN",
                "Ahlan Cyber - OPAS",
                "Alpheya_Sentinel_Soc",
                "Department_GRC",
                "Global Administrator",
                "Talent Acquisition",
                "SG_Sales_Users",
                "Emaar Data classification/AIP/FP",
                "MOCA",
                "SOC - Scope Investment",
                "Ahlan Cyber -Presales",
                "SOC Banque Misr",
                "RLS-Project Plan",
                "SG_Finance_Users",
                "Qatar SOC 2 Audit",
                "KSA Region-Internal",
                "Sentinel Documents",
                "IDO Meeting RAK",
                "sales group",
                "STC Project",
                "NBF- AIP Project",
                "MSS-ABG",
                "Submission of Pending TNA Forms",
                "CA002 Policy exclusion -  non admins",
                "SG_Infrastructure Security_Users",
                "4.x- Schneider-OT",
                "MSS-EWEC-Admin",
                "DLP Test",
                "Teams_Group_FARAH EXPERIENCES",
                "Securus 360",
                "Ahlan Sales",
                "Project Status",
                "CSNxxT-Employees",
                "MSS-JAMG",
                "SentinelSME",
                "Teams_Group_KYNDRYL",
                "Identity Workshop",
                "Department_Data Security",
                "Dynamics 365 Sales",
                "Fifa game test",
                "Daman Project",
                "Department_Finance",
                "SailPoint Training",
                "SG_Staffing Solutions_Users",
                "Team Kuwait Projects",
                "The Executive Council",
                "Team Kuwait",
                "Data Protection Cloud Services",
                "Presales_TechMSS",
                "Microsoft Fasttrack-RFA",
                "FP&A",
                "Consulting-Presales",
                "Qatar OPAS",
                "LetsDefend SOC Alerts",
                "SG_Management_Users",
                "Security Sales Department",
                "Tamkeen-Data Classification Project",
                "SG_Cloud Services_Users",
                "DC-SOC",
                "Global Reader",
                "MSS-ALFANAR",
                "From GulfIT- QNB CLM Keyfacotr",
                "Microsoft 365 Business Standard Licensed Users",
                "SG_MSS_Users",
                "Farah",
                "SG_GRC_Users",
                "Edge week and month report",
                "SOC Tamkeen",
                "Microsoft Projects",
                "Internship",
                "License Administrator",
                "KIB_GROUP",
                "IAM Projects",
                "Cloud Security",
                "Mashreq Data Classification Project",
                "ISO Delivery",
                "Dukhan Bank IAM assessment project",
                "Intune MAM Policy Exclusion",
                "Qatar Finance & Admin",
                "SG_Data Privacy_Users",
                "Miral SOC Group",
                "Team Qatar",
                "Intune App Testing",
                "RLS-Project-Group",
                "Intune Enroll Excluded Users",
                "Department_Staffing Solutions",
                "DATA SECURITY TEAM",
                "Gulf Islamic Investment (GII)",
                "GDP- Marketing blitzkrieg",
                "MSS-DCAA",
                "Billing Details",
                "Test Team - SOC",
                "CISSP Training 2021",
                "Pcs DLP Policy Group",
                "Qatar -Presales",
                "DAG Group - Security Assessment",
                "Department_Management",
                "HR-ConfidentialLabel",
                "Sales-UAE",
                "SOC MBRHE",
                "Pre-Sales - Consulting",
                "SG_Consulting Services_Users",
                "CISCO FIFA RFP",
                "Test RLS-Project plan",
                "Microsoft Elite",
                "SG_Renewals- Core Security_Users",
                "Teams_Group_MSO_EDGE",
                "Department_Infrastructure Security",
                "Infra Security BU",
                "Dukhan Bank IAM Assessment",
                "Bahrain Support",
                "IDAM Team",
                "MyITBuddy",
                "Department_OT Security",
                "ISO 27001:2022 LA Training",
                "OT - Reading resources",
                "SG_OT Security_Users",
                "KIB_GRC",
                "Corporate Governing Council",
                "Dubai Metro Blue Line",
                "PMO",
                "PartnerCenter_MPNAdmin",
                "Ahlan Cyber Knowledge Base",
                "Internal Team",
                "MSS
2025-06-09 13:46:00,949 - src.core.analysis - INFO - LLM response parsed successfully for chunk 18
2025-06-09 13:46:00,949 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 18 response: {}
2025-06-09 13:46:00,951 - src.core.analysis - INFO - LLM response parsed successfully for chunk 19
2025-06-09 13:46:00,952 - src.core.analysis - INFO - Processed 18/36 chunks (50%)
2025-06-09 13:46:00,953 - src.core.analysis - INFO - LLM response parsed successfully for chunk 20
2025-06-09 13:46:00,954 - src.core.analysis - INFO - Processed 19/36 chunks (52%)
2025-06-09 13:46:00,954 - src.core.analysis - INFO - LLM response parsed successfully for chunk 21
2025-06-09 13:46:00,955 - src.core.analysis - INFO - Processed 20/36 chunks (55%)
2025-06-09 13:46:00,957 - src.core.analysis - WARNING - JSON parsing error: Unterminated string starting at: line 427 column 49 (char 18437). Attempting to fix unterminated string.
2025-06-09 13:46:00,958 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "418cf370-1c30-ed11-9db1-000d3a65164f": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "7f610e67-fa3f-ee11-bdf3-000d3a669ba8": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "5d30d823-f5ea-ef11-be20-6045bddd1bad": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "48747db0-413b-ee11-bdf4-000d3adc8967": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Bharat Devashi Luva": "Unusual location: Dubayy, AE at 2025-05-27 06:5...",
        "Meghna Muralidharan": "Unusual sign-in time: 2025-05-29 19:07:58 (hour..."
    },
    "mismatches": {
        "5d30d823-f5ea-ef11-be20-6045bddd1bad": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "48747db0-413b-ee11-bdf4-000d3adc8967": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across multiple users, including PCS and Paramount roles.",
        "unused_roles": {
            "PCS-Related": [
                "PCS XDR Monitoring",
                "PCS-GRC-LAB-USERS",
                "PCS-IT-ADMIN",
                "PCS Alfanar Manual Tracker Data",
                "PCS-Sales",
                "PCS AIP Users",
                "PCS-MSS-TAMKEEN",
                "PCS-NBK Project Team",
                "PCS Employees - Bahrain",
                "PCS_Jumaalmajid",
                "PCS-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCS-QAPCO-USERS",
                "PCS-BRM",
                "SOC - PCS",
                "PCS Business Reviews",
                "PCSKWT",
                "PCS- KSA Freelancers",
                "PCS - Outsourced Team",
                "PCS Qatar - Delivery",
                "PCS-MSS-AIR-ARABIA",
                "PCS_UAE-Internal",
                "PCS-MSS-ALWASL",
                "PCS-Consulting Services",
                "PCS-MSS-BM",
                "PCSUAEBiz",
                "PCS -LDP",
                "PCS Outsourced Team",
                "PCS Employees - Saudi",
                "PCS MSS Team",
                "PCS Technical",
                "PCS- GII- Infosec Team",
                "PCS - Ajman Municipality",
                "PCS-MSS-MBRHE",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-Dubai Culture",
                "PCS Qatar - Presales",
                "PCS Employees - Kuwait",
                "PCS- Kuwait Support",
                "PCS-MSS-DCAA",
                "PCS MATRIX",
                "PCS MSO XDR Monitoring Team",
                "PCS-ELSATIC-LAB-USERS",
                "PCS-Sentinel",
                "PCS-MSS-MIRAL",
                "PCS Admin",
                "PCSAIPOLD"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Silver-ParamountMXDR360",
                "Paramount CSR",
                "Paramount Audit",
                "Paramount Intune Enrolled Users Group",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Sales Team"
            ],
            "General": [
                "Department_Cloud Services",
                "Sales Assistant",
                "Intune Administrator",
                "DHA Sentinel Offshore",
                "Intune Compliance windows 10",
                "AKI_SOC",
                "Intune MAM light Policy",
                "Department_MSS",
                "Global PMO CoE",
                "CyberNxt - Talent Cloud",
                "Dynamics 365 Support",
                "altaf",
                "Appreciations Tracker",
                "IGA Project",
                "PAM Team",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "MSS-SOC-Sentinel-India",
                "Department_Marketing",
                "KFCA IT IOT Assessment",
                "IT Test",
                "Testing",
                "Department_Consulting Services",
                "Sentinel Cyber Defence Team",
                "Presales - OT Security",
                "SCT Project Delivery",
                "Sentinel Projects",
                "Woqod - Qatar Fuel",
                "CyberNxt - Dashboard",
                "Content Management Group",
                "Qatar CSR",
                "Coresecurity/Tech Projects",
                "MRM Submission 2024",
                "Department_Renewals - Core Security",
                "SG_Data Security_Users",
                "Security Operator",
                "Invoices | Ahlan Cyber",
                "BFSI and O&G",
                "Evanssion Visit",
                "Sharing Weekly Internal PPT",
                "Weekly Sales Report",
                "SG_IAM_Users",
                "Internship 2024",
                "NBO Project",
                "Learning Plan",
                "MSS SOC Team",
                "KSA Invoicing",
                "M365 Copilot",
                "IAM Projects - Test",
                "Team MSS",
                "Staffing",
                "Azure Information Protection Administrator",
                "EDGE Service Delivery",
                "DHA Offshore SOC Team",
                "Qatar Sales",
                "OT-D-A-V-S",
                "Cloud Sec Documents",
                "Business Excellence",
                "6clicks-role-Administrator",
                "ahalnees",
                "Order Booking",
                "Security Co-Pilot",
                "Vivalearn - Integration testing",
                "Resource Management",
                "Microsoft 365 Business Premium Licensed Users",
                "IAM Delivery Team",
                "Department_Data Privacy",
                "FortiGate SSL VPN Access",
                "Department_Administration",
                "SCS-Employee",
                "Cybersecurity NxxT Team",
                "SALES TEAM - BAHRAIN",
                "Ahlan Cyber - OPAS",
                "Alpheya_Sentinel_Soc",
                "Department_GRC",
                "Global Administrator",
                "Talent Acquisition",
                "SG_Sales_Users",
                "Emaar Data classification/AIP/FP",
                "MOCA",
                "SOC - Scope Investment",
                "Ahlan Cyber -Presales",
                "SOC Banque Misr",
                "RLS-Project Plan",
                "SG_Finance_Users",
                "Qatar SOC 2 Audit",
                "KSA Region-Internal",
                "Sentinel Documents",
                "IDO Meeting RAK",
                "sales group",
                "STC Project",
                "NBF- AIP Project",
                "MSS-ABG",
                "Submission of Pending TNA Forms",
                "CA002 Policy exclusion -  non admins",
                "SG_Infrastructure Security_Users",
                "4.x- Schneider-OT",
                "MSS-EWEC-Admin",
                "DLP Test",
                "Teams_Group_FARAH EXPERIENCES",
                "Securus 360",
                "Ahlan Sales",
                "Project Status",
                "CSNxxT-Employees",
                "MSS-JAMG",
                "SentinelSME",
                "Teams_Group_KYNDRYL",
                "Identity Workshop",
                "Department_Data Security",
                "Dynamics 365 Sales",
                "Fifa game test",
                "Daman Project",
                "Department_Finance",
                "SailPoint Training",
                "SG_Staffing Solutions_Users",
                "Team Kuwait Projects",
                "The Executive Council",
                "Team Kuwait",
                "Data Protection Cloud Services",
                "Presales_TechMSS",
                "Microsoft Fasttrack-RFA",
                "FP&A",
                "Consulting-Presales",
                "Qatar OPAS",
                "LetsDefend SOC Alerts",
                "SG_Management_Users",
                "Security Sales Department",
                "Tamkeen-Data Classification Project",
                "SG_Cloud Services_Users",
                "DC-SOC",
                "Global Reader",
                "MSS-ALFANAR",
                "From GulfIT- QNB CLM Keyfacotr",
                "Microsoft 365 Business Standard Licensed Users",
                "SG_MSS_Users",
                "Farah",
                "SG_GRC_Users",
                "Edge week and month report",
                "SOC Tamkeen",
                "Microsoft Projects",
                "Internship",
                "License Administrator",
                "KIB_GROUP",
                "IAM Projects",
                "Cloud Security",
                "Mashreq Data Classification Project",
                "ISO Delivery",
                "Dukhan Bank IAM assessment project",
                "Intune MAM Policy Exclusion",
                "Qatar Finance & Admin",
                "SG_Data Privacy_Users",
                "Miral SOC Group",
                "Team Qatar",
                "Intune App Testing",
                "RLS-Project-Group",
                "Intune Enroll Excluded Users",
                "Department_Staffing Solutions",
                "DATA SECURITY TEAM",
                "Gulf Islamic Investment (GII)",
                "GDP- Marketing blitzkrieg",
                "MSS-DCAA",
                "Billing Details",
                "Test Team - SOC",
                "CISSP Training 2021",
                "Pcs DLP Policy Group",
                "Qatar -Presales",
                "DAG Group - Security Assessment",
                "Department_Management",
                "HR-ConfidentialLabel",
                "Sales-UAE",
                "SOC MBRHE",
                "Pre-Sales - Consulting",
                "SG_Consulting Services_Users",
                "CISCO FIFA RFP",
                "Test RLS-Project plan",
                "Microsoft Elite",
                "SG_Renewals- Core Security_Users",
                "Teams_Group_MSO_EDGE",
                "Department_Infrastructure Security",
                "Infra Security BU",
                "Dukhan Bank IAM Assessment",
                "Bahrain Support",
                "IDAM Team",
                "MyITBuddy",
                "Department_OT Security",
                "ISO 27001:2022 LA Training",
                "OT - Reading resources",
                "SG_OT Security_Users",
                "KIB_GRC",
                "Corporate Governing Council",
                "Dubai Metro Blue Line",
                "PMO",
                "PartnerCenter_MPNAdmin",
                "Ahlan Cyber Knowledge Base",
                "Internal Team",
                "MSS-EDGE",
                "SG_Administration_Users",
                "Teams_Group_Qatar_proposals",
                "Managed Security Operations Team EDGE",
                "KAFD Project",
                "Data Privacy",
                "CybersecurityNxxT Team",
                "Network Security Champs!",
                "BUPA Microsoft Security Project",
                "Al-Turki Holding LLC",
                "Mashreq Archer Implementation",
                "SOC Notification",
                "Scope Investment",
                "Office 365 Security",
                "Alpheya_Sentinel_Siem_Admins",
                "Ahlanees",
                "Communication compliance",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "MS-Channel",
                "MSS-EWEC-SOC",
                "FIDO",
                "MSS Security Advisory",
                "Teams_Group_MSS_projects",
                "Salama Insurance - Consulting",
                "Weekly Summary - Compliance",
                "Critical Infra Security- D-A-V-S",
                "Project1 PLAN",
                "COO conversations",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Group_core_security",
                "DLP Flow test",
                "Partnership Kuwait",
                "Microsoft Core Team",
                "AUB Project Files",
                "Paramout-KSA",
                "Finance Team",
                "DEWA BCM",
                "IAM - Presales",
                "KFCA IT-IoT Assessment",
                "Team Bahrain",
                "Microsoft 365 E5 Licensed Users",
                "Department_Sales",
                "Department_IAM",
                "HelpdeskAgents",
                "Power BI Administrator",
                "Intune MAM & Defender",
                "Excellence Driving Centre",
                "Daily Tasks",
                "Target",
                "Cloud Services Team",
                "Project Management Office - Consulting",
                "customer facing employees"
            ],
            "Explanation": "These roles have no associated activity in audit or sign-in logs over the analyzed period."
        }
    },
    "inactive": {
        "418cf370-1c30-ed11-9db1-000d3a65164f": "No activity recorded in the last 30 days. Reason: User has multiple roles but no sign-in activity.",
        "5d30d823-f5ea-ef11-be20-6045bddd1bad": "No activity recorded in the last 30 days. Reason: User has excessive permissions but no sign-in activity.",
        "48747db0-413b-ee11-bdf4-000d3adc8967": "No activity recorded in the last 30 days. Reason: User
2025-06-09 13:46:00,964 - src.core.analysis - INFO - LLM response parsed successfully for chunk 22
2025-06-09 13:46:00,965 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 22 response: {}
2025-06-09 13:46:00,966 - src.core.analysis - INFO - LLM response parsed successfully for chunk 23
2025-06-09 13:46:00,968 - src.core.analysis - INFO - Processed 21/36 chunks (58%)
2025-06-09 13:46:00,969 - src.core.analysis - INFO - LLM response parsed successfully for chunk 24
2025-06-09 13:46:00,971 - src.core.analysis - INFO - Processed 22/36 chunks (61%)
2025-06-09 13:46:00,971 - src.core.analysis - INFO - LLM response parsed successfully for chunk 25
2025-06-09 13:46:00,973 - src.core.analysis - INFO - Processed 23/36 chunks (63%)
2025-06-09 13:46:00,975 - src.core.analysis - INFO - LLM response parsed successfully for chunk 26
2025-06-09 13:46:00,977 - src.core.analysis - INFO - Processed 24/36 chunks (66%)
2025-06-09 13:46:00,979 - src.core.analysis - INFO - LLM response parsed successfully for chunk 27
2025-06-09 13:46:00,982 - src.core.analysis - INFO - Processed 25/36 chunks (69%)
2025-06-09 13:46:00,982 - src.core.analysis - INFO - LLM response parsed successfully for chunk 28
2025-06-09 13:46:00,984 - src.core.analysis - INFO - Processed 26/36 chunks (72%)
2025-06-09 13:46:00,984 - src.core.analysis - INFO - LLM response parsed successfully for chunk 29
2025-06-09 13:46:00,985 - src.core.analysis - INFO - Processed 27/36 chunks (75%)
2025-06-09 13:46:00,986 - src.core.analysis - INFO - LLM response parsed successfully for chunk 30
2025-06-09 13:46:00,987 - src.core.analysis - INFO - Processed 28/36 chunks (77%)
2025-06-09 13:46:00,988 - src.core.analysis - INFO - LLM response parsed successfully for chunk 31
2025-06-09 13:46:00,989 - src.core.analysis - INFO - Processed 29/36 chunks (80%)
2025-06-09 13:46:00,990 - src.core.analysis - INFO - LLM response parsed successfully for chunk 32
2025-06-09 13:46:00,992 - src.core.analysis - INFO - Processed 30/36 chunks (83%)
2025-06-09 13:46:00,993 - src.core.analysis - WARNING - JSON parsing error: Expecting value: line 420 column 16 (char 18539). Attempting to fix unterminated string.
2025-06-09 13:46:00,995 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "4771cf7d-0606-ef11-9f89-002248a41fb1": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "b7878ab9-76b4-eb11-8236-000d3ab5a61f": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "bdf54c33-dd15-f011-998a-7c1e52362954": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "2cd0086a-e5be-eb11-bacc-000d3ade3348": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Dawood Lhan": "Unusual location: At Tawar, AE at 2025-06-02 06:00",
        "Sarath AN": "Unusual sign-in time: 2025-05-31 01:55:51 (hour outside normal working hours)"
    },
    "mismatches": {
        "b7878ab9-76b4-eb11-8236-000d3ab5a61f": [
            "Excessive permission: Basic User. Expected for PCS: None",
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS: None",
            "Excessive permission: PCS Country Manager. Expected for PCS: None",
            "Excessive permission: Sales Enterprise app access. Expected for PCS: None",
            "Permission 'Basic User' assigned but no activity in app 'unknown'",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS Country Manager' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "bdf54c33-dd15-f011-998a-7c1e52362954": [
            "Excessive permission: Sales Enterprise app access. Expected for PCS: None",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ],
        "2cd0086a-e5be-eb11-bacc-000d3ade3348": [
            "Excessive permission: Dynamics 365 App for Outlook User. Expected for PCS Employees - UAE: None",
            "Excessive permission: PCS BU Manager. Expected for PCS Employees - UAE: None",
            "Excessive permission: Sales Enterprise app access. Expected for PCS Employees - UAE: None",
            "Permission 'Dynamics 365 App for Outlook User' assigned but no activity in app 'unknown'",
            "Permission 'PCS BU Manager' assigned but no activity in app 'unknown'",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'"
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across PCS and Paramount roles, indicating potential over-assignment.",
        "unused_roles": {
            "PCS-Related": [
                "PCS XDR Monitoring",
                "PCS-GRC-LAB-USERS",
                "PCS-IT-ADMIN",
                "PCS Alfanar Manual Tracker Data",
                "PCS-Sales",
                "PCS AIP Users",
                "PCS-MSS-TAMKEEN",
                "PCS-NBK Project Team",
                "PCS Employees - Bahrain",
                "PCS_Jumaalmajid",
                "PCS-LAB-USERS",
                "PCS_Qatar_SOC",
                "PCS-QAPCO-USERS",
                "PCS-BRM",
                "SOC - PCS",
                "PCS Business Reviews",
                "PCSKWT",
                "PCS- KSA Freelancers",
                "PCS - Outsourced Team",
                "PCS Qatar - Delivery",
                "PCS-MSS-AIR-ARABIA",
                "PCS_UAE-Internal",
                "PCS-MSS-ALWASL",
                "PCS-Consulting Services",
                "PCS-MSS-BM",
                "PCSUAEBiz",
                "PCS -LDP",
                "PCS Outsourced Team",
                "PCS Employees - Saudi",
                "PCS MSS Team",
                "PCS Technical",
                "PCS- GII- Infosec Team",
                "PCS - Ajman Municipality",
                "PCS-MSS-MBRHE",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-Dubai Culture",
                "PCS Qatar - Presales",
                "PCS Employees - Kuwait",
                "PCS- Kuwait Support",
                "PCS-MSS-DCAA",
                "PCS MATRIX",
                "PCS MSO XDR Monitoring Team",
                "PCS-ELSATIC-LAB-USERS",
                "PCS-Sentinel",
                "PCS-MSS-MIRAL",
                "PCS Admin",
                "PCSAIPOLD"
            ],
            "Paramount-Related": [
                "Paramount global",
                "Silver-ParamountMXDR360",
                "Paramount CSR",
                "Paramount Audit",
                "Paramount Intune Enrolled Users Group",
                "Paramount Delivery Team",
                "Paramount XDR360 team",
                "Paramount Awards & Certification",
                "Paramount Sales Team"
            ],
            "General": [
                "Department_Cloud Services",
                "Sales Assistant",
                "Intune Administrator",
                "DHA Sentinel Offshore",
                "Intune Compliance windows 10",
                "AKI_SOC",
                "Intune MAM light Policy",
                "Department_MSS",
                "Global PMO CoE",
                "CyberNxt - Talent Cloud",
                "Dynamics 365 Support",
                "altaf",
                "Appreciations Tracker",
                "IGA Project",
                "PAM Team",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "MSS-SOC-Sentinel-India",
                "Department_Marketing",
                "KFCA IT IOT Assessment",
                "IT Test",
                "Testing",
                "Department_Consulting Services",
                "Sentinel Cyber Defence Team",
                "Presales - OT Security",
                "SCT Project Delivery",
                "Sentinel Projects",
                "Woqod - Qatar Fuel",
                "CyberNxt - Dashboard",
                "Content Management Group",
                "Qatar CSR",
                "Coresecurity/Tech Projects",
                "MRM Submission 2024",
                "Department_Renewals - Core Security",
                "SG_Data Security_Users",
                "Security Operator",
                "Invoices | Ahlan Cyber",
                "BFSI and O&G",
                "Evanssion Visit",
                "Sharing Weekly Internal PPT",
                "Weekly Sales Report",
                "SG_IAM_Users",
                "Internship 2024",
                "NBO Project",
                "Learning Plan",
                "MSS SOC Team",
                "KSA Invoicing",
                "M365 Copilot",
                "IAM Projects - Test",
                "Team MSS",
                "Staffing",
                "Azure Information Protection Administrator",
                "EDGE Service Delivery",
                "DHA Offshore SOC Team",
                "Qatar Sales",
                "OT-D-A-V-S",
                "Cloud Sec Documents",
                "Business Excellence",
                "6clicks-role-Administrator",
                "ahalnees",
                "Order Booking",
                "Security Co-Pilot",
                "Vivalearn - Integration testing",
                "Resource Management",
                "Microsoft 365 Business Premium Licensed Users",
                "IAM Delivery Team",
                "Department_Data Privacy",
                "FortiGate SSL VPN Access",
                "Department_Administration",
                "SCS-Employee",
                "Cybersecurity NxxT Team",
                "SALES TEAM - BAHRAIN",
                "Ahlan Cyber - OPAS",
                "Alpheya_Sentinel_Soc",
                "Department_GRC",
                "Global Administrator",
                "Talent Acquisition",
                "SG_Sales_Users",
                "Emaar Data classification/AIP/FP",
                "MOCA",
                "SOC - Scope Investment",
                "Ahlan Cyber -Presales",
                "SOC Banque Misr",
                "RLS-Project Plan",
                "SG_Finance_Users",
                "Qatar SOC 2 Audit",
                "KSA Region-Internal",
                "Sentinel Documents",
                "IDO Meeting RAK",
                "sales group",
                "STC Project",
                "NBF- AIP Project",
                "MSS-ABG",
                "Submission of Pending TNA Forms",
                "CA002 Policy exclusion -  non admins",
                "SG_Infrastructure Security_Users",
                "4.x- Schneider-OT",
                "MSS-EWEC-Admin",
                "DLP Test",
                "Teams_Group_FARAH EXPERIENCES",
                "Securus 360",
                "Ahlan Sales",
                "Project Status",
                "CSNxxT-Employees",
                "MSS-JAMG",
                "SentinelSME",
                "Teams_Group_KYNDRYL",
                "Identity Workshop",
                "Department_Data Security",
                "Dynamics 365 Sales",
                "Fifa game test",
                "Daman Project",
                "Department_Finance",
                "SailPoint Training",
                "SG_Staffing Solutions_Users",
                "Team Kuwait Projects",
                "The Executive Council",
                "Team Kuwait",
                "Data Protection Cloud Services",
                "Presales_TechMSS",
                "Microsoft Fasttrack-RFA",
                "FP&A",
                "Consulting-Presales",
                "Qatar OPAS",
                "LetsDefend SOC Alerts",
                "SG_Management_Users",
                "Security Sales Department",
                "Tamkeen-Data Classification Project",
                "SG_Cloud Services_Users",
                "DC-SOC",
                "Global Reader",
                "MSS-ALFANAR",
                "From GulfIT- QNB CLM Keyfacotr",
                "Microsoft 365 Business Standard Licensed Users",
                "SG_MSS_Users",
                "Farah",
                "SG_GRC_Users",
                "Edge week and month report",
                "SOC Tamkeen",
                "Microsoft Projects",
                "Internship",
                "License Administrator",
                "KIB_GROUP",
                "IAM Projects",
                "Cloud Security",
                "Mashreq Data Classification Project",
                "ISO Delivery",
                "Dukhan Bank IAM assessment project",
                "Intune MAM Policy Exclusion",
                "Qatar Finance & Admin",
                "SG_Data Privacy_Users",
                "Miral SOC Group",
                "Team Qatar",
                "Intune App Testing",
                "RLS-Project-Group",
                "Intune Enroll Excluded Users",
                "Department_Staffing Solutions",
                "DATA SECURITY TEAM",
                "Gulf Islamic Investment (GII)",
                "GDP- Marketing blitzkrieg",
                "MSS-DCAA",
                "Billing Details",
                "Test Team - SOC",
                "CISSP Training 2021",
                "Pcs DLP Policy Group",
                "Qatar -Presales",
                "DAG Group - Security Assessment",
                "Department_Management",
                "HR-ConfidentialLabel",
                "Sales-UAE",
                "SOC MBRHE",
                "Pre-Sales - Consulting",
                "SG_Consulting Services_Users",
                "CISCO FIFA RFP",
                "Test RLS-Project plan",
                "Microsoft Elite",
                "SG_Renewals- Core Security_Users",
                "Teams_Group_MSO_EDGE",
                "Department_Infrastructure Security",
                "Infra Security BU",
                "Dukhan Bank IAM Assessment",
                "Bahrain Support",
                "IDAM Team",
                "MyITBuddy",
                "Department_OT Security",
                "ISO 27001:2022 LA Training",
                "OT - Reading resources",
                "SG_OT Security_Users",
                "KIB_GRC",
                "Corporate Governing Council",
                "Dubai Metro Blue Line",
                "PMO",
                "PartnerCenter_MPNAdmin",
                "Ahlan Cyber Knowledge Base",
                "Internal Team",
                "MSS-EDGE",
                "SG_Administration_Users",
                "Teams_Group_Qatar_proposals",
                "Managed Security Operations Team EDGE",
                "KAFD Project",
                "Data Privacy",
                "CybersecurityNxxT Team",
                "Network Security Champs!",
                "BUPA Microsoft Security Project",
                "Al-Turki Holding LLC",
                "Mashreq Archer Implementation",
                "SOC Notification",
                "Scope Investment",
                "Office 365 Security",
                "Alpheya_Sentinel_Siem_Admins",
                "Ahlanees",
                "Communication compliance",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "MS-Channel",
                "MSS-EWEC-SOC",
                "FIDO",
                "MSS Security Advisory",
                "Teams_Group_MSS_projects",
                "Salama Insurance - Consulting",
                "Weekly Summary - Compliance",
                "Critical Infra Security- D-A-V-S",
                "Project1 PLAN",
                "COO conversations",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "Group_core_security",
                "DLP Flow test",
                "Partnership Kuwait",
                "Microsoft Core Team",
                "AUB Project Files",
                "Paramout-KSA",
                "Finance Team",
                "DEWA BCM",
                "IAM - Presales",
               
2025-06-09 13:46:01,007 - src.core.analysis - INFO - LLM response parsed successfully for chunk 33
2025-06-09 13:46:01,008 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 33 response: {}
2025-06-09 13:46:01,009 - src.core.analysis - INFO - LLM response parsed successfully for chunk 34
2025-06-09 13:46:01,010 - src.core.analysis - INFO - Processed 31/36 chunks (86%)
2025-06-09 13:46:01,010 - src.core.analysis - INFO - LLM response parsed successfully for chunk 35
2025-06-09 13:46:01,012 - src.core.analysis - INFO - Processed 32/36 chunks (88%)
2025-06-09 13:46:01,013 - src.core.analysis - INFO - LLM response parsed successfully for chunk 36
2025-06-09 13:46:01,014 - src.core.analysis - INFO - Processed 33/36 chunks (91%)
2025-06-09 13:46:01,015 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 13:46:01,016 - src.core.analysis - INFO - Sequential processing completed in 2092.63s
2025-06-09 13:46:01,016 - src.core.analysis - INFO - Successfully processed 33/36 chunks
2025-06-09 13:46:01,017 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 13:46:01,019 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 13:46:01,023 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 13:46:01,025 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 13:46:01,032 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 13:46:01,034 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 13455 bytes
2025-06-09 13:46:20,949 - src.core.analysis - INFO - Recommendations chunk 1 completed in 19.92s
2025-06-09 13:46:20,949 - src.core.analysis - INFO - Waiting 30s before processing next chunk to avoid rate limits
2025-06-09 13:46:50,965 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 13:46:50,965 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 13:46:50,966 - src.core.analysis - INFO - Analysis completed successfully with 17 recommendations
2025-06-09 14:11:28,827 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 14:12:13,953 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 14:12:14,177 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 14:12:14,178 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 14:12:14,178 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 14:12:14,179 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 14:12:54,082 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 14:13:01,618 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 14:13:01,620 - src.core.embeddings - INFO - Embedding initialization took 47.44 seconds
2025-06-09 14:13:01,623 - src.core.embeddings - INFO - Memory usage: RSS=510.73 MB, VMS=2699.88 MB
2025-06-09 14:13:01,623 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 14:13:01,624 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 14:13:01,627 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 14:13:01,697 - src.core.embeddings - INFO - Precomputed location history in 0.07 seconds
2025-06-09 14:13:05,303 - src.core.embeddings - INFO - Text generation took 3.68 seconds
2025-06-09 14:13:05,304 - src.core.embeddings - INFO - Memory usage: RSS=539.99 MB, VMS=2728.79 MB
2025-06-09 14:13:05,304 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 14:13:10,654 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 14:13:10,655 - src.core.embeddings - INFO - Document conversion took 5.35 seconds
2025-06-09 14:13:10,655 - src.core.embeddings - INFO - Memory usage: RSS=576.17 MB, VMS=2764.86 MB
2025-06-09 14:13:10,656 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 14:13:10,659 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 14:13:47,052 - src.core.embeddings - INFO - Memory usage: RSS=736.17 MB, VMS=2944.86 MB
2025-06-09 14:13:47,053 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 14:14:18,880 - src.core.embeddings - INFO - Memory usage: RSS=810.77 MB, VMS=3019.27 MB
2025-06-09 14:14:18,881 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 14:14:51,543 - src.core.embeddings - INFO - Memory usage: RSS=885.27 MB, VMS=3094.36 MB
2025-06-09 14:14:51,544 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 14:15:10,596 - src.core.embeddings - INFO - Memory usage: RSS=961.41 MB, VMS=3169.95 MB
2025-06-09 14:15:10,596 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 14:15:28,052 - src.core.embeddings - INFO - Memory usage: RSS=1035.16 MB, VMS=3243.34 MB
2025-06-09 14:15:28,053 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 14:15:42,536 - src.core.embeddings - INFO - Memory usage: RSS=1108.73 MB, VMS=3317.45 MB
2025-06-09 14:15:42,537 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 14:16:20,398 - src.core.embeddings - INFO - Memory usage: RSS=1338.13 MB, VMS=3573.87 MB
2025-06-09 14:16:20,399 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 14:17:49,929 - src.core.embeddings - INFO - Memory usage: RSS=1199.92 MB, VMS=3618.46 MB
2025-06-09 14:17:49,930 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 14:18:13,877 - src.core.embeddings - INFO - Memory usage: RSS=1219.36 MB, VMS=3638.18 MB
2025-06-09 14:18:14,272 - src.core.embeddings - INFO - Embedding generation took 303.62 seconds
2025-06-09 14:18:14,273 - src.core.embeddings - INFO - Memory usage: RSS=1219.36 MB, VMS=3638.18 MB
2025-06-09 14:18:14,273 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 14:18:15,325 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 14:18:16,856 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 14:18:16,885 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 14:18:16,886 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 14:18:16,886 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.61 seconds
2025-06-09 14:18:16,887 - src.core.embeddings - INFO - Memory usage: RSS=1442.01 MB, VMS=3993.43 MB
2025-06-09 14:18:16,921 - src.core.embeddings - INFO - Total embedding generation took 362.74 seconds
2025-06-09 14:18:16,973 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 14:18:16,974 - src.utils.config - INFO - Loading environment variables
2025-06-09 14:18:17,007 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 14:18:17,007 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 14:18:17,219 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:18:17,220 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 14:18:17,220 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 14:18:17,221 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 14:18:17,222 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 14:18:17,231 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 14:18:17,231 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 14:18:17,232 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 14:18:17,232 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 14:18:17,233 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 14:18:20,286 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 14:18:20,323 - src.core.analysis - INFO - Starting analysis
2025-06-09 14:18:20,324 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 14:18:23,840 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 14:18:23,841 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 14:18:23,842 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 14:18:23,842 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 14:18:23,843 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:18:23,843 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 14:18:23,844 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 14:18:23,858 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:18:23,909 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 14:18:23,961 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 14:18:23,969 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 14:18:23,970 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 14:18:23,970 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 14:18:23,971 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 14:18:23,972 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 14:18:23,972 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 14:18:23,973 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 14:18:23,973 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 14:18:23,974 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 14:18:23,974 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 14:18:23,975 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 14:18:23,975 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 14:18:23,975 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 14:18:23,976 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 14:18:23,976 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 14:18:23,977 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 14:18:25,719 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 14:18:25,720 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 14:18:25,721 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:18:25,721 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:18:25,722 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:18:25,723 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 14:18:26,686 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 14:18:26,687 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 14:18:26,808 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 14:18:26,867 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:18:28,060 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 14:18:28,060 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 14:18:28,061 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 14:18:28,061 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 14:18:28,062 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:18:28,079 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 14:18:28,080 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:18:28,090 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 14:18:28,091 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 14:18:30,931 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 14:18:30,933 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 14:18:30,982 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 14:18:30,982 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 14:18:30,984 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 14:18:30,994 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 14:18:30,996 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 124157 bytes
2025-06-09 14:18:56,745 - src.core.analysis - INFO - Findings chunk 1 completed in 25.75s
2025-06-09 14:18:56,746 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 14:18:56,748 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 128418 bytes
2025-06-09 14:19:21,089 - src.core.analysis - INFO - Findings chunk 2 completed in 24.34s
2025-06-09 14:19:21,090 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 14:19:21,091 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 86992 bytes
2025-06-09 14:19:40,406 - src.core.analysis - INFO - Findings chunk 3 completed in 19.32s
2025-06-09 14:19:40,518 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 14:19:40,520 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 14:19:40,520 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 14:19:40,521 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 14:19:40,523 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 14:19:40,524 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 14:19:40,524 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 14:19:40,525 - src.core.analysis - INFO - Sequential processing completed in 69.54s
2025-06-09 14:19:40,525 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 14:19:40,526 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 14:19:40,526 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 14:19:40,528 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 14:19:40,529 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 14:19:40,529 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 14:19:40,530 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 11081 bytes
2025-06-09 14:19:51,236 - src.core.analysis - INFO - Recommendations chunk 1 completed in 10.71s
2025-06-09 14:19:51,342 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 14:19:51,345 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 14:19:51,346 - src.core.analysis - INFO - Analysis completed successfully with 12 recommendations
2025-06-09 14:38:59,541 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 14:39:38,120 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 14:39:38,449 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 14:39:38,449 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 14:39:38,451 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 14:39:38,452 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 14:40:17,413 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 14:40:22,707 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 14:40:22,708 - src.core.embeddings - INFO - Embedding initialization took 44.25 seconds
2025-06-09 14:40:22,709 - src.core.embeddings - INFO - Memory usage: RSS=510.22 MB, VMS=2699.19 MB
2025-06-09 14:40:22,710 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 14:40:22,710 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 14:40:22,713 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 14:40:22,738 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 14:40:23,750 - src.core.embeddings - INFO - Text generation took 1.04 seconds
2025-06-09 14:40:23,750 - src.core.embeddings - INFO - Memory usage: RSS=539.79 MB, VMS=2728.34 MB
2025-06-09 14:40:23,751 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 14:40:25,959 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 14:40:25,960 - src.core.embeddings - INFO - Document conversion took 2.21 seconds
2025-06-09 14:40:25,961 - src.core.embeddings - INFO - Memory usage: RSS=575.93 MB, VMS=2764.41 MB
2025-06-09 14:40:25,961 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 14:40:25,963 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 14:40:38,780 - src.core.embeddings - INFO - Memory usage: RSS=738.41 MB, VMS=2945.96 MB
2025-06-09 14:40:38,781 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 14:40:53,070 - src.core.embeddings - INFO - Memory usage: RSS=813.27 MB, VMS=3020.34 MB
2025-06-09 14:40:53,071 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 14:41:07,259 - src.core.embeddings - INFO - Memory usage: RSS=887.98 MB, VMS=3094.80 MB
2025-06-09 14:41:07,260 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 14:41:20,887 - src.core.embeddings - INFO - Memory usage: RSS=961.89 MB, VMS=3168.22 MB
2025-06-09 14:41:20,888 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 14:41:33,655 - src.core.embeddings - INFO - Memory usage: RSS=1035.59 MB, VMS=3242.41 MB
2025-06-09 14:41:33,656 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 14:41:46,425 - src.core.embeddings - INFO - Memory usage: RSS=1108.98 MB, VMS=3316.48 MB
2025-06-09 14:41:46,426 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 14:42:22,230 - src.core.embeddings - INFO - Memory usage: RSS=1366.16 MB, VMS=3571.83 MB
2025-06-09 14:42:22,231 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 14:43:00,950 - src.core.embeddings - INFO - Memory usage: RSS=1443.05 MB, VMS=3649.02 MB
2025-06-09 14:43:00,951 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 14:43:21,921 - src.core.embeddings - INFO - Memory usage: RSS=1482.52 MB, VMS=3689.58 MB
2025-06-09 14:43:22,251 - src.core.embeddings - INFO - Embedding generation took 176.29 seconds
2025-06-09 14:43:22,252 - src.core.embeddings - INFO - Memory usage: RSS=1482.52 MB, VMS=3689.58 MB
2025-06-09 14:43:22,255 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 14:43:23,086 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 14:43:24,255 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 14:43:24,279 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 14:43:24,279 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 14:43:24,280 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.02 seconds
2025-06-09 14:43:24,281 - src.core.embeddings - INFO - Memory usage: RSS=1698.98 MB, VMS=4044.46 MB
2025-06-09 14:43:24,291 - src.core.embeddings - INFO - Total embedding generation took 225.84 seconds
2025-06-09 14:43:24,328 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 14:43:24,329 - src.utils.config - INFO - Loading environment variables
2025-06-09 14:43:24,331 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 14:43:24,332 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 14:43:24,453 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:43:24,453 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 14:43:24,454 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 14:43:24,454 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 14:43:24,455 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 14:43:24,459 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 14:43:24,459 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 14:43:24,460 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 14:43:24,460 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 14:43:24,460 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 14:43:26,350 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 14:43:26,383 - src.core.analysis - INFO - Starting analysis
2025-06-09 14:43:26,384 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 14:43:29,053 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 14:43:29,054 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 14:43:29,055 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 14:43:29,055 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 14:43:29,056 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:43:29,056 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 14:43:29,059 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 14:43:29,067 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:43:29,082 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 14:43:29,105 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 14:43:29,113 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 14:43:29,113 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 14:43:29,114 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 14:43:29,114 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 14:43:29,115 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 14:43:29,115 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 14:43:29,116 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 14:43:29,116 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 14:43:29,117 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 14:43:29,117 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 14:43:29,117 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 14:43:29,118 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 14:43:29,118 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 14:43:29,119 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 14:43:29,119 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 14:43:29,120 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 14:43:30,524 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 14:43:30,525 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 14:43:30,525 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:43:30,528 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:43:30,528 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:43:30,529 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 14:43:31,182 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 14:43:31,183 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 14:43:31,301 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 14:43:31,345 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:43:32,335 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 14:43:32,336 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 14:43:32,336 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 14:43:32,337 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 14:43:32,337 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:43:32,351 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 14:43:32,351 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:43:32,360 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 14:43:32,361 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 14:43:34,832 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 14:43:34,835 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 14:43:34,885 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 14:43:34,886 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 14:43:34,887 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 14:43:34,890 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 14:43:34,892 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 158095 bytes
2025-06-09 14:44:16,029 - src.core.analysis - INFO - Findings chunk 1 completed in 41.14s
2025-06-09 14:44:16,030 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 14:44:16,031 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 151339 bytes
2025-06-09 14:44:45,256 - src.core.analysis - INFO - Findings chunk 2 completed in 29.23s
2025-06-09 14:44:45,257 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 14:44:45,258 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 120538 bytes
2025-06-09 14:45:12,668 - src.core.analysis - INFO - Findings chunk 3 completed in 27.41s
2025-06-09 14:45:12,775 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 14:45:12,776 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 14:45:12,777 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 14:45:12,777 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 14:45:12,778 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 14:45:12,778 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 14:45:12,779 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 14:45:12,779 - src.core.analysis - INFO - Sequential processing completed in 97.89s
2025-06-09 14:45:12,779 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 14:45:12,780 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 14:45:12,780 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 14:45:12,781 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 14:45:12,782 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 14:45:12,783 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 14:45:12,783 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 11505 bytes
2025-06-09 14:45:21,843 - src.core.analysis - INFO - Recommendations chunk 1 completed in 9.06s
2025-06-09 14:45:21,946 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 14:45:21,947 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 14:45:21,947 - src.core.analysis - INFO - Analysis completed successfully with 12 recommendations
2025-06-09 14:48:56,491 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 14:50:08,065 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 14:50:08,286 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 14:50:08,287 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 14:50:08,287 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 14:50:08,288 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 14:50:57,781 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 14:51:02,898 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 14:51:02,899 - src.core.embeddings - INFO - Embedding initialization took 54.61 seconds
2025-06-09 14:51:02,899 - src.core.embeddings - INFO - Memory usage: RSS=509.60 MB, VMS=2698.58 MB
2025-06-09 14:51:02,900 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 14:51:02,900 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 14:51:02,903 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 14:51:02,919 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-09 14:51:03,687 - src.core.embeddings - INFO - Text generation took 0.79 seconds
2025-06-09 14:51:03,688 - src.core.embeddings - INFO - Memory usage: RSS=538.93 MB, VMS=2727.48 MB
2025-06-09 14:51:03,688 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 14:51:06,996 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 14:51:06,996 - src.core.embeddings - INFO - Document conversion took 3.31 seconds
2025-06-09 14:51:06,997 - src.core.embeddings - INFO - Memory usage: RSS=575.09 MB, VMS=2763.55 MB
2025-06-09 14:51:06,998 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 14:51:07,000 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 14:51:19,942 - src.core.embeddings - INFO - Memory usage: RSS=737.90 MB, VMS=2945.57 MB
2025-06-09 14:51:19,943 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 14:51:32,619 - src.core.embeddings - INFO - Memory usage: RSS=813.19 MB, VMS=3020.58 MB
2025-06-09 14:51:32,620 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 14:51:45,549 - src.core.embeddings - INFO - Memory usage: RSS=887.92 MB, VMS=3094.88 MB
2025-06-09 14:51:45,550 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 14:51:59,673 - src.core.embeddings - INFO - Memory usage: RSS=961.79 MB, VMS=3168.33 MB
2025-06-09 14:51:59,674 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 14:52:13,873 - src.core.embeddings - INFO - Memory usage: RSS=1035.48 MB, VMS=3242.52 MB
2025-06-09 14:52:13,874 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 14:52:26,724 - src.core.embeddings - INFO - Memory usage: RSS=1109.45 MB, VMS=3317.01 MB
2025-06-09 14:52:26,725 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 14:52:59,406 - src.core.embeddings - INFO - Memory usage: RSS=1366.64 MB, VMS=3572.93 MB
2025-06-09 14:52:59,406 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 14:53:38,849 - src.core.embeddings - INFO - Memory usage: RSS=1442.28 MB, VMS=3648.45 MB
2025-06-09 14:53:38,850 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 14:53:59,012 - src.core.embeddings - INFO - Memory usage: RSS=1481.67 MB, VMS=3688.94 MB
2025-06-09 14:53:59,347 - src.core.embeddings - INFO - Embedding generation took 172.35 seconds
2025-06-09 14:53:59,348 - src.core.embeddings - INFO - Memory usage: RSS=1481.67 MB, VMS=3688.94 MB
2025-06-09 14:53:59,349 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 14:54:00,241 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 14:54:01,515 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 14:54:01,537 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 14:54:01,538 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 14:54:01,539 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.19 seconds
2025-06-09 14:54:01,539 - src.core.embeddings - INFO - Memory usage: RSS=1698.52 MB, VMS=4044.21 MB
2025-06-09 14:54:01,549 - src.core.embeddings - INFO - Total embedding generation took 233.26 seconds
2025-06-09 14:54:01,592 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 14:54:01,592 - src.utils.config - INFO - Loading environment variables
2025-06-09 14:54:01,595 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 14:54:01,596 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 14:54:01,751 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:54:01,752 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 14:54:01,753 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 14:54:01,754 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 14:54:01,754 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 14:54:01,759 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 14:54:01,759 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 14:54:01,760 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 14:54:01,760 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 14:54:01,761 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 14:54:03,370 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 14:54:03,401 - src.core.analysis - INFO - Starting analysis
2025-06-09 14:54:03,402 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 14:54:06,771 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 14:54:06,772 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-09 14:54:06,773 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 14:54:06,773 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 14:54:06,774 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 14:54:06,774 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:54:06,775 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 14:54:06,775 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 14:54:06,790 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:54:06,811 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 14:54:06,844 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 14:54:06,852 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 14:54:06,853 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 14:54:06,853 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 14:54:06,854 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 14:54:06,855 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 14:54:06,855 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 14:54:06,856 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 14:54:06,857 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 14:54:06,857 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 14:54:06,858 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 14:54:06,858 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 14:54:06,859 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 14:54:06,859 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 14:54:06,860 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 14:54:06,860 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 14:54:06,861 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 14:54:08,977 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 14:54:08,978 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 14:54:08,978 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:54:08,979 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:54:08,979 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 14:54:08,981 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 14:54:09,772 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 14:54:09,773 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 14:54:09,878 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 14:54:09,931 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:54:10,963 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 14:54:10,964 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 14:54:10,965 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 14:54:10,965 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 14:54:10,966 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 14:54:10,991 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 14:54:10,992 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 14:54:11,001 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 14:54:11,002 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 14:54:13,502 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 14:54:13,504 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 14:54:13,579 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 14:54:13,579 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 14:54:13,581 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 14:54:13,595 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 14:54:13,597 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 167436 bytes
2025-06-09 14:54:49,795 - src.core.analysis - INFO - Findings chunk 1 completed in 36.20s
2025-06-09 14:54:49,796 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 14:54:49,797 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 152009 bytes
2025-06-09 14:55:31,343 - src.core.analysis - INFO - Findings chunk 2 completed in 41.55s
2025-06-09 14:55:31,343 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 14:55:31,345 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 110527 bytes
2025-06-09 14:55:58,859 - src.core.analysis - INFO - Findings chunk 3 completed in 27.52s
2025-06-09 14:55:58,964 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 14:55:58,966 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 14:55:58,967 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 14:55:58,968 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 14:55:58,968 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 14:55:58,969 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 14:55:58,970 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 14:55:58,970 - src.core.analysis - INFO - Sequential processing completed in 105.39s
2025-06-09 14:55:58,971 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 14:55:58,971 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 14:55:58,972 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 14:55:58,973 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 14:55:58,974 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 14:55:58,975 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 14:55:58,975 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 15774 bytes
2025-06-09 14:56:12,983 - src.core.analysis - INFO - Recommendations chunk 1 completed in 14.01s
2025-06-09 14:56:13,095 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 14:56:13,096 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 14:56:13,096 - src.core.analysis - INFO - Analysis completed successfully with 11 recommendations
2025-06-09 15:01:09,138 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 15:01:30,976 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 15:04:28,726 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 15:04:29,014 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 15:04:29,015 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 15:04:29,015 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 15:04:29,017 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 15:05:05,574 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 15:05:10,542 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 15:05:10,543 - src.core.embeddings - INFO - Embedding initialization took 41.52 seconds
2025-06-09 15:05:10,544 - src.core.embeddings - INFO - Memory usage: RSS=509.98 MB, VMS=2698.71 MB
2025-06-09 15:05:10,544 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 15:05:10,545 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 15:05:10,548 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 15:05:10,579 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-09 15:05:11,938 - src.core.embeddings - INFO - Text generation took 1.39 seconds
2025-06-09 15:05:11,939 - src.core.embeddings - INFO - Memory usage: RSS=539.27 MB, VMS=2727.61 MB
2025-06-09 15:05:11,939 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 15:05:17,362 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 15:05:17,363 - src.core.embeddings - INFO - Document conversion took 5.42 seconds
2025-06-09 15:05:17,365 - src.core.embeddings - INFO - Memory usage: RSS=575.44 MB, VMS=2763.68 MB
2025-06-09 15:05:17,365 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 15:05:17,368 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 15:05:31,659 - src.core.embeddings - INFO - Memory usage: RSS=737.95 MB, VMS=2945.55 MB
2025-06-09 15:05:31,660 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 15:05:45,637 - src.core.embeddings - INFO - Memory usage: RSS=813.52 MB, VMS=3020.91 MB
2025-06-09 15:05:45,638 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 15:05:59,769 - src.core.embeddings - INFO - Memory usage: RSS=888.32 MB, VMS=3095.59 MB
2025-06-09 15:05:59,770 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 15:06:13,747 - src.core.embeddings - INFO - Memory usage: RSS=962.02 MB, VMS=3169.78 MB
2025-06-09 15:06:13,748 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 15:06:27,343 - src.core.embeddings - INFO - Memory usage: RSS=1035.88 MB, VMS=3243.15 MB
2025-06-09 15:06:27,344 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 15:06:40,006 - src.core.embeddings - INFO - Memory usage: RSS=1109.60 MB, VMS=3317.45 MB
2025-06-09 15:06:40,007 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 15:07:12,042 - src.core.embeddings - INFO - Memory usage: RSS=1327.83 MB, VMS=3573.27 MB
2025-06-09 15:07:12,042 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 15:07:50,217 - src.core.embeddings - INFO - Memory usage: RSS=1404.50 MB, VMS=3650.24 MB
2025-06-09 15:07:50,218 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 15:08:09,780 - src.core.embeddings - INFO - Memory usage: RSS=1443.46 MB, VMS=3690.07 MB
2025-06-09 15:08:10,133 - src.core.embeddings - INFO - Embedding generation took 172.77 seconds
2025-06-09 15:08:10,134 - src.core.embeddings - INFO - Memory usage: RSS=1443.46 MB, VMS=3690.07 MB
2025-06-09 15:08:10,136 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 15:08:10,999 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 15:08:12,471 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 15:08:12,497 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 15:08:12,498 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 15:08:12,500 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.36 seconds
2025-06-09 15:08:12,500 - src.core.embeddings - INFO - Memory usage: RSS=1660.24 MB, VMS=4045.25 MB
2025-06-09 15:08:12,512 - src.core.embeddings - INFO - Total embedding generation took 223.50 seconds
2025-06-09 15:08:12,560 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 15:08:12,560 - src.utils.config - INFO - Loading environment variables
2025-06-09 15:08:12,564 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 15:08:12,564 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 15:08:12,730 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:08:12,730 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:08:12,731 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:08:12,731 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 15:08:12,732 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 15:08:12,737 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 15:08:12,737 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 15:08:12,738 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 15:08:12,738 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 15:08:12,739 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 15:08:14,424 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 15:08:14,449 - src.core.analysis - INFO - Starting analysis
2025-06-09 15:08:14,449 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 15:08:21,464 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 15:08:21,467 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-09 15:08:21,470 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 15:08:21,471 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 15:08:21,472 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 15:08:21,473 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:08:21,474 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 15:08:21,475 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:08:21,498 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:08:21,525 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 15:08:21,605 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 15:08:21,613 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 15:08:21,614 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 15:08:21,615 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 15:08:21,615 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 15:08:21,616 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 15:08:21,616 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 15:08:21,617 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 15:08:21,618 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 15:08:21,619 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 15:08:21,620 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 15:08:21,620 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 15:08:21,621 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 15:08:21,621 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 15:08:21,622 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 15:08:21,622 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 15:08:21,623 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 15:08:24,446 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 15:08:24,446 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 15:08:24,447 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:08:24,451 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:08:24,452 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:08:24,453 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 15:08:25,393 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 15:08:25,394 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 15:08:25,491 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:08:25,583 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:08:26,912 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 15:08:26,913 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 15:08:26,914 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 15:08:26,914 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:08:26,915 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:08:26,929 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 15:08:26,930 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:08:26,940 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 15:08:26,941 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:08:30,084 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 15:08:30,088 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 15:08:30,192 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 15:08:30,192 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 15:08:30,195 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 15:08:30,196 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 15:08:30,200 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 163711 bytes
2025-06-09 15:09:10,778 - src.core.analysis - INFO - Findings chunk 1 completed in 40.58s
2025-06-09 15:09:10,779 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 15:09:10,781 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 150359 bytes
2025-06-09 15:09:44,931 - src.core.analysis - INFO - Findings chunk 2 completed in 34.15s
2025-06-09 15:09:44,932 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 15:09:44,935 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 115902 bytes
2025-06-09 15:10:07,803 - src.core.analysis - INFO - Findings chunk 3 completed in 22.87s
2025-06-09 15:10:07,911 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 15:10:07,912 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 15:10:07,913 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 15:10:07,914 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 15:10:07,914 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 15:10:07,915 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 15:10:07,917 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 15:10:07,917 - src.core.analysis - INFO - Sequential processing completed in 97.72s
2025-06-09 15:10:07,918 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 15:10:07,919 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 15:10:07,920 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 15:10:07,922 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 15:10:07,923 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 15:10:07,924 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 15:10:07,924 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 12977 bytes
2025-06-09 15:10:21,463 - src.core.analysis - INFO - Recommendations chunk 1 completed in 13.54s
2025-06-09 15:10:21,570 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 15:10:21,571 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 15:10:21,571 - src.core.analysis - INFO - Analysis completed successfully with 13 recommendations
2025-06-09 15:10:21,573 - src.utils.azure_blob - ERROR - File not found: D:\Production\app.log
2025-06-09 15:14:48,788 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 15:15:08,408 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 15:15:08,648 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 15:15:08,649 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 15:15:08,649 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 15:15:08,650 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 15:15:15,676 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 15:15:21,110 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 15:15:21,110 - src.core.embeddings - INFO - Embedding initialization took 12.46 seconds
2025-06-09 15:15:21,111 - src.core.embeddings - INFO - Memory usage: RSS=510.79 MB, VMS=2699.64 MB
2025-06-09 15:15:21,111 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 15:15:21,112 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 15:15:21,115 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 15:15:21,129 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-09 15:15:22,281 - src.core.embeddings - INFO - Text generation took 1.17 seconds
2025-06-09 15:15:22,282 - src.core.embeddings - INFO - Memory usage: RSS=540.13 MB, VMS=2728.55 MB
2025-06-09 15:15:22,301 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 15:15:24,532 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 15:15:24,532 - src.core.embeddings - INFO - Document conversion took 2.23 seconds
2025-06-09 15:15:24,533 - src.core.embeddings - INFO - Memory usage: RSS=576.29 MB, VMS=2764.62 MB
2025-06-09 15:15:24,533 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 15:15:24,536 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 15:15:37,370 - src.core.embeddings - INFO - Memory usage: RSS=738.59 MB, VMS=2946.16 MB
2025-06-09 15:15:37,371 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 15:15:51,375 - src.core.embeddings - INFO - Memory usage: RSS=813.70 MB, VMS=3021.04 MB
2025-06-09 15:15:51,376 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 15:16:04,992 - src.core.embeddings - INFO - Memory usage: RSS=889.09 MB, VMS=3095.88 MB
2025-06-09 15:16:04,993 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 15:16:17,803 - src.core.embeddings - INFO - Memory usage: RSS=962.80 MB, VMS=3169.24 MB
2025-06-09 15:16:17,804 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 15:16:32,056 - src.core.embeddings - INFO - Memory usage: RSS=1036.79 MB, VMS=3243.77 MB
2025-06-09 15:16:32,056 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 15:16:44,803 - src.core.embeddings - INFO - Memory usage: RSS=1110.33 MB, VMS=3317.64 MB
2025-06-09 15:16:44,804 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 15:17:17,254 - src.core.embeddings - INFO - Memory usage: RSS=1367.88 MB, VMS=3573.32 MB
2025-06-09 15:17:17,255 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 15:17:56,560 - src.core.embeddings - INFO - Memory usage: RSS=1444.11 MB, VMS=3649.90 MB
2025-06-09 15:17:56,560 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 15:18:16,535 - src.core.embeddings - INFO - Memory usage: RSS=1483.34 MB, VMS=3689.81 MB
2025-06-09 15:18:16,849 - src.core.embeddings - INFO - Embedding generation took 172.32 seconds
2025-06-09 15:18:16,850 - src.core.embeddings - INFO - Memory usage: RSS=1483.34 MB, VMS=3689.81 MB
2025-06-09 15:18:16,851 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 15:18:17,634 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 15:18:18,878 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 15:18:18,905 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 15:18:18,906 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 15:18:18,906 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.06 seconds
2025-06-09 15:18:18,907 - src.core.embeddings - INFO - Memory usage: RSS=1699.81 MB, VMS=4044.90 MB
2025-06-09 15:18:18,915 - src.core.embeddings - INFO - Total embedding generation took 190.27 seconds
2025-06-09 15:18:18,953 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 15:18:18,954 - src.utils.config - INFO - Loading environment variables
2025-06-09 15:18:18,990 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 15:18:18,991 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 15:18:19,104 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:18:19,104 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:18:19,105 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:18:19,106 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 15:18:19,106 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 15:18:19,111 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 15:18:19,112 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 15:18:19,112 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 15:18:19,113 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 15:18:19,113 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 15:18:20,650 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 15:18:20,670 - src.core.analysis - INFO - Starting analysis
2025-06-09 15:18:20,671 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 15:18:24,365 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 15:18:24,366 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-09 15:18:24,367 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 15:18:24,368 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 15:18:24,368 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 15:18:24,369 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:18:24,369 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 15:18:24,370 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:18:24,383 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:18:24,406 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 15:18:24,439 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 15:18:24,446 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 15:18:24,447 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 15:18:24,448 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 15:18:24,448 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 15:18:24,449 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 15:18:24,450 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 15:18:24,450 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 15:18:24,451 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 15:18:24,451 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 15:18:24,452 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 15:18:24,453 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 15:18:24,453 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 15:18:24,454 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 15:18:24,454 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 15:18:24,455 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 15:18:24,455 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 15:18:25,894 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 15:18:25,895 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 15:18:25,899 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:18:25,899 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:18:25,900 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:18:25,901 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 15:18:26,740 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 15:18:26,741 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 15:18:26,833 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:18:26,884 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:18:27,925 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 15:18:27,925 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 15:18:27,926 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 15:18:27,927 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:18:27,927 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:18:27,937 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 15:18:27,938 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:18:27,948 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 15:18:27,949 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:18:30,555 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 15:18:30,557 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 15:18:30,599 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 15:18:30,600 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 15:18:30,601 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 15:18:30,605 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 15:18:30,606 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 168797 bytes
2025-06-09 15:18:53,295 - src.core.analysis - INFO - Findings chunk 1 completed in 22.69s
2025-06-09 15:18:53,296 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 15:18:53,299 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 167164 bytes
2025-06-09 15:19:30,546 - src.core.analysis - INFO - Findings chunk 2 completed in 37.25s
2025-06-09 15:19:30,547 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 15:19:30,550 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 94011 bytes
2025-06-09 15:19:58,410 - src.core.analysis - INFO - Findings chunk 3 completed in 27.86s
2025-06-09 15:19:58,526 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 15:19:58,527 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 15:19:58,528 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 15:19:58,530 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 15:19:58,530 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 15:19:58,531 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 15:19:58,532 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 15:19:58,532 - src.core.analysis - INFO - Sequential processing completed in 87.93s
2025-06-09 15:19:58,533 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 15:19:58,533 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 15:19:58,534 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 15:19:58,535 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 15:19:58,536 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 15:19:58,537 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 15:19:58,538 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 14414 bytes
2025-06-09 15:20:08,889 - src.core.analysis - INFO - Recommendations chunk 1 completed in 10.35s
2025-06-09 15:20:09,000 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 15:20:09,001 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 15:20:09,001 - src.core.analysis - INFO - Analysis completed successfully with 9 recommendations
2025-06-09 15:20:09,002 - src.utils.azure_blob - ERROR - File not found: D:\Production\app.log
2025-06-09 15:22:32,157 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 15:23:05,237 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 15:23:05,937 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 15:23:05,938 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 15:23:05,939 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 15:23:05,939 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 15:23:52,880 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 15:23:58,295 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 15:23:58,295 - src.core.embeddings - INFO - Embedding initialization took 52.36 seconds
2025-06-09 15:23:58,296 - src.core.embeddings - INFO - Memory usage: RSS=510.16 MB, VMS=2698.72 MB
2025-06-09 15:23:58,297 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 15:23:58,297 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 15:23:58,300 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 15:23:58,312 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-09 15:24:00,114 - src.core.embeddings - INFO - Text generation took 1.82 seconds
2025-06-09 15:24:00,115 - src.core.embeddings - INFO - Memory usage: RSS=539.43 MB, VMS=2727.64 MB
2025-06-09 15:24:00,116 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 15:24:04,519 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 15:24:04,520 - src.core.embeddings - INFO - Document conversion took 4.40 seconds
2025-06-09 15:24:04,521 - src.core.embeddings - INFO - Memory usage: RSS=575.57 MB, VMS=2763.71 MB
2025-06-09 15:24:04,521 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 15:24:04,524 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 15:24:38,313 - src.core.embeddings - INFO - Memory usage: RSS=738.27 MB, VMS=2945.88 MB
2025-06-09 15:24:38,314 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 15:24:52,514 - src.core.embeddings - INFO - Memory usage: RSS=813.83 MB, VMS=3021.29 MB
2025-06-09 15:24:52,515 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 15:25:06,550 - src.core.embeddings - INFO - Memory usage: RSS=888.44 MB, VMS=3095.75 MB
2025-06-09 15:25:06,551 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 15:25:20,046 - src.core.embeddings - INFO - Memory usage: RSS=962.11 MB, VMS=3168.98 MB
2025-06-09 15:25:20,047 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 15:25:35,091 - src.core.embeddings - INFO - Memory usage: RSS=1035.76 MB, VMS=3243.10 MB
2025-06-09 15:25:35,091 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 15:25:48,974 - src.core.embeddings - INFO - Memory usage: RSS=1109.67 MB, VMS=3317.42 MB
2025-06-09 15:25:48,975 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 15:26:22,160 - src.core.embeddings - INFO - Memory usage: RSS=1367.05 MB, VMS=3573.17 MB
2025-06-09 15:26:22,161 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 15:26:59,889 - src.core.embeddings - INFO - Memory usage: RSS=1443.15 MB, VMS=3649.54 MB
2025-06-09 15:26:59,890 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 15:27:20,039 - src.core.embeddings - INFO - Memory usage: RSS=1484.13 MB, VMS=3691.51 MB
2025-06-09 15:27:20,372 - src.core.embeddings - INFO - Embedding generation took 195.85 seconds
2025-06-09 15:27:20,375 - src.core.embeddings - INFO - Memory usage: RSS=1484.13 MB, VMS=3691.51 MB
2025-06-09 15:27:20,375 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 15:27:21,250 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 15:27:22,415 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 15:27:22,435 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 15:27:22,436 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 15:27:22,436 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.06 seconds
2025-06-09 15:27:22,437 - src.core.embeddings - INFO - Memory usage: RSS=1699.23 MB, VMS=4044.77 MB
2025-06-09 15:27:22,447 - src.core.embeddings - INFO - Total embedding generation took 256.51 seconds
2025-06-09 15:27:22,484 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 15:27:22,485 - src.utils.config - INFO - Loading environment variables
2025-06-09 15:27:22,488 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 15:27:22,488 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 15:27:22,637 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:27:22,638 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:27:22,638 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:27:22,639 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 15:27:22,639 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 15:27:22,644 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 15:27:22,645 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 15:27:22,645 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 15:27:22,646 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 15:27:22,646 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 15:27:24,290 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 15:27:24,317 - src.core.analysis - INFO - Starting analysis
2025-06-09 15:27:24,318 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 15:27:27,147 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 15:27:27,148 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-09 15:27:27,148 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 15:27:27,149 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 15:27:27,149 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 15:27:27,149 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:27:27,150 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 15:27:27,150 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:27:27,159 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:27:27,173 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 15:27:27,196 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 15:27:27,202 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 15:27:27,203 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 15:27:27,203 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 15:27:27,204 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 15:27:27,204 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 15:27:27,205 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 15:27:27,205 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 15:27:27,206 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 15:27:27,206 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 15:27:27,206 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 15:27:27,206 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 15:27:27,207 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 15:27:27,207 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 15:27:27,207 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 15:27:27,208 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 15:27:27,208 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 15:27:28,756 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 15:27:28,757 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 15:27:28,757 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:27:28,758 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:27:28,758 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:27:28,759 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 15:27:29,980 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 15:27:29,980 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 15:27:30,130 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:27:30,201 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:27:31,442 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 15:27:31,443 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 15:27:31,444 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 15:27:31,444 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:27:31,445 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:27:31,458 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 15:27:31,459 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:27:31,468 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 15:27:31,469 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:27:34,187 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 15:27:34,189 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 15:27:34,245 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 15:27:34,246 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 15:27:34,247 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 15:27:34,249 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 15:27:34,251 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 165640 bytes
2025-06-09 15:28:09,773 - src.core.analysis - INFO - Findings chunk 1 completed in 35.52s
2025-06-09 15:28:09,774 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 15:28:09,776 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 159480 bytes
2025-06-09 15:28:36,819 - src.core.analysis - INFO - Findings chunk 2 completed in 27.04s
2025-06-09 15:28:36,820 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 15:28:36,821 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 104852 bytes
2025-06-09 15:29:09,044 - src.core.analysis - INFO - Findings chunk 3 completed in 32.22s
2025-06-09 15:29:09,150 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 15:29:09,151 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 15:29:09,151 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 15:29:09,152 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 15:29:09,153 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 15:29:09,154 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 15:29:09,154 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 15:29:09,155 - src.core.analysis - INFO - Sequential processing completed in 94.91s
2025-06-09 15:29:09,155 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 15:29:09,156 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 15:29:09,156 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 15:29:09,158 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 15:29:09,159 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 15:29:09,159 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 15:29:09,160 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 13205 bytes
2025-06-09 15:29:19,813 - src.core.analysis - INFO - Recommendations chunk 1 completed in 10.65s
2025-06-09 15:29:19,930 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 15:29:19,931 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 15:29:19,931 - src.core.analysis - INFO - Analysis completed successfully with 9 recommendations
2025-06-09 15:29:20,832 - src.utils.azure_blob - ERROR - Failed to upload D:\Production\backend\app.log to https://d365accessreview.blob.core.windows.net/20250609_095919/app.log: 409 <?xml version="1.0" encoding="utf-8"?><Error><Code>PublicAccessNotPermitted</Code><Message>Public access is not permitted on this storage account.
RequestId:715f7d2b-b01e-0069-5d25-d90961000000
Time:2025-06-09T09:59:21.2505164Z</Message></Error>
2025-06-09 15:40:00,026 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 15:40:00,349 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 15:40:00,350 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 15:40:00,350 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 15:40:00,351 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 15:40:00,355 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 15:40:05,113 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 15:40:05,115 - src.core.embeddings - INFO - Embedding initialization took 4.76 seconds
2025-06-09 15:40:05,116 - src.core.embeddings - INFO - Memory usage: RSS=168.66 MB, VMS=3102.93 MB
2025-06-09 15:40:05,116 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 15:40:05,117 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 15:40:05,118 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 15:40:05,131 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-09 15:40:06,181 - src.core.embeddings - INFO - Text generation took 1.06 seconds
2025-06-09 15:40:06,182 - src.core.embeddings - INFO - Memory usage: RSS=199.27 MB, VMS=3104.00 MB
2025-06-09 15:40:06,182 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 15:40:10,571 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 15:40:10,572 - src.core.embeddings - INFO - Document conversion took 4.39 seconds
2025-06-09 15:40:10,573 - src.core.embeddings - INFO - Memory usage: RSS=457.08 MB, VMS=3053.34 MB
2025-06-09 15:40:10,573 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 15:40:10,578 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 15:40:51,406 - src.core.embeddings - INFO - Memory usage: RSS=606.14 MB, VMS=3115.23 MB
2025-06-09 15:40:51,406 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 15:41:18,610 - src.core.embeddings - INFO - Memory usage: RSS=680.66 MB, VMS=3187.69 MB
2025-06-09 15:41:18,611 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 15:41:43,265 - src.core.embeddings - INFO - Memory usage: RSS=755.60 MB, VMS=3262.38 MB
2025-06-09 15:41:43,267 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 15:42:10,694 - src.core.embeddings - INFO - Memory usage: RSS=828.62 MB, VMS=3336.16 MB
2025-06-09 15:42:10,695 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 15:42:35,286 - src.core.embeddings - INFO - Memory usage: RSS=902.54 MB, VMS=3410.65 MB
2025-06-09 15:42:35,286 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 15:43:04,138 - src.core.embeddings - INFO - Memory usage: RSS=976.25 MB, VMS=3484.05 MB
2025-06-09 15:43:04,139 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 15:44:06,158 - src.core.embeddings - INFO - Memory usage: RSS=1235.74 MB, VMS=3730.97 MB
2025-06-09 15:44:06,159 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 15:45:24,998 - src.core.embeddings - INFO - Memory usage: RSS=1205.47 MB, VMS=3724.04 MB
2025-06-09 15:45:24,999 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 15:46:09,122 - src.core.embeddings - INFO - Memory usage: RSS=1217.80 MB, VMS=3744.45 MB
2025-06-09 15:46:09,527 - src.core.embeddings - INFO - Embedding generation took 358.95 seconds
2025-06-09 15:46:09,528 - src.core.embeddings - INFO - Memory usage: RSS=1217.80 MB, VMS=3744.45 MB
2025-06-09 15:46:09,528 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 15:46:10,778 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 15:46:12,484 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 15:46:12,505 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 15:46:12,506 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 15:46:12,507 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.98 seconds
2025-06-09 15:46:12,508 - src.core.embeddings - INFO - Memory usage: RSS=1431.41 MB, VMS=3968.96 MB
2025-06-09 15:46:12,517 - src.core.embeddings - INFO - Total embedding generation took 372.17 seconds
2025-06-09 15:46:12,570 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 15:46:12,571 - src.utils.config - INFO - Loading environment variables
2025-06-09 15:46:12,595 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 15:46:12,596 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 15:46:12,768 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:46:12,768 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:46:12,769 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:46:12,769 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 15:46:12,770 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 15:46:12,774 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 15:46:12,774 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 15:46:12,775 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 15:46:12,775 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 15:46:12,776 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 15:46:14,002 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 15:46:14,030 - src.core.analysis - INFO - Starting analysis
2025-06-09 15:46:14,030 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 15:46:18,097 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 15:46:18,098 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-09 15:46:18,101 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 15:46:18,102 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 15:46:18,103 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 15:46:18,103 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:46:18,104 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 15:46:18,104 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 15:46:18,117 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:46:18,164 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 15:46:18,219 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 15:46:18,227 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 15:46:18,228 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 15:46:18,229 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 15:46:18,229 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 15:46:18,230 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 15:46:18,231 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 15:46:18,232 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 15:46:18,232 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 15:46:18,233 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 15:46:18,233 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 15:46:18,234 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 15:46:18,235 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 15:46:18,235 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 15:46:18,236 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 15:46:18,238 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 15:46:18,239 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 15:46:20,666 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 15:46:20,667 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 15:46:20,667 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:46:20,668 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:46:20,668 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 15:46:20,669 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 15:46:22,041 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 15:46:22,041 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 15:46:22,213 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:46:22,303 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:46:23,266 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 15:46:23,267 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 15:46:23,268 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 15:46:23,269 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 15:46:23,269 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 15:46:23,286 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 15:46:23,286 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 15:46:23,297 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 15:46:23,298 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 15:46:26,582 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 15:46:26,584 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 15:46:26,650 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 15:46:26,652 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 15:46:26,654 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 15:46:26,657 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 15:46:26,659 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 165640 bytes
2025-06-09 15:47:05,959 - src.core.analysis - INFO - Findings chunk 1 completed in 39.30s
2025-06-09 15:47:05,960 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 15:47:05,962 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 159480 bytes
2025-06-09 15:47:38,697 - src.core.analysis - INFO - Findings chunk 2 completed in 32.74s
2025-06-09 15:47:38,698 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 15:47:38,700 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 104852 bytes
2025-06-09 15:48:03,224 - src.core.analysis - INFO - Findings chunk 3 completed in 24.53s
2025-06-09 15:48:03,340 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 15:48:03,341 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 15:48:03,342 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 15:48:03,343 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 15:48:03,344 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 15:48:03,346 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 15:48:03,347 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 15:48:03,347 - src.core.analysis - INFO - Sequential processing completed in 96.69s
2025-06-09 15:48:03,348 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 15:48:03,349 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 15:48:03,350 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 15:48:03,353 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 15:48:03,354 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 15:48:03,355 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 15:48:03,356 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 13258 bytes
2025-06-09 15:48:15,595 - src.core.analysis - INFO - Recommendations chunk 1 completed in 12.24s
2025-06-09 15:48:15,698 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 15:48:15,699 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 15:48:15,699 - src.core.analysis - INFO - Analysis completed successfully with 9 recommendations
2025-06-09 15:48:16,552 - src.utils.azure_blob - ERROR - Failed to upload D:\Production\backend\app.log to https://d365accessreview.blob.core.windows.net/20250609_101815/app.log: 404 <?xml version="1.0" encoding="utf-8"?><Error><Code>ResourceNotFound</Code><Message>The specified resource does not exist.
RequestId:a750c8d9-501e-0013-4e27-d91421000000
Time:2025-06-09T10:18:16.9759628Z</Message></Error>
2025-06-09 16:41:07,212 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-09 16:41:07,890 - src.core.embeddings - INFO - Starting embedding generation
2025-06-09 16:41:07,891 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-09 16:41:07,892 - src.core.embeddings - INFO - Using batch_size=64
2025-06-09 16:41:07,894 - src.core.embeddings - INFO - Using device: cpu
2025-06-09 16:41:07,930 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-09 16:41:13,033 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-09 16:41:13,034 - src.core.embeddings - INFO - Embedding initialization took 5.14 seconds
2025-06-09 16:41:13,039 - src.core.embeddings - INFO - Memory usage: RSS=117.33 MB, VMS=3128.00 MB
2025-06-09 16:41:13,040 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-09 16:41:13,040 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-09 16:41:13,043 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-09 16:41:13,120 - src.core.embeddings - INFO - Precomputed location history in 0.08 seconds
2025-06-09 16:41:16,361 - src.core.embeddings - INFO - Text generation took 3.32 seconds
2025-06-09 16:41:16,362 - src.core.embeddings - INFO - Memory usage: RSS=386.12 MB, VMS=3060.36 MB
2025-06-09 16:41:16,362 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-09 16:41:19,003 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-09 16:41:19,004 - src.core.embeddings - INFO - Document conversion took 2.64 seconds
2025-06-09 16:41:19,004 - src.core.embeddings - INFO - Memory usage: RSS=418.21 MB, VMS=3061.97 MB
2025-06-09 16:41:19,005 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-09 16:41:19,009 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-09 16:41:36,472 - src.core.embeddings - INFO - Memory usage: RSS=573.21 MB, VMS=3127.90 MB
2025-06-09 16:41:36,473 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-09 16:42:06,596 - src.core.embeddings - INFO - Memory usage: RSS=643.68 MB, VMS=3197.52 MB
2025-06-09 16:42:06,597 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-09 16:42:46,117 - src.core.embeddings - INFO - Memory usage: RSS=708.28 MB, VMS=3266.33 MB
2025-06-09 16:42:46,119 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-09 16:43:10,414 - src.core.embeddings - INFO - Memory usage: RSS=771.96 MB, VMS=3340.10 MB
2025-06-09 16:43:10,415 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-09 16:43:49,204 - src.core.embeddings - INFO - Memory usage: RSS=845.66 MB, VMS=3413.87 MB
2025-06-09 16:43:49,204 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-09 16:44:23,712 - src.core.embeddings - INFO - Memory usage: RSS=919.72 MB, VMS=3488.27 MB
2025-06-09 16:44:23,713 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-09 16:45:06,479 - src.core.embeddings - INFO - Memory usage: RSS=1117.50 MB, VMS=3682.16 MB
2025-06-09 16:45:06,480 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-09 16:45:51,323 - src.core.embeddings - INFO - Memory usage: RSS=1196.21 MB, VMS=3766.81 MB
2025-06-09 16:45:51,324 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-09 16:46:12,950 - src.core.embeddings - INFO - Memory usage: RSS=1244.74 MB, VMS=3807.20 MB
2025-06-09 16:46:13,400 - src.core.embeddings - INFO - Embedding generation took 294.39 seconds
2025-06-09 16:46:13,400 - src.core.embeddings - INFO - Memory usage: RSS=1244.74 MB, VMS=3807.20 MB
2025-06-09 16:46:13,401 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-09 16:46:14,392 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-09 16:46:15,776 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-09 16:46:15,802 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-09 16:46:15,802 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-09 16:46:15,803 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.40 seconds
2025-06-09 16:46:15,803 - src.core.embeddings - INFO - Memory usage: RSS=1461.40 MB, VMS=4034.41 MB
2025-06-09 16:46:15,834 - src.core.embeddings - INFO - Total embedding generation took 307.94 seconds
2025-06-09 16:46:15,877 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-09 16:46:15,879 - src.utils.config - INFO - Loading environment variables
2025-06-09 16:46:15,924 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-09 16:46:15,924 - src.core.analysis - INFO - Validating input DataFrames
2025-06-09 16:46:16,074 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 16:46:16,074 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 16:46:16,075 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 16:46:16,076 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-09 16:46:16,077 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-09 16:46:16,085 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-09 16:46:16,086 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-09 16:46:16,086 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-09 16:46:16,087 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-09 16:46:16,087 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-09 16:46:17,005 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-09 16:46:17,033 - src.core.analysis - INFO - Starting analysis
2025-06-09 16:46:17,034 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-09 16:46:19,703 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-09 16:46:19,704 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-09 16:46:19,706 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-09 16:46:19,707 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-09 16:46:19,708 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-09 16:46:19,708 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 16:46:19,708 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-09 16:46:19,708 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-09 16:46:19,734 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-09 16:46:19,774 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-09 16:46:19,798 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-09 16:46:19,804 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-09 16:46:19,805 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-09 16:46:19,805 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-09 16:46:19,806 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-09 16:46:19,806 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-09 16:46:19,807 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-09 16:46:19,807 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-09 16:46:19,808 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-09 16:46:19,808 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-09 16:46:19,809 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-09 16:46:19,809 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-09 16:46:19,809 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-09 16:46:19,810 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-09 16:46:19,810 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-09 16:46:19,810 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-09 16:46:19,811 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-09 16:46:21,247 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-09 16:46:21,249 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-09 16:46:21,250 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 16:46:21,251 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 16:46:21,251 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-09 16:46:21,252 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-09 16:46:22,002 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-09 16:46:22,003 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-09 16:46:22,131 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-09 16:46:22,181 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-09 16:46:22,830 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-09 16:46:22,831 - src.core.analysis - INFO - Analyzing inactive users
2025-06-09 16:46:22,833 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-09 16:46:22,833 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-09 16:46:22,834 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-09 16:46:22,852 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-09 16:46:22,853 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-09 16:46:22,861 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-09 16:46:22,862 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-09 16:46:25,657 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-09 16:46:25,659 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-09 16:46:25,711 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-09 16:46:25,711 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-09 16:46:25,713 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-09 16:46:25,716 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-09 16:46:25,717 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 165640 bytes
2025-06-09 16:46:55,301 - src.core.analysis - INFO - Findings chunk 1 completed in 29.59s
2025-06-09 16:46:55,302 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-09 16:46:55,304 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 159480 bytes
2025-06-09 16:47:25,109 - src.core.analysis - INFO - Findings chunk 2 completed in 29.81s
2025-06-09 16:47:25,110 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-09 16:47:25,111 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 104852 bytes
2025-06-09 16:47:54,484 - src.core.analysis - INFO - Findings chunk 3 completed in 29.37s
2025-06-09 16:47:54,592 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-09 16:47:54,594 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-09 16:47:54,594 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-09 16:47:54,595 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-09 16:47:54,595 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-09 16:47:54,596 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-09 16:47:54,597 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-09 16:47:54,597 - src.core.analysis - INFO - Sequential processing completed in 88.88s
2025-06-09 16:47:54,598 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-09 16:47:54,598 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-09 16:47:54,600 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-09 16:47:54,602 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-09 16:47:54,602 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-09 16:47:54,603 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-09 16:47:54,603 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 13256 bytes
2025-06-09 16:48:07,638 - src.core.analysis - INFO - Recommendations chunk 1 completed in 13.03s
2025-06-09 16:48:07,741 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-09 16:48:07,744 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-09 16:48:07,744 - src.core.analysis - INFO - Analysis completed successfully with 12 recommendations
2025-06-09 16:48:08,674 - src.utils.azure_blob - ERROR - Failed to upload D:\Production\backend\app.log to https://d365accessreview.blob.core.windows.net/20250609_111807/app.log: 404 <?xml version="1.0" encoding="utf-8"?><Error><Code>ResourceNotFound</Code><Message>The specified resource does not exist.
RequestId:66e75cb4-201e-009f-5130-d97c2f000000
Time:2025-06-09T11:18:09.1308202Z</Message></Error>
2025-06-09 16:49:45,272 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 16:51:31,121 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 16:54:46,910 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 16:55:34,297 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 16:56:28,322 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 17:08:13,330 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 17:09:01,573 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 17:09:16,789 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 17:09:43,710 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 17:12:33,129 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 17:12:45,449 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-09 17:12:57,711 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 10:43:58,794 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 10:45:26,218 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 10:45:41,655 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 10:47:34,843 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 10:49:39,582 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 10:50:09,438 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 10:50:09,886 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 10:50:09,888 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 10:50:09,888 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 10:50:09,889 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 10:51:01,867 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 10:51:07,991 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 10:51:07,992 - src.core.embeddings - INFO - Embedding initialization took 58.10 seconds
2025-06-10 10:51:07,993 - src.core.embeddings - INFO - Memory usage: RSS=511.05 MB, VMS=2699.41 MB
2025-06-10 10:51:07,994 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 10:51:07,994 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 10:51:07,998 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 10:51:08,046 - src.core.embeddings - INFO - Precomputed location history in 0.05 seconds
2025-06-10 10:51:09,277 - src.core.embeddings - INFO - Text generation took 1.28 seconds
2025-06-10 10:51:09,278 - src.core.embeddings - INFO - Memory usage: RSS=540.41 MB, VMS=2728.32 MB
2025-06-10 10:51:09,278 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 10:51:11,369 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 10:51:11,370 - src.core.embeddings - INFO - Document conversion took 2.09 seconds
2025-06-10 10:51:11,372 - src.core.embeddings - INFO - Memory usage: RSS=576.56 MB, VMS=2764.39 MB
2025-06-10 10:51:11,373 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 10:51:11,375 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 10:51:24,672 - src.core.embeddings - INFO - Memory usage: RSS=738.82 MB, VMS=2945.88 MB
2025-06-10 10:51:24,673 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 10:51:38,277 - src.core.embeddings - INFO - Memory usage: RSS=814.36 MB, VMS=3020.96 MB
2025-06-10 10:51:38,278 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 10:51:51,475 - src.core.embeddings - INFO - Memory usage: RSS=889.16 MB, VMS=3095.27 MB
2025-06-10 10:51:51,476 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 10:52:04,967 - src.core.embeddings - INFO - Memory usage: RSS=962.65 MB, VMS=3169.34 MB
2025-06-10 10:52:04,968 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 10:52:19,442 - src.core.embeddings - INFO - Memory usage: RSS=1036.61 MB, VMS=3242.82 MB
2025-06-10 10:52:19,444 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 10:52:32,888 - src.core.embeddings - INFO - Memory usage: RSS=1110.59 MB, VMS=3317.38 MB
2025-06-10 10:52:32,888 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 10:53:08,298 - src.core.embeddings - INFO - Memory usage: RSS=1335.02 MB, VMS=3572.98 MB
2025-06-10 10:53:08,299 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 10:53:48,931 - src.core.embeddings - INFO - Memory usage: RSS=1412.04 MB, VMS=3649.75 MB
2025-06-10 10:53:48,932 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 10:54:11,321 - src.core.embeddings - INFO - Memory usage: RSS=1451.18 MB, VMS=3689.92 MB
2025-06-10 10:54:11,765 - src.core.embeddings - INFO - Embedding generation took 180.39 seconds
2025-06-10 10:54:11,766 - src.core.embeddings - INFO - Memory usage: RSS=1451.18 MB, VMS=3689.92 MB
2025-06-10 10:54:11,769 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 10:54:12,748 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 10:54:14,002 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 10:54:14,028 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 10:54:14,028 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 10:54:14,029 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.26 seconds
2025-06-10 10:54:14,030 - src.core.embeddings - INFO - Memory usage: RSS=1667.87 MB, VMS=4044.58 MB
2025-06-10 10:54:14,040 - src.core.embeddings - INFO - Total embedding generation took 244.15 seconds
2025-06-10 10:54:14,076 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 10:54:14,076 - src.utils.config - INFO - Loading environment variables
2025-06-10 10:54:14,079 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 10:54:14,079 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 10:54:14,221 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 10:54:14,221 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 10:54:14,222 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 10:54:14,222 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 10:54:14,222 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 10:54:14,227 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 10:54:14,227 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 10:54:14,228 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 10:54:14,228 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 10:54:14,229 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 10:54:16,489 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 10:54:16,515 - src.core.analysis - INFO - Starting analysis
2025-06-10 10:54:16,515 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 10:54:19,313 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 10:54:19,314 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 10:54:19,315 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 10:54:19,316 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 10:54:19,316 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 10:54:19,317 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 10:54:19,317 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 10:54:19,318 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 10:54:19,329 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 10:54:19,345 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 10:54:19,367 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 10:54:19,373 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 10:54:19,373 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 10:54:19,374 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 10:54:19,374 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 10:54:19,375 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 10:54:19,375 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 10:54:19,375 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 10:54:19,376 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 10:54:19,376 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 10:54:19,376 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 10:54:19,376 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 10:54:19,377 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 10:54:19,377 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 10:54:19,378 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 10:54:19,378 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 10:54:19,379 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 10:54:21,004 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 10:54:21,005 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 10:54:21,006 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 10:54:21,009 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 10:54:21,009 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 10:54:21,010 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 10:54:21,818 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 10:54:21,819 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 10:54:21,913 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 10:54:21,978 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 10:54:22,841 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 10:54:22,842 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 10:54:22,843 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 10:54:22,844 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 10:54:22,844 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 10:54:22,861 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 10:54:22,862 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 10:54:22,871 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 10:54:22,872 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 10:54:25,392 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 10:54:25,394 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 10:54:25,452 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 10:54:25,454 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 10:54:25,455 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 10:54:25,457 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 10:54:25,459 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 157922 bytes
2025-06-10 10:54:55,039 - src.core.analysis - INFO - Findings chunk 1 completed in 29.58s
2025-06-10 10:54:55,040 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 10:54:55,041 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 151128 bytes
2025-06-10 10:55:31,526 - src.core.analysis - INFO - Findings chunk 2 completed in 36.49s
2025-06-10 10:55:31,527 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 10:55:31,528 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 120922 bytes
2025-06-10 10:55:57,767 - src.core.analysis - INFO - Findings chunk 3 completed in 26.24s
2025-06-10 10:55:57,874 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 10:55:57,875 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 10:55:57,875 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 10:55:57,876 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 10:55:57,876 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 10:55:57,877 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 10:55:57,878 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 10:55:57,878 - src.core.analysis - INFO - Sequential processing completed in 92.42s
2025-06-10 10:55:57,878 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 10:55:57,879 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 10:55:57,879 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 10:55:57,881 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 10:55:57,882 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 10:55:57,882 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 10:55:57,883 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 11070 bytes
2025-06-10 10:56:09,197 - src.core.analysis - INFO - Recommendations chunk 1 completed in 11.31s
2025-06-10 10:56:09,305 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 10:56:09,306 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 10:56:09,307 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-10 11:03:26,797 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 11:04:09,287 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 11:04:16,339 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 11:04:16,872 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 11:04:16,872 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 11:04:16,873 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 11:04:16,873 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 11:05:12,462 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 11:05:22,740 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 11:05:22,741 - src.core.embeddings - INFO - Embedding initialization took 65.87 seconds
2025-06-10 11:05:22,742 - src.core.embeddings - INFO - Memory usage: RSS=511.25 MB, VMS=2700.09 MB
2025-06-10 11:05:22,743 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 11:05:22,743 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 11:05:22,747 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 11:05:22,799 - src.core.embeddings - INFO - Precomputed location history in 0.05 seconds
2025-06-10 11:05:25,368 - src.core.embeddings - INFO - Text generation took 2.62 seconds
2025-06-10 11:05:25,369 - src.core.embeddings - INFO - Memory usage: RSS=540.57 MB, VMS=2729.01 MB
2025-06-10 11:05:25,369 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 11:05:32,313 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 11:05:32,314 - src.core.embeddings - INFO - Document conversion took 6.94 seconds
2025-06-10 11:05:32,315 - src.core.embeddings - INFO - Memory usage: RSS=576.73 MB, VMS=2765.08 MB
2025-06-10 11:05:32,315 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 11:05:32,319 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 11:06:02,681 - src.core.embeddings - INFO - Memory usage: RSS=738.86 MB, VMS=2946.27 MB
2025-06-10 11:06:02,682 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 11:06:33,176 - src.core.embeddings - INFO - Memory usage: RSS=813.73 MB, VMS=3020.69 MB
2025-06-10 11:06:33,177 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 11:07:04,111 - src.core.embeddings - INFO - Memory usage: RSS=888.36 MB, VMS=3095.09 MB
2025-06-10 11:07:04,112 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 11:07:28,825 - src.core.embeddings - INFO - Memory usage: RSS=961.96 MB, VMS=3169.26 MB
2025-06-10 11:07:28,826 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 11:08:00,304 - src.core.embeddings - INFO - Memory usage: RSS=1035.56 MB, VMS=3242.45 MB
2025-06-10 11:08:00,304 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 11:08:26,047 - src.core.embeddings - INFO - Memory usage: RSS=1109.20 MB, VMS=3316.51 MB
2025-06-10 11:08:26,048 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 11:09:27,196 - src.core.embeddings - INFO - Memory usage: RSS=1114.73 MB, VMS=3488.74 MB
2025-06-10 11:09:27,198 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 11:10:52,664 - src.core.embeddings - INFO - Memory usage: RSS=1041.71 MB, VMS=3457.07 MB
2025-06-10 11:10:52,665 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 11:11:36,963 - src.core.embeddings - INFO - Memory usage: RSS=1175.56 MB, VMS=3588.65 MB
2025-06-10 11:11:37,545 - src.core.embeddings - INFO - Embedding generation took 365.23 seconds
2025-06-10 11:11:37,546 - src.core.embeddings - INFO - Memory usage: RSS=1171.66 MB, VMS=3588.65 MB
2025-06-10 11:11:37,546 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 11:11:39,240 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 11:11:41,764 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 11:11:41,806 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 11:11:41,807 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 11:11:41,807 - src.core.embeddings - INFO - FAISS vectorstore creation took 4.26 seconds
2025-06-10 11:11:41,808 - src.core.embeddings - INFO - Memory usage: RSS=1393.27 MB, VMS=3943.16 MB
2025-06-10 11:11:41,881 - src.core.embeddings - INFO - Total embedding generation took 445.01 seconds
2025-06-10 11:11:41,949 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 11:11:41,950 - src.utils.config - INFO - Loading environment variables
2025-06-10 11:11:41,960 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 11:11:41,961 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 11:11:42,248 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 11:11:42,249 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 11:11:42,250 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 11:11:42,250 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 11:11:42,251 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 11:11:42,262 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 11:11:42,263 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 11:11:42,263 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 11:11:42,264 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 11:11:42,264 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 11:11:46,157 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 11:11:46,210 - src.core.analysis - INFO - Starting analysis
2025-06-10 11:11:46,211 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 11:11:54,103 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 11:11:54,104 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 11:11:54,106 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 11:11:54,106 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 11:11:54,107 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 11:11:54,107 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 11:11:54,108 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 11:11:54,109 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 11:11:54,132 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 11:11:54,188 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 11:11:54,262 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 11:11:54,274 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 11:11:54,275 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 11:11:54,275 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 11:11:54,276 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 11:11:54,277 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 11:11:54,277 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 11:11:54,278 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 11:11:54,279 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 11:11:54,280 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 11:11:54,280 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 11:11:54,281 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 11:11:54,282 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 11:11:54,283 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 11:11:54,284 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 11:11:54,285 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 11:11:54,286 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 11:11:58,143 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 11:11:58,144 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 11:11:58,144 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 11:11:58,145 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 11:11:58,146 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 11:11:58,155 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 11:12:00,758 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 11:12:00,760 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 11:12:01,119 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 11:12:01,259 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 11:12:03,526 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 11:12:03,527 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 11:12:03,528 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 11:12:03,529 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 11:12:03,530 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 11:12:03,563 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 11:12:03,564 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 11:12:03,573 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 11:12:03,574 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 11:12:08,867 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 11:12:08,871 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 11:12:09,058 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 11:12:09,059 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 11:12:09,062 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 11:12:09,064 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 11:12:09,067 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 153934 bytes
2025-06-10 11:12:41,888 - src.core.analysis - INFO - Findings chunk 1 completed in 32.82s
2025-06-10 11:12:41,890 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 11:12:41,893 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 156981 bytes
2025-06-10 11:13:16,764 - src.core.analysis - INFO - Findings chunk 2 completed in 34.87s
2025-06-10 11:13:16,765 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 11:13:16,767 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 119057 bytes
2025-06-10 11:13:45,989 - src.core.analysis - INFO - Findings chunk 3 completed in 29.22s
2025-06-10 11:13:46,108 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 11:13:46,110 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 11:13:46,110 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 11:13:46,112 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 11:13:46,112 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 11:13:46,114 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 11:13:46,115 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 11:13:46,116 - src.core.analysis - INFO - Sequential processing completed in 97.05s
2025-06-10 11:13:46,117 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 11:13:46,118 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 11:13:46,119 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 11:13:46,123 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 11:13:46,125 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 11:13:46,126 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 11:13:46,128 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 15760 bytes
2025-06-10 11:14:02,553 - src.core.analysis - INFO - Recommendations chunk 1 completed in 16.43s
2025-06-10 11:14:02,660 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 11:14:02,663 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 11:14:02,664 - src.core.analysis - INFO - Analysis completed successfully with 19 recommendations
2025-06-10 11:15:24,911 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 11:15:56,180 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 11:18:41,742 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 11:19:07,122 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 11:19:39,328 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 11:19:39,716 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 11:19:39,718 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 11:19:39,718 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 11:19:39,719 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 11:20:36,925 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 11:20:43,540 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 11:20:43,540 - src.core.embeddings - INFO - Embedding initialization took 63.82 seconds
2025-06-10 11:20:43,542 - src.core.embeddings - INFO - Memory usage: RSS=510.89 MB, VMS=2699.73 MB
2025-06-10 11:20:43,543 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 11:20:43,543 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 11:20:43,547 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 11:20:43,604 - src.core.embeddings - INFO - Precomputed location history in 0.06 seconds
2025-06-10 11:20:46,450 - src.core.embeddings - INFO - Text generation took 2.91 seconds
2025-06-10 11:20:46,451 - src.core.embeddings - INFO - Memory usage: RSS=540.20 MB, VMS=2728.89 MB
2025-06-10 11:20:46,451 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 11:20:53,031 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 11:20:53,032 - src.core.embeddings - INFO - Document conversion took 6.58 seconds
2025-06-10 11:20:53,033 - src.core.embeddings - INFO - Memory usage: RSS=576.59 MB, VMS=2764.95 MB
2025-06-10 11:20:53,034 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 11:20:53,038 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 11:21:17,475 - src.core.embeddings - INFO - Memory usage: RSS=701.11 MB, VMS=2944.78 MB
2025-06-10 11:21:17,476 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 11:21:41,891 - src.core.embeddings - INFO - Memory usage: RSS=776.16 MB, VMS=3019.40 MB
2025-06-10 11:21:41,892 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 11:22:12,277 - src.core.embeddings - INFO - Memory usage: RSS=710.53 MB, VMS=3095.22 MB
2025-06-10 11:22:12,279 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 11:22:39,787 - src.core.embeddings - INFO - Memory usage: RSS=768.80 MB, VMS=3169.65 MB
2025-06-10 11:22:39,788 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 11:23:03,128 - src.core.embeddings - INFO - Memory usage: RSS=843.43 MB, VMS=3242.78 MB
2025-06-10 11:23:03,129 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 11:23:26,066 - src.core.embeddings - INFO - Memory usage: RSS=917.25 MB, VMS=3316.97 MB
2025-06-10 11:23:26,067 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 11:24:23,080 - src.core.embeddings - INFO - Memory usage: RSS=1171.40 MB, VMS=3572.64 MB
2025-06-10 11:24:23,081 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 11:25:31,843 - src.core.embeddings - INFO - Memory usage: RSS=1143.27 MB, VMS=3565.43 MB
2025-06-10 11:25:31,844 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 11:26:11,933 - src.core.embeddings - INFO - Memory usage: RSS=1175.52 MB, VMS=3589.22 MB
2025-06-10 11:26:12,426 - src.core.embeddings - INFO - Embedding generation took 319.39 seconds
2025-06-10 11:26:12,427 - src.core.embeddings - INFO - Memory usage: RSS=1175.53 MB, VMS=3589.22 MB
2025-06-10 11:26:12,430 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 11:26:13,880 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 11:26:15,902 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 11:26:15,967 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 11:26:15,969 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 11:26:15,970 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.54 seconds
2025-06-10 11:26:15,972 - src.core.embeddings - INFO - Memory usage: RSS=1395.40 MB, VMS=3943.23 MB
2025-06-10 11:26:16,101 - src.core.embeddings - INFO - Total embedding generation took 396.38 seconds
2025-06-10 11:26:16,219 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 11:26:16,220 - src.utils.config - INFO - Loading environment variables
2025-06-10 11:26:16,234 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 11:26:16,235 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 11:26:16,542 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 11:26:16,543 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 11:26:16,544 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 11:26:16,545 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 11:26:16,546 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 11:26:16,558 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 11:26:16,559 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 11:26:16,560 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 11:26:16,561 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 11:26:16,561 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 11:26:20,171 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 11:26:20,222 - src.core.analysis - INFO - Starting analysis
2025-06-10 11:26:20,223 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 11:26:25,613 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 11:26:25,614 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 11:26:25,616 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 11:26:25,616 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 11:26:25,617 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 11:26:25,618 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 11:26:25,619 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 11:26:25,620 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 11:26:25,642 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 11:26:25,697 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 11:26:25,765 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 11:26:25,773 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 11:26:25,774 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 11:26:25,774 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 11:26:25,775 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 11:26:25,775 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 11:26:25,775 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 11:26:25,776 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 11:26:25,776 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 11:26:25,776 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 11:26:25,777 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 11:26:25,778 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 11:26:25,778 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 11:26:25,779 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 11:26:25,780 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 11:26:25,781 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 11:26:25,782 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 11:26:27,665 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 11:26:27,665 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 11:26:27,666 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 11:26:27,667 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 11:26:27,668 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 11:26:27,670 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 11:26:28,907 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 11:26:28,909 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 11:26:29,016 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 11:26:29,097 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 11:26:30,474 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 11:26:30,475 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 11:26:30,476 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 11:26:30,477 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 11:26:30,477 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 11:26:30,501 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 11:26:30,502 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 11:26:30,514 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 11:26:30,515 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 11:26:34,641 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 11:26:34,643 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 11:26:34,692 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 11:26:34,702 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 11:26:34,706 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 11:26:34,709 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 11:26:34,713 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 166328 bytes
2025-06-10 11:27:05,333 - src.core.analysis - INFO - Findings chunk 1 completed in 30.62s
2025-06-10 11:27:05,334 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 11:27:05,337 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 149704 bytes
2025-06-10 11:27:33,823 - src.core.analysis - INFO - Findings chunk 2 completed in 28.49s
2025-06-10 11:27:33,824 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 11:27:33,825 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 113940 bytes
2025-06-10 11:27:58,347 - src.core.analysis - INFO - Findings chunk 3 completed in 24.52s
2025-06-10 11:27:58,467 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 11:27:58,469 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 11:27:58,469 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 11:27:58,471 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 11:27:58,471 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 11:27:58,473 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 11:27:58,474 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 11:27:58,475 - src.core.analysis - INFO - Sequential processing completed in 83.77s
2025-06-10 11:27:58,476 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 11:27:58,477 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 11:27:58,478 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 11:27:58,481 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 11:27:58,483 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 11:27:58,484 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 11:27:58,485 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 15850 bytes
2025-06-10 11:28:11,258 - src.core.analysis - INFO - Recommendations chunk 1 completed in 12.77s
2025-06-10 11:28:11,367 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 11:28:11,371 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 11:28:11,371 - src.core.analysis - INFO - Analysis completed successfully with 11 recommendations
2025-06-10 12:07:17,989 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 12:07:18,986 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 12:07:18,988 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 12:07:18,988 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 12:07:18,993 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 12:07:19,071 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 12:07:23,784 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 12:07:23,785 - src.core.embeddings - INFO - Embedding initialization took 4.79 seconds
2025-06-10 12:07:23,794 - src.core.embeddings - INFO - Memory usage: RSS=85.27 MB, VMS=3099.22 MB
2025-06-10 12:07:23,795 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 12:07:23,795 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 12:07:23,800 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 12:07:23,893 - src.core.embeddings - INFO - Precomputed location history in 0.09 seconds
2025-06-10 12:07:25,399 - src.core.embeddings - INFO - Text generation took 1.60 seconds
2025-06-10 12:07:25,400 - src.core.embeddings - INFO - Memory usage: RSS=118.39 MB, VMS=3102.04 MB
2025-06-10 12:07:25,401 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 12:07:32,771 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 12:07:32,772 - src.core.embeddings - INFO - Document conversion took 7.37 seconds
2025-06-10 12:07:32,772 - src.core.embeddings - INFO - Memory usage: RSS=407.66 MB, VMS=3051.38 MB
2025-06-10 12:07:32,774 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 12:07:32,777 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 12:07:52,873 - src.core.embeddings - INFO - Memory usage: RSS=562.99 MB, VMS=3115.53 MB
2025-06-10 12:07:52,874 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 12:08:07,993 - src.core.embeddings - INFO - Memory usage: RSS=636.52 MB, VMS=3187.99 MB
2025-06-10 12:08:07,993 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 12:08:24,809 - src.core.embeddings - INFO - Memory usage: RSS=711.19 MB, VMS=3261.90 MB
2025-06-10 12:08:24,810 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 12:09:05,591 - src.core.embeddings - INFO - Memory usage: RSS=785.32 MB, VMS=3336.38 MB
2025-06-10 12:09:05,592 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 12:09:49,750 - src.core.embeddings - INFO - Memory usage: RSS=855.69 MB, VMS=3410.21 MB
2025-06-10 12:09:49,751 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 12:10:29,280 - src.core.embeddings - INFO - Memory usage: RSS=929.71 MB, VMS=3484.71 MB
2025-06-10 12:10:29,285 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 12:12:12,513 - src.core.embeddings - INFO - Memory usage: RSS=938.95 MB, VMS=3496.41 MB
2025-06-10 12:12:12,514 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 12:13:12,169 - src.core.embeddings - INFO - Memory usage: RSS=1146.98 MB, VMS=3721.40 MB
2025-06-10 12:13:12,170 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 12:13:40,663 - src.core.embeddings - INFO - Memory usage: RSS=1228.48 MB, VMS=3793.88 MB
2025-06-10 12:13:41,082 - src.core.embeddings - INFO - Embedding generation took 368.31 seconds
2025-06-10 12:13:41,083 - src.core.embeddings - INFO - Memory usage: RSS=1228.48 MB, VMS=3793.88 MB
2025-06-10 12:13:41,083 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 12:13:42,157 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 12:13:43,560 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 12:13:43,591 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 12:13:43,592 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 12:13:43,592 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.51 seconds
2025-06-10 12:13:43,593 - src.core.embeddings - INFO - Memory usage: RSS=1443.46 MB, VMS=4018.46 MB
2025-06-10 12:13:43,714 - src.core.embeddings - INFO - Total embedding generation took 384.73 seconds
2025-06-10 12:13:43,798 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 12:13:43,799 - src.utils.config - INFO - Loading environment variables
2025-06-10 12:13:43,973 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 12:13:43,974 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 12:13:44,204 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 12:13:44,205 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 12:13:44,206 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 12:13:44,208 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 12:13:44,209 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 12:13:44,218 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 12:13:44,219 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 12:13:44,220 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 12:13:44,220 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 12:13:44,221 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 12:13:45,857 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 12:13:45,893 - src.core.analysis - INFO - Starting analysis
2025-06-10 12:13:45,893 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 12:13:52,639 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 12:13:52,648 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 12:13:52,649 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 12:13:52,650 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 12:13:52,651 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 12:13:52,651 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 12:13:52,652 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 12:13:52,652 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 12:13:52,670 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 12:13:52,727 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 12:13:52,773 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 12:13:52,782 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 12:13:52,783 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 12:13:52,783 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 12:13:52,784 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 12:13:52,784 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 12:13:52,785 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 12:13:52,786 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 12:13:52,786 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 12:13:52,787 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 12:13:52,787 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 12:13:52,788 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 12:13:52,788 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 12:13:52,789 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 12:13:52,789 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 12:13:52,790 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 12:13:52,791 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 12:13:54,752 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 12:13:54,752 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 12:13:54,753 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 12:13:54,753 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 12:13:54,754 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 12:13:54,755 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 12:13:56,126 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 12:13:56,127 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 12:13:56,240 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 12:13:56,303 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 12:13:57,233 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 12:13:57,234 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 12:13:57,239 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 12:13:57,240 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 12:13:57,240 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 12:13:57,263 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 12:13:57,264 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 12:13:57,274 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 12:13:57,275 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 12:14:00,322 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 12:14:00,324 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 12:14:00,382 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 12:14:00,383 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 12:14:00,385 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 12:14:00,388 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 12:14:00,390 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 166328 bytes
2025-06-10 12:14:33,693 - src.core.analysis - INFO - Findings chunk 1 completed in 33.31s
2025-06-10 12:14:33,694 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 12:14:33,696 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 149704 bytes
2025-06-10 12:15:02,800 - src.core.analysis - INFO - Findings chunk 2 completed in 29.11s
2025-06-10 12:15:02,801 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 12:15:02,804 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 113940 bytes
2025-06-10 12:15:30,734 - src.core.analysis - INFO - Findings chunk 3 completed in 27.93s
2025-06-10 12:15:30,848 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 12:15:30,850 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 12:15:30,850 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 12:15:30,851 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 12:15:30,852 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 12:15:30,852 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 12:15:30,854 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 12:15:30,854 - src.core.analysis - INFO - Sequential processing completed in 90.47s
2025-06-10 12:15:30,855 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 12:15:30,856 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 12:15:30,856 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 12:15:30,858 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 12:15:30,859 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 12:15:30,860 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 12:15:30,860 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 15998 bytes
2025-06-10 12:15:44,949 - src.core.analysis - INFO - Recommendations chunk 1 completed in 14.09s
2025-06-10 12:15:45,064 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 12:15:45,065 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 12:15:45,065 - src.core.analysis - INFO - Analysis completed successfully with 11 recommendations
2025-06-10 12:20:30,996 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:11:55,448 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:12:32,365 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:12:39,309 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 13:12:40,208 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 13:12:40,209 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 13:12:40,210 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 13:12:40,210 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 13:13:36,014 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 13:13:42,429 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 13:13:42,429 - src.core.embeddings - INFO - Embedding initialization took 62.22 seconds
2025-06-10 13:13:42,431 - src.core.embeddings - INFO - Memory usage: RSS=509.88 MB, VMS=2698.74 MB
2025-06-10 13:13:42,431 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 13:13:42,432 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 13:13:42,435 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 13:13:42,482 - src.core.embeddings - INFO - Precomputed location history in 0.05 seconds
2025-06-10 13:13:43,565 - src.core.embeddings - INFO - Text generation took 1.13 seconds
2025-06-10 13:13:43,566 - src.core.embeddings - INFO - Memory usage: RSS=539.20 MB, VMS=2727.65 MB
2025-06-10 13:13:43,569 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 13:13:46,394 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 13:13:46,394 - src.core.embeddings - INFO - Document conversion took 2.82 seconds
2025-06-10 13:13:46,403 - src.core.embeddings - INFO - Memory usage: RSS=575.37 MB, VMS=2763.71 MB
2025-06-10 13:13:46,403 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 13:13:46,407 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 13:14:07,837 - src.core.embeddings - INFO - Memory usage: RSS=737.87 MB, VMS=2945.70 MB
2025-06-10 13:14:07,838 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 13:14:24,749 - src.core.embeddings - INFO - Memory usage: RSS=812.97 MB, VMS=3020.52 MB
2025-06-10 13:14:24,750 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 13:14:42,089 - src.core.embeddings - INFO - Memory usage: RSS=887.53 MB, VMS=3094.90 MB
2025-06-10 13:14:42,090 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 13:15:18,866 - src.core.embeddings - INFO - Memory usage: RSS=961.30 MB, VMS=3169.23 MB
2025-06-10 13:15:18,867 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 13:15:39,570 - src.core.embeddings - INFO - Memory usage: RSS=1035.07 MB, VMS=3242.64 MB
2025-06-10 13:15:39,572 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 13:16:20,714 - src.core.embeddings - INFO - Memory usage: RSS=911.23 MB, VMS=3317.05 MB
2025-06-10 13:16:20,715 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 13:17:08,264 - src.core.embeddings - INFO - Memory usage: RSS=1154.93 MB, VMS=3571.80 MB
2025-06-10 13:17:08,264 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 13:17:52,492 - src.core.embeddings - INFO - Memory usage: RSS=1238.66 MB, VMS=3649.44 MB
2025-06-10 13:17:52,493 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 13:18:17,515 - src.core.embeddings - INFO - Memory usage: RSS=1277.86 MB, VMS=3689.35 MB
2025-06-10 13:18:18,006 - src.core.embeddings - INFO - Embedding generation took 271.60 seconds
2025-06-10 13:18:18,007 - src.core.embeddings - INFO - Memory usage: RSS=1277.86 MB, VMS=3689.35 MB
2025-06-10 13:18:18,007 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 13:18:19,300 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 13:18:21,000 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 13:18:21,035 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 13:18:21,036 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 13:18:21,036 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.03 seconds
2025-06-10 13:18:21,037 - src.core.embeddings - INFO - Memory usage: RSS=1499.34 MB, VMS=4044.01 MB
2025-06-10 13:18:21,125 - src.core.embeddings - INFO - Total embedding generation took 340.92 seconds
2025-06-10 13:18:21,191 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 13:18:21,192 - src.utils.config - INFO - Loading environment variables
2025-06-10 13:18:21,253 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 13:18:21,255 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 13:18:21,461 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 13:18:21,462 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 13:18:21,464 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 13:18:21,464 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 13:18:21,464 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 13:18:21,472 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 13:18:21,473 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 13:18:21,474 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 13:18:21,474 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 13:18:21,475 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 13:18:24,138 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 13:18:24,183 - src.core.analysis - INFO - Starting analysis
2025-06-10 13:18:24,184 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 13:18:30,335 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 13:18:30,336 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 13:18:30,337 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 13:18:30,338 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 13:18:30,338 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 13:18:30,339 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 13:18:30,339 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 13:18:30,340 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 13:18:30,360 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 13:18:30,383 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 13:18:30,420 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 13:18:30,430 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 13:18:30,430 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 13:18:30,430 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 13:18:30,431 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 13:18:30,431 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 13:18:30,432 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 13:18:30,433 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 13:18:30,433 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 13:18:30,434 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 13:18:30,434 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 13:18:30,435 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 13:18:30,435 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 13:18:30,436 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 13:18:30,437 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 13:18:30,437 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 13:18:30,438 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 13:18:33,204 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 13:18:33,205 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 13:18:33,205 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 13:18:33,206 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 13:18:33,206 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 13:18:33,208 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 13:18:35,302 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 13:18:35,303 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 13:18:35,564 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 13:18:35,698 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 13:18:37,532 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 13:18:37,533 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 13:18:37,533 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 13:18:37,534 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 13:18:37,535 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 13:18:37,554 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 13:18:37,555 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 13:18:37,564 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 13:18:37,565 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 13:18:40,853 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 13:18:40,855 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 13:18:40,910 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 13:18:40,911 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 13:18:40,912 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 13:18:40,915 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 13:18:40,917 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 154798 bytes
2025-06-10 13:19:10,581 - src.core.analysis - INFO - Findings chunk 1 completed in 29.67s
2025-06-10 13:19:10,581 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 13:19:10,583 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 161604 bytes
2025-06-10 13:19:46,736 - src.core.analysis - INFO - Findings chunk 2 completed in 36.15s
2025-06-10 13:19:46,736 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 13:19:46,738 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 113570 bytes
2025-06-10 13:20:17,685 - src.core.analysis - INFO - Findings chunk 3 completed in 30.95s
2025-06-10 13:20:17,803 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 13:20:17,804 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 13:20:17,804 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 13:20:17,805 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 13:20:17,805 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 13:20:17,806 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 13:20:17,807 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 13:20:17,807 - src.core.analysis - INFO - Sequential processing completed in 96.89s
2025-06-10 13:20:17,807 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 13:20:17,808 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 13:20:17,808 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 13:20:17,810 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 13:20:17,811 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 13:20:17,811 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 13:20:17,812 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 11353 bytes
2025-06-10 13:20:26,494 - src.core.analysis - INFO - Recommendations chunk 1 completed in 8.68s
2025-06-10 13:20:26,601 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 13:20:26,604 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 13:20:26,604 - src.core.analysis - INFO - Analysis completed successfully with 8 recommendations
2025-06-10 13:20:26,605 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 13:20:26,606 - src.core.analysis - INFO - [BLOB DEBUG] data_dir: D:\Production\data
2025-06-10 13:20:26,606 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: []
2025-06-10 13:20:26,607 - src.core.analysis - WARNING - [BLOB DEBUG] No files found in data_dir for upload.
2025-06-10 13:24:35,778 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:27:08,656 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:27:16,702 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 13:27:16,703 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 13:27:16,704 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 13:27:16,705 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 13:27:16,706 - main - INFO - FastAPI application started
2025-06-10 13:28:55,257 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 13:28:55,259 - main - INFO - FastAPI application shutdown
2025-06-10 13:29:03,318 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:29:09,283 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 13:29:09,284 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 13:29:09,285 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 13:29:09,287 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 13:29:09,287 - main - INFO - FastAPI application started
2025-06-10 13:29:09,291 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 13:29:09,293 - main - INFO - FastAPI application shutdown
2025-06-10 13:29:20,486 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:29:24,994 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 13:29:24,994 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 13:29:24,995 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 13:29:24,997 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 13:29:24,997 - main - INFO - FastAPI application started
2025-06-10 13:29:24,999 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 13:29:25,000 - main - INFO - FastAPI application shutdown
2025-06-10 13:29:38,988 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 13:29:43,402 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 13:29:43,403 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 13:29:43,404 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 13:29:43,405 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 13:29:43,406 - main - INFO - FastAPI application started
2025-06-10 13:29:55,910 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 13:29:56,304 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 13:29:56,304 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 13:29:56,305 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 13:29:56,305 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 13:30:44,937 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 13:30:50,865 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 13:30:50,865 - src.core.embeddings - INFO - Embedding initialization took 54.56 seconds
2025-06-10 13:30:50,867 - src.core.embeddings - INFO - Memory usage: RSS=512.06 MB, VMS=2701.17 MB
2025-06-10 13:30:50,867 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 13:30:50,868 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 13:30:50,871 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 13:30:50,904 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-10 13:30:51,969 - src.core.embeddings - INFO - Text generation took 1.10 seconds
2025-06-10 13:30:51,970 - src.core.embeddings - INFO - Memory usage: RSS=541.51 MB, VMS=2730.27 MB
2025-06-10 13:30:51,970 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 13:30:54,526 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 13:30:54,527 - src.core.embeddings - INFO - Document conversion took 2.56 seconds
2025-06-10 13:30:54,527 - src.core.embeddings - INFO - Memory usage: RSS=577.70 MB, VMS=2766.34 MB
2025-06-10 13:30:54,528 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 13:30:54,530 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 13:31:09,473 - src.core.embeddings - INFO - Memory usage: RSS=740.46 MB, VMS=2947.43 MB
2025-06-10 13:31:09,473 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 13:31:25,410 - src.core.embeddings - INFO - Memory usage: RSS=815.66 MB, VMS=3022.09 MB
2025-06-10 13:31:25,411 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 13:31:39,616 - src.core.embeddings - INFO - Memory usage: RSS=890.15 MB, VMS=3096.36 MB
2025-06-10 13:31:39,617 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 13:31:53,446 - src.core.embeddings - INFO - Memory usage: RSS=963.69 MB, VMS=3170.65 MB
2025-06-10 13:31:53,447 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 13:32:07,197 - src.core.embeddings - INFO - Memory usage: RSS=1037.55 MB, VMS=3245.17 MB
2025-06-10 13:32:07,198 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 13:32:22,415 - src.core.embeddings - INFO - Memory usage: RSS=1111.05 MB, VMS=3319.21 MB
2025-06-10 13:32:22,416 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 13:32:59,762 - src.core.embeddings - INFO - Memory usage: RSS=1289.38 MB, VMS=3573.75 MB
2025-06-10 13:32:59,763 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 13:33:45,599 - src.core.embeddings - INFO - Memory usage: RSS=1249.99 MB, VMS=3650.16 MB
2025-06-10 13:33:45,599 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 13:34:08,153 - src.core.embeddings - INFO - Memory usage: RSS=1278.54 MB, VMS=3691.11 MB
2025-06-10 13:34:08,517 - src.core.embeddings - INFO - Embedding generation took 193.99 seconds
2025-06-10 13:34:08,517 - src.core.embeddings - INFO - Memory usage: RSS=1278.54 MB, VMS=3691.11 MB
2025-06-10 13:34:08,519 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 13:34:09,554 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 13:34:10,978 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 13:34:11,012 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 13:34:11,013 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 13:34:11,013 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.49 seconds
2025-06-10 13:34:11,014 - src.core.embeddings - INFO - Memory usage: RSS=1500.95 MB, VMS=4047.52 MB
2025-06-10 13:34:11,032 - src.core.embeddings - INFO - Total embedding generation took 254.73 seconds
2025-06-10 13:34:11,078 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 13:34:11,078 - src.utils.config - INFO - Loading environment variables
2025-06-10 13:34:11,133 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 13:34:11,134 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 13:34:11,275 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 13:34:11,276 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 13:34:11,277 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 13:34:11,277 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 13:34:11,278 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 13:34:11,284 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 13:34:11,284 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 13:34:11,285 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 13:34:11,285 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 13:34:11,286 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 13:34:13,752 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 13:34:13,782 - src.core.analysis - INFO - Starting analysis
2025-06-10 13:34:13,782 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 13:34:19,948 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 13:34:19,948 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 13:34:19,950 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 13:34:19,951 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 13:34:19,951 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 13:34:19,952 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 13:34:19,952 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 13:34:19,953 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 13:34:19,967 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 13:34:19,984 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 13:34:20,032 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 13:34:20,038 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 13:34:20,039 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 13:34:20,039 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 13:34:20,040 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 13:34:20,040 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 13:34:20,041 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 13:34:20,042 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 13:34:20,042 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 13:34:20,043 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 13:34:20,043 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 13:34:20,044 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 13:34:20,044 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 13:34:20,044 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 13:34:20,045 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 13:34:20,045 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 13:34:20,046 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 13:34:21,891 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 13:34:21,891 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 13:34:21,892 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 13:34:21,893 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 13:34:21,893 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 13:34:21,894 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 13:34:22,844 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 13:34:22,845 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 13:34:22,982 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 13:34:23,055 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 13:34:24,306 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 13:34:24,306 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 13:34:24,307 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 13:34:24,308 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 13:34:24,308 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 13:34:24,327 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 13:34:24,328 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 13:34:24,338 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 13:34:24,339 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 13:34:27,614 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 13:34:27,617 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 13:34:27,690 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 13:34:27,691 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 13:34:27,693 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 13:34:27,695 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 13:34:27,697 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 144830 bytes
2025-06-10 13:35:02,316 - src.core.analysis - INFO - Findings chunk 1 completed in 34.62s
2025-06-10 13:35:02,317 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 13:35:02,319 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 174649 bytes
2025-06-10 13:35:37,461 - src.core.analysis - INFO - Findings chunk 2 completed in 35.14s
2025-06-10 13:35:37,462 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 13:35:37,464 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 110493 bytes
2025-06-10 13:35:56,122 - src.core.analysis - INFO - Findings chunk 3 completed in 18.66s
2025-06-10 13:35:56,235 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 13:35:56,237 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 13:35:56,237 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 13:35:56,238 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 13:35:56,238 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 13:35:56,240 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 13:35:56,240 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 13:35:56,241 - src.core.analysis - INFO - Sequential processing completed in 88.55s
2025-06-10 13:35:56,241 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 13:35:56,242 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 13:35:56,242 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 13:35:56,244 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 13:35:56,245 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 13:35:56,245 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 13:35:56,246 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 13244 bytes
2025-06-10 13:36:07,054 - src.core.analysis - INFO - Recommendations chunk 1 completed in 10.81s
2025-06-10 13:36:07,161 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 13:36:07,162 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 13:36:07,162 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-10 13:36:07,164 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 13:36:07,165 - src.core.analysis - ERROR - Error during analysis: name 'glob' is not defined
Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 782, in analyze
    files_to_upload = glob.glob(os.path.join(data_dir, "*"))
                      ^^^^
NameError: name 'glob' is not defined. Did you forget to import 'glob'?
2025-06-10 13:36:07,171 - src.core.analysis - ERROR - Failed to run analysis: name 'glob' is not defined
Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 810, in run_analysis
    result = await app.ainvoke({
             ^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    })
    ^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2788, in ainvoke
    async for chunk in self.astream(
    ...<19 lines>...
            chunks.append(chunk)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2655, in astream
    async for _ in runner.atick(
    ...<7 lines>...
            yield o
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\runner.py", line 294, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\retry.py", line 136, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 672, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
        step.ainvoke(input, config, **kwargs), context=context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 440, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Production\backend\src\core\analysis.py", line 782, in analyze
    files_to_upload = glob.glob(os.path.join(data_dir, "*"))
                      ^^^^
NameError: name 'glob' is not defined. Did you forget to import 'glob'?
During task with name 'analyze' and id '64a35e9a-dafb-d9eb-bb06-e8c20426cf53'
2025-06-10 14:30:05,150 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 14:30:35,820 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 14:30:35,821 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 14:30:35,821 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 14:30:35,823 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 14:30:35,824 - main - INFO - FastAPI application started
2025-06-10 14:35:07,221 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 14:35:07,224 - main - INFO - FastAPI application shutdown
2025-06-10 14:35:16,094 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 14:35:21,508 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 14:35:21,509 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 14:35:21,509 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 14:35:21,511 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 14:35:21,511 - main - INFO - FastAPI application started
2025-06-10 14:35:21,513 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 14:35:21,950 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 14:35:21,951 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 14:35:21,951 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 14:35:21,952 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 14:36:06,777 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 14:36:12,056 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 14:36:12,057 - src.core.embeddings - INFO - Embedding initialization took 50.10 seconds
2025-06-10 14:36:12,058 - src.core.embeddings - INFO - Memory usage: RSS=511.43 MB, VMS=2700.28 MB
2025-06-10 14:36:12,058 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 14:36:12,059 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 14:36:12,062 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 14:36:12,109 - src.core.embeddings - INFO - Precomputed location history in 0.05 seconds
2025-06-10 14:36:13,270 - src.core.embeddings - INFO - Text generation took 1.21 seconds
2025-06-10 14:36:13,271 - src.core.embeddings - INFO - Memory usage: RSS=540.99 MB, VMS=2729.43 MB
2025-06-10 14:36:13,271 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 14:36:15,950 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 14:36:15,950 - src.core.embeddings - INFO - Document conversion took 2.68 seconds
2025-06-10 14:36:15,951 - src.core.embeddings - INFO - Memory usage: RSS=577.12 MB, VMS=2765.50 MB
2025-06-10 14:36:15,952 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 14:36:15,954 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 14:36:30,420 - src.core.embeddings - INFO - Memory usage: RSS=738.86 MB, VMS=2945.61 MB
2025-06-10 14:36:30,421 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 14:36:46,240 - src.core.embeddings - INFO - Memory usage: RSS=813.82 MB, VMS=3020.74 MB
2025-06-10 14:36:46,241 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 14:37:01,543 - src.core.embeddings - INFO - Memory usage: RSS=888.94 MB, VMS=3095.33 MB
2025-06-10 14:37:01,544 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 14:37:16,378 - src.core.embeddings - INFO - Memory usage: RSS=962.40 MB, VMS=3169.50 MB
2025-06-10 14:37:16,379 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 14:37:30,631 - src.core.embeddings - INFO - Memory usage: RSS=1036.09 MB, VMS=3243.72 MB
2025-06-10 14:37:30,632 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 14:37:45,042 - src.core.embeddings - INFO - Memory usage: RSS=1109.76 MB, VMS=3318.04 MB
2025-06-10 14:37:45,043 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 14:38:19,191 - src.core.embeddings - INFO - Memory usage: RSS=1366.92 MB, VMS=3572.41 MB
2025-06-10 14:38:19,192 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 14:39:00,232 - src.core.embeddings - INFO - Memory usage: RSS=1443.42 MB, VMS=3648.75 MB
2025-06-10 14:39:00,233 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 14:39:22,756 - src.core.embeddings - INFO - Memory usage: RSS=1482.39 MB, VMS=3688.93 MB
2025-06-10 14:39:23,157 - src.core.embeddings - INFO - Embedding generation took 187.21 seconds
2025-06-10 14:39:23,158 - src.core.embeddings - INFO - Memory usage: RSS=1482.39 MB, VMS=3688.93 MB
2025-06-10 14:39:23,159 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 14:39:24,104 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 14:39:25,415 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 14:39:25,435 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 14:39:25,436 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 14:39:25,437 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.28 seconds
2025-06-10 14:39:25,437 - src.core.embeddings - INFO - Memory usage: RSS=1698.05 MB, VMS=4043.91 MB
2025-06-10 14:39:25,449 - src.core.embeddings - INFO - Total embedding generation took 243.50 seconds
2025-06-10 14:39:25,505 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 14:39:25,505 - src.utils.config - INFO - Loading environment variables
2025-06-10 14:39:25,508 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 14:39:25,508 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 14:39:25,670 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 14:39:25,671 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 14:39:25,672 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 14:39:25,672 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 14:39:25,673 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 14:39:25,678 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 14:39:25,679 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 14:39:25,680 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 14:39:25,680 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 14:39:25,682 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 14:39:27,439 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 14:39:27,471 - src.core.analysis - INFO - Starting analysis
2025-06-10 14:39:27,471 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 14:39:30,203 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 14:39:30,204 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 14:39:30,205 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 14:39:30,206 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 14:39:30,206 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 14:39:30,207 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 14:39:30,207 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 14:39:30,208 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 14:39:30,223 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 14:39:30,241 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 14:39:30,270 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 14:39:30,277 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 14:39:30,277 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 14:39:30,278 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 14:39:30,278 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 14:39:30,279 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 14:39:30,280 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 14:39:30,280 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 14:39:30,280 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 14:39:30,281 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 14:39:30,281 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 14:39:30,282 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 14:39:30,283 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 14:39:30,284 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 14:39:30,285 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 14:39:30,285 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 14:39:30,286 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 14:39:31,591 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 14:39:31,592 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 14:39:31,593 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 14:39:31,593 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 14:39:31,594 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 14:39:31,595 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 14:39:32,562 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 14:39:32,563 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 14:39:32,685 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 14:39:32,771 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 14:39:33,986 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 14:39:33,987 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 14:39:33,988 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 14:39:33,988 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 14:39:33,989 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 14:39:34,007 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 14:39:34,008 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 14:39:34,016 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 14:39:34,017 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 14:39:36,886 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 14:39:36,888 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 14:39:36,945 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 14:39:36,946 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 14:39:36,949 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 14:39:36,952 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 14:39:36,954 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 173785 bytes
2025-06-10 14:40:11,506 - src.core.analysis - INFO - Findings chunk 1 completed in 34.55s
2025-06-10 14:40:11,507 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 14:40:11,508 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 156478 bytes
2025-06-10 14:40:32,835 - src.core.analysis - INFO - Findings chunk 2 completed in 21.33s
2025-06-10 14:40:32,836 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 14:40:32,838 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 99709 bytes
2025-06-10 14:41:03,100 - src.core.analysis - INFO - Findings chunk 3 completed in 30.26s
2025-06-10 14:41:03,211 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 14:41:03,213 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 14:41:03,213 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 14:41:03,214 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 14:41:03,214 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 14:41:03,215 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 14:41:03,216 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 14:41:03,216 - src.core.analysis - INFO - Sequential processing completed in 86.27s
2025-06-10 14:41:03,216 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 14:41:03,217 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 14:41:03,217 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 14:41:03,218 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 14:41:03,219 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 14:41:03,220 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 14:41:03,220 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 16049 bytes
2025-06-10 14:41:13,361 - src.core.analysis - INFO - Recommendations chunk 1 completed in 10.14s
2025-06-10 14:41:13,476 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 14:41:13,477 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 14:41:13,477 - src.core.analysis - INFO - Analysis completed successfully with 8 recommendations
2025-06-10 14:41:13,478 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:13,479 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-10 14:41:13,481 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-10 14:41:13,482 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/analyze.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:13,935 - src.utils.azure_blob - ERROR - Failed to upload D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview/analyze.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D: 400 <?xml version="1.0" encoding="utf-8"?><Error><Code>UnsupportedHeader</Code><Message>One of the HTTP headers specified in the request is not supported.
RequestId:0da983cb-601e-0055-60e7-d920a6000000
Time:2025-06-10T09:11:14.9824050Z</Message><HeaderName>Transfer-Encoding</HeaderName></Error>
2025-06-10 14:41:13,936 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-10 14:41:13,937 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_roles.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:14,510 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview/app_roles.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:14,511 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-10 14:41:14,512 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_roles.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:15,180 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview/app_roles.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:15,183 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-10 14:41:15,184 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:15,742 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:15,745 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-10 14:41:15,746 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:16,448 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:16,449 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-10 14:41:16,450 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:17,440 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:17,441 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-10 14:41:17,442 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:18,788 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:18,789 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-10 14:41:18,790 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/business_units.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:19,124 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview/business_units.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:19,125 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-10 14:41:19,126 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/business_units.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:19,488 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview/business_units.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:19,489 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-10 14:41:19,490 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:19,985 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:19,986 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-10 14:41:19,987 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:20,464 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:20,465 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-10 14:41:20,466 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:21,527 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:21,530 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-10 14:41:21,531 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:22,800 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:22,803 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-10 14:41:22,804 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:23,233 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:23,234 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-10 14:41:23,234 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:23,729 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:23,732 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-10 14:41:23,732 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:24,212 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:24,213 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-10 14:41:24,214 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:24,760 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:24,761 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-10 14:41:24,762 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/user_details.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:25,324 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview/user_details.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:25,325 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-10 14:41:25,325 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/user_details.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 14:41:25,989 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview/user_details.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 15:34:10,361 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 15:34:10,474 - main - INFO - FastAPI application shutdown
2025-06-10 15:35:11,518 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 15:36:18,476 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 15:36:18,478 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 15:36:18,480 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 15:36:18,483 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 15:36:18,487 - main - INFO - FastAPI application started
2025-06-10 15:39:37,105 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 15:39:37,111 - main - INFO - FastAPI application shutdown
2025-06-10 15:39:57,475 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 15:40:09,175 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 15:40:09,176 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 15:40:09,178 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 15:40:09,180 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 15:40:09,180 - main - INFO - FastAPI application started
2025-06-10 15:57:13,882 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 15:57:13,892 - main - INFO - FastAPI application shutdown
2025-06-10 15:57:40,239 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 15:58:06,753 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 15:58:06,753 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 15:58:06,754 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 15:58:06,755 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 15:58:06,756 - main - INFO - FastAPI application started
2025-06-10 18:09:36,181 - main - INFO - [analyze] Endpoint called
2025-06-10 18:09:36,222 - main - INFO - [analyze] Loading data from D:\Production\backend\data
2025-06-10 18:09:36,238 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 18:09:37,345 - main - INFO - [analyze] Generating embeddings for analysis...
2025-06-10 18:09:37,350 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 18:09:37,351 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 18:09:37,352 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 18:09:37,358 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 18:10:27,101 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 18:10:32,822 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 18:10:32,823 - src.core.embeddings - INFO - Embedding initialization took 55.46 seconds
2025-06-10 18:10:32,825 - src.core.embeddings - INFO - Memory usage: RSS=357.74 MB, VMS=2697.62 MB
2025-06-10 18:10:32,826 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 18:10:32,827 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 18:10:32,831 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 18:10:32,895 - src.core.embeddings - INFO - Precomputed location history in 0.06 seconds
2025-06-10 18:10:34,021 - src.core.embeddings - INFO - Text generation took 1.19 seconds
2025-06-10 18:10:34,022 - src.core.embeddings - INFO - Memory usage: RSS=388.72 MB, VMS=2727.77 MB
2025-06-10 18:10:34,023 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 18:10:37,209 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 18:10:37,210 - src.core.embeddings - INFO - Document conversion took 3.19 seconds
2025-06-10 18:10:37,210 - src.core.embeddings - INFO - Memory usage: RSS=424.95 MB, VMS=2763.84 MB
2025-06-10 18:10:37,211 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 18:10:37,214 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 18:10:59,166 - src.core.embeddings - INFO - Memory usage: RSS=589.03 MB, VMS=2945.02 MB
2025-06-10 18:10:59,167 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 18:11:12,428 - src.core.embeddings - INFO - Memory usage: RSS=664.36 MB, VMS=3020.11 MB
2025-06-10 18:11:12,429 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 18:11:26,710 - src.core.embeddings - INFO - Memory usage: RSS=738.95 MB, VMS=3094.55 MB
2025-06-10 18:11:26,712 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 18:11:42,692 - src.core.embeddings - INFO - Memory usage: RSS=812.38 MB, VMS=3168.61 MB
2025-06-10 18:11:42,693 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 18:11:59,210 - src.core.embeddings - INFO - Memory usage: RSS=875.77 MB, VMS=3242.93 MB
2025-06-10 18:11:59,211 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 18:12:16,978 - src.core.embeddings - INFO - Memory usage: RSS=949.67 MB, VMS=3317.36 MB
2025-06-10 18:12:16,979 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 18:13:30,094 - src.core.embeddings - INFO - Memory usage: RSS=1119.71 MB, VMS=3571.91 MB
2025-06-10 18:13:30,095 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 18:15:11,772 - src.core.embeddings - INFO - Memory usage: RSS=1125.61 MB, VMS=3567.88 MB
2025-06-10 18:15:11,773 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 18:16:13,763 - src.core.embeddings - INFO - Memory usage: RSS=1084.52 MB, VMS=3503.82 MB
2025-06-10 18:16:14,285 - src.core.embeddings - INFO - Embedding generation took 337.07 seconds
2025-06-10 18:16:14,286 - src.core.embeddings - INFO - Memory usage: RSS=1084.81 MB, VMS=3503.82 MB
2025-06-10 18:16:14,286 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 18:16:15,693 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 18:16:18,225 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 18:16:18,258 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 18:16:18,258 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 18:16:18,259 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.97 seconds
2025-06-10 18:16:18,260 - src.core.embeddings - INFO - Memory usage: RSS=1306.19 MB, VMS=3858.34 MB
2025-06-10 18:16:18,332 - src.core.embeddings - INFO - Total embedding generation took 400.98 seconds
2025-06-10 18:16:18,406 - main - INFO - [analyze] Running analysis pipeline...
2025-06-10 18:16:18,409 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 18:16:18,411 - src.utils.config - INFO - Loading environment variables
2025-06-10 18:16:18,521 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 18:16:18,523 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 18:16:18,810 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:16:18,811 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 18:16:18,811 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 18:16:18,813 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 18:16:18,813 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 18:16:18,824 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 18:16:18,824 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 18:16:18,824 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 18:16:18,825 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 18:16:18,825 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 18:16:23,286 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 18:16:23,312 - main - INFO - [analyze] Endpoint called
2025-06-10 18:16:23,313 - main - INFO - [analyze] Loading data from D:\Production\backend\data
2025-06-10 18:16:23,316 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 18:16:23,901 - main - INFO - [analyze] Generating embeddings for analysis...
2025-06-10 18:16:23,902 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 18:16:23,903 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 18:16:23,903 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 18:16:23,904 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 18:16:23,909 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 18:16:27,275 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 18:16:27,276 - src.core.embeddings - INFO - Embedding initialization took 3.37 seconds
2025-06-10 18:16:27,276 - src.core.embeddings - INFO - Memory usage: RSS=1205.13 MB, VMS=3855.21 MB
2025-06-10 18:16:27,277 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 18:16:27,277 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 18:16:27,279 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 18:16:27,319 - src.core.embeddings - INFO - Precomputed location history in 0.04 seconds
2025-06-10 18:16:29,723 - src.core.embeddings - INFO - Text generation took 2.45 seconds
2025-06-10 18:16:29,724 - src.core.embeddings - INFO - Memory usage: RSS=1210.05 MB, VMS=3859.22 MB
2025-06-10 18:16:29,724 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 18:16:33,934 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 18:16:33,934 - src.core.embeddings - INFO - Document conversion took 4.21 seconds
2025-06-10 18:16:33,940 - src.core.embeddings - INFO - Memory usage: RSS=1246.29 MB, VMS=3895.29 MB
2025-06-10 18:16:33,940 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 18:16:33,943 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 18:17:06,582 - src.core.embeddings - INFO - Memory usage: RSS=1356.80 MB, VMS=3959.43 MB
2025-06-10 18:17:06,582 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 18:17:39,291 - src.core.embeddings - INFO - Memory usage: RSS=1398.94 MB, VMS=4034.38 MB
2025-06-10 18:17:39,292 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 18:18:09,381 - src.core.embeddings - INFO - Memory usage: RSS=1409.51 MB, VMS=4108.08 MB
2025-06-10 18:18:09,382 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 18:18:43,348 - src.core.embeddings - INFO - Memory usage: RSS=1451.55 MB, VMS=4182.37 MB
2025-06-10 18:18:43,348 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 18:19:11,792 - src.core.embeddings - INFO - Memory usage: RSS=1519.31 MB, VMS=4256.22 MB
2025-06-10 18:19:11,793 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 18:19:47,795 - src.core.embeddings - INFO - Memory usage: RSS=1584.92 MB, VMS=4331.31 MB
2025-06-10 18:19:47,796 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 18:21:46,298 - src.core.embeddings - INFO - Memory usage: RSS=1581.48 MB, VMS=4349.51 MB
2025-06-10 18:21:46,308 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 18:24:21,475 - src.core.embeddings - INFO - Memory usage: RSS=1685.25 MB, VMS=4571.54 MB
2025-06-10 18:24:21,493 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 18:25:42,815 - src.core.embeddings - INFO - Memory usage: RSS=1760.75 MB, VMS=4507.77 MB
2025-06-10 18:25:43,580 - src.core.embeddings - INFO - Embedding generation took 549.64 seconds
2025-06-10 18:25:43,580 - src.core.embeddings - INFO - Memory usage: RSS=1761.08 MB, VMS=4507.77 MB
2025-06-10 18:25:43,581 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 18:25:45,364 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 18:25:47,396 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 18:25:47,435 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 18:25:47,436 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 18:25:47,436 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.85 seconds
2025-06-10 18:25:47,437 - src.core.embeddings - INFO - Memory usage: RSS=1973.45 MB, VMS=4734.20 MB
2025-06-10 18:25:47,526 - src.core.embeddings - INFO - Total embedding generation took 563.62 seconds
2025-06-10 18:25:47,571 - main - INFO - [analyze] Running analysis pipeline...
2025-06-10 18:25:47,574 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 18:25:47,575 - src.utils.config - INFO - Loading environment variables
2025-06-10 18:25:47,682 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 18:25:47,682 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 18:25:47,939 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:25:47,941 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 18:25:47,942 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 18:25:47,942 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 18:25:47,942 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 18:25:47,954 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 18:25:47,954 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 18:25:47,955 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 18:25:47,955 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 18:25:47,956 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 18:25:49,484 - main - INFO - [analyze] Endpoint called
2025-06-10 18:25:49,485 - main - INFO - [analyze] Loading data from D:\Production\backend\data
2025-06-10 18:25:49,486 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 18:25:50,123 - main - INFO - [analyze] Generating embeddings for analysis...
2025-06-10 18:25:50,123 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 18:25:50,124 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 18:25:50,124 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 18:25:50,125 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 18:25:50,133 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 18:25:53,670 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 18:25:53,670 - src.core.embeddings - INFO - Embedding initialization took 3.54 seconds
2025-06-10 18:25:53,671 - src.core.embeddings - INFO - Memory usage: RSS=1868.88 MB, VMS=4720.16 MB
2025-06-10 18:25:53,671 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 18:25:53,671 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 18:25:53,673 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 18:25:53,707 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-10 18:25:56,074 - src.core.embeddings - INFO - Text generation took 2.40 seconds
2025-06-10 18:25:56,074 - src.core.embeddings - INFO - Memory usage: RSS=1872.39 MB, VMS=4720.16 MB
2025-06-10 18:25:56,075 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 18:25:59,876 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 18:25:59,876 - src.core.embeddings - INFO - Document conversion took 3.80 seconds
2025-06-10 18:25:59,879 - src.core.embeddings - INFO - Memory usage: RSS=1908.21 MB, VMS=4756.23 MB
2025-06-10 18:25:59,879 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 18:25:59,883 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 18:26:26,444 - src.core.embeddings - INFO - Memory usage: RSS=1889.08 MB, VMS=4815.20 MB
2025-06-10 18:26:26,450 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 18:26:50,587 - src.core.embeddings - INFO - Memory usage: RSS=1967.48 MB, VMS=4887.21 MB
2025-06-10 18:26:50,590 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 18:27:05,613 - src.core.embeddings - INFO - Memory usage: RSS=2050.35 MB, VMS=4960.75 MB
2025-06-10 18:27:05,614 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 18:27:23,064 - src.core.embeddings - INFO - Memory usage: RSS=2131.23 MB, VMS=5035.07 MB
2025-06-10 18:27:23,064 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 18:28:32,483 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 18:28:55,212 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 18:28:55,212 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 18:28:55,213 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 18:28:55,214 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 18:28:55,215 - main - INFO - FastAPI application started
2025-06-10 18:29:26,552 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 18:29:26,757 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 18:29:26,758 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 18:29:26,758 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 18:29:26,759 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 18:30:10,977 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 18:30:16,177 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 18:30:16,177 - src.core.embeddings - INFO - Embedding initialization took 49.42 seconds
2025-06-10 18:30:16,178 - src.core.embeddings - INFO - Memory usage: RSS=510.93 MB, VMS=2700.26 MB
2025-06-10 18:30:16,179 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 18:30:16,179 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 18:30:16,182 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 18:30:16,213 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-10 18:30:17,229 - src.core.embeddings - INFO - Text generation took 1.05 seconds
2025-06-10 18:30:17,229 - src.core.embeddings - INFO - Memory usage: RSS=540.50 MB, VMS=2729.41 MB
2025-06-10 18:30:17,230 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 18:30:19,512 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 18:30:19,512 - src.core.embeddings - INFO - Document conversion took 2.28 seconds
2025-06-10 18:30:19,513 - src.core.embeddings - INFO - Memory usage: RSS=576.64 MB, VMS=2765.47 MB
2025-06-10 18:30:19,514 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 18:30:19,517 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 18:30:33,293 - src.core.embeddings - INFO - Memory usage: RSS=738.26 MB, VMS=2945.21 MB
2025-06-10 18:30:33,295 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 18:30:47,801 - src.core.embeddings - INFO - Memory usage: RSS=813.88 MB, VMS=3020.71 MB
2025-06-10 18:30:47,801 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 18:31:02,119 - src.core.embeddings - INFO - Memory usage: RSS=888.86 MB, VMS=3095.52 MB
2025-06-10 18:31:02,120 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 18:31:15,884 - src.core.embeddings - INFO - Memory usage: RSS=962.44 MB, VMS=3169.61 MB
2025-06-10 18:31:15,885 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 18:31:29,556 - src.core.embeddings - INFO - Memory usage: RSS=1036.02 MB, VMS=3243.79 MB
2025-06-10 18:31:29,557 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 18:31:43,459 - src.core.embeddings - INFO - Memory usage: RSS=1109.86 MB, VMS=3318.12 MB
2025-06-10 18:31:43,460 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 18:32:16,705 - src.core.embeddings - INFO - Memory usage: RSS=1367.16 MB, VMS=3572.86 MB
2025-06-10 18:32:16,706 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 18:32:56,258 - src.core.embeddings - INFO - Memory usage: RSS=1333.79 MB, VMS=3649.92 MB
2025-06-10 18:32:56,259 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 18:33:17,081 - src.core.embeddings - INFO - Memory usage: RSS=1372.95 MB, VMS=3689.65 MB
2025-06-10 18:33:17,447 - src.core.embeddings - INFO - Embedding generation took 177.93 seconds
2025-06-10 18:33:17,448 - src.core.embeddings - INFO - Memory usage: RSS=1372.95 MB, VMS=3689.65 MB
2025-06-10 18:33:17,449 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 18:33:18,330 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 18:33:19,532 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 18:33:19,548 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 18:33:19,550 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 18:33:19,550 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.10 seconds
2025-06-10 18:33:19,551 - src.core.embeddings - INFO - Memory usage: RSS=1590.93 MB, VMS=4046.39 MB
2025-06-10 18:33:19,563 - src.core.embeddings - INFO - Total embedding generation took 232.81 seconds
2025-06-10 18:33:19,601 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 18:33:19,602 - src.utils.config - INFO - Loading environment variables
2025-06-10 18:33:19,604 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 18:33:19,604 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 18:33:19,733 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:33:19,734 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 18:33:19,735 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 18:33:19,735 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 18:33:19,736 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 18:33:19,740 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 18:33:19,741 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 18:33:19,741 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 18:33:19,742 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 18:33:19,742 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 18:33:21,739 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 18:33:21,775 - src.core.analysis - INFO - Starting analysis
2025-06-10 18:33:21,775 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 18:33:24,542 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 18:33:24,543 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 18:33:24,544 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 18:33:24,545 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 18:33:24,545 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 18:33:24,546 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:33:24,546 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 18:33:24,547 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 18:33:24,560 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 18:33:24,579 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 18:33:24,605 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 18:33:24,614 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 18:33:24,614 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 18:33:24,615 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 18:33:24,615 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 18:33:24,616 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 18:33:24,616 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 18:33:24,616 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 18:33:24,617 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 18:33:24,617 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 18:33:24,618 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 18:33:24,618 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 18:33:24,618 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 18:33:24,619 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 18:33:24,619 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 18:33:24,619 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 18:33:24,620 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 18:33:26,097 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 18:33:26,098 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 18:33:26,098 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 18:33:26,099 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 18:33:26,099 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 18:33:26,100 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 18:33:27,204 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 18:33:27,205 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 18:33:27,304 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 18:33:27,373 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 18:33:28,502 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 18:33:28,503 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 18:33:28,504 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 18:33:28,504 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 18:33:28,505 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:33:28,519 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 18:33:28,520 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 18:33:28,531 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 18:33:28,532 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 18:33:30,993 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 18:33:30,995 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 18:33:31,046 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 18:33:31,046 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 18:33:31,048 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 18:33:31,051 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 18:33:31,052 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 166463 bytes
2025-06-10 18:34:10,741 - src.core.analysis - INFO - Findings chunk 1 completed in 39.69s
2025-06-10 18:34:10,741 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 18:34:10,743 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 158376 bytes
2025-06-10 18:34:40,707 - src.core.analysis - INFO - Findings chunk 2 completed in 29.97s
2025-06-10 18:34:40,708 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 18:34:40,709 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 105133 bytes
2025-06-10 18:35:09,375 - src.core.analysis - INFO - Findings chunk 3 completed in 28.67s
2025-06-10 18:35:09,494 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 18:35:09,496 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 18:35:09,497 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 18:35:09,497 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 18:35:09,498 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 18:35:09,499 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 18:35:09,500 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 18:35:09,500 - src.core.analysis - INFO - Sequential processing completed in 98.45s
2025-06-10 18:35:09,500 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 18:35:09,501 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 18:35:09,501 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 18:35:09,503 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 18:35:09,503 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 18:35:09,504 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 18:35:09,504 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 16797 bytes
2025-06-10 18:35:22,452 - src.core.analysis - INFO - Recommendations chunk 1 completed in 12.95s
2025-06-10 18:35:22,563 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 18:35:22,563 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 18:35:22,564 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-10 18:35:22,564 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:22,565 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-10 18:35:22,567 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-10 18:35:22,568 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/analyze.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:22,997 - src.utils.azure_blob - ERROR - Failed to upload D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview/analyze.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D: 400 <?xml version="1.0" encoding="utf-8"?><Error><Code>UnsupportedHeader</Code><Message>One of the HTTP headers specified in the request is not supported.
RequestId:67237bcd-d01e-0032-0b08-da305a000000
Time:2025-06-10T13:05:24.1474805Z</Message><HeaderName>Transfer-Encoding</HeaderName></Error>
2025-06-10 18:35:22,999 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-10 18:35:22,999 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_roles.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:23,594 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview/app_roles.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:23,595 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-10 18:35:23,595 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_roles.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:24,250 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview/app_roles.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:24,251 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-10 18:35:24,252 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:24,850 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:24,851 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-10 18:35:24,851 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:25,482 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview/app_role_assignments.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:25,484 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-10 18:35:25,485 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:26,403 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:26,404 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-10 18:35:26,405 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:27,598 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview/audit_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:27,599 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-10 18:35:27,600 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/business_units.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:27,951 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview/business_units.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:27,952 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-10 18:35:27,953 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/business_units.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:28,306 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview/business_units.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:28,308 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-10 18:35:28,309 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:28,833 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:28,834 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-10 18:35:28,835 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:29,306 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview/conditional_access_policies.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:29,307 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-10 18:35:29,308 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:30,305 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:30,307 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-10 18:35:30,308 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:31,474 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview/signin_logs.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:31,477 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-10 18:35:31,477 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:31,919 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:31,920 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-10 18:35:31,921 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:32,419 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview/users_without_d365_license.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:32,421 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-10 18:35:32,422 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:32,951 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:32,952 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-10 18:35:32,953 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:33,534 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview/users_without_entra_id.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:33,536 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-10 18:35:33,536 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/user_details.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:34,151 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview/user_details.csv?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:34,154 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-10 18:35:34,156 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview/user_details.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:34,735 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview/user_details.json?si=key1&sv=2024-11-04&sr=c&sig=mEOKR7nFMBENbKKqmMo41GiKZsY8ss2yzbjdeVrhw0E%3D
2025-06-10 18:35:34,741 - main - INFO - Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-10 18:35:34,763 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '68837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '98972628-45fb-11f0-b5a2-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:35:35,162 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 403
Response headers:
    'Content-Length': '544'
    'Content-Type': 'application/xml'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f5dbe3e1-601e-008e-0e08-dae69b000000'
    'x-ms-error-code': 'AuthenticationFailed'
    'Date': 'Tue, 10 Jun 2025 13:05:35 GMT'
2025-06-10 18:35:35,167 - main - ERROR - Analysis failed: Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.
RequestId:f5dbe3e1-601e-008e-0e08-dae69b000000
Time:2025-06-10T13:05:36.2492626Z
ErrorCode:AuthenticationFailed
authenticationerrordetail:Signature not valid in the specified time frame: Start [Mon, 09 Jun 2025 05:35:52 GMT] - Expiry [Mon, 09 Jun 2025 13:35:52 GMT] - Current [Tue, 10 Jun 2025 13:05:36 GMT]
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>AuthenticationFailed</Code><Message>Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.
RequestId:f5dbe3e1-601e-008e-0e08-dae69b000000
Time:2025-06-10T13:05:36.2492626Z</Message><AuthenticationErrorDetail>Signature not valid in the specified time frame: Start [Mon, 09 Jun 2025 05:35:52 GMT] - Expiry [Mon, 09 Jun 2025 13:35:52 GMT] - Current [Tue, 10 Jun 2025 13:05:36 GMT]</AuthenticationErrorDetail></Error>
2025-06-10 18:42:32,576 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 18:42:32,622 - main - INFO - FastAPI application shutdown
2025-06-10 18:43:03,196 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 18:44:12,159 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 18:44:18,097 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 18:44:18,098 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 18:44:18,099 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 18:44:18,101 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 18:44:18,101 - main - INFO - FastAPI application started
2025-06-10 18:46:38,186 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 18:46:38,187 - main - INFO - FastAPI application shutdown
2025-06-10 18:46:45,429 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 18:46:51,239 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 18:46:51,240 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 18:46:51,240 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 18:46:51,242 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 18:46:51,242 - main - INFO - FastAPI application started
2025-06-10 18:49:47,791 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 18:49:47,805 - main - INFO - FastAPI application shutdown
2025-06-10 18:50:13,580 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 18:50:37,799 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 18:50:37,801 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 18:50:37,802 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 18:50:37,809 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 18:50:37,811 - main - INFO - FastAPI application started
2025-06-10 18:50:45,868 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-10 18:50:45,869 - main - INFO - FastAPI application shutdown
2025-06-10 18:50:53,725 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-10 18:50:59,515 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 18:50:59,516 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-10 18:50:59,516 - apscheduler.scheduler - INFO - Scheduler started
2025-06-10 18:50:59,518 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-10 18:50:59,518 - main - INFO - FastAPI application started
2025-06-10 18:50:59,522 - src.core.data_loader - INFO - Loading data from CSV files in D:\Production\backend\data
2025-06-10 18:50:59,992 - src.core.embeddings - INFO - Starting embedding generation
2025-06-10 18:50:59,993 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-10 18:50:59,994 - src.core.embeddings - INFO - Using batch_size=64
2025-06-10 18:50:59,994 - src.core.embeddings - INFO - Using device: cpu
2025-06-10 18:51:37,834 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-10 18:51:43,266 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-10 18:51:43,267 - src.core.embeddings - INFO - Embedding initialization took 43.27 seconds
2025-06-10 18:51:43,269 - src.core.embeddings - INFO - Memory usage: RSS=510.73 MB, VMS=2700.43 MB
2025-06-10 18:51:43,269 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-10 18:51:43,269 - src.core.embeddings - INFO - Using all logs: audit_logs=31505 rows, signin_logs=11204 rows
2025-06-10 18:51:43,272 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-10 18:51:43,303 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-10 18:51:44,339 - src.core.embeddings - INFO - Text generation took 1.07 seconds
2025-06-10 18:51:44,340 - src.core.embeddings - INFO - Memory usage: RSS=540.30 MB, VMS=2729.57 MB
2025-06-10 18:51:44,341 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-10 18:51:46,991 - src.core.embeddings - INFO - Total documents to embed: 42709
2025-06-10 18:51:46,992 - src.core.embeddings - INFO - Document conversion took 2.65 seconds
2025-06-10 18:51:46,992 - src.core.embeddings - INFO - Memory usage: RSS=576.42 MB, VMS=2765.57 MB
2025-06-10 18:51:46,993 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-10 18:51:46,995 - src.core.embeddings - INFO - Embedding chunk 1/9 (5000 documents)
2025-06-10 18:52:03,140 - src.core.embeddings - INFO - Memory usage: RSS=736.22 MB, VMS=2946.34 MB
2025-06-10 18:52:03,141 - src.core.embeddings - INFO - Embedding chunk 2/9 (5000 documents)
2025-06-10 18:52:17,576 - src.core.embeddings - INFO - Memory usage: RSS=811.38 MB, VMS=3021.10 MB
2025-06-10 18:52:17,577 - src.core.embeddings - INFO - Embedding chunk 3/9 (5000 documents)
2025-06-10 18:52:30,998 - src.core.embeddings - INFO - Memory usage: RSS=886.28 MB, VMS=3095.69 MB
2025-06-10 18:52:31,001 - src.core.embeddings - INFO - Embedding chunk 4/9 (5000 documents)
2025-06-10 18:52:44,409 - src.core.embeddings - INFO - Memory usage: RSS=960.15 MB, VMS=3170.23 MB
2025-06-10 18:52:44,410 - src.core.embeddings - INFO - Embedding chunk 5/9 (5000 documents)
2025-06-10 18:52:57,640 - src.core.embeddings - INFO - Memory usage: RSS=1034.05 MB, VMS=3244.72 MB
2025-06-10 18:52:57,641 - src.core.embeddings - INFO - Embedding chunk 6/9 (5000 documents)
2025-06-10 18:53:10,732 - src.core.embeddings - INFO - Memory usage: RSS=1107.30 MB, VMS=3318.36 MB
2025-06-10 18:53:10,733 - src.core.embeddings - INFO - Embedding chunk 7/9 (5000 documents)
2025-06-10 18:53:46,333 - src.core.embeddings - INFO - Memory usage: RSS=1278.21 MB, VMS=3573.55 MB
2025-06-10 18:53:46,334 - src.core.embeddings - INFO - Embedding chunk 8/9 (5000 documents)
2025-06-10 18:54:26,574 - src.core.embeddings - INFO - Memory usage: RSS=1355.13 MB, VMS=3650.59 MB
2025-06-10 18:54:26,575 - src.core.embeddings - INFO - Embedding chunk 9/9 (2709 documents)
2025-06-10 18:54:48,445 - src.core.embeddings - INFO - Memory usage: RSS=1374.44 MB, VMS=3691.04 MB
2025-06-10 18:54:48,845 - src.core.embeddings - INFO - Embedding generation took 181.85 seconds
2025-06-10 18:54:48,846 - src.core.embeddings - INFO - Memory usage: RSS=1374.44 MB, VMS=3691.04 MB
2025-06-10 18:54:48,846 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-10 18:54:49,863 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 42709 vectors
2025-06-10 18:54:51,379 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-10 18:54:51,399 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-10 18:54:51,399 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-10 18:54:51,400 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.55 seconds
2025-06-10 18:54:51,402 - src.core.embeddings - INFO - Memory usage: RSS=1591.82 MB, VMS=4046.46 MB
2025-06-10 18:54:51,419 - src.core.embeddings - INFO - Total embedding generation took 231.43 seconds
2025-06-10 18:54:51,472 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-10 18:54:51,472 - src.utils.config - INFO - Loading environment variables
2025-06-10 18:54:51,476 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-10 18:54:51,476 - src.core.analysis - INFO - Validating input DataFrames
2025-06-10 18:54:51,616 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:54:51,616 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 18:54:51,617 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 18:54:51,617 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-10 18:54:51,619 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-10 18:54:51,625 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-10 18:54:51,625 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-10 18:54:51,626 - src.core.analysis - INFO - User IDs from audit_logs: 0
2025-06-10 18:54:51,626 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-10 18:54:51,627 - src.core.analysis - INFO - Total unique user IDs: 510
2025-06-10 18:54:54,158 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-10 18:54:54,196 - src.core.analysis - INFO - Starting analysis
2025-06-10 18:54:54,197 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-10 18:54:57,463 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-10 18:54:57,464 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-10 18:54:57,465 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-10 18:54:57,466 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-10 18:54:57,466 - src.analysis.anomaly_detector - INFO - User details shape: (205, 9)
2025-06-10 18:54:57,467 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:54:57,467 - src.analysis.anomaly_detector - INFO - Signin logs shape: (11204, 12)
2025-06-10 18:54:57,468 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-10 18:54:57,482 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-10 18:54:57,503 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-10 18:54:57,535 - src.analysis.anomaly_detector - INFO - Successfully mapped 11194 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-10 18:54:57,542 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-10 18:54:57,543 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-10 18:54:57,543 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 47
2025-06-10 18:54:57,544 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-10 18:54:57,544 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-10 18:54:57,545 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: Unknown)
2025-06-10 18:54:57,545 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: Unknown)
2025-06-10 18:54:57,546 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: Unknown)
2025-06-10 18:54:57,547 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: Unknown)
2025-06-10 18:54:57,547 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Unknown)
2025-06-10 18:54:57,548 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-10 18:54:57,548 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-10 18:54:57,549 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-10 18:54:57,549 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-10 18:54:57,550 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-10 18:54:57,550 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-10 18:54:59,005 - src.analysis.anomaly_detector - INFO - Detected 77 anomalies
2025-06-10 18:54:59,006 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-10 18:54:59,006 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 18:54:59,007 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 18:54:59,007 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-10 18:54:59,009 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-10 18:54:59,805 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-10 18:54:59,806 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-10 18:54:59,922 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-10 18:54:59,975 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-10 18:55:01,293 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-10 18:55:01,294 - src.core.analysis - INFO - Analyzing inactive users
2025-06-10 18:55:01,295 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-10 18:55:01,295 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-10 18:55:01,296 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'userName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups']
2025-06-10 18:55:01,312 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-04 16:13:56+0000', tz='UTC'), Timestamp('2025-06-04 15:48:45+0000', tz='UTC'), Timestamp('2025-06-04 15:45:05+0000', tz='UTC'), Timestamp('2025-06-04 15:38:29+0000', tz='UTC'), Timestamp('2025-06-04 15:30:26+0000', tz='UTC')]
2025-06-10 18:55:01,313 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-10 18:55:01,323 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-06 19:43:50+0000', tz='UTC'), Timestamp('2025-03-06 22:31:03+0000', tz='UTC'), Timestamp('2025-03-06 22:31:05+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC'), Timestamp('2025-03-07 16:24:53+0000', tz='UTC')]
2025-06-10 18:55:01,324 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-10 18:55:04,067 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-10 18:55:04,069 - src.core.analysis - INFO - Total unique user IDs after analysis: 537
2025-06-10 18:55:04,137 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-10 18:55:04,137 - src.core.analysis - INFO - Using chunk size: 200 for 537 users
2025-06-10 18:55:04,140 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-10 18:55:04,142 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-10 18:55:04,145 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 164103 bytes
2025-06-10 18:55:37,892 - src.core.analysis - INFO - Findings chunk 1 completed in 33.75s
2025-06-10 18:55:37,895 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-10 18:55:37,898 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 152898 bytes
2025-06-10 18:56:14,355 - src.core.analysis - INFO - Findings chunk 2 completed in 36.46s
2025-06-10 18:56:14,356 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-10 18:56:14,358 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 112971 bytes
2025-06-10 18:56:49,942 - src.core.analysis - INFO - Findings chunk 3 completed in 35.59s
2025-06-10 18:56:50,049 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-10 18:56:50,050 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-10 18:56:50,051 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-10 18:56:50,052 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-10 18:56:50,053 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-10 18:56:50,053 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-10 18:56:50,054 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-10 18:56:50,054 - src.core.analysis - INFO - Sequential processing completed in 105.91s
2025-06-10 18:56:50,055 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-10 18:56:50,055 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-10 18:56:50,056 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 537 users
2025-06-10 18:56:50,059 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-10 18:56:50,061 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-10 18:56:50,061 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-10 18:56:50,062 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 16723 bytes
2025-06-10 18:56:59,935 - src.core.analysis - INFO - Recommendations chunk 1 completed in 9.87s
2025-06-10 18:57:00,041 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-10 18:57:00,042 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-10 18:57:00,042 - src.core.analysis - INFO - Analysis completed successfully with 9 recommendations
2025-06-10 18:57:00,043 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:00,045 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-10 18:57:00,047 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-10 18:57:00,051 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:00,092 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '68837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '96b4b869-45fe-11f0-b0ef-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:00,659 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:01 GMT'
    'ETag': '"0x8DDA8227BF2A908"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0c2b9117-901e-007e-620b-daa06a000000'
    'x-ms-client-request-id': '96b4b869-45fe-11f0-b0ef-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:01 GMT'
2025-06-10 18:57:00,661 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-10 18:57:00,663 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-10 18:57:00,664 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:00,670 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137477'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '970cf70e-45fe-11f0-ab34-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:01,235 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:02 GMT'
    'ETag': '"0x8DDA8227C4BAFAB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'cedb2483-001e-006c-730b-dadbba000000'
    'x-ms-client-request-id': '970cf70e-45fe-11f0-ab34-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:02 GMT'
2025-06-10 18:57:01,237 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-10 18:57:01,238 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-10 18:57:01,239 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:01,276 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '97696f52-45fe-11f0-bd91-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:01,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:03 GMT'
    'ETag': '"0x8DDA8227CB911D1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '71200156-201e-0044-730b-daba12000000'
    'x-ms-client-request-id': '97696f52-45fe-11f0-bd91-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:02 GMT'
2025-06-10 18:57:01,948 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-10 18:57:01,949 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-10 18:57:01,950 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:01,957 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '97d140af-45fe-11f0-ba9c-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:02,539 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:03 GMT'
    'ETag': '"0x8DDA8227D1328B9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '62b62ffe-301e-0083-270b-da2e4f000000'
    'x-ms-client-request-id': '97d140af-45fe-11f0-ba9c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:03 GMT'
2025-06-10 18:57:02,540 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-10 18:57:02,542 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-10 18:57:02,543 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:02,574 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '982f7b9c-45fe-11f0-aef9-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:03,204 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:04 GMT'
    'ETag': '"0x8DDA8227D78A47E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4a3924d0-d01e-000d-7c0b-daf8f9000000'
    'x-ms-client-request-id': '982f7b9c-45fe-11f0-aef9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:04 GMT'
2025-06-10 18:57:03,205 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-10 18:57:03,206 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-10 18:57:03,207 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:03,215 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1953380'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '989138ce-45fe-11f0-90cb-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:04,077 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:05 GMT'
    'ETag': '"0x8DDA8227DFBC02E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '654dbd2c-701e-0076-0a0b-daba65000000'
    'x-ms-client-request-id': '989138ce-45fe-11f0-90cb-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:04 GMT'
2025-06-10 18:57:04,078 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-10 18:57:04,079 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-10 18:57:04,080 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:04,114 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '991a75b3-45fe-11f0-a69a-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:05,328 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:06 GMT'
    'ETag': '"0x8DDA8227EBC631A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd813b614-b01e-0046-420b-da04aa000000'
    'x-ms-client-request-id': '991a75b3-45fe-11f0-a69a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:06 GMT'
2025-06-10 18:57:05,330 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-10 18:57:05,332 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-10 18:57:05,334 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:05,338 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '99d53e96-45fe-11f0-a33d-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:05,675 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:06 GMT'
    'ETag': '"0x8DDA8227EF1DCFF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '97e02b56-901e-0041-120b-da68c9000000'
    'x-ms-client-request-id': '99d53e96-45fe-11f0-a33d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:06 GMT'
2025-06-10 18:57:05,676 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-10 18:57:05,678 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-10 18:57:05,679 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:05,704 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9a0d04f4-45fe-11f0-add0-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:06,032 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:07 GMT'
    'ETag': '"0x8DDA8227F286738"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '31a9d7d2-a01e-005a-780b-da56ca000000'
    'x-ms-client-request-id': '9a0d04f4-45fe-11f0-add0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:07 GMT'
2025-06-10 18:57:06,033 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-10 18:57:06,034 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-10 18:57:06,036 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:06,043 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '62059'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9a40bd83-45fe-11f0-9a4f-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:06,517 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:07 GMT'
    'ETag': '"0x8DDA8227F71EEE0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '07e1fa31-601e-00b1-2a0b-da2e38000000'
    'x-ms-client-request-id': '9a40bd83-45fe-11f0-9a4f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:07 GMT'
2025-06-10 18:57:06,518 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-10 18:57:06,519 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-10 18:57:06,520 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:06,548 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9a8dcfa7-45fe-11f0-a75c-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:07,043 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:08 GMT'
    'ETag': '"0x8DDA8227FC1FEEC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0db03a3a-601e-0055-0b0b-da20a6000000'
    'x-ms-client-request-id': '9a8dcfa7-45fe-11f0-a75c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:07 GMT'
2025-06-10 18:57:07,044 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-10 18:57:07,045 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-10 18:57:07,047 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:07,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2802494'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9adbdf79-45fe-11f0-b2f4-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:08,079 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:09 GMT'
    'ETag': '"0x8DDA8228060255A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9c4b7aff-b01e-0024-140b-dac68d000000'
    'x-ms-client-request-id': '9adbdf79-45fe-11f0-b2f4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:08 GMT'
2025-06-10 18:57:08,081 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-10 18:57:08,082 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-10 18:57:08,083 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:08,116 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9b7d0dba-45fe-11f0-b969-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:09,235 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:10 GMT'
    'ETag': '"0x8DDA822810FEB3D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a8956879-001e-0053-030b-da1319000000'
    'x-ms-client-request-id': '9b7d0dba-45fe-11f0-b969-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:09 GMT'
2025-06-10 18:57:09,238 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-10 18:57:09,239 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-10 18:57:09,242 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:09,279 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9c2e8f56-45fe-11f0-ab81-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:09,663 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:10 GMT'
    'ETag': '"0x8DDA82281524EFD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'aa08c2c6-c01e-004c-640b-daa01d000000'
    'x-ms-client-request-id': '9c2e8f56-45fe-11f0-ab81-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:10 GMT'
2025-06-10 18:57:09,664 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-10 18:57:09,667 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-10 18:57:09,668 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:09,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9c6d97cf-45fe-11f0-9154-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:10,214 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:11 GMT'
    'ETag': '"0x8DDA82281A5DD84"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'aa9067e9-101e-00ab-4d0b-da4fe7000000'
    'x-ms-client-request-id': '9c6d97cf-45fe-11f0-9154-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:11 GMT'
2025-06-10 18:57:10,215 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-10 18:57:10,218 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-10 18:57:10,219 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:10,252 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9cc31871-45fe-11f0-a227-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:10,743 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:11 GMT'
    'ETag': '"0x8DDA82281F6AFFF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5f1a26ec-a01e-0007-4e0b-da5c4e000000'
    'x-ms-client-request-id': '9cc31871-45fe-11f0-a227-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:11 GMT'
2025-06-10 18:57:10,745 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-10 18:57:10,748 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-10 18:57:10,749 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:10,774 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9d129c53-45fe-11f0-9c07-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:11,324 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:12 GMT'
    'ETag': '"0x8DDA822824F8FBE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '500e275f-801e-00a9-270b-daf15f000000'
    'x-ms-client-request-id': '9d129c53-45fe-11f0-9c07-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:12 GMT'
2025-06-10 18:57:11,325 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-10 18:57:11,326 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-10 18:57:11,327 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:11,334 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '105311'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9d68353b-45fe-11f0-90be-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:11,883 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:13 GMT'
    'ETag': '"0x8DDA82282A517DF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4a266792-a01e-004a-7a0b-da93a2000000'
    'x-ms-client-request-id': '9d68353b-45fe-11f0-90be-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:12 GMT'
2025-06-10 18:57:11,884 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-10 18:57:11,885 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-10 18:57:11,887 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-10 18:57:11,913 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9dc085c0-45fe-11f0-b33e-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:12,520 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:13 GMT'
    'ETag': '"0x8DDA8228303969A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b7d22ad0-001e-0043-340b-dad671000000'
    'x-ms-client-request-id': '9dc085c0-45fe-11f0-b33e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:13 GMT'
2025-06-10 18:57:12,521 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-10 18:57:12,528 - main - INFO - Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-10 18:57:12,552 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '74760'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9e21f097-45fe-11f0-9769-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:13,041 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:14 GMT'
    'ETag': '"0x8DDA8228354DDBF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105381-d01e-0050-2e0b-daf27d000000'
    'x-ms-client-request-id': '9e21f097-45fe-11f0-9769-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:13 GMT'
2025-06-10 18:57:13,046 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137477'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9e6d5181-45fe-11f0-9dc8-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:13,203 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:14 GMT'
    'ETag': '"0x8DDA822836E6396"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105387-d01e-0050-330b-daf27d000000'
    'x-ms-client-request-id': '9e6d5181-45fe-11f0-9dc8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:13 GMT'
2025-06-10 18:57:13,208 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9e86038c-45fe-11f0-ad86-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:13,383 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:14 GMT'
    'ETag': '"0x8DDA8228389953B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105388-d01e-0050-340b-daf27d000000'
    'x-ms-client-request-id': '9e86038c-45fe-11f0-ad86-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:13 GMT'
2025-06-10 18:57:13,388 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9ea17d1e-45fe-11f0-86f3-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:13,480 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:14 GMT'
    'ETag': '"0x8DDA822839803F6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e10538e-d01e-0050-3a0b-daf27d000000'
    'x-ms-client-request-id': '9ea17d1e-45fe-11f0-86f3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:13 GMT'
2025-06-10 18:57:13,484 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9eb02a29-45fe-11f0-ae15-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:13,580 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:14 GMT'
    'ETag': '"0x8DDA82283A75C08"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105391-d01e-0050-3d0b-daf27d000000'
    'x-ms-client-request-id': '9eb02a29-45fe-11f0-ae15-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:13 GMT'
2025-06-10 18:57:13,585 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1953380'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9ebfa716-45fe-11f0-9c98-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:13,928 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:15 GMT'
    'ETag': '"0x8DDA82283DCFCE1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105394-d01e-0050-400b-daf27d000000'
    'x-ms-client-request-id': '9ebfa716-45fe-11f0-9c98-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:14 GMT'
2025-06-10 18:57:13,938 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9ef57889-45fe-11f0-9a2e-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:14,477 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:15 GMT'
    'ETag': '"0x8DDA82284303D9A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e1053bd-d01e-0050-670b-daf27d000000'
    'x-ms-client-request-id': '9ef57889-45fe-11f0-9a2e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:14 GMT'
2025-06-10 18:57:14,482 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9f488278-45fe-11f0-beed-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:14,567 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:15 GMT'
    'ETag': '"0x8DDA822843E37A9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e1053e6-d01e-0050-0e0b-daf27d000000'
    'x-ms-client-request-id': '9f488278-45fe-11f0-beed-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:14 GMT'
2025-06-10 18:57:14,571 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9f560192-45fe-11f0-8839-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:14,647 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:15 GMT'
    'ETag': '"0x8DDA822844AFA95"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e1053ee-d01e-0050-130b-daf27d000000'
    'x-ms-client-request-id': '9f560192-45fe-11f0-8839-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:14 GMT'
2025-06-10 18:57:14,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '62059'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9f625157-45fe-11f0-8bba-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:14,739 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:15 GMT'
    'ETag': '"0x8DDA8228458CDBB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e1053f1-d01e-0050-160b-daf27d000000'
    'x-ms-client-request-id': '9f625157-45fe-11f0-8bba-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:15 GMT'
2025-06-10 18:57:14,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9f703567-45fe-11f0-8071-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:14,839 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:16 GMT'
    'ETag': '"0x8DDA8228466EEAF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e1053f5-d01e-0050-190b-daf27d000000'
    'x-ms-client-request-id': '9f703567-45fe-11f0-8071-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:15 GMT'
2025-06-10 18:57:14,845 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2802494'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9f7fcbcd-45fe-11f0-9948-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:15,164 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:16 GMT'
    'ETag': '"0x8DDA8228499AC8F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105400-d01e-0050-230b-daf27d000000'
    'x-ms-client-request-id': '9f7fcbcd-45fe-11f0-9948-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:15 GMT'
2025-06-10 18:57:15,172 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9fb1b18e-45fe-11f0-89c3-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:15,727 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:16 GMT'
    'ETag': '"0x8DDA82284EFA95D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e10540e-d01e-0050-310b-daf27d000000'
    'x-ms-client-request-id': '9fb1b18e-45fe-11f0-89c3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:16 GMT'
2025-06-10 18:57:15,732 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a00745af-45fe-11f0-b110-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:15,824 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:17 GMT'
    'ETag': '"0x8DDA82284FDA369"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105417-d01e-0050-3a0b-daf27d000000'
    'x-ms-client-request-id': 'a00745af-45fe-11f0-b110-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:16 GMT'
2025-06-10 18:57:15,828 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a015da05-45fe-11f0-9e9a-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:15,917 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:17 GMT'
    'ETag': '"0x8DDA822850C3909"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e10541a-d01e-0050-3d0b-daf27d000000'
    'x-ms-client-request-id': 'a015da05-45fe-11f0-9e9a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:16 GMT'
2025-06-10 18:57:15,921 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a024028d-45fe-11f0-9a36-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:16,010 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:17 GMT'
    'ETag': '"0x8DDA822851A59F7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e10541c-d01e-0050-3f0b-daf27d000000'
    'x-ms-client-request-id': 'a024028d-45fe-11f0-9a36-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:16 GMT'
2025-06-10 18:57:16,013 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a03224fe-45fe-11f0-8b7b-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:16,109 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:17 GMT'
    'ETag': '"0x8DDA82285287AE9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e10541e-d01e-0050-410b-daf27d000000'
    'x-ms-client-request-id': 'a03224fe-45fe-11f0-8b7b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:16 GMT'
2025-06-10 18:57:16,114 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '105311'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a0417229-45fe-11f0-adc3-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:16,200 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:17 GMT'
    'ETag': '"0x8DDA8228537AC13"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e105427-d01e-0050-4a0b-daf27d000000'
    'x-ms-client-request-id': 'a0417229-45fe-11f0-adc3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:16 GMT'
2025-06-10 18:57:16,204 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a04f2b4d-45fe-11f0-a7f2-ec4c8c6ceba6'
A body is sent with the request
2025-06-10 18:57:16,292 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 10 Jun 2025 13:27:17 GMT'
    'ETag': '"0x8DDA8228545A624"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e10542e-d01e-0050-4f0b-daf27d000000'
    'x-ms-client-request-id': 'a04f2b4d-45fe-11f0-a7f2-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:27:16 GMT'
2025-06-10 18:59:39,240 - main - INFO - [fetch-data] Endpoint called
2025-06-10 18:59:39,241 - main - INFO - [fetch-data] Fetching data using scripts/data_fetcher.py...
2025-06-10 18:59:39,242 - d365 - INFO - Loading D365 data
2025-06-10 18:59:39,244 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 18:59:39,535 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '29bb4fda-55c9-45c9-afcf-707699bebc00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:29:40 GMT'
    'Content-Length': '1753'
2025-06-10 18:59:39,554 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 18:59:39,798 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'de7e4274-77f5-4bae-83ff-698e8f7af800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:29:40 GMT'
    'Content-Length': '1647'
2025-06-10 18:59:39,800 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 18:59:39,800 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-10 18:59:39,801 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-12T13:29:39Z)
2025-06-10 18:59:44,274 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-10 18:59:47,424 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-10 18:59:51,225 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-10 18:59:54,763 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-10 18:59:58,100 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-10 19:00:01,353 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-10 19:00:02,759 - d365 - INFO - Progress: Fetched 31742 audit logs after 7 pages
2025-06-10 19:00:02,864 - d365 - INFO - Fetched 31742 D365 audit logs via Dataverse
2025-06-10 19:00:03,058 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-10 19:00:03,066 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:00:03,384 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0412fa52-9d1d-4b29-b9ae-878d0f129500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:03 GMT'
    'Content-Length': '1753'
2025-06-10 19:00:03,385 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:00:03,823 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e22d9858-d17c-409a-9f40-57a74b68e100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:04 GMT'
    'Content-Length': '1991'
2025-06-10 19:00:03,824 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:00:03,825 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-10 19:00:03,826 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-12T13:30:03Z)
2025-06-10 19:00:03,827 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-10 19:00:19,993 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 3.7 req/min | Time: 0:00:16
2025-06-10 19:00:40,590 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-12T13%3a30%3a03Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=5bec200aa63630efb763390b4db3aee5a784fa579ff278c48270fe55a4a3ead1: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-10 19:00:40,592 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-12T13%3a30%3a03Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=5bec200aa63630efb763390b4db3aee5a784fa579ff278c48270fe55a4a3ead1: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-10 19:00:40,595 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-10 19:00:41,079 - d365 - INFO - Loaded 11204 sign-in logs from CSV
2025-06-10 19:00:41,085 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:00:41,397 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '47e4fb01-1fbc-44ac-b58e-e8b91e19bd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:41 GMT'
    'Content-Length': '1753'
2025-06-10 19:00:41,401 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:00:41,555 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f6cda0a5-d75c-4b92-991f-1e44addfd300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:41 GMT'
    'Content-Length': '1653'
2025-06-10 19:00:41,557 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:00:41,557 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-10 19:00:41,559 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:00:41,904 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '893dc028-3cd3-4842-899b-088b53d3e900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:42 GMT'
    'Content-Length': '1753'
2025-06-10 19:00:41,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:00:42,143 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2fac6809-8491-49cf-9ff5-960e1c68de00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:42 GMT'
    'Content-Length': '1996'
2025-06-10 19:00:42,145 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:00:42,145 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-10 19:00:42,147 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:00:42,440 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9d82fd05-5b80-40c8-9369-2099a8daec00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:43 GMT'
    'Content-Length': '1753'
2025-06-10 19:00:42,442 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:00:42,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e46cc03b-cfae-4ab1-ac5e-521f20cb6200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:30:43 GMT'
    'Content-Length': '1991'
2025-06-10 19:00:42,693 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:00:42,694 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-10 19:00:45,123 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-10 19:00:45,124 - d365 - INFO - Found 975 users in Entra ID
2025-06-10 19:00:46,391 - d365 - INFO - Fetched 933 user records from D365
2025-06-10 19:01:55,306 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-10 19:01:55,310 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-10 19:02:37,659 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-10 19:02:37,660 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-10 19:02:40,228 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-10 19:02:40,231 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-10 19:02:45,376 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-10 19:02:45,377 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-10 19:03:35,899 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-10 19:03:35,901 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-10 19:04:03,966 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-10 19:04:03,967 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-10 19:04:21,112 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-10 19:04:21,114 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-10 19:05:08,551 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-10 19:05:08,552 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-10 19:05:08,553 - d365 - INFO - Final user count after filtering: 205
2025-06-10 19:05:08,555 - d365 - INFO - Fetched 205 user details after filtering
2025-06-10 19:05:08,568 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-10 19:05:08,583 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-10 19:05:08,591 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-10 19:05:08,602 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:05:08,845 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd4e6fbdd-3722-481e-bfbe-cd85a140a000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:09 GMT'
    'Content-Length': '1753'
2025-06-10 19:05:08,846 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:05:08,976 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2b0344d5-0cd4-401f-b21d-a89b09182900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:09 GMT'
    'Content-Length': '1653'
2025-06-10 19:05:08,977 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:05:08,978 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-10 19:05:10,862 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-10 19:05:10,870 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-10 19:05:10,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:05:11,093 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b0c478da-10bd-464e-902b-88fe6f38a800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:11 GMT'
    'Content-Length': '1753'
2025-06-10 19:05:11,094 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:05:11,306 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'cb5cfbb8-dbea-4ca4-b2ab-4ab0008dcc00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:11 GMT'
    'Content-Length': '1647'
2025-06-10 19:05:11,307 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:05:11,308 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-10 19:05:13,538 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-10 19:05:13,546 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-10 19:05:13,550 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:05:13,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2e5275b2-8321-4a45-bae7-1193990e6f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:14 GMT'
    'Content-Length': '1753'
2025-06-10 19:05:13,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:05:13,940 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8d107584-6c46-48d8-8691-89784a1c1c01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:14 GMT'
    'Content-Length': '1992'
2025-06-10 19:05:13,941 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:05:13,942 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-10 19:05:16,362 - d365 - INFO - Fetched 35 conditional access policies
2025-06-10 19:05:16,366 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-10 19:05:16,367 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-10 19:05:16,597 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '989b0bb1-2c46-4271-b65f-ec3f74b7ef00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:17 GMT'
    'Content-Length': '1753'
2025-06-10 19:05:16,598 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-10 19:05:16,804 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '989b0bb1-2c46-4271-b65f-ec3f77b7ef00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 10 Jun 2025 13:35:17 GMT'
    'Content-Length': '1647'
2025-06-10 19:05:16,805 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-10 19:05:16,806 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-10 19:05:17,507 - d365 - INFO - Fetched 11 business units
2025-06-10 19:05:17,510 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-10 19:05:17,569 - d365 - INFO - D365 data loaded successfully
2025-06-10 19:05:17,576 - main - ERROR - [fetch-data] Data fetch failed: Unknown error
2025-06-10 19:05:17,577 - main - ERROR - [fetch-data] Error fetching data: Data fetch failed: Unknown error
Traceback (most recent call last):
  File "D:\Production\backend\main.py", line 220, in fetch_data_endpoint
    raise ValueError(f"Data fetch failed: {fetch_result.get('error', 'Unknown error')}")
ValueError: Data fetch failed: Unknown error
2025-06-11 08:58:40,311 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 08:58:40,377 - main - INFO - FastAPI application shutdown
2025-06-11 08:59:14,685 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 08:59:33,726 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 08:59:33,727 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 08:59:33,727 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 08:59:33,728 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 08:59:33,728 - main - INFO - FastAPI application started
2025-06-11 08:59:33,730 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 08:59:33,730 - main - INFO - FastAPI application shutdown
2025-06-11 08:59:33,859 - main - INFO - [fetch-data] Endpoint called
2025-06-11 08:59:33,859 - main - INFO - [fetch-data] Fetching data using scripts/data_fetcher.py...
2025-06-11 08:59:33,860 - d365 - INFO - Loading D365 data
2025-06-11 08:59:33,861 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 08:59:41,111 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 08:59:45,092 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 08:59:45,092 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 08:59:45,093 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 08:59:45,094 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 08:59:45,094 - main - INFO - FastAPI application started
2025-06-11 08:59:45,095 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 08:59:45,096 - main - INFO - FastAPI application shutdown
2025-06-11 08:59:54,211 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 08:59:59,210 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 08:59:59,211 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 08:59:59,212 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 08:59:59,213 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 08:59:59,214 - main - INFO - FastAPI application started
2025-06-11 09:00:06,682 - main - INFO - [fetch-data] Endpoint called
2025-06-11 09:00:06,682 - main - INFO - [fetch-data] Fetching data using scripts/data_fetcher.py...
2025-06-11 09:00:06,682 - d365 - INFO - Loading D365 data
2025-06-11 09:00:06,683 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:00:06,940 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '27b92442-251a-4194-942c-09dc5ce6c000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:30:06 GMT'
    'Content-Length': '1753'
2025-06-11 09:00:06,953 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:00:07,110 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2a520106-45fa-48d4-949b-9b46578ba000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:30:07 GMT'
    'Content-Length': '1648'
2025-06-11 09:00:07,111 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:00:07,112 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:00:07,112 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T03:30:07Z)
2025-06-11 09:00:13,865 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 09:00:18,897 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 09:00:23,069 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 09:00:26,165 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 09:00:29,215 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 09:00:32,017 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 09:00:33,251 - d365 - INFO - Progress: Fetched 31761 audit logs after 7 pages
2025-06-11 09:00:33,293 - d365 - INFO - Fetched 31761 D365 audit logs via Dataverse
2025-06-11 09:00:33,395 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 09:00:33,401 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:00:33,691 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '473bab89-c71f-4460-8ade-17db9ddf3301'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:30:32 GMT'
    'Content-Length': '1753'
2025-06-11 09:00:33,693 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:00:33,933 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3ed949f7-06f8-4dca-a688-44a41f5f0001'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:30:33 GMT'
    'Content-Length': '1996'
2025-06-11 09:00:33,934 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:00:33,935 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:00:33,935 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T03:30:33Z)
2025-06-11 09:00:33,936 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 09:00:44,703 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 5.6 req/min | Time: 0:00:10
2025-06-11 09:01:01,983 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 4.3 req/min | Time: 0:00:28
2025-06-11 09:01:19,129 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.0 req/min | Time: 0:00:45
2025-06-11 09:01:37,447 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 3.8 req/min | Time: 0:01:03
2025-06-11 09:01:53,720 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 3.8 req/min | Time: 0:01:19
2025-06-11 09:02:08,533 - d365 - INFO - Progress: 5,822 records | Pages: 6 | Requests: 6 | Rate: 3.8 req/min | Time: 0:01:34
2025-06-11 09:02:09,036 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T03:31:27Z to 2025-06-11T03:19:15Z
2025-06-11 09:02:09,253 - d365 - INFO - Fetch completed: 5,822 records in 0:01:35
2025-06-11 09:02:09,254 - d365 - INFO - Total requests made: 6
2025-06-11 09:02:09,276 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:02:09,498 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c2d902b4-7702-4d1c-b708-79502e461201'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:32:09 GMT'
    'Content-Length': '1753'
2025-06-11 09:02:09,502 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:02:09,631 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f91e5bb7-ac14-45ed-98f4-0d98dac69a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:32:09 GMT'
    'Content-Length': '1653'
2025-06-11 09:02:09,632 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:02:09,633 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:02:09,635 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:02:09,789 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4cdcef46-4776-4579-8c7b-7cf0e9410600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:32:09 GMT'
    'Content-Length': '1753'
2025-06-11 09:02:09,792 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:02:10,081 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '25205aaa-87a7-4930-bfaa-a6b0b79f9a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:32:09 GMT'
    'Content-Length': '1991'
2025-06-11 09:02:10,083 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:02:10,084 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:02:10,086 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:02:10,398 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '49666b05-41fe-47e3-a422-f2057a6a9500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:32:10 GMT'
    'Content-Length': '1753'
2025-06-11 09:02:10,401 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:02:10,660 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5c34ecac-a383-4c1e-998f-26f6cf30fc00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:32:10 GMT'
    'Content-Length': '1989'
2025-06-11 09:02:10,662 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:02:10,663 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:02:13,760 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 09:02:13,761 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 09:02:15,400 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 09:03:21,816 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 09:03:21,818 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 09:04:01,804 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 09:04:01,806 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 09:04:04,275 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 09:04:04,276 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 09:04:08,634 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 09:04:08,635 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 09:04:57,390 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 09:04:57,391 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 09:05:23,872 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 09:05:23,873 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 09:05:40,225 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 09:05:40,226 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 09:06:21,249 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 09:06:21,250 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 09:06:21,250 - d365 - INFO - Final user count after filtering: 206
2025-06-11 09:06:21,252 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 09:06:21,259 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 09:06:21,264 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 09:06:21,274 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 09:06:21,277 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:06:21,512 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '84a8e152-a569-487e-8887-edf62b03b000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:20 GMT'
    'Content-Length': '1753'
2025-06-11 09:06:21,514 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:06:21,730 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '17fc0c51-feba-44e0-ab3e-17387ba5de00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:21 GMT'
    'Content-Length': '1651'
2025-06-11 09:06:21,731 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:06:21,732 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:06:23,519 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 09:06:23,526 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 09:06:23,528 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:06:23,798 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '52d40ef6-1bce-4004-992f-cd66d317f000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:23 GMT'
    'Content-Length': '1753'
2025-06-11 09:06:23,800 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:06:24,058 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e95e0419-9a0b-419d-89d9-8218e1491001'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:23 GMT'
    'Content-Length': '1647'
2025-06-11 09:06:24,060 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:06:24,060 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:06:26,399 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 09:06:26,405 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 09:06:26,407 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:06:26,689 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3461f46f-8122-4484-92a6-b01302d0fd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:26 GMT'
    'Content-Length': '1753'
2025-06-11 09:06:26,691 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:06:26,895 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '473bab89-c71f-4460-8ade-17db97133401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:26 GMT'
    'Content-Length': '1992'
2025-06-11 09:06:26,896 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:06:26,897 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:06:30,073 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 09:06:30,077 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 09:06:30,078 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:06:30,342 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0f14081b-2ea2-4aaa-ae11-4c46f1f11a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:30 GMT'
    'Content-Length': '1753'
2025-06-11 09:06:30,344 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:06:30,494 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '86c397b5-c3e3-45b8-bdb3-45013003b700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:36:30 GMT'
    'Content-Length': '1652'
2025-06-11 09:06:30,495 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:06:30,495 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:06:31,374 - d365 - INFO - Fetched 11 business units
2025-06-11 09:06:31,377 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 09:06:31,390 - d365 - INFO - D365 data loaded successfully
2025-06-11 09:06:31,415 - main - ERROR - [fetch-data] Data fetch failed: Data fetched and saved successfully
2025-06-11 09:06:31,416 - main - ERROR - [fetch-data] Error fetching data: Data fetch failed: Data fetched and saved successfully
Traceback (most recent call last):
  File "D:\Production\backend\main.py", line 220, in fetch_data_endpoint
    raise ValueError(f"Data fetch failed: {fetch_result.get('message', 'Unknown error')}")
ValueError: Data fetch failed: Data fetched and saved successfully
2025-06-11 09:12:41,118 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 09:12:41,130 - main - INFO - FastAPI application shutdown
2025-06-11 09:13:09,148 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 09:13:30,816 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 09:13:30,817 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 09:13:30,817 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 09:13:30,819 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 09:13:30,819 - main - INFO - FastAPI application started
2025-06-11 09:13:30,822 - main - INFO - [fetch-data] Endpoint called
2025-06-11 09:13:30,822 - main - INFO - [fetch-data] Fetching data using scripts/data_fetcher.py...
2025-06-11 09:13:30,823 - d365 - INFO - Loading D365 data
2025-06-11 09:13:30,824 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:13:31,084 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0672aafb-d719-4d94-b86c-180d45a6ae00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:43:30 GMT'
    'Content-Length': '1753'
2025-06-11 09:13:31,099 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:13:31,251 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'cda9f49b-23b4-4ed2-972a-2c37292db600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:43:30 GMT'
    'Content-Length': '1653'
2025-06-11 09:13:31,252 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:13:31,252 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:13:31,253 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T03:43:31Z)
2025-06-11 09:13:34,946 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 09:13:37,683 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 09:13:40,856 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 09:13:43,455 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 09:13:46,129 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 09:13:48,779 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 09:13:49,876 - d365 - INFO - Progress: Fetched 31762 audit logs after 7 pages
2025-06-11 09:13:49,898 - d365 - INFO - Fetched 31762 D365 audit logs via Dataverse
2025-06-11 09:13:49,955 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 09:13:49,959 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:13:50,406 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '893dc028-3cd3-4842-899b-088bb293fd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:43:49 GMT'
    'Content-Length': '1753'
2025-06-11 09:13:50,407 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:13:50,606 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '83ecd29e-6f86-4a06-b69a-a9958b71b500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:43:50 GMT'
    'Content-Length': '1997'
2025-06-11 09:13:50,607 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:13:50,608 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:13:50,609 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T03:43:50Z)
2025-06-11 09:13:50,609 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 09:13:59,657 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 6.6 req/min | Time: 0:00:09
2025-06-11 09:14:14,221 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 5.1 req/min | Time: 0:00:23
2025-06-11 09:14:22,705 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.6 req/min | Time: 0:00:32
2025-06-11 09:14:32,114 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.8 req/min | Time: 0:00:41
2025-06-11 09:14:39,617 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 6.1 req/min | Time: 0:00:49
2025-06-11 09:14:50,376 - d365 - INFO - Progress: 5,814 records | Pages: 6 | Requests: 6 | Rate: 6.0 req/min | Time: 0:00:59
2025-06-11 09:14:50,878 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T03:44:05Z to 2025-06-11T03:19:15Z
2025-06-11 09:14:50,953 - d365 - INFO - Fetch completed: 5,814 records in 0:01:00
2025-06-11 09:14:50,954 - d365 - INFO - Total requests made: 6
2025-06-11 09:14:50,966 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:14:51,184 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '999af670-8483-465d-81fa-e80fa2afef00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:44:51 GMT'
    'Content-Length': '1753'
2025-06-11 09:14:51,186 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:14:51,424 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'dc80e424-0d80-4f42-9f58-bb60f9134100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:44:51 GMT'
    'Content-Length': '1648'
2025-06-11 09:14:51,425 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:14:51,426 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:14:51,427 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:14:51,743 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5938425a-0d73-4273-84cf-29c44d26f400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:44:51 GMT'
    'Content-Length': '1753'
2025-06-11 09:14:51,744 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:14:51,949 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3c80a5b7-5ebc-467e-81bb-eb905b988e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:44:51 GMT'
    'Content-Length': '1991'
2025-06-11 09:14:51,950 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:14:51,951 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:14:51,951 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:14:52,142 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2613494f-f0d3-4887-beb2-288fe73df200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:44:51 GMT'
    'Content-Length': '1753'
2025-06-11 09:14:52,143 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:14:52,408 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1ff38e97-e847-4624-a1a1-ae1daf09a800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:44:52 GMT'
    'Content-Length': '1991'
2025-06-11 09:14:52,409 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:14:52,409 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:14:54,905 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 09:14:54,906 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 09:14:56,012 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 09:15:59,817 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 09:15:59,819 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 09:16:40,108 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 09:16:40,109 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 09:16:42,730 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 09:16:42,732 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 09:16:47,771 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 09:16:47,772 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 09:17:36,071 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 09:17:36,072 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 09:18:01,402 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 09:18:01,403 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 09:18:26,153 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 09:18:26,154 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 09:19:08,011 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 09:19:08,011 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 09:19:08,012 - d365 - INFO - Final user count after filtering: 206
2025-06-11 09:19:08,013 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 09:19:08,020 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 09:19:08,027 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 09:19:08,035 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 09:19:08,037 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:19:08,300 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c7828e23-7217-4917-b86c-dad981335401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:07 GMT'
    'Content-Length': '1753'
2025-06-11 09:19:08,302 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:19:08,654 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ec826540-3380-4e32-aa2d-7332e7d9a700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:08 GMT'
    'Content-Length': '1645'
2025-06-11 09:19:08,655 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:19:08,656 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:19:09,837 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 09:19:09,844 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 09:19:09,847 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:19:10,269 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3550ec82-4119-431c-9749-20b1aad2ed00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:09 GMT'
    'Content-Length': '1753'
2025-06-11 09:19:10,270 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:19:10,538 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0d35343b-164d-4ec0-af6a-20d40b931e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:10 GMT'
    'Content-Length': '1648'
2025-06-11 09:19:10,539 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:19:10,541 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:19:13,179 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 09:19:13,186 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 09:19:13,188 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:19:13,624 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '18f13d69-1dd6-4739-9f23-0e45f5932a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:13 GMT'
    'Content-Length': '1753'
2025-06-11 09:19:13,626 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:19:13,984 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '18f13d69-1dd6-4739-9f23-0e45fc932a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:13 GMT'
    'Content-Length': '1991'
2025-06-11 09:19:13,985 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:19:13,986 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:19:15,737 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 09:19:15,740 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 09:19:15,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:19:16,036 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3461f46f-8122-4484-92a6-b013782efe00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:15 GMT'
    'Content-Length': '1753'
2025-06-11 09:19:16,037 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:19:16,295 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ef918d4a-7032-465b-92d3-59935e250a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 03:49:15 GMT'
    'Content-Length': '1648'
2025-06-11 09:19:16,297 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:19:16,297 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:19:17,327 - d365 - INFO - Fetched 11 business units
2025-06-11 09:19:17,330 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 09:19:17,340 - d365 - INFO - D365 data loaded successfully
2025-06-11 09:19:17,366 - main - ERROR - [fetch-data] Data fetch failed: Data fetched and saved successfully
2025-06-11 09:19:17,367 - main - ERROR - [fetch-data] Error fetching data: Data fetch failed: Data fetched and saved successfully
Traceback (most recent call last):
  File "D:\Production\backend\main.py", line 220, in fetch_data_endpoint
    raise ValueError(f"Data fetch failed: {fetch_result.get('message', 'Unknown error')}")
ValueError: Data fetch failed: Data fetched and saved successfully
2025-06-11 09:58:34,375 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 09:58:34,416 - main - INFO - FastAPI application shutdown
2025-06-11 09:58:56,387 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 09:59:13,506 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 09:59:13,507 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 09:59:13,507 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 09:59:13,509 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 09:59:13,509 - main - INFO - FastAPI application started
2025-06-11 09:59:13,511 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 09:59:13,513 - main - INFO - FastAPI application shutdown
2025-06-11 09:59:19,192 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 09:59:23,194 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 09:59:23,195 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 09:59:23,196 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 09:59:23,198 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 09:59:23,198 - main - INFO - FastAPI application started
2025-06-11 09:59:23,202 - main - INFO - [fetch-data] Endpoint called
2025-06-11 09:59:23,202 - main - INFO - [fetch-data] Fetching data using scripts/data_fetcher.py...
2025-06-11 09:59:23,203 - d365 - INFO - Loading D365 data
2025-06-11 09:59:23,205 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:59:23,466 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '68ed2742-b7f7-43c0-a7f8-f5d9ad11c000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:29:23 GMT'
    'Content-Length': '1753'
2025-06-11 09:59:23,481 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:59:23,612 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a740ba47-56db-4d99-a15a-13b79dcfd500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:29:23 GMT'
    'Content-Length': '1653'
2025-06-11 09:59:23,613 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:59:23,613 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 09:59:23,614 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T04:29:23Z)
2025-06-11 09:59:27,478 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 09:59:30,218 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 09:59:32,853 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 09:59:35,504 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 09:59:38,129 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 09:59:40,806 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 09:59:42,076 - d365 - INFO - Progress: Fetched 31765 audit logs after 7 pages
2025-06-11 09:59:42,120 - d365 - INFO - Fetched 31765 D365 audit logs via Dataverse
2025-06-11 09:59:42,235 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 09:59:42,241 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 09:59:42,442 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '15ef5db0-97a6-4af7-a5ef-6c753849d800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:29:42 GMT'
    'Content-Length': '1753'
2025-06-11 09:59:42,444 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 09:59:42,628 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '13a5617b-fca5-4bb0-b511-30d452546600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:29:42 GMT'
    'Content-Length': '1996'
2025-06-11 09:59:42,630 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 09:59:42,630 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 09:59:42,631 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T04:29:42Z)
2025-06-11 09:59:42,631 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 09:59:55,754 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 4.6 req/min | Time: 0:00:13
2025-06-11 10:00:10,496 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 4.3 req/min | Time: 0:00:27
2025-06-11 10:00:23,034 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.5 req/min | Time: 0:00:40
2025-06-11 10:00:34,229 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 4.7 req/min | Time: 0:00:51
2025-06-11 10:00:47,118 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.7 req/min | Time: 0:01:04
2025-06-11 10:00:54,517 - d365 - INFO - Progress: 5,818 records | Pages: 6 | Requests: 6 | Rate: 5.0 req/min | Time: 0:01:11
2025-06-11 10:00:55,019 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T04:32:39Z to 2025-06-11T04:24:40Z
2025-06-11 10:00:55,090 - d365 - INFO - Fetch completed: 5,818 records in 0:01:12
2025-06-11 10:00:55,091 - d365 - INFO - Total requests made: 6
2025-06-11 10:00:55,097 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 10:00:55,282 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '00d4c74a-7e8b-4cad-bbcd-5f0ecc9bfc00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:30:54 GMT'
    'Content-Length': '1753'
2025-06-11 10:00:55,283 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 10:00:55,480 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7497b06d-24cb-4545-b614-c2f863c74e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:30:54 GMT'
    'Content-Length': '1652'
2025-06-11 10:00:55,481 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 10:00:55,481 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 10:00:55,482 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 10:00:55,649 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7651626d-9372-4372-9bf9-82f33ceee500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:30:55 GMT'
    'Content-Length': '1753'
2025-06-11 10:00:55,650 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 10:00:55,881 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '76838d4f-89ba-4451-91a5-74edb3b8de00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:30:55 GMT'
    'Content-Length': '1991'
2025-06-11 10:00:55,881 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 10:00:55,882 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 10:00:55,883 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 10:00:56,017 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '225f65f0-33ec-4fc2-9acf-28495a28f800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:30:56 GMT'
    'Content-Length': '1753'
2025-06-11 10:00:56,018 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 10:00:56,232 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'bc40384e-253b-46a8-96d5-0873b37e4a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:30:56 GMT'
    'Content-Length': '1989'
2025-06-11 10:00:56,233 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 10:00:56,233 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 10:00:59,016 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 10:00:59,017 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 10:01:01,794 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 10:02:08,953 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 10:02:08,954 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 10:02:49,041 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 10:02:49,042 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 10:02:51,655 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 10:02:51,657 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 10:02:56,650 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 10:02:56,651 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 10:03:44,034 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 10:03:44,035 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 10:04:09,804 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 10:04:09,806 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 10:04:27,221 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 10:04:27,222 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 10:05:10,594 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 10:05:10,594 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 10:05:10,595 - d365 - INFO - Final user count after filtering: 206
2025-06-11 10:05:10,596 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 10:05:10,605 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 10:05:10,613 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 10:05:10,621 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 10:05:10,627 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 10:05:10,901 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1896caa4-5d1f-4c6c-8d3b-58cf04ed9700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:10 GMT'
    'Content-Length': '1753'
2025-06-11 10:05:10,903 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 10:05:11,388 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'de7e4274-77f5-4bae-83ff-698ebab71301'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:10 GMT'
    'Content-Length': '1647'
2025-06-11 10:05:11,389 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 10:05:11,390 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 10:05:12,609 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 10:05:12,618 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 10:05:12,620 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 10:05:12,819 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3962ba87-2f7d-4ac2-b99a-80e1ff30a000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:12 GMT'
    'Content-Length': '1753'
2025-06-11 10:05:12,820 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 10:05:13,065 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e65b610d-7626-49e8-b9d2-a97ee68ae200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:12 GMT'
    'Content-Length': '1647'
2025-06-11 10:05:13,066 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 10:05:13,069 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 10:05:15,259 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 10:05:15,266 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 10:05:15,268 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 10:05:15,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'eb0320d9-bd88-4a81-9aa0-f02135ef2401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:15 GMT'
    'Content-Length': '1753'
2025-06-11 10:05:15,544 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 10:05:15,763 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a8ce6410-0bfe-406c-a477-6a4a16810b01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:15 GMT'
    'Content-Length': '1992'
2025-06-11 10:05:15,764 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 10:05:15,765 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 10:05:19,172 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 10:05:19,176 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 10:05:19,177 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 10:05:19,460 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3a661693-16c2-47fc-ae50-2471a49ed400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:18 GMT'
    'Content-Length': '1753'
2025-06-11 10:05:19,461 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 10:05:19,676 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '02ab39b7-ca7c-4bcb-bc83-59b74567e600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 04:35:19 GMT'
    'Content-Length': '1652'
2025-06-11 10:05:19,677 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 10:05:19,678 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 10:05:20,356 - d365 - INFO - Fetched 11 business units
2025-06-11 10:05:20,358 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 10:05:20,378 - d365 - INFO - D365 data loaded successfully
2025-06-11 10:05:20,393 - main - INFO - [fetch-data] Data fetched successfully, now loading into memory...
2025-06-11 10:05:20,394 - main - INFO - Loading data from CSV files
2025-06-11 10:05:20,491 - main - INFO - Loaded audit_logs with 31765 rows
2025-06-11 10:05:20,561 - main - INFO - Loaded signin_logs with 5818 rows
2025-06-11 10:05:20,591 - main - INFO - Loaded user_details with 206 rows
2025-06-11 10:05:20,617 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 10:05:20,660 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 10:05:20,789 - main - INFO - Created group_memberships with 3306 rows
2025-06-11 10:05:20,833 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 10:05:20,848 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 10:05:20,849 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['8d5429c6-df27-449e-baca-523753e23005', '38638d06-9c44-418f-8be6-2247be5924ec', '46aee3ae-b46f-4737-a826-87ff31e6c3ff', '42d1b83b-00fd-45b3-95a7-ed9c051441b7', 'dcacb04f-1360-4d83-8c55-2f1bdc3762cf']...
2025-06-11 10:05:20,850 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['5638d5cf-ac35-ef11-840a-0022489ba102', '2c19b3b6-14aa-eb11-8236-0022489b4c66', 'ef419352-2555-ef11-bfe3-0022489b4696', '7250733f-13aa-eb11-8236-0022489b4c66', '24b4c94e-8533-ec11-b6e6-0022489bd51d']...
2025-06-11 10:05:20,851 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 10:05:20,865 - main - INFO - [fetch-data] Data loaded into memory successfully
2025-06-11 11:23:22,423 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 11:23:22,456 - main - INFO - FastAPI application shutdown
2025-06-11 11:23:46,702 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 11:24:07,202 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 11:24:07,203 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 11:24:07,203 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 11:24:07,205 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 11:24:07,205 - main - INFO - FastAPI application started
2025-06-11 11:24:08,051 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 11:24:08,052 - main - INFO - FastAPI application shutdown
2025-06-11 11:24:16,509 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 11:24:21,223 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 11:24:21,224 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 11:24:21,224 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 11:24:21,226 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 11:24:21,226 - main - INFO - FastAPI application started
2025-06-11 11:24:21,228 - d365 - INFO - Loading D365 data
2025-06-11 11:24:21,230 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:24:21,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '999af670-8483-465d-81fa-e80fe4ddf400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:54:21 GMT'
    'Content-Length': '1753'
2025-06-11 11:24:21,579 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:24:21,824 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2a0a13fc-af2a-49eb-ba61-b2a70a70db00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:54:21 GMT'
    'Content-Length': '1647'
2025-06-11 11:24:21,825 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:24:21,826 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:24:21,826 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T05:54:21Z)
2025-06-11 11:24:27,815 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 11:24:31,029 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 11:24:34,308 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 11:24:37,340 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 11:24:40,468 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 11:24:43,578 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 11:24:44,975 - d365 - INFO - Progress: Fetched 31765 audit logs after 7 pages
2025-06-11 11:24:45,010 - d365 - INFO - Fetched 31765 D365 audit logs via Dataverse
2025-06-11 11:24:45,100 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 11:24:45,104 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:24:45,405 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '800564cb-bdfc-4ef1-ac16-2f797368e200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:54:45 GMT'
    'Content-Length': '1753'
2025-06-11 11:24:45,406 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:24:45,698 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '029b5cb1-f53b-44db-919f-41625960fd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:54:45 GMT'
    'Content-Length': '1996'
2025-06-11 11:24:45,699 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:24:45,700 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:24:45,700 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T05:54:45Z)
2025-06-11 11:24:45,701 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 11:25:03,893 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 3.3 req/min | Time: 0:00:18
2025-06-11 11:25:15,876 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 4.0 req/min | Time: 0:00:30
2025-06-11 11:25:27,723 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.3 req/min | Time: 0:00:42
2025-06-11 11:25:41,682 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 4.3 req/min | Time: 0:00:55
2025-06-11 11:25:51,921 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.5 req/min | Time: 0:01:06
2025-06-11 11:25:59,849 - d365 - INFO - Progress: 5,845 records | Pages: 6 | Requests: 6 | Rate: 4.9 req/min | Time: 0:01:14
2025-06-11 11:26:00,350 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T05:55:19Z to 2025-06-11T05:50:59Z
2025-06-11 11:26:00,441 - d365 - INFO - Fetch completed: 5,845 records in 0:01:14
2025-06-11 11:26:00,442 - d365 - INFO - Total requests made: 6
2025-06-11 11:26:00,452 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:26:00,691 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '276749cd-c4b0-4b33-9462-316094160301'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:56:00 GMT'
    'Content-Length': '1753'
2025-06-11 11:26:00,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:26:00,898 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'dd6bad63-ecf7-4ac3-8693-e9bdde79ce00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:56:00 GMT'
    'Content-Length': '1648'
2025-06-11 11:26:00,899 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:26:00,899 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:26:00,901 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:26:01,148 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd882b8a0-13b4-42a0-83b7-20b620d29200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:56:00 GMT'
    'Content-Length': '1753'
2025-06-11 11:26:01,150 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:26:01,354 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '660202fc-990a-4225-abf2-f196f2854e01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:56:01 GMT'
    'Content-Length': '1991'
2025-06-11 11:26:01,355 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:26:01,355 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:26:01,356 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:26:01,646 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9cfde1a1-c90c-480d-b62a-d25727ba2a01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:56:01 GMT'
    'Content-Length': '1753'
2025-06-11 11:26:01,647 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:26:02,184 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '95dff45c-9602-4391-a20c-3903d774f500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 05:56:01 GMT'
    'Content-Length': '1991'
2025-06-11 11:26:02,186 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:26:02,186 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:26:04,419 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 11:26:04,420 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 11:26:05,813 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 11:27:13,389 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 11:27:13,391 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 11:27:56,309 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 11:27:56,310 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 11:27:58,584 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 11:27:58,586 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 11:28:03,246 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 11:28:03,247 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 11:28:52,354 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 11:28:52,355 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 11:29:19,467 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 11:29:19,468 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 11:29:35,421 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 11:29:35,423 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 11:30:16,636 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 11:30:16,637 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 11:30:16,638 - d365 - INFO - Final user count after filtering: 206
2025-06-11 11:30:16,639 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 11:30:16,644 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 11:30:16,650 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 11:30:16,656 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 11:30:16,658 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:30:16,977 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'cef20d22-a246-4244-8ed2-00913588e900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:16 GMT'
    'Content-Length': '1753'
2025-06-11 11:30:16,978 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:30:17,218 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7ece4479-ca1c-4d97-9295-87848914f100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:16 GMT'
    'Content-Length': '1652'
2025-06-11 11:30:17,219 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:30:17,220 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:30:18,640 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 11:30:18,646 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 11:30:18,648 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:30:18,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1735aef0-3018-4f4e-9529-5fb7c2ca4901'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:18 GMT'
    'Content-Length': '1753'
2025-06-11 11:30:18,948 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:30:19,106 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8d3a86f8-9af7-433b-916d-dda8bb87a000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:18 GMT'
    'Content-Length': '1653'
2025-06-11 11:30:19,109 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:30:19,109 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:30:23,234 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 11:30:23,239 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 11:30:23,241 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:30:23,547 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3ed949f7-06f8-4dca-a688-44a4cbdc0601'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:22 GMT'
    'Content-Length': '1753'
2025-06-11 11:30:23,548 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:30:23,783 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '21912909-c22f-4b76-9ec6-67a5b27cbf00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:23 GMT'
    'Content-Length': '1985'
2025-06-11 11:30:23,784 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:30:23,784 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:30:27,019 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 11:30:27,023 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 11:30:27,025 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:30:27,288 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '371cdfac-2712-46a5-b1f1-d49668fea600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:26 GMT'
    'Content-Length': '1753'
2025-06-11 11:30:27,289 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:30:27,435 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '63e160c0-cb0d-4fd5-9abd-726b4aec0b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:00:26 GMT'
    'Content-Length': '1653'
2025-06-11 11:30:27,436 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:30:27,437 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:30:28,169 - d365 - INFO - Fetched 11 business units
2025-06-11 11:30:28,171 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 11:30:28,181 - d365 - INFO - D365 data loaded successfully
2025-06-11 11:30:28,201 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 11:30:28,202 - main - INFO - Loading data from CSV files
2025-06-11 11:30:28,284 - main - INFO - Loaded audit_logs with 31765 rows
2025-06-11 11:30:28,336 - main - INFO - Loaded signin_logs with 5845 rows
2025-06-11 11:30:28,344 - main - INFO - Loaded user_details with 206 rows
2025-06-11 11:30:28,355 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 11:30:28,387 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 11:30:28,506 - main - INFO - Created group_memberships with 3308 rows
2025-06-11 11:30:28,640 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 11:30:28,650 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 11:30:28,651 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['005a3324-6c26-484a-be06-07d829df9a76', 'fc6fd2a8-593f-48a1-b2df-81d689137150', '828a0c6f-7972-442a-afd6-d0a6e2f0057c', '52614237-42ce-44ca-a731-4567d6dcace2', '22f074a3-f331-4ba5-a5c3-aa0e8af9b61e']...
2025-06-11 11:30:28,652 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['33b4c94e-8533-ec11-b6e6-0022489bd51d', '21e8a382-f8bc-ec11-9840-0022489e2e28', 'c2da05ff-8ac6-ed11-b597-0022489b4de1', 'a239aad0-0aaa-eb11-8236-0022489b4c66', 'ae50733f-13aa-eb11-8236-0022489b4c66']...
2025-06-11 11:30:28,653 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 11:30:28,663 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 11:30:28,663 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 11:30:28,664 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 11:30:28,664 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 11:30:28,665 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 11:31:08,284 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 11:31:13,862 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 11:31:13,863 - src.core.embeddings - INFO - Embedding initialization took 45.20 seconds
2025-06-11 11:31:13,864 - src.core.embeddings - INFO - Memory usage: RSS=507.43 MB, VMS=2702.06 MB
2025-06-11 11:31:13,864 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 11:31:13,865 - src.core.embeddings - INFO - Using all logs: audit_logs=31765 rows, signin_logs=5845 rows
2025-06-11 11:31:13,869 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 11:31:13,888 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-11 11:31:14,736 - src.core.embeddings - INFO - Text generation took 0.87 seconds
2025-06-11 11:31:14,737 - src.core.embeddings - INFO - Memory usage: RSS=531.11 MB, VMS=2726.29 MB
2025-06-11 11:31:14,737 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 11:31:16,918 - src.core.embeddings - INFO - Total documents to embed: 37610
2025-06-11 11:31:16,919 - src.core.embeddings - INFO - Document conversion took 2.18 seconds
2025-06-11 11:31:16,920 - src.core.embeddings - INFO - Memory usage: RSS=560.72 MB, VMS=2755.34 MB
2025-06-11 11:31:16,920 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 11:31:16,922 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 11:31:30,742 - src.core.embeddings - INFO - Memory usage: RSS=726.64 MB, VMS=2940.21 MB
2025-06-11 11:31:30,743 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-11 11:31:43,929 - src.core.embeddings - INFO - Memory usage: RSS=802.12 MB, VMS=3015.34 MB
2025-06-11 11:31:43,930 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-11 11:31:56,791 - src.core.embeddings - INFO - Memory usage: RSS=876.79 MB, VMS=3089.83 MB
2025-06-11 11:31:56,791 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-11 11:32:09,715 - src.core.embeddings - INFO - Memory usage: RSS=950.59 MB, VMS=3163.03 MB
2025-06-11 11:32:09,716 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-11 11:32:23,179 - src.core.embeddings - INFO - Memory usage: RSS=1024.11 MB, VMS=3237.15 MB
2025-06-11 11:32:23,180 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-11 11:32:36,176 - src.core.embeddings - INFO - Memory usage: RSS=1097.96 MB, VMS=3311.56 MB
2025-06-11 11:32:36,177 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-11 11:33:07,963 - src.core.embeddings - INFO - Memory usage: RSS=1252.77 MB, VMS=3567.79 MB
2025-06-11 11:33:07,964 - src.core.embeddings - INFO - Embedding chunk 8/8 (2610 documents)
2025-06-11 11:33:47,204 - src.core.embeddings - INFO - Memory usage: RSS=1184.12 MB, VMS=3606.04 MB
2025-06-11 11:33:47,863 - src.core.embeddings - INFO - Embedding generation took 150.94 seconds
2025-06-11 11:33:47,865 - src.core.embeddings - INFO - Memory usage: RSS=1155.65 MB, VMS=3606.04 MB
2025-06-11 11:33:47,867 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-11 11:33:49,694 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37610 vectors
2025-06-11 11:33:52,475 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-11 11:33:52,525 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-11 11:33:52,526 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-11 11:33:52,527 - src.core.embeddings - INFO - FAISS vectorstore creation took 4.66 seconds
2025-06-11 11:33:52,529 - src.core.embeddings - INFO - Memory usage: RSS=1111.04 MB, VMS=3938.79 MB
2025-06-11 11:33:52,843 - src.core.embeddings - INFO - Total embedding generation took 204.18 seconds
2025-06-11 11:33:52,909 - main - INFO - [analyze] Embeddings generated.
2025-06-11 11:33:52,986 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-11 11:33:52,989 - src.utils.config - INFO - Loading environment variables
2025-06-11 11:33:53,011 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-11 11:33:53,012 - src.core.analysis - INFO - Validating input DataFrames
2025-06-11 11:33:53,570 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 11:33:53,572 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 11:33:53,573 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 11:33:53,573 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-11 11:33:53,574 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-11 11:33:53,600 - src.core.analysis - INFO - User IDs from user_details: 206
2025-06-11 11:33:53,601 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-11 11:33:53,602 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-11 11:33:53,604 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-11 11:33:53,605 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-11 11:33:57,601 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-11 11:33:57,669 - src.core.analysis - INFO - Starting analysis
2025-06-11 11:33:57,670 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-11 11:34:05,536 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-11 11:34:05,540 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-11 11:34:05,541 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-11 11:34:05,542 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-11 11:34:05,542 - src.analysis.anomaly_detector - INFO - User details shape: (206, 10)
2025-06-11 11:34:05,543 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 11:34:05,544 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5845, 12)
2025-06-11 11:34:05,544 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 11:34:05,562 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-11 11:34:05,596 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-11 11:34:05,653 - src.analysis.anomaly_detector - INFO - Successfully mapped 5838 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-11 11:34:05,661 - src.analysis.anomaly_detector - INFO - Total mapped users: 206
2025-06-11 11:34:05,662 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-11 11:34:05,662 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-11 11:34:05,663 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-11 11:34:05,663 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-11 11:34:05,664 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-11 11:34:05,664 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-11 11:34:05,666 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-11 11:34:05,667 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-11 11:34:05,667 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-11 11:34:05,667 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-11 11:34:05,669 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-11 11:34:05,670 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-11 11:34:05,670 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-11 11:34:05,671 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-11 11:34:05,671 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-11 11:34:05,673 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-11 11:34:05,674 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-11 11:34:08,157 - src.analysis.anomaly_detector - INFO - Detected 62 anomalies
2025-06-11 11:34:08,158 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-11 11:34:08,158 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> High sign-in frequency: 2420 sign-ins (avg: 82.3, threshold: 664.5) (Department: Air Arabia NOC); Un...
2025-06-11 11:34:08,159 - src.analysis.anomaly_detector - INFO - Example 2: Akib Gorikhan -> Unusual location: Dubayy, AE at 2025-05-15 05:44:35. Typical: Abu Zaby, AE (93.8%) (Department: PCS ...
2025-06-11 11:34:08,178 - src.analysis.anomaly_detector - INFO - Example 3: Sujan Upreti -> Unusual location: Birganj, NP at 2025-05-29 08:16:04. Typical: Kathmandu, NP (89.9%) (Department: Al...
2025-06-11 11:34:08,180 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-11 11:34:09,189 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-11 11:34:09,190 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-11 11:34:09,260 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-11 11:34:09,688 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-11 11:34:10,361 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-11 11:34:10,362 - src.core.analysis - INFO - Analyzing inactive users
2025-06-11 11:34:10,363 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-11 11:34:10,363 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 11:34:10,364 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 11:34:10,385 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 05:50:59+0000', tz='UTC'), Timestamp('2025-06-11 05:47:37+0000', tz='UTC'), Timestamp('2025-06-11 05:45:31+0000', tz='UTC'), Timestamp('2025-06-11 05:43:27+0000', tz='UTC'), Timestamp('2025-06-11 05:41:26+0000', tz='UTC')]
2025-06-11 11:34:10,386 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-11 11:34:10,397 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-13 18:52:49+0000', tz='UTC'), Timestamp('2025-03-13 20:19:13+0000', tz='UTC'), Timestamp('2025-03-13 22:30:19+0000', tz='UTC'), Timestamp('2025-03-13 22:30:24+0000', tz='UTC'), Timestamp('2025-03-13 22:30:29+0000', tz='UTC')]
2025-06-11 11:34:10,399 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-11 11:34:11,082 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 206 total users.
2025-06-11 11:34:11,084 - src.core.analysis - INFO - Total unique user IDs after analysis: 523
2025-06-11 11:34:11,154 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-11 11:34:11,155 - src.core.analysis - INFO - Using chunk size: 200 for 523 users
2025-06-11 11:34:11,157 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-11 11:34:11,159 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-11 11:34:11,161 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 145463 bytes
2025-06-11 11:34:34,465 - src.core.analysis - INFO - Findings chunk 1 completed in 23.31s
2025-06-11 11:34:34,466 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-11 11:34:34,468 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 177401 bytes
2025-06-11 11:35:03,768 - src.core.analysis - INFO - Findings chunk 2 completed in 29.30s
2025-06-11 11:35:03,768 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-11 11:35:03,788 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 104029 bytes
2025-06-11 11:35:29,422 - src.core.analysis - INFO - Findings chunk 3 completed in 25.64s
2025-06-11 11:35:29,529 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-11 11:35:29,531 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-11 11:35:29,531 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-11 11:35:29,532 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-11 11:35:29,533 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-11 11:35:29,534 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-11 11:35:29,535 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-11 11:35:29,535 - src.core.analysis - INFO - Sequential processing completed in 78.38s
2025-06-11 11:35:29,535 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-11 11:35:29,536 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-11 11:35:29,537 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 523 users
2025-06-11 11:35:29,538 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-11 11:35:29,540 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-11 11:35:29,541 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-11 11:35:29,542 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 12380 bytes
2025-06-11 11:35:39,571 - src.core.analysis - INFO - Recommendations chunk 1 completed in 10.03s
2025-06-11 11:35:39,684 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-11 11:35:39,685 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-11 11:35:39,686 - src.core.analysis - INFO - Analysis completed successfully with 9 recommendations
2025-06-11 11:35:39,695 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:39,698 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-11 11:35:39,699 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-11 11:35:39,714 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:39,750 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '74760'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '199abd1d-468a-11f0-9662-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:40,389 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:40 GMT'
    'ETag': '"0x8DDA8ADFE3E859B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1d05e795-d01e-0040-0696-da3715000000'
    'x-ms-client-request-id': '199abd1d-468a-11f0-9662-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:39 GMT'
2025-06-11 11:35:40,392 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-11 11:35:40,394 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-11 11:35:40,395 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:40,401 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '19fe4aaa-468a-11f0-9091-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:40,956 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:41 GMT'
    'ETag': '"0x8DDA8ADFE973E54"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4dfc8d75-c01e-0087-4c96-daa348000000'
    'x-ms-client-request-id': '19fe4aaa-468a-11f0-9091-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:40 GMT'
2025-06-11 11:35:40,957 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-11 11:35:40,958 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-11 11:35:40,959 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:41,019 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1a5c949c-468a-11f0-9b20-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:41,631 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:41 GMT'
    'ETag': '"0x8DDA8ADFEFF0163"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e9f71ed-a01e-004a-4a96-da93a2000000'
    'x-ms-client-request-id': '1a5c949c-468a-11f0-9b20-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:40 GMT'
2025-06-11 11:35:41,632 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-11 11:35:41,644 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-11 11:35:41,645 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:41,655 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1abd9611-468a-11f0-a5cf-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:42,229 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:42 GMT'
    'ETag': '"0x8DDA8ADFF598CD9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '48f594e9-a01e-0017-1f96-da9926000000'
    'x-ms-client-request-id': '1abd9611-468a-11f0-a5cf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:41 GMT'
2025-06-11 11:35:42,231 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-11 11:35:42,232 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-11 11:35:42,234 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:42,267 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1b1b196f-468a-11f0-808f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:42,911 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:43 GMT'
    'ETag': '"0x8DDA8ADFFC2ADE8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c81c2ed3-701e-0049-3d96-da72c6000000'
    'x-ms-client-request-id': '1b1b196f-468a-11f0-808f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:42 GMT'
2025-06-11 11:35:42,912 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-11 11:35:42,913 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-11 11:35:42,917 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:42,926 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1969500'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1b7f929c-468a-11f0-8cbf-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:43,797 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:43 GMT'
    'ETag': '"0x8DDA8AE0049BCA3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '771122f7-801e-002f-0496-da3de6000000'
    'x-ms-client-request-id': '1b7f929c-468a-11f0-8cbf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:43 GMT'
2025-06-11 11:35:43,799 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-11 11:35:43,800 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-11 11:35:43,801 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:43,840 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1c0b107f-468a-11f0-ba73-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:45,221 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:45 GMT'
    'ETag': '"0x8DDA8AE011FA429"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4d7ae81a-401e-007d-3096-da410e000000'
    'x-ms-client-request-id': '1c0b107f-468a-11f0-ba73-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:44 GMT'
2025-06-11 11:35:45,223 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-11 11:35:45,224 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-11 11:35:45,225 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:45,236 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1ce00e9f-468a-11f0-a213-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:45,700 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:45 GMT'
    'ETag': '"0x8DDA8AE0167322C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ca8c99ef-b01e-009d-1596-dac297000000'
    'x-ms-client-request-id': '1ce00e9f-468a-11f0-a213-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:45 GMT'
2025-06-11 11:35:45,701 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-11 11:35:45,702 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-11 11:35:45,704 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:45,724 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1d2a918e-468a-11f0-891c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:46,072 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:46 GMT'
    'ETag': '"0x8DDA8AE01A41DC4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6ac8e328-701e-0059-2e96-dab7ae000000'
    'x-ms-client-request-id': '1d2a918e-468a-11f0-891c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:45 GMT'
2025-06-11 11:35:46,073 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-11 11:35:46,075 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-11 11:35:46,076 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:46,081 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1d60f6cb-468a-11f0-b84b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:46,566 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:46 GMT'
    'ETag': '"0x8DDA8AE01EF7804"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6334abf6-b01e-0046-7996-da04aa000000'
    'x-ms-client-request-id': '1d60f6cb-468a-11f0-b84b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:46 GMT'
2025-06-11 11:35:46,567 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-11 11:35:46,569 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-11 11:35:46,570 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:46,602 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1db07af0-468a-11f0-b341-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:47,092 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:47 GMT'
    'ETag': '"0x8DDA8AE023E9E99"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '81f6cfee-101e-0084-5c96-da422c000000'
    'x-ms-client-request-id': '1db07af0-468a-11f0-b341-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:46 GMT'
2025-06-11 11:35:47,093 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-11 11:35:47,100 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-11 11:35:47,102 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:47,113 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1495685'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1dfe6bcc-468a-11f0-ade2-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:48,322 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:48 GMT'
    'ETag': '"0x8DDA8AE02FA8BA5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '060075ac-c01e-0097-1c96-da6620000000'
    'x-ms-client-request-id': '1dfe6bcc-468a-11f0-ade2-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:48 GMT'
2025-06-11 11:35:48,324 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-11 11:35:48,326 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-11 11:35:48,327 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:48,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1ebc6e0b-468a-11f0-9230-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:49,823 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:49 GMT'
    'ETag': '"0x8DDA8AE03E03FE4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fe3debc5-f01e-0057-7f96-da9e1e000000'
    'x-ms-client-request-id': '1ebc6e0b-468a-11f0-9230-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:49 GMT'
2025-06-11 11:35:49,825 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-11 11:35:49,826 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-11 11:35:49,828 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:49,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1f9d8095-468a-11f0-8088-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:50,279 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:50 GMT'
    'ETag': '"0x8DDA8AE0426BDA5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f9527d9e-d01e-0022-2196-daf532000000'
    'x-ms-client-request-id': '1f9d8095-468a-11f0-8088-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:49 GMT'
2025-06-11 11:35:50,282 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-11 11:35:50,283 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-11 11:35:50,284 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:50,309 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1fe61aae-468a-11f0-a69d-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:50,789 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:50 GMT'
    'ETag': '"0x8DDA8AE047375FD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b1b647a9-c01e-00a8-7096-daae83000000'
    'x-ms-client-request-id': '1fe61aae-468a-11f0-a69d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:50 GMT'
2025-06-11 11:35:50,790 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-11 11:35:50,795 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-11 11:35:50,797 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:50,803 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '20317fb7-468a-11f0-bbf3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:51,223 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:51 GMT'
    'ETag': '"0x8DDA8AE04B710C4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b5c7158e-801e-00a9-4496-daf15f000000'
    'x-ms-client-request-id': '20317fb7-468a-11f0-bbf3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:50 GMT'
2025-06-11 11:35:51,224 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-11 11:35:51,225 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-11 11:35:51,227 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:51,251 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2075ea40-468a-11f0-9dcd-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:51,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:51 GMT'
    'ETag': '"0x8DDA8AE051651DF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '251f51ae-e01e-0090-7596-da0a43000000'
    'x-ms-client-request-id': '2075ea40-468a-11f0-9dcd-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:51 GMT'
2025-06-11 11:35:51,908 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-11 11:35:51,914 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-11 11:35:51,916 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:51,924 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '20dc6f52-468a-11f0-ab74-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:52,843 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:52 GMT'
    'ETag': '"0x8DDA8AE05AD069F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2a0a6132-001e-0088-1096-dad524000000'
    'x-ms-client-request-id': '20dc6f52-468a-11f0-ab74-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:52 GMT'
2025-06-11 11:35:52,845 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-11 11:35:52,846 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-11 11:35:52,847 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:35:52,874 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '216d794d-468a-11f0-94a6-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:53,539 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:53 GMT'
    'ETag': '"0x8DDA8AE0617382F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20c3cc3-001e-007c-7396-da1ed2000000'
    'x-ms-client-request-id': '216d794d-468a-11f0-94a6-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:53 GMT'
2025-06-11 11:35:53,541 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-11 11:35:53,546 - main - INFO - [analyze] Analysis completed.
2025-06-11 11:35:53,565 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-11 11:35:53,587 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '272982'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '21da57b0-468a-11f0-b91b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:54,158 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:54 GMT'
    'ETag': '"0x8DDA8AE06762B8C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca20-301e-0015-3996-da279e000000'
    'x-ms-client-request-id': '21da57b0-468a-11f0-b91b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:53 GMT'
2025-06-11 11:35:54,163 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '22322d78-468a-11f0-bb0f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:54,246 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:54 GMT'
    'ETag': '"0x8DDA8AE06844C80"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca24-301e-0015-3b96-da279e000000'
    'x-ms-client-request-id': '22322d78-468a-11f0-bb0f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:53 GMT'
2025-06-11 11:35:54,249 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '223f5d24-468a-11f0-b6a5-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:54,391 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:54 GMT'
    'ETag': '"0x8DDA8AE069797C5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca26-301e-0015-3d96-da279e000000'
    'x-ms-client-request-id': '223f5d24-468a-11f0-b6a5-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:53 GMT'
2025-06-11 11:35:54,397 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2255da14-468a-11f0-8090-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:54,485 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:54 GMT'
    'ETag': '"0x8DDA8AE06A826FD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca2a-301e-0015-4196-da279e000000'
    'x-ms-client-request-id': '2255da14-468a-11f0-8090-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:53 GMT'
2025-06-11 11:35:54,489 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2263eea4-468a-11f0-8f40-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:54,595 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:54 GMT'
    'ETag': '"0x8DDA8AE06B88F52"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca2c-301e-0015-4396-da279e000000'
    'x-ms-client-request-id': '2263eea4-468a-11f0-8f40-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:53 GMT'
2025-06-11 11:35:54,601 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1969500'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '227516c9-468a-11f0-983b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:54,935 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:55 GMT'
    'ETag': '"0x8DDA8AE06ED6DB6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca2d-301e-0015-4496-da279e000000'
    'x-ms-client-request-id': '227516c9-468a-11f0-983b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:54 GMT'
2025-06-11 11:35:54,944 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '22a95e8a-468a-11f0-9056-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:55,589 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:55 GMT'
    'ETag': '"0x8DDA8AE074F1D30"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca31-301e-0015-4796-da279e000000'
    'x-ms-client-request-id': '22a95e8a-468a-11f0-9056-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:54 GMT'
2025-06-11 11:35:55,595 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '230cc57d-468a-11f0-8618-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:55,673 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:55 GMT'
    'ETag': '"0x8DDA8AE075E00A4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca38-301e-0015-4b96-da279e000000'
    'x-ms-client-request-id': '230cc57d-468a-11f0-8618-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:54 GMT'
2025-06-11 11:35:55,677 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '23193f79-468a-11f0-9ba9-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:55,784 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:55 GMT'
    'ETag': '"0x8DDA8AE0769DA33"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca3a-301e-0015-4d96-da279e000000'
    'x-ms-client-request-id': '23193f79-468a-11f0-9ba9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:54 GMT'
2025-06-11 11:35:55,789 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '232a3dab-468a-11f0-8aaf-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:55,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:55 GMT'
    'ETag': '"0x8DDA8AE077B79AC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca3d-301e-0015-5096-da279e000000'
    'x-ms-client-request-id': '232a3dab-468a-11f0-8aaf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:55 GMT'
2025-06-11 11:35:55,878 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2337ce5f-468a-11f0-bb1c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:55,972 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:56 GMT'
    'ETag': '"0x8DDA8AE078925E7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca3e-301e-0015-5196-da279e000000'
    'x-ms-client-request-id': '2337ce5f-468a-11f0-bb1c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:55 GMT'
2025-06-11 11:35:55,977 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1495685'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2346f84d-468a-11f0-aa26-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:56,138 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:56 GMT'
    'ETag': '"0x8DDA8AE07A4F32C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca3f-301e-0015-5296-da279e000000'
    'x-ms-client-request-id': '2346f84d-468a-11f0-aa26-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:55 GMT'
2025-06-11 11:35:56,145 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2360b055-468a-11f0-96e9-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:56,822 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:56 GMT'
    'ETag': '"0x8DDA8AE080BF3E3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca43-301e-0015-5696-da279e000000'
    'x-ms-client-request-id': '2360b055-468a-11f0-96e9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:56 GMT'
2025-06-11 11:35:56,827 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '23c8bca7-468a-11f0-b5da-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:56,908 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:57 GMT'
    'ETag': '"0x8DDA8AE081A629F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca50-301e-0015-6296-da279e000000'
    'x-ms-client-request-id': '23c8bca7-468a-11f0-b5da-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:56 GMT'
2025-06-11 11:35:56,912 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '23d5b420-468a-11f0-a167-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:57,011 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:57 GMT'
    'ETag': '"0x8DDA8AE08296CEE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca51-301e-0015-6396-da279e000000'
    'x-ms-client-request-id': '23d5b420-468a-11f0-a167-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:56 GMT'
2025-06-11 11:35:57,015 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '23e573e6-468a-11f0-b3e9-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:57,091 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:57 GMT'
    'ETag': '"0x8DDA8AE08367DA2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca52-301e-0015-6496-da279e000000'
    'x-ms-client-request-id': '23e573e6-468a-11f0-b3e9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:56 GMT'
2025-06-11 11:35:57,097 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '23f1e4bb-468a-11f0-bfa8-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:57,190 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:57 GMT'
    'ETag': '"0x8DDA8AE0843DC1F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca53-301e-0015-6596-da279e000000'
    'x-ms-client-request-id': '23f1e4bb-468a-11f0-bfa8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:56 GMT'
2025-06-11 11:35:57,193 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2400a069-468a-11f0-8a45-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:57,278 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:57 GMT'
    'ETag': '"0x8DDA8AE08524ADC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca57-301e-0015-6896-da279e000000'
    'x-ms-client-request-id': '2400a069-468a-11f0-8a45-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:56 GMT'
2025-06-11 11:35:57,282 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '240e1796-468a-11f0-9c7a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:35:57,368 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:05:57 GMT'
    'ETag': '"0x8DDA8AE086092B1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569cca58-301e-0015-6996-da279e000000'
    'x-ms-client-request-id': '240e1796-468a-11f0-9c7a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:05:56 GMT'
2025-06-11 11:43:29,498 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 11:43:29,528 - main - INFO - FastAPI application shutdown
2025-06-11 11:43:48,132 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 11:43:57,879 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 11:43:57,880 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 11:43:57,880 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 11:43:57,882 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 11:43:57,882 - main - INFO - FastAPI application started
2025-06-11 11:43:57,887 - d365 - INFO - Loading D365 data
2025-06-11 11:43:57,889 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:43:58,188 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6801c3b6-2568-4630-8ed4-212d2dc8b600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:13:58 GMT'
    'Content-Length': '1753'
2025-06-11 11:43:58,208 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:43:58,457 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '31157359-ad69-4f5e-b7f5-9122538bdb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:13:58 GMT'
    'Content-Length': '1647'
2025-06-11 11:43:58,459 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:43:58,459 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:43:58,460 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T06:13:58Z)
2025-06-11 11:44:06,095 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 11:44:13,267 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 11:44:19,748 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 11:44:26,009 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 11:44:32,341 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 11:44:38,808 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 11:44:41,109 - d365 - INFO - Progress: Fetched 31767 audit logs after 7 pages
2025-06-11 11:44:41,149 - d365 - INFO - Fetched 31767 D365 audit logs via Dataverse
2025-06-11 11:44:41,257 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 11:44:41,261 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:44:41,575 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'cfddb614-2211-4635-8707-cb7ebc780701'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:14:41 GMT'
    'Content-Length': '1753'
2025-06-11 11:44:41,577 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:44:41,819 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '27719408-67be-49ff-9975-3d1935379900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:14:41 GMT'
    'Content-Length': '1991'
2025-06-11 11:44:41,821 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:44:41,821 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:44:41,822 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T06:14:41Z)
2025-06-11 11:44:41,824 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 11:44:52,937 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 5.4 req/min | Time: 0:00:11
2025-06-11 11:45:07,227 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 4.7 req/min | Time: 0:00:25
2025-06-11 11:45:15,860 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.3 req/min | Time: 0:00:34
2025-06-11 11:45:27,569 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.2 req/min | Time: 0:00:45
2025-06-11 11:45:37,538 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.4 req/min | Time: 0:00:55
2025-06-11 11:45:44,521 - d365 - INFO - Progress: 5,851 records | Pages: 6 | Requests: 6 | Rate: 5.7 req/min | Time: 0:01:02
2025-06-11 11:45:45,022 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T06:16:34Z to 2025-06-11T06:09:26Z
2025-06-11 11:45:45,169 - d365 - INFO - Fetch completed: 5,851 records in 0:01:03
2025-06-11 11:45:45,170 - d365 - INFO - Total requests made: 6
2025-06-11 11:45:45,193 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:45:45,519 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2103c012-8985-4820-b2a9-d29d5845bd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:15:45 GMT'
    'Content-Length': '1753'
2025-06-11 11:45:45,521 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:45:45,749 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '202f5632-1a76-4e3e-917a-23165f0b5800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:15:45 GMT'
    'Content-Length': '1652'
2025-06-11 11:45:45,751 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:45:45,751 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:45:45,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:45:46,044 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '98e96d2a-fe61-4240-87c5-1f8c8b631300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:15:45 GMT'
    'Content-Length': '1753'
2025-06-11 11:45:46,046 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:45:46,276 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ba4f19be-f937-4738-b559-a8682eead400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:15:45 GMT'
    'Content-Length': '1996'
2025-06-11 11:45:46,278 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:45:46,278 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:45:46,281 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:45:46,632 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'be6934e1-d943-402c-84ac-81e68540f400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:15:46 GMT'
    'Content-Length': '1753'
2025-06-11 11:45:46,634 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:45:46,882 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7d9f47c3-f3fe-4879-8a41-7c3e6990d100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:15:46 GMT'
    'Content-Length': '1991'
2025-06-11 11:45:46,884 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:45:46,884 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:45:49,184 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 11:45:49,185 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 11:45:51,008 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 11:46:56,959 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 11:46:56,962 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 11:47:38,353 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 11:47:38,355 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 11:47:40,821 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 11:47:40,823 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 11:47:46,286 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 11:47:46,287 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 11:49:06,082 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 11:49:06,084 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 11:49:49,750 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 11:49:49,752 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 11:50:15,035 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 11:50:15,039 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 11:51:17,270 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 11:51:17,270 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 11:51:17,271 - d365 - INFO - Final user count after filtering: 206
2025-06-11 11:51:17,273 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 11:51:17,282 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 11:51:17,294 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 11:51:17,307 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 11:51:17,314 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:51:17,672 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b65925e7-44fe-4b52-8d7a-3cfeeace0501'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:17 GMT'
    'Content-Length': '1753'
2025-06-11 11:51:17,675 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:51:17,856 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e7547bdc-293e-42ee-9b12-6b604dbdfe00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:17 GMT'
    'Content-Length': '1653'
2025-06-11 11:51:17,859 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:51:17,860 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:51:19,472 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 11:51:19,492 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 11:51:19,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:51:19,751 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4cb356df-7c52-49f5-be6b-ba9616173700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:18 GMT'
    'Content-Length': '1753'
2025-06-11 11:51:19,753 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:51:19,914 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f9ecd242-cb32-4d90-866b-38108387f000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:19 GMT'
    'Content-Length': '1653'
2025-06-11 11:51:19,915 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:51:19,916 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:51:23,201 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 11:51:23,221 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 11:51:23,233 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:51:23,563 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '893dc028-3cd3-4842-899b-088b13cc0401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:23 GMT'
    'Content-Length': '1753'
2025-06-11 11:51:23,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:51:23,773 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '88512188-4510-4494-b3f4-3946cb210801'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:23 GMT'
    'Content-Length': '1991'
2025-06-11 11:51:23,775 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:51:23,775 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 11:51:25,810 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 11:51:25,830 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 11:51:25,834 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 11:51:26,121 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e7230f85-f3f9-405b-8174-3a599275aa00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:26 GMT'
    'Content-Length': '1753'
2025-06-11 11:51:26,122 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 11:51:26,379 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e95e0419-9a0b-419d-89d9-8218cda71701'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:21:26 GMT'
    'Content-Length': '1647'
2025-06-11 11:51:26,380 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 11:51:26,381 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 11:51:27,299 - d365 - INFO - Fetched 11 business units
2025-06-11 11:51:27,305 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 11:51:27,330 - d365 - INFO - D365 data loaded successfully
2025-06-11 11:51:27,408 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 11:51:27,408 - main - INFO - Loading data from CSV files
2025-06-11 11:51:27,532 - main - INFO - Loaded audit_logs with 31767 rows
2025-06-11 11:51:27,610 - main - INFO - Loaded signin_logs with 5851 rows
2025-06-11 11:51:27,621 - main - INFO - Loaded user_details with 206 rows
2025-06-11 11:51:27,634 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 11:51:27,686 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 11:51:27,830 - main - INFO - Created group_memberships with 3308 rows
2025-06-11 11:51:27,877 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 11:51:27,891 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 11:51:27,893 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['6a29c514-afdf-4cb4-b21b-408e2791b5cc', '69ff8819-44af-409a-90cd-29f8df54df5c', 'c9a68d4d-342a-416c-b54c-ec2cdabc0c3f', '828a0c6f-7972-442a-afd6-d0a6e2f0057c', 'a9c69b84-fe75-496a-b3be-7b04fddbfdcd']...
2025-06-11 11:51:27,894 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['d0d8ac80-177d-ef11-ac21-0022489ba102', 'e7752e5e-bbdc-ee11-904d-0022489ba240', '1492dbd6-9c58-ed11-9562-0022489b4de1', '558b16a0-76b4-eb11-8236-000d3ab6406f', 'f3b4c94e-8533-ec11-b6e6-0022489bd51d']...
2025-06-11 11:51:27,895 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 11:51:27,902 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 11:51:27,903 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 11:51:27,904 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 11:51:27,904 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 11:51:27,905 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 11:51:42,469 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 11:51:49,527 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 11:51:49,528 - src.core.embeddings - INFO - Embedding initialization took 21.62 seconds
2025-06-11 11:51:49,529 - src.core.embeddings - INFO - Memory usage: RSS=438.91 MB, VMS=2703.40 MB
2025-06-11 11:51:49,530 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 11:51:49,531 - src.core.embeddings - INFO - Using all logs: audit_logs=31767 rows, signin_logs=5851 rows
2025-06-11 11:51:49,542 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 11:51:49,606 - src.core.embeddings - INFO - Precomputed location history in 0.06 seconds
2025-06-11 11:51:52,046 - src.core.embeddings - INFO - Text generation took 2.52 seconds
2025-06-11 11:51:52,047 - src.core.embeddings - INFO - Memory usage: RSS=463.07 MB, VMS=2727.88 MB
2025-06-11 11:51:52,058 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 11:51:58,804 - src.core.embeddings - INFO - Total documents to embed: 37618
2025-06-11 11:51:58,805 - src.core.embeddings - INFO - Document conversion took 6.75 seconds
2025-06-11 11:51:58,806 - src.core.embeddings - INFO - Memory usage: RSS=492.71 MB, VMS=2756.93 MB
2025-06-11 11:51:58,806 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 11:51:58,809 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 11:52:16,633 - src.core.embeddings - INFO - Memory usage: RSS=658.10 MB, VMS=2940.97 MB
2025-06-11 11:52:16,634 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-11 11:52:38,395 - src.core.embeddings - INFO - Memory usage: RSS=733.43 MB, VMS=3015.96 MB
2025-06-11 11:52:38,396 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-11 11:52:59,568 - src.core.embeddings - INFO - Memory usage: RSS=808.41 MB, VMS=3090.56 MB
2025-06-11 11:52:59,569 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-11 11:53:21,413 - src.core.embeddings - INFO - Memory usage: RSS=877.07 MB, VMS=3160.60 MB
2025-06-11 11:53:21,414 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-11 11:53:44,416 - src.core.embeddings - INFO - Memory usage: RSS=953.36 MB, VMS=3239.19 MB
2025-06-11 11:53:44,416 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-11 11:54:06,539 - src.core.embeddings - INFO - Memory usage: RSS=1027.12 MB, VMS=3313.48 MB
2025-06-11 11:54:06,540 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-11 11:55:00,139 - src.core.embeddings - INFO - Memory usage: RSS=1248.75 MB, VMS=3568.72 MB
2025-06-11 11:55:00,140 - src.core.embeddings - INFO - Embedding chunk 8/8 (2618 documents)
2025-06-11 11:55:23,244 - src.core.embeddings - INFO - Memory usage: RSS=1288.51 MB, VMS=3608.54 MB
2025-06-11 11:55:23,590 - src.core.embeddings - INFO - Embedding generation took 204.78 seconds
2025-06-11 11:55:23,591 - src.core.embeddings - INFO - Memory usage: RSS=1288.51 MB, VMS=3608.54 MB
2025-06-11 11:55:23,592 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-11 11:55:24,329 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37618 vectors
2025-06-11 11:55:25,329 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-11 11:55:25,347 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-11 11:55:25,347 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-11 11:55:25,348 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.76 seconds
2025-06-11 11:55:25,348 - src.core.embeddings - INFO - Memory usage: RSS=1486.29 MB, VMS=3942.32 MB
2025-06-11 11:55:25,360 - src.core.embeddings - INFO - Total embedding generation took 237.46 seconds
2025-06-11 11:55:25,395 - main - INFO - [analyze] Embeddings generated.
2025-06-11 11:55:25,395 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-11 11:55:25,398 - src.utils.config - INFO - Loading environment variables
2025-06-11 11:55:25,422 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-11 11:55:25,423 - src.core.analysis - INFO - Validating input DataFrames
2025-06-11 11:55:25,513 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 11:55:25,514 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 11:55:25,515 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 11:55:25,515 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-11 11:55:25,516 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-11 11:55:25,526 - src.core.analysis - INFO - User IDs from user_details: 206
2025-06-11 11:55:25,527 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-11 11:55:25,527 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-11 11:55:25,528 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-11 11:55:25,528 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-11 11:55:27,462 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-11 11:55:27,498 - src.core.analysis - INFO - Starting analysis
2025-06-11 11:55:27,500 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-11 11:55:31,250 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-11 11:55:31,251 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-11 11:55:31,252 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-11 11:55:31,252 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-11 11:55:31,252 - src.analysis.anomaly_detector - INFO - User details shape: (206, 10)
2025-06-11 11:55:31,253 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 11:55:31,254 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5851, 12)
2025-06-11 11:55:31,254 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 11:55:31,266 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-11 11:55:31,283 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-11 11:55:31,317 - src.analysis.anomaly_detector - INFO - Successfully mapped 5844 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-11 11:55:31,323 - src.analysis.anomaly_detector - INFO - Total mapped users: 206
2025-06-11 11:55:31,323 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-11 11:55:31,324 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-11 11:55:31,324 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-11 11:55:31,325 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-11 11:55:31,325 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-11 11:55:31,326 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-11 11:55:31,326 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-11 11:55:31,326 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-11 11:55:31,327 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-11 11:55:31,327 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-11 11:55:31,328 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-11 11:55:31,328 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-11 11:55:31,328 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-11 11:55:31,329 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-11 11:55:31,329 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-11 11:55:31,329 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-11 11:55:31,330 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-11 11:55:32,372 - src.analysis.anomaly_detector - INFO - Detected 62 anomalies
2025-06-11 11:55:32,373 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-11 11:55:32,373 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> High sign-in frequency: 2427 sign-ins (avg: 82.4, threshold: 666.2) (Department: Air Arabia NOC); Un...
2025-06-11 11:55:32,374 - src.analysis.anomaly_detector - INFO - Example 2: Akib Gorikhan -> Unusual location: Dubayy, AE at 2025-05-15 05:44:35. Typical: Abu Zaby, AE (93.8%) (Department: PCS ...
2025-06-11 11:55:32,374 - src.analysis.anomaly_detector - INFO - Example 3: Sujan Upreti -> Unusual location: Birganj, NP at 2025-05-29 08:16:04. Typical: Kathmandu, NP (89.9%) (Department: Al...
2025-06-11 11:55:32,375 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-11 11:55:33,142 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-11 11:55:33,145 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-11 11:55:33,302 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-11 11:55:33,676 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-11 11:55:34,188 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-11 11:55:34,189 - src.core.analysis - INFO - Analyzing inactive users
2025-06-11 11:55:34,189 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-11 11:55:34,190 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 11:55:34,193 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 11:55:34,205 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 06:09:26+0000', tz='UTC'), Timestamp('2025-06-11 06:07:16+0000', tz='UTC'), Timestamp('2025-06-11 06:02:53+0000', tz='UTC'), Timestamp('2025-06-11 06:00:51+0000', tz='UTC'), Timestamp('2025-06-11 05:58:49+0000', tz='UTC')]
2025-06-11 11:55:34,206 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-11 11:55:34,214 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-13 18:52:49+0000', tz='UTC'), Timestamp('2025-03-13 20:19:13+0000', tz='UTC'), Timestamp('2025-03-13 22:30:19+0000', tz='UTC'), Timestamp('2025-03-13 22:30:24+0000', tz='UTC'), Timestamp('2025-03-13 22:30:29+0000', tz='UTC')]
2025-06-11 11:55:34,215 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-11 11:55:34,657 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 206 total users.
2025-06-11 11:55:34,658 - src.core.analysis - INFO - Total unique user IDs after analysis: 523
2025-06-11 11:55:34,689 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-11 11:55:34,690 - src.core.analysis - INFO - Using chunk size: 200 for 523 users
2025-06-11 11:55:34,691 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-11 11:55:34,692 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-11 11:55:34,693 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 164356 bytes
2025-06-11 11:56:29,404 - src.core.analysis - INFO - Findings chunk 1 completed in 54.71s
2025-06-11 11:56:29,405 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-11 11:56:29,406 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 164710 bytes
2025-06-11 11:57:14,728 - src.core.analysis - INFO - Findings chunk 2 completed in 45.32s
2025-06-11 11:57:14,729 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-11 11:57:14,730 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 97827 bytes
2025-06-11 11:57:36,830 - src.core.analysis - INFO - Findings chunk 3 completed in 22.10s
2025-06-11 11:57:36,939 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-11 11:57:36,940 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-11 11:57:36,941 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-11 11:57:36,942 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-11 11:57:36,942 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-11 11:57:36,943 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-11 11:57:36,944 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-11 11:57:36,944 - src.core.analysis - INFO - Sequential processing completed in 122.25s
2025-06-11 11:57:36,944 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-11 11:57:36,945 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-11 11:57:36,946 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 523 users
2025-06-11 11:57:36,947 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-11 11:57:36,948 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-11 11:57:36,948 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-11 11:57:36,949 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 13084 bytes
2025-06-11 11:57:49,802 - src.core.analysis - INFO - Recommendations chunk 1 completed in 12.85s
2025-06-11 11:57:49,907 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-11 11:57:49,908 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-11 11:57:49,909 - src.core.analysis - INFO - Analysis completed successfully with 12 recommendations
2025-06-11 11:57:49,909 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:49,910 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-11 11:57:49,912 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-11 11:57:49,914 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:49,985 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '272982'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '327c97fe-468d-11f0-8159-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:50,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:50 GMT'
    'ETag': '"0x8DDA8B1172B84DD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fccf4a7a-e01e-0039-3899-dacb31000000'
    'x-ms-client-request-id': '327c97fe-468d-11f0-8159-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:50 GMT'
2025-06-11 11:57:50,679 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-11 11:57:50,680 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-11 11:57:50,681 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:50,714 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '32ebf949-468d-11f0-b7da-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:51,238 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:51 GMT'
    'ETag': '"0x8DDA8B11782DFE8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c5411e41-c01e-0063-8099-daadd6000000'
    'x-ms-client-request-id': '32ebf949-468d-11f0-b7da-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:50 GMT'
2025-06-11 11:57:51,240 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-11 11:57:51,242 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-11 11:57:51,243 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:51,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '33403a60-468d-11f0-92f4-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:51,932 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:52 GMT'
    'ETag': '"0x8DDA8B117EC014B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9cfb46de-a01e-0081-3f99-da90f7000000'
    'x-ms-client-request-id': '33403a60-468d-11f0-92f4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:51 GMT'
2025-06-11 11:57:51,933 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-11 11:57:51,934 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-11 11:57:51,935 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:51,966 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '33aaf0b1-468d-11f0-8914-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:52,479 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:52 GMT'
    'ETag': '"0x8DDA8B11840A058"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '075cb57f-601e-006a-4799-dae805000000'
    'x-ms-client-request-id': '33aaf0b1-468d-11f0-8914-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:51 GMT'
2025-06-11 11:57:52,481 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-11 11:57:52,483 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-11 11:57:52,484 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:52,512 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '33fe4a8a-468d-11f0-a223-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:53,112 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:53 GMT'
    'ETag': '"0x8DDA8B118A02F80"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1ad61862-601e-0055-6099-da20a6000000'
    'x-ms-client-request-id': '33fe4a8a-468d-11f0-a223-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:52 GMT'
2025-06-11 11:57:53,114 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-11 11:57:53,115 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-11 11:57:53,116 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:53,144 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1969624'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '345ec0fc-468d-11f0-8146-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:54,121 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:54 GMT'
    'ETag': '"0x8DDA8B11939EE6C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b22b366a-b01e-00b2-5299-dacf5c000000'
    'x-ms-client-request-id': '345ec0fc-468d-11f0-8146-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:54 GMT'
2025-06-11 11:57:54,122 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-11 11:57:54,123 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-11 11:57:54,124 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:54,161 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '34f9d8ca-468d-11f0-a094-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:55,803 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:55 GMT'
    'ETag': '"0x8DDA8B11A39EBD3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6d0c21f0-d01e-0032-1899-da305a000000'
    'x-ms-client-request-id': '34f9d8ca-468d-11f0-a094-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:55 GMT'
2025-06-11 11:57:55,805 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-11 11:57:55,806 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-11 11:57:55,807 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:55,823 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '35f792bc-468d-11f0-aa03-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:56,217 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:56 GMT'
    'ETag': '"0x8DDA8B11A746953"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9c60c14-701e-0076-5599-daba65000000'
    'x-ms-client-request-id': '35f792bc-468d-11f0-aa03-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:56 GMT'
2025-06-11 11:57:56,218 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-11 11:57:56,219 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-11 11:57:56,220 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:56,243 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '363783e3-468d-11f0-9394-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:56,676 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:56 GMT'
    'ETag': '"0x8DDA8B11ABF4F2D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fccf4adf-e01e-0039-7899-dacb31000000'
    'x-ms-client-request-id': '363783e3-468d-11f0-9394-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:56 GMT'
2025-06-11 11:57:56,677 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-11 11:57:56,678 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-11 11:57:56,680 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:56,720 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3680653c-468d-11f0-862c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:57,223 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:57 GMT'
    'ETag': '"0x8DDA8B11B132BB0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a84204a-b01e-001b-6799-da0e2e000000'
    'x-ms-client-request-id': '3680653c-468d-11f0-862c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:56 GMT'
2025-06-11 11:57:57,224 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-11 11:57:57,225 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-11 11:57:57,226 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:57,250 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '36d14dfc-468d-11f0-aeff-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:57,706 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:57 GMT'
    'ETag': '"0x8DDA8B11B5E1192"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '85e0a958-101e-0012-4999-da4bfd000000'
    'x-ms-client-request-id': '36d14dfc-468d-11f0-aeff-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:57 GMT'
2025-06-11 11:57:57,707 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-11 11:57:57,708 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-11 11:57:57,709 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:57,728 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1497134'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '371a4747-468d-11f0-8f25-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:57:58,669 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:27:58 GMT'
    'ETag': '"0x8DDA8B11BEBCFF9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '431cb348-a01e-0038-7899-da94ed000000'
    'x-ms-client-request-id': '371a4747-468d-11f0-8f25-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:57 GMT'
2025-06-11 11:57:58,671 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-11 11:57:58,672 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-11 11:57:58,673 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:57:58,704 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '37af2364-468d-11f0-b1fd-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:00,086 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:00 GMT'
    'ETag': '"0x8DDA8B11CC7CBE5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c5411ecb-c01e-0063-5f99-daadd6000000'
    'x-ms-client-request-id': '37af2364-468d-11f0-b1fd-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:00 GMT'
2025-06-11 11:58:00,089 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-11 11:58:00,091 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-11 11:58:00,092 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:58:00,117 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3886b3fe-468d-11f0-bcc0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:00,467 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:00 GMT'
    'ETag': '"0x8DDA8B11D0359A6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '99f28936-e01e-0064-4d99-dac1b5000000'
    'x-ms-client-request-id': '3886b3fe-468d-11f0-bcc0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:27:59 GMT'
2025-06-11 11:58:00,468 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-11 11:58:00,469 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-11 11:58:00,470 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:58:00,490 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '38bf95ef-468d-11f0-bd86-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:00,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:01 GMT'
    'ETag': '"0x8DDA8B11D4BAA54"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'defd1d87-f01e-0025-3a99-da9951000000'
    'x-ms-client-request-id': '38bf95ef-468d-11f0-bd86-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:00 GMT'
2025-06-11 11:58:00,949 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-11 11:58:00,950 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-11 11:58:00,951 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:58:00,971 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3909151f-468d-11f0-ae3b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:01,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:01 GMT'
    'ETag': '"0x8DDA8B11D9FD49C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ac8e0b59-201e-0026-0b99-da7835000000'
    'x-ms-client-request-id': '3909151f-468d-11f0-ae3b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:00 GMT'
2025-06-11 11:58:01,500 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-11 11:58:01,501 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-11 11:58:01,502 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:58:01,522 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '395d1fa2-468d-11f0-b0d4-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:02,080 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:02 GMT'
    'ETag': '"0x8DDA8B11DF83FDF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '05ac693b-101e-0070-0499-da89da000000'
    'x-ms-client-request-id': '395d1fa2-468d-11f0-b0d4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:02 GMT'
2025-06-11 11:58:02,081 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-11 11:58:02,082 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-11 11:58:02,083 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:58:02,112 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '39b72308-468d-11f0-ad31-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:02,679 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:02 GMT'
    'ETag': '"0x8DDA8B11E53DBE2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'caa86f2e-a01e-0065-4d99-da9e69000000'
    'x-ms-client-request-id': '39b72308-468d-11f0-ad31-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:02 GMT'
2025-06-11 11:58:02,681 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-11 11:58:02,682 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-11 11:58:02,683 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 11:58:02,701 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3a10fbd4-468d-11f0-b760-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:03,245 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:03 GMT'
    'ETag': '"0x8DDA8B11EA9D8D9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2517c079-401e-006d-0999-da8466000000'
    'x-ms-client-request-id': '3a10fbd4-468d-11f0-b760-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:03 GMT'
2025-06-11 11:58:03,246 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-11 11:58:03,250 - main - INFO - [analyze] Analysis completed.
2025-06-11 11:58:03,268 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-11 11:58:03,292 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '558810'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3a6b42ff-468d-11f0-8bff-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:04,034 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:04 GMT'
    'ETag': '"0x8DDA8B11F227940"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d19c2-001e-007c-1399-da1ed2000000'
    'x-ms-client-request-id': '3a6b42ff-468d-11f0-8bff-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:03 GMT'
2025-06-11 11:58:04,040 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3add4d94-468d-11f0-9eb0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:04,138 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:04 GMT'
    'ETag': '"0x8DDA8B11F32460C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d19e0-001e-007c-2f99-da1ed2000000'
    'x-ms-client-request-id': '3add4d94-468d-11f0-9eb0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:03 GMT'
2025-06-11 11:58:04,143 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3aed070a-468d-11f0-b10e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:04,263 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:04 GMT'
    'ETag': '"0x8DDA8B11F45915A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d19e3-001e-007c-3299-da1ed2000000'
    'x-ms-client-request-id': '3aed070a-468d-11f0-b10e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:03 GMT'
2025-06-11 11:58:04,269 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3b00378f-468d-11f0-a035-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:04,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:04 GMT'
    'ETag': '"0x8DDA8B11F5426FF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d19e4-001e-007c-3399-da1ed2000000'
    'x-ms-client-request-id': '3b00378f-468d-11f0-a035-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:03 GMT'
2025-06-11 11:58:04,361 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3b0e5ca9-468d-11f0-82e4-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:04,465 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:04 GMT'
    'ETag': '"0x8DDA8B11F641AAE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d19e6-001e-007c-3599-da1ed2000000'
    'x-ms-client-request-id': '3b0e5ca9-468d-11f0-82e4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:03 GMT'
2025-06-11 11:58:04,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1969624'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3b1f1269-468d-11f0-8694-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:04,841 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:04 GMT'
    'ETag': '"0x8DDA8B11F9D6108"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d19e8-001e-007c-3799-da1ed2000000'
    'x-ms-client-request-id': '3b1f1269-468d-11f0-8694-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:04 GMT'
2025-06-11 11:58:04,849 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3b58c0ac-468d-11f0-962c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:05,852 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:05 GMT'
    'ETag': '"0x8DDA8B1203746D5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d19f1-001e-007c-3f99-da1ed2000000'
    'x-ms-client-request-id': '3b58c0ac-468d-11f0-962c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:05 GMT'
2025-06-11 11:58:05,857 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3bf28b8b-468d-11f0-8bab-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:05,937 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:06 GMT'
    'ETag': '"0x8DDA8B12044F324"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a0a-001e-007c-5499-da1ed2000000'
    'x-ms-client-request-id': '3bf28b8b-468d-11f0-8bab-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:05 GMT'
2025-06-11 11:58:05,941 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3bff6f7b-468d-11f0-baad-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:06,026 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:06 GMT'
    'ETag': '"0x8DDA8B12051DCF9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a0c-001e-007c-5699-da1ed2000000'
    'x-ms-client-request-id': '3bff6f7b-468d-11f0-baad-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:05 GMT'
2025-06-11 11:58:06,031 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3c0d1fcc-468d-11f0-9dce-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:06,113 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:06 GMT'
    'ETag': '"0x8DDA8B1205FFDEF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a0d-001e-007c-5799-da1ed2000000'
    'x-ms-client-request-id': '3c0d1fcc-468d-11f0-9dce-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:05 GMT'
2025-06-11 11:58:06,120 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3c1aae37-468d-11f0-a88b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:06,204 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:06 GMT'
    'ETag': '"0x8DDA8B1206DAA3F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a11-001e-007c-5b99-da1ed2000000'
    'x-ms-client-request-id': '3c1aae37-468d-11f0-a88b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:05 GMT'
2025-06-11 11:58:06,208 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1497134'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3c2829c5-468d-11f0-9d05-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:06,842 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:06 GMT'
    'ETag': '"0x8DDA8B120A12AAF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a14-001e-007c-5e99-da1ed2000000'
    'x-ms-client-request-id': '3c2829c5-468d-11f0-9d05-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:05 GMT'
2025-06-11 11:58:06,849 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3c89fa8a-468d-11f0-8b27-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:07,816 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:07 GMT'
    'ETag': '"0x8DDA8B121632C01"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a30-001e-007c-6d99-da1ed2000000'
    'x-ms-client-request-id': '3c89fa8a-468d-11f0-8b27-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:07 GMT'
2025-06-11 11:58:07,820 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d1e1544-468d-11f0-b63b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:07,904 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:08 GMT'
    'ETag': '"0x8DDA8B12170B16B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a63-001e-007c-0699-da1ed2000000'
    'x-ms-client-request-id': '3d1e1544-468d-11f0-b63b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:07 GMT'
2025-06-11 11:58:07,908 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d2b86e9-468d-11f0-8751-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:07,995 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:08 GMT'
    'ETag': '"0x8DDA8B1217F202E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a68-001e-007c-0a99-da1ed2000000'
    'x-ms-client-request-id': '3d2b86e9-468d-11f0-8751-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:07 GMT'
2025-06-11 11:58:08,000 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d3982ed-468d-11f0-8ef6-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:08,080 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:08 GMT'
    'ETag': '"0x8DDA8B1218C57CB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a70-001e-007c-1299-da1ed2000000'
    'x-ms-client-request-id': '3d3982ed-468d-11f0-8ef6-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:07 GMT'
2025-06-11 11:58:08,084 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d466d29-468d-11f0-80f0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:08,170 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:08 GMT'
    'ETag': '"0x8DDA8B12199B64F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a75-001e-007c-1799-da1ed2000000'
    'x-ms-client-request-id': '3d466d29-468d-11f0-80f0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:07 GMT'
2025-06-11 11:58:08,174 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d542782-468d-11f0-b269-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:08,259 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:08 GMT'
    'ETag': '"0x8DDA8B121A7897F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a78-001e-007c-1a99-da1ed2000000'
    'x-ms-client-request-id': '3d542782-468d-11f0-b269-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:07 GMT'
2025-06-11 11:58:08,263 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d61b52c-468d-11f0-b3a3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 11:58:08,364 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 06:28:08 GMT'
    'ETag': '"0x8DDA8B121B58393"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e20d1a7a-001e-007c-1c99-da1ed2000000'
    'x-ms-client-request-id': '3d61b52c-468d-11f0-b3a3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:28:07 GMT'
2025-06-11 12:18:21,063 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 12:18:21,219 - main - INFO - FastAPI application shutdown
2025-06-11 12:18:59,436 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 12:19:24,154 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 12:19:24,154 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 12:19:24,155 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 12:19:24,156 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 12:19:24,156 - main - INFO - FastAPI application started
2025-06-11 12:19:50,074 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 12:19:50,077 - main - INFO - FastAPI application shutdown
2025-06-11 12:19:56,753 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 12:20:01,248 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 12:20:01,248 - apscheduler.scheduler - INFO - Added job "Run analysis every 4 hours" to job store "default"
2025-06-11 12:20:01,249 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 12:20:01,250 - main - INFO - Scheduler started - Analysis will run every 4 hours
2025-06-11 12:20:01,251 - main - INFO - FastAPI application started
2025-06-11 12:20:01,253 - d365 - INFO - Loading D365 data
2025-06-11 12:20:01,255 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:20:01,599 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f2387b15-db8b-4941-971a-5af3bf80c000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:50:00 GMT'
    'Content-Length': '1753'
2025-06-11 12:20:01,613 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:20:01,862 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '77aaf27f-4bfb-4612-994a-a6dcf07bc600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:50:01 GMT'
    'Content-Length': '1647'
2025-06-11 12:20:01,863 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:20:01,865 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 12:20:01,866 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T06:50:01Z)
2025-06-11 12:20:08,597 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 12:20:14,955 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 12:20:22,227 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 12:20:28,348 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 12:20:35,662 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 12:20:42,275 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 12:20:44,586 - d365 - INFO - Progress: Fetched 31768 audit logs after 7 pages
2025-06-11 12:20:44,634 - d365 - INFO - Fetched 31768 D365 audit logs via Dataverse
2025-06-11 12:20:44,784 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 12:20:44,790 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:20:45,141 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8bc9a1b2-d595-4ba8-a134-3827ccb7f000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:50:44 GMT'
    'Content-Length': '1753'
2025-06-11 12:20:45,146 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:20:45,385 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4cb46624-0a42-466b-a5a7-3ce503a59800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:50:44 GMT'
    'Content-Length': '1991'
2025-06-11 12:20:45,386 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:20:45,387 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 12:20:45,387 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T06:50:45Z)
2025-06-11 12:20:45,388 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 12:21:00,191 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 4.1 req/min | Time: 0:00:14
2025-06-11 12:21:16,745 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.8 req/min | Time: 0:00:31
2025-06-11 12:21:30,915 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.0 req/min | Time: 0:00:45
2025-06-11 12:21:43,264 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 4.1 req/min | Time: 0:00:57
2025-06-11 12:21:53,517 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.4 req/min | Time: 0:01:08
2025-06-11 12:22:12,939 - d365 - INFO - Progress: 5,856 records | Pages: 6 | Requests: 6 | Rate: 4.1 req/min | Time: 0:01:27
2025-06-11 12:22:13,441 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T07:22:41Z to 2025-06-11T06:43:31Z
2025-06-11 12:22:13,518 - d365 - INFO - Fetch completed: 5,856 records in 0:01:28
2025-06-11 12:22:13,519 - d365 - INFO - Total requests made: 6
2025-06-11 12:22:13,526 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:22:13,826 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '19e555c6-7fc7-4030-85b2-2092315b4f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:52:13 GMT'
    'Content-Length': '1753'
2025-06-11 12:22:13,827 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:22:14,069 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8e69cdba-0355-4395-b88d-95236a136e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:52:14 GMT'
    'Content-Length': '1652'
2025-06-11 12:22:14,070 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:22:14,071 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 12:22:14,072 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:22:14,409 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4d5fe226-9251-495d-808b-185652579000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:52:13 GMT'
    'Content-Length': '1753'
2025-06-11 12:22:14,411 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:22:14,580 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6e7618a1-14e5-4a43-af59-15548c6b5600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:52:14 GMT'
    'Content-Length': '1997'
2025-06-11 12:22:14,581 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:22:14,582 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 12:22:14,583 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:22:14,898 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '041348ea-0ea8-4837-90de-09082447b500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:52:14 GMT'
    'Content-Length': '1753'
2025-06-11 12:22:14,899 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:22:15,129 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3a94b686-954b-4567-ad66-55274a737400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:52:14 GMT'
    'Content-Length': '1991'
2025-06-11 12:22:15,129 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:22:15,130 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 12:22:17,875 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 12:22:17,877 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 12:22:19,126 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 12:23:38,175 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 12:23:38,176 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 12:24:40,902 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 12:24:40,903 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 12:24:44,547 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 12:24:44,548 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 12:24:51,693 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 12:24:51,694 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 12:26:02,904 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 12:26:02,906 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 12:26:43,940 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 12:26:43,942 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 12:27:02,584 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 12:27:02,586 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 12:27:50,178 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 12:27:50,179 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 12:27:50,179 - d365 - INFO - Final user count after filtering: 206
2025-06-11 12:27:50,182 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 12:27:50,188 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 12:27:50,195 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 12:27:50,205 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 12:27:50,207 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:27:50,470 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'de932d46-f339-4fc5-91dc-ae42afeaff00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:50 GMT'
    'Content-Length': '1753'
2025-06-11 12:27:50,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:27:50,790 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ca1778d2-0b45-48ec-a392-ffcb2e610301'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:50 GMT'
    'Content-Length': '1645'
2025-06-11 12:27:50,791 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:27:50,791 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 12:27:52,545 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 12:27:52,554 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 12:27:52,556 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:27:52,786 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9408906f-394d-4c00-a472-cc68cf97bb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:52 GMT'
    'Content-Length': '1753'
2025-06-11 12:27:52,790 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:27:53,023 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1dc15c62-9917-48ab-bf79-b912d2693401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:53 GMT'
    'Content-Length': '1648'
2025-06-11 12:27:53,024 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:27:53,025 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 12:27:55,290 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 12:27:55,315 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 12:27:55,318 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:27:55,928 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a8b04401-23fb-4b9e-85c2-33b8cceb4600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:55 GMT'
    'Content-Length': '1753'
2025-06-11 12:27:55,931 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:27:56,090 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4f6182b7-5f45-4b54-880c-84f4536abf00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:55 GMT'
    'Content-Length': '1997'
2025-06-11 12:27:56,091 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:27:56,092 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 12:27:58,557 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 12:27:58,570 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 12:27:58,571 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 12:27:58,815 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '84a8e152-a569-487e-8887-edf6210cb800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:58 GMT'
    'Content-Length': '1753'
2025-06-11 12:27:58,817 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 12:27:59,068 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '70f8502a-8552-4b4d-b5f8-e336d6e70801'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 06:57:58 GMT'
    'Content-Length': '1648'
2025-06-11 12:27:59,070 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 12:27:59,070 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 12:27:59,854 - d365 - INFO - Fetched 11 business units
2025-06-11 12:27:59,857 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 12:27:59,871 - d365 - INFO - D365 data loaded successfully
2025-06-11 12:27:59,919 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 12:27:59,920 - main - INFO - Loading data from CSV files
2025-06-11 12:28:00,050 - main - INFO - Loaded audit_logs with 31768 rows
2025-06-11 12:28:00,173 - main - INFO - Loaded signin_logs with 5856 rows
2025-06-11 12:28:00,193 - main - INFO - Loaded user_details with 206 rows
2025-06-11 12:28:00,212 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 12:28:00,235 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 12:28:00,517 - main - INFO - Created group_memberships with 3308 rows
2025-06-11 12:28:00,569 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 12:28:00,589 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 12:28:00,590 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['401b998a-bb2f-4dd4-887e-c0045a3964bf', 'd1df6d9c-9e84-4709-b859-4c5da3a5b3ee', 'c4728a54-94cd-4103-a2a8-1cd7f4699819', 'e5f47082-e16b-4429-9d36-09d4b1354a24', 'b547f4bc-a21b-428d-b1ea-4cabca29522b']...
2025-06-11 12:28:00,592 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['24b4c94e-8533-ec11-b6e6-0022489bd51d', '99e70ea6-76b4-eb11-8236-000d3ab6406f', '14e8a382-f8bc-ec11-9840-0022489e2e28', 'c2710d15-fe30-ee11-bdf4-000d3adc8967', '8ce10f9a-76b4-eb11-8236-000d3ab6406f']...
2025-06-11 12:28:00,594 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 12:28:00,613 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 12:28:00,616 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 12:28:00,620 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 12:28:00,622 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 12:28:00,624 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 12:28:49,064 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 12:28:54,857 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 12:28:54,857 - src.core.embeddings - INFO - Embedding initialization took 54.23 seconds
2025-06-11 12:28:54,858 - src.core.embeddings - INFO - Memory usage: RSS=514.39 MB, VMS=2702.02 MB
2025-06-11 12:28:54,859 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 12:28:54,859 - src.core.embeddings - INFO - Using all logs: audit_logs=31768 rows, signin_logs=5856 rows
2025-06-11 12:28:54,866 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 12:28:54,897 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-11 12:28:56,872 - src.core.embeddings - INFO - Text generation took 2.01 seconds
2025-06-11 12:28:56,876 - src.core.embeddings - INFO - Memory usage: RSS=538.41 MB, VMS=2726.50 MB
2025-06-11 12:28:56,878 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 12:29:02,085 - src.core.embeddings - INFO - Total documents to embed: 37624
2025-06-11 12:29:02,085 - src.core.embeddings - INFO - Document conversion took 5.20 seconds
2025-06-11 12:29:02,086 - src.core.embeddings - INFO - Memory usage: RSS=568.12 MB, VMS=2755.55 MB
2025-06-11 12:29:02,087 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 12:29:02,093 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 12:29:39,638 - src.core.embeddings - INFO - Memory usage: RSS=678.31 MB, VMS=2878.98 MB
2025-06-11 12:29:39,639 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-11 12:30:12,888 - src.core.embeddings - INFO - Memory usage: RSS=807.19 MB, VMS=3015.14 MB
2025-06-11 12:30:12,889 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-11 12:30:44,401 - src.core.embeddings - INFO - Memory usage: RSS=772.05 MB, VMS=3089.90 MB
2025-06-11 12:30:44,402 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-11 12:31:22,478 - src.core.embeddings - INFO - Memory usage: RSS=803.93 MB, VMS=3163.10 MB
2025-06-11 12:31:22,479 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-11 12:31:59,767 - src.core.embeddings - INFO - Memory usage: RSS=821.03 MB, VMS=3173.67 MB
2025-06-11 12:31:59,768 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-11 12:32:42,002 - src.core.embeddings - INFO - Memory usage: RSS=950.36 MB, VMS=3311.14 MB
2025-06-11 12:32:42,003 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-11 12:34:35,848 - src.core.embeddings - INFO - Memory usage: RSS=955.99 MB, VMS=3331.20 MB
2025-06-11 12:34:35,850 - src.core.embeddings - INFO - Embedding chunk 8/8 (2624 documents)
2025-06-11 12:35:55,408 - src.core.embeddings - INFO - Memory usage: RSS=1087.86 MB, VMS=3503.15 MB
2025-06-11 12:35:56,876 - src.core.embeddings - INFO - Embedding generation took 414.79 seconds
2025-06-11 12:35:56,879 - src.core.embeddings - INFO - Memory usage: RSS=1087.86 MB, VMS=3503.15 MB
2025-06-11 12:35:56,882 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-11 12:35:59,935 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37624 vectors
2025-06-11 12:36:04,218 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-11 12:36:04,251 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-11 12:36:04,252 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-11 12:36:04,253 - src.core.embeddings - INFO - FAISS vectorstore creation took 7.37 seconds
2025-06-11 12:36:04,254 - src.core.embeddings - INFO - Memory usage: RSS=1285.03 MB, VMS=3835.95 MB
2025-06-11 12:36:04,337 - src.core.embeddings - INFO - Total embedding generation took 483.72 seconds
2025-06-11 12:36:04,432 - main - INFO - [analyze] Embeddings generated.
2025-06-11 12:36:04,433 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-11 12:36:04,434 - src.utils.config - INFO - Loading environment variables
2025-06-11 12:36:04,509 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-11 12:36:04,511 - src.core.analysis - INFO - Validating input DataFrames
2025-06-11 12:36:04,733 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 12:36:04,734 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 12:36:04,735 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 12:36:04,736 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-11 12:36:04,736 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-11 12:36:04,767 - src.core.analysis - INFO - User IDs from user_details: 206
2025-06-11 12:36:04,768 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-11 12:36:04,768 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-11 12:36:04,769 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-11 12:36:04,770 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-11 12:36:10,749 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-11 12:36:10,830 - src.core.analysis - INFO - Starting analysis
2025-06-11 12:36:10,831 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-11 12:36:20,580 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-11 12:36:20,583 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-11 12:36:20,584 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-11 12:36:20,585 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-11 12:36:20,585 - src.analysis.anomaly_detector - INFO - User details shape: (206, 10)
2025-06-11 12:36:20,586 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 12:36:20,587 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5856, 12)
2025-06-11 12:36:20,588 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 12:36:20,610 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-11 12:36:20,650 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-11 12:36:20,713 - src.analysis.anomaly_detector - INFO - Successfully mapped 5849 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-11 12:36:20,722 - src.analysis.anomaly_detector - INFO - Total mapped users: 206
2025-06-11 12:36:20,722 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-11 12:36:20,723 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-11 12:36:20,723 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-11 12:36:20,724 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-11 12:36:20,724 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-11 12:36:20,724 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-11 12:36:20,725 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-11 12:36:20,725 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-11 12:36:20,726 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-11 12:36:20,727 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-11 12:36:20,727 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-11 12:36:20,728 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-11 12:36:20,729 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-11 12:36:20,730 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-11 12:36:20,731 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-11 12:36:24,831 - src.analysis.anomaly_detector - INFO - Detected 64 anomalies
2025-06-11 12:36:24,832 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-11 12:36:24,833 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-401b998a-bb2f-4dd4-887e-c0045a3964bf -> Activity pattern anomaly detected (Department: Unknown, Roles: Unknown Role, Unknown Role, Unknown R...
2025-06-11 12:36:24,833 - src.analysis.anomaly_detector - INFO - Example 2: Vikneshkumar Palanisamy -> High sign-in frequency: 2434 sign-ins (avg: 82.5, threshold: 667.9) (Department: Air Arabia NOC); Un...
2025-06-11 12:36:24,834 - src.analysis.anomaly_detector - INFO - Example 3: Deepthy Surendran Nambiar -> Unusual location: Al Ramaqia, AE at 2025-06-11 06:28:37. Typical: Al Hamriyah, AE (54.5%) (Departmen...
2025-06-11 12:36:24,835 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-11 12:36:27,674 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-11 12:36:27,675 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-11 12:36:27,998 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-11 12:36:29,164 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-11 12:36:30,938 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-11 12:36:30,939 - src.core.analysis - INFO - Analyzing inactive users
2025-06-11 12:36:30,943 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-11 12:36:30,944 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 12:36:30,945 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 12:36:30,976 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 06:43:31+0000', tz='UTC'), Timestamp('2025-06-11 06:41:25+0000', tz='UTC'), Timestamp('2025-06-11 06:39:12+0000', tz='UTC'), Timestamp('2025-06-11 06:37:09+0000', tz='UTC'), Timestamp('2025-06-11 06:34:27+0000', tz='UTC')]
2025-06-11 12:36:30,979 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-11 12:36:31,007 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-13 18:52:49+0000', tz='UTC'), Timestamp('2025-03-13 20:19:13+0000', tz='UTC'), Timestamp('2025-03-13 22:30:19+0000', tz='UTC'), Timestamp('2025-03-13 22:30:24+0000', tz='UTC'), Timestamp('2025-03-13 22:30:29+0000', tz='UTC')]
2025-06-11 12:36:31,009 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-11 12:36:32,459 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 206 total users.
2025-06-11 12:36:32,463 - src.core.analysis - INFO - Total unique user IDs after analysis: 525
2025-06-11 12:36:32,600 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-11 12:36:32,601 - src.core.analysis - INFO - Using chunk size: 200 for 525 users
2025-06-11 12:36:32,606 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-11 12:36:32,610 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-11 12:36:32,613 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 155243 bytes
2025-06-11 12:37:16,073 - src.core.analysis - INFO - Findings chunk 1 completed in 43.46s
2025-06-11 12:37:16,074 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-11 12:37:16,078 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 166146 bytes
2025-06-11 12:37:49,599 - src.core.analysis - INFO - Findings chunk 2 completed in 33.52s
2025-06-11 12:37:49,600 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-11 12:37:49,606 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 106096 bytes
2025-06-11 12:38:06,020 - src.core.analysis - INFO - Findings chunk 3 completed in 16.42s
2025-06-11 12:38:06,127 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-11 12:38:06,129 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-11 12:38:06,130 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-11 12:38:06,131 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-11 12:38:06,132 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-11 12:38:06,133 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-11 12:38:06,134 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-11 12:38:06,134 - src.core.analysis - INFO - Sequential processing completed in 93.53s
2025-06-11 12:38:06,135 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-11 12:38:06,135 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-11 12:38:06,136 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 525 users
2025-06-11 12:38:06,140 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-11 12:38:06,143 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-11 12:38:06,144 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-11 12:38:06,145 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 12865 bytes
2025-06-11 12:38:19,610 - src.core.analysis - INFO - Recommendations chunk 1 completed in 13.47s
2025-06-11 12:38:19,726 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-11 12:38:19,727 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-11 12:38:19,727 - src.core.analysis - INFO - Analysis completed successfully with 11 recommendations
2025-06-11 12:38:19,731 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:19,732 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-11 12:38:19,733 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-11 12:38:19,737 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:19,790 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '558810'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dac32af4-4692-11f0-9f19-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:20,594 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:20 GMT'
    'ETag': '"0x8DDA8B6BF86531D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a882d1e2-601e-009e-629f-da23f3000000'
    'x-ms-client-request-id': 'dac32af4-4692-11f0-9f19-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:20 GMT'
2025-06-11 12:38:20,597 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-11 12:38:20,599 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-11 12:38:20,601 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:20,647 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db46413b-4692-11f0-9d71-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:21,172 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:21 GMT'
    'ETag': '"0x8DDA8B6BFE17A27"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b22c35e0-b01e-00b2-459f-dacf5c000000'
    'x-ms-client-request-id': 'db46413b-4692-11f0-9d71-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:20 GMT'
2025-06-11 12:38:21,173 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-11 12:38:21,174 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-11 12:38:21,176 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:21,218 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db9d6337-4692-11f0-895f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:21,869 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:22 GMT'
    'ETag': '"0x8DDA8B6C04BD25A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fcd0741c-e01e-0039-139f-dacb31000000'
    'x-ms-client-request-id': 'db9d6337-4692-11f0-895f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:21 GMT'
2025-06-11 12:38:21,871 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-11 12:38:21,872 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-11 12:38:21,874 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:21,904 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dc062b6e-4692-11f0-8fe0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:22,451 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:22 GMT'
    'ETag': '"0x8DDA8B6C0A41671"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4a3a9135-701e-0014-659f-da7842000000'
    'x-ms-client-request-id': 'dc062b6e-4692-11f0-8fe0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:22 GMT'
2025-06-11 12:38:22,455 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-11 12:38:22,456 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-11 12:38:22,457 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:22,486 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dc5ec1c5-4692-11f0-b36c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:23,114 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:23 GMT'
    'ETag': '"0x8DDA8B6C109DFE6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6bcc041d-c01e-005c-319f-da6575000000'
    'x-ms-client-request-id': 'dc5ec1c5-4692-11f0-b36c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:23 GMT'
2025-06-11 12:38:23,116 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-11 12:38:23,117 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-11 12:38:23,118 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:23,145 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1969686'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dcc37560-4692-11f0-b7e0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:24,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:24 GMT'
    'ETag': '"0x8DDA8B6C1999774"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a855876-b01e-001b-3b9f-da0e2e000000'
    'x-ms-client-request-id': 'dcc37560-4692-11f0-b7e0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:24 GMT'
2025-06-11 12:38:24,061 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-11 12:38:24,062 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-11 12:38:24,063 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:24,107 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd564797-4692-11f0-9559-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:25,454 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:25 GMT'
    'ETag': '"0x8DDA8B6C26EE36F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fe3fb7c3-f01e-0057-399f-da9e1e000000'
    'x-ms-client-request-id': 'dd564797-4692-11f0-9559-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:24 GMT'
2025-06-11 12:38:25,456 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-11 12:38:25,457 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-11 12:38:25,459 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:25,482 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'de27f77c-4692-11f0-a565-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:25,792 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:25 GMT'
    'ETag': '"0x8DDA8B6C2A28A9E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ebe157fa-301e-0058-529f-dae872000000'
    'x-ms-client-request-id': 'de27f77c-4692-11f0-a565-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:24 GMT'
2025-06-11 12:38:25,793 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-11 12:38:25,794 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-11 12:38:25,795 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:25,823 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'de5c05fc-4692-11f0-86c4-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:26,214 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:26 GMT'
    'ETag': '"0x8DDA8B6C2E2A6ED"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c28d6079-701e-0066-159f-da7f0d000000'
    'x-ms-client-request-id': 'de5c05fc-4692-11f0-86c4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:25 GMT'
2025-06-11 12:38:26,218 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-11 12:38:26,219 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-11 12:38:26,220 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:26,251 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'de9d6be9-4692-11f0-92c6-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:26,727 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:26 GMT'
    'ETag': '"0x8DDA8B6C330E42B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c81db4d5-701e-0049-519f-da72c6000000'
    'x-ms-client-request-id': 'de9d6be9-4692-11f0-92c6-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:26 GMT'
2025-06-11 12:38:26,730 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-11 12:38:26,732 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-11 12:38:26,735 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:26,758 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'deeaacfd-4692-11f0-a22e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:27,224 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:27 GMT'
    'ETag': '"0x8DDA8B6C37CDA06"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f2b49337-a01e-0028-489f-da5185000000'
    'x-ms-client-request-id': 'deeaacfd-4692-11f0-a22e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:26 GMT'
2025-06-11 12:38:27,225 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-11 12:38:27,228 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-11 12:38:27,229 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:27,253 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1498342'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'df36513e-4692-11f0-8a26-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:28,068 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:28 GMT'
    'ETag': '"0x8DDA8B6C3FC2947"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c2c05062-f01e-0068-669f-da56bd000000'
    'x-ms-client-request-id': 'df36513e-4692-11f0-8a26-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:27 GMT'
2025-06-11 12:38:28,069 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-11 12:38:28,071 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-11 12:38:28,072 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:28,104 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dfb82ebe-4692-11f0-8edb-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:29,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:29 GMT'
    'ETag': '"0x8DDA8B6C4C21D31"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0874adc6-701e-0004-2f9f-dabd2a000000'
    'x-ms-client-request-id': 'dfb82ebe-4692-11f0-8edb-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:28 GMT'
2025-06-11 12:38:29,360 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-11 12:38:29,362 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-11 12:38:29,363 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:29,397 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e07d579d-4692-11f0-bfb9-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:29,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:29 GMT'
    'ETag': '"0x8DDA8B6C5017708"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f2aa33e8-901e-0023-4f9f-daaaee000000'
    'x-ms-client-request-id': 'e07d579d-4692-11f0-bfb9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:29 GMT'
2025-06-11 12:38:29,773 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-11 12:38:29,775 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-11 12:38:29,776 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:29,805 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e0bbbb10-4692-11f0-beb6-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:30,276 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:30 GMT'
    'ETag': '"0x8DDA8B6C54EA408"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'dc05e32f-d01e-007f-129f-daffb6000000'
    'x-ms-client-request-id': 'e0bbbb10-4692-11f0-beb6-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:30 GMT'
2025-06-11 12:38:30,278 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-11 12:38:30,279 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-11 12:38:30,281 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:30,310 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e108afb5-4692-11f0-a792-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:30,776 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:30 GMT'
    'ETag': '"0x8DDA8B6C59AC0C5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'afd84286-201e-0009-699f-da75fe000000'
    'x-ms-client-request-id': 'e108afb5-4692-11f0-a792-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:30 GMT'
2025-06-11 12:38:30,779 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-11 12:38:30,781 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-11 12:38:30,783 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:30,808 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e1549e02-4692-11f0-8436-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:31,346 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:31 GMT'
    'ETag': '"0x8DDA8B6C5F1F4A0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '075e00b6-601e-006a-289f-dae805000000'
    'x-ms-client-request-id': 'e1549e02-4692-11f0-8436-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:31 GMT'
2025-06-11 12:38:31,347 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-11 12:38:31,348 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-11 12:38:31,350 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:31,383 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e1ac6ac3-4692-11f0-83fe-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:31,917 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:32 GMT'
    'ETag': '"0x8DDA8B6C6490189"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6d0eb1c7-d01e-0032-019f-da305a000000'
    'x-ms-client-request-id': 'e1ac6ac3-4692-11f0-83fe-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:31 GMT'
2025-06-11 12:38:31,919 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-11 12:38:31,920 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-11 12:38:31,923 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 12:38:31,962 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e204bc6a-4692-11f0-a872-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:32,511 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:32 GMT'
    'ETag': '"0x8DDA8B6C6A38D10"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '569e2b40-301e-0015-499f-da279e000000'
    'x-ms-client-request-id': 'e204bc6a-4692-11f0-a872-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:31 GMT'
2025-06-11 12:38:32,513 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-11 12:38:32,516 - main - INFO - [analyze] Analysis completed.
2025-06-11 12:38:32,548 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-11 12:38:32,591 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '303673'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e264b1c4-4692-11f0-8a4a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:33,204 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:33 GMT'
    'ETag': '"0x8DDA8B6C70CFBE3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd3d0-c01e-0001-319f-da6ff1000000'
    'x-ms-client-request-id': 'e264b1c4-4692-11f0-8a4a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:33 GMT'
2025-06-11 12:38:33,233 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e2c6c4a0-4692-11f0-ac90-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:33,363 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:33 GMT'
    'ETag': '"0x8DDA8B6C7257174"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd3ed-c01e-0001-4d9f-da6ff1000000'
    'x-ms-client-request-id': 'e2c6c4a0-4692-11f0-ac90-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:33 GMT'
2025-06-11 12:38:33,391 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e2deb199-4692-11f0-abab-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:33,537 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:33 GMT'
    'ETag': '"0x8DDA8B6C73F6BF1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd3f2-c01e-0001-529f-da6ff1000000'
    'x-ms-client-request-id': 'e2deb199-4692-11f0-abab-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:33 GMT'
2025-06-11 12:38:33,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e2f5f6f2-4692-11f0-baa1-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:33,636 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:33 GMT'
    'ETag': '"0x8DDA8B6C74DDAA6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd400-c01e-0001-5f9f-da6ff1000000'
    'x-ms-client-request-id': 'e2f5f6f2-4692-11f0-baa1-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:33 GMT'
2025-06-11 12:38:33,642 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e3052ecd-4692-11f0-8769-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:33,764 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:33 GMT'
    'ETag': '"0x8DDA8B6C7623624"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd406-c01e-0001-659f-da6ff1000000'
    'x-ms-client-request-id': 'e3052ecd-4692-11f0-8769-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:33 GMT'
2025-06-11 12:38:33,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1969686'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e318df8c-4692-11f0-9210-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:34,198 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:34 GMT'
    'ETag': '"0x8DDA8B6C7A4C0B6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd415-c01e-0001-749f-da6ff1000000'
    'x-ms-client-request-id': 'e318df8c-4692-11f0-9210-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:34 GMT'
2025-06-11 12:38:34,210 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e35bc8ae-4692-11f0-a7d3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:35,040 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:35 GMT'
    'ETag': '"0x8DDA8B6C824F953"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd420-c01e-0001-7d9f-da6ff1000000'
    'x-ms-client-request-id': 'e35bc8ae-4692-11f0-a7d3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:35 GMT'
2025-06-11 12:38:35,047 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e3db7c07-4692-11f0-bc92-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:35,142 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:35 GMT'
    'ETag': '"0x8DDA8B6C832F35E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd439-c01e-0001-159f-da6ff1000000'
    'x-ms-client-request-id': 'e3db7c07-4692-11f0-bc92-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:35 GMT'
2025-06-11 12:38:35,148 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e3eae3cc-4692-11f0-acc3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:35,548 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:35 GMT'
    'ETag': '"0x8DDA8B6C843F73B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd43a-c01e-0001-169f-da6ff1000000'
    'x-ms-client-request-id': 'e3eae3cc-4692-11f0-acc3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:35 GMT'
2025-06-11 12:38:35,554 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e428fa61-4692-11f0-8582-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:35,637 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:35 GMT'
    'ETag': '"0x8DDA8B6C8809504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd45f-c01e-0001-209f-da6ff1000000'
    'x-ms-client-request-id': 'e428fa61-4692-11f0-8582-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:35 GMT'
2025-06-11 12:38:35,644 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e4369035-4692-11f0-bfd4-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:35,732 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:35 GMT'
    'ETag': '"0x8DDA8B6C88EB5F3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd460-c01e-0001-219f-da6ff1000000'
    'x-ms-client-request-id': 'e4369035-4692-11f0-bfd4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:35 GMT'
2025-06-11 12:38:35,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1498342'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e4458902-4692-11f0-98b3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:35,953 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:36 GMT'
    'ETag': '"0x8DDA8B6C8B0BDB3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd464-c01e-0001-259f-da6ff1000000'
    'x-ms-client-request-id': 'e4458902-4692-11f0-98b3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:35 GMT'
2025-06-11 12:38:35,965 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e4679b9a-4692-11f0-b527-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:36,524 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:36 GMT'
    'ETag': '"0x8DDA8B6C907A3C5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd46e-c01e-0001-2c9f-da6ff1000000'
    'x-ms-client-request-id': 'e4679b9a-4692-11f0-b527-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:36 GMT'
2025-06-11 12:38:36,531 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e4bdff43-4692-11f0-9e51-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:36,616 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:36 GMT'
    'ETag': '"0x8DDA8B6C9155003"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd484-c01e-0001-429f-da6ff1000000'
    'x-ms-client-request-id': 'e4bdff43-4692-11f0-9e51-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:36 GMT'
2025-06-11 12:38:36,620 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e4cb9d26-4692-11f0-a29a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:37,012 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:36 GMT'
    'ETag': '"0x8DDA8B6C9245A49"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd487-c01e-0001-459f-da6ff1000000'
    'x-ms-client-request-id': 'e4cb9d26-4692-11f0-a29a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:36 GMT'
2025-06-11 12:38:37,018 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e5083c88-4692-11f0-aa17-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:37,100 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:37 GMT'
    'ETag': '"0x8DDA8B6C95FE7D3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd48f-c01e-0001-4b9f-da6ff1000000'
    'x-ms-client-request-id': 'e5083c88-4692-11f0-aa17-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:37 GMT'
2025-06-11 12:38:37,106 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e515aeaf-4692-11f0-a8a2-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:37,192 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:37 GMT'
    'ETag': '"0x8DDA8B6C96DE1ED"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd490-c01e-0001-4c9f-da6ff1000000'
    'x-ms-client-request-id': 'e515aeaf-4692-11f0-a8a2-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:37 GMT'
2025-06-11 12:38:37,197 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e5239b62-4692-11f0-8641-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:37,310 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:37 GMT'
    'ETag': '"0x8DDA8B6C97C02CB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd491-c01e-0001-4d9f-da6ff1000000'
    'x-ms-client-request-id': 'e5239b62-4692-11f0-8641-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:37 GMT'
2025-06-11 12:38:37,315 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e5359d56-4692-11f0-b649-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 12:38:37,416 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 07:08:37 GMT'
    'ETag': '"0x8DDA8B6C98F74F2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a0fd49e-c01e-0001-4e9f-da6ff1000000'
    'x-ms-client-request-id': 'e5359d56-4692-11f0-b649-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 07:08:37 GMT'
2025-06-11 15:23:27,006 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 15:23:27,068 - main - INFO - FastAPI application shutdown
2025-06-11 15:24:00,818 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 15:24:25,662 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 15:24:25,663 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 15:24:25,664 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 15:24:25,669 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 15:24:25,671 - main - INFO - FastAPI application started
2025-06-11 15:24:41,242 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 15:24:41,243 - main - INFO - FastAPI application shutdown
2025-06-11 15:24:48,342 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 15:24:53,676 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 15:24:53,677 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 15:24:53,678 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 15:24:53,680 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 15:24:53,681 - main - INFO - FastAPI application started
2025-06-11 15:25:54,623 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 15:25:54,624 - main - INFO - FastAPI application shutdown
2025-06-11 15:26:02,782 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 15:26:07,272 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 15:26:07,272 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 15:26:07,273 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 15:26:07,275 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 15:26:07,275 - main - INFO - FastAPI application started
2025-06-11 15:27:07,289 - apscheduler.executors.default - INFO - Running job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:27:07 IST)" (scheduled at 2025-06-11 15:27:07.272019+05:30)
2025-06-11 15:27:07,292 - main - INFO - Running scheduled analysis task
2025-06-11 15:27:09,346 - d365 - INFO - Loading D365 data
2025-06-11 15:27:09,348 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:27:09,622 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0e7dfc9e-0048-4341-8c37-f48fc6931000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:57:09 GMT'
    'Content-Length': '1753'
2025-06-11 15:27:09,648 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:27:09,877 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f8a05091-e276-49f2-add6-384992918600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:57:09 GMT'
    'Content-Length': '1647'
2025-06-11 15:27:09,878 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:27:09,879 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 15:27:09,880 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T09:57:09Z)
2025-06-11 15:27:16,726 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 15:27:23,431 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 15:27:29,806 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 15:27:36,912 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 15:27:44,321 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 15:27:51,209 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 15:27:54,074 - d365 - INFO - Progress: Fetched 31802 audit logs after 7 pages
2025-06-11 15:27:54,095 - d365 - INFO - Fetched 31802 D365 audit logs via Dataverse
2025-06-11 15:27:54,157 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 15:27:54,160 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:27:54,431 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2fb7771e-5a4c-4a59-a211-92fc76545e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:57:53 GMT'
    'Content-Length': '1753'
2025-06-11 15:27:54,432 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:27:54,670 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3c150532-4931-4806-b443-dd2adbce7a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:57:54 GMT'
    'Content-Length': '1991'
2025-06-11 15:27:54,671 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:27:54,672 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 15:27:54,672 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T09:57:54Z)
2025-06-11 15:27:54,673 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 15:28:07,277 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:28:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:28:12,986 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 3.3 req/min | Time: 0:00:18
2025-06-11 15:28:26,591 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.8 req/min | Time: 0:00:31
2025-06-11 15:28:36,675 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.3 req/min | Time: 0:00:42
2025-06-11 15:28:46,833 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 4.6 req/min | Time: 0:00:52
2025-06-11 15:29:05,132 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.3 req/min | Time: 0:01:10
2025-06-11 15:29:07,273 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:29:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:29:16,609 - d365 - INFO - Progress: 5,907 records | Pages: 6 | Requests: 6 | Rate: 4.4 req/min | Time: 0:01:21
2025-06-11 15:29:17,110 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T09:58:31Z to 2025-06-11T09:38:13Z
2025-06-11 15:29:17,176 - d365 - INFO - Fetch completed: 5,907 records in 0:01:22
2025-06-11 15:29:17,176 - d365 - INFO - Total requests made: 6
2025-06-11 15:29:17,183 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:29:17,497 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd105a9c9-f5b1-45a2-819d-419db1654e01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:59:16 GMT'
    'Content-Length': '1753'
2025-06-11 15:29:17,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:29:17,696 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'fbe18ec0-b0bf-4eba-aaa4-d395cff76c01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:59:16 GMT'
    'Content-Length': '1647'
2025-06-11 15:29:17,697 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:29:17,698 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 15:29:17,699 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:29:18,005 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4b758a3e-3343-4fdd-a6a4-b61240a70701'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:59:18 GMT'
    'Content-Length': '1753'
2025-06-11 15:29:18,007 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:29:18,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2c24d5b9-8c5e-4b3c-92cc-1da5f42bdd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:59:18 GMT'
    'Content-Length': '1997'
2025-06-11 15:29:18,156 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:29:18,156 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 15:29:18,157 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:29:18,441 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'bb182886-b58a-4bee-a4c4-682b09561300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:59:18 GMT'
    'Content-Length': '1753'
2025-06-11 15:29:18,442 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:29:18,686 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '69f1b4ee-ede3-45cb-924d-d7f9804dde00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 09:59:18 GMT'
    'Content-Length': '1991'
2025-06-11 15:29:18,687 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:29:18,688 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 15:29:21,421 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 15:29:21,422 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 15:29:23,301 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 15:30:07,283 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:30:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:30:40,672 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 15:30:40,675 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 15:31:07,274 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:31:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:31:27,647 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 15:31:27,648 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 15:31:30,539 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 15:31:30,541 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 15:31:36,223 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 15:31:36,225 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 15:32:07,278 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:32:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:32:39,330 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 15:32:39,331 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 15:33:07,282 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:33:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:33:15,647 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 15:33:15,648 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 15:33:37,670 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 15:33:37,671 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 15:34:07,273 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:34:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:34:24,380 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 15:34:24,382 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 15:34:24,382 - d365 - INFO - Final user count after filtering: 206
2025-06-11 15:34:24,390 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 15:34:24,414 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 15:34:24,428 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 15:34:24,440 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 15:34:24,451 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:34:24,809 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'dd843bf0-6294-4f46-9ba4-011dd863d400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:24 GMT'
    'Content-Length': '1753'
2025-06-11 15:34:24,811 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:34:24,966 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'dff2589e-2a76-4c8f-a3c1-c2793714b900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:24 GMT'
    'Content-Length': '1653'
2025-06-11 15:34:24,967 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:34:24,967 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 15:34:27,332 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 15:34:27,346 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 15:34:27,349 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:34:27,758 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f2af1db8-c608-4989-951c-86bdb03be200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:27 GMT'
    'Content-Length': '1753'
2025-06-11 15:34:27,760 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:34:28,308 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0f12b20b-86d7-45ba-80fe-ba4874bffa00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:27 GMT'
    'Content-Length': '1652'
2025-06-11 15:34:28,309 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:34:28,310 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 15:34:31,142 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 15:34:31,154 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 15:34:31,158 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:34:34,497 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd8418729-c168-491c-b47c-dd652b20e600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:34 GMT'
    'Content-Length': '1753'
2025-06-11 15:34:34,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:34:34,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b4b96498-a026-4d32-a671-733beabef600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:34 GMT'
    'Content-Length': '1997'
2025-06-11 15:34:34,948 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:34:34,949 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 15:34:36,902 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 15:34:36,913 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 15:34:36,919 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 15:34:37,230 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '73d47af3-aed2-469d-9f53-b459cec73600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:37 GMT'
    'Content-Length': '1753'
2025-06-11 15:34:37,234 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 15:34:37,539 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2fac6809-8491-49cf-9ff5-960e8bd6fd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:04:37 GMT'
    'Content-Length': '1652'
2025-06-11 15:34:37,540 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 15:34:37,541 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 15:34:38,329 - d365 - INFO - Fetched 11 business units
2025-06-11 15:34:38,336 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 15:34:38,434 - d365 - INFO - D365 data loaded successfully
2025-06-11 15:34:38,584 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 15:34:38,590 - main - INFO - Loading data from CSV files
2025-06-11 15:34:38,778 - main - INFO - Loaded audit_logs with 31802 rows
2025-06-11 15:34:38,873 - main - INFO - Loaded signin_logs with 5907 rows
2025-06-11 15:34:38,893 - main - INFO - Loaded user_details with 206 rows
2025-06-11 15:34:38,912 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 15:34:38,930 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 15:34:39,167 - main - INFO - Created group_memberships with 3308 rows
2025-06-11 15:34:39,310 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 15:34:39,328 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 15:34:39,329 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['00e5df59-0081-4e43-9ae0-7c9969f698dc', 'e3fc650d-860f-4e24-8161-9785eaf99d82', '3ac384df-adbd-464b-81e6-abcdbd1cebbc', 'bfa5d2b9-f1ec-454e-82e1-9dad0275f657', '3cac4936-d302-442e-be13-d025ceb75f3a']...
2025-06-11 15:34:39,331 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['e5eff26e-b4ca-ee11-907a-0022489ba0c8', 'ffecdb91-1bbe-eb11-bacc-000d3ade3348', 'b12f8297-7fc0-ee11-907a-0022489b4696', '0a8c16a0-76b4-eb11-8236-000d3ab6406f', 'bab4c94e-8533-ec11-b6e6-0022489bd51d']...
2025-06-11 15:34:39,332 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 15:34:39,406 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 15:34:39,409 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 15:34:39,411 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 15:34:39,412 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 15:34:39,417 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 15:35:07,274 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:35:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:35:45,833 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 15:35:51,536 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 15:35:51,537 - src.core.embeddings - INFO - Embedding initialization took 72.12 seconds
2025-06-11 15:35:51,539 - src.core.embeddings - INFO - Memory usage: RSS=363.38 MB, VMS=2702.96 MB
2025-06-11 15:35:51,539 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 15:35:51,539 - src.core.embeddings - INFO - Using all logs: audit_logs=31802 rows, signin_logs=5907 rows
2025-06-11 15:35:51,546 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 15:35:51,571 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-11 15:35:52,186 - src.core.embeddings - INFO - Text generation took 0.65 seconds
2025-06-11 15:35:52,187 - src.core.embeddings - INFO - Memory usage: RSS=387.76 MB, VMS=2727.69 MB
2025-06-11 15:35:52,188 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 15:35:53,922 - src.core.embeddings - INFO - Total documents to embed: 37709
2025-06-11 15:35:53,923 - src.core.embeddings - INFO - Document conversion took 1.73 seconds
2025-06-11 15:35:53,923 - src.core.embeddings - INFO - Memory usage: RSS=417.47 MB, VMS=2757.75 MB
2025-06-11 15:35:53,924 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 15:35:53,925 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 15:36:07,284 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:36:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:36:19,288 - src.core.embeddings - INFO - Memory usage: RSS=585.43 MB, VMS=2942.43 MB
2025-06-11 15:36:19,289 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-11 15:36:35,151 - src.core.embeddings - INFO - Memory usage: RSS=660.74 MB, VMS=3017.24 MB
2025-06-11 15:36:35,151 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-11 15:36:57,636 - src.core.embeddings - INFO - Memory usage: RSS=735.27 MB, VMS=3091.43 MB
2025-06-11 15:36:57,637 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-11 15:37:07,272 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:37:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:37:15,696 - src.core.embeddings - INFO - Memory usage: RSS=806.13 MB, VMS=3165.72 MB
2025-06-11 15:37:15,697 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-11 15:37:31,582 - src.core.embeddings - INFO - Memory usage: RSS=879.45 MB, VMS=3238.78 MB
2025-06-11 15:37:31,583 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-11 15:37:45,548 - src.core.embeddings - INFO - Memory usage: RSS=953.24 MB, VMS=3313.08 MB
2025-06-11 15:37:45,549 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-11 15:38:07,284 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:38:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:38:22,156 - src.core.embeddings - INFO - Memory usage: RSS=1153.78 MB, VMS=3552.81 MB
2025-06-11 15:38:22,158 - src.core.embeddings - INFO - Embedding chunk 8/8 (2709 documents)
2025-06-11 15:38:44,219 - src.core.embeddings - INFO - Memory usage: RSS=1204.39 MB, VMS=3603.73 MB
2025-06-11 15:38:44,519 - src.core.embeddings - INFO - Embedding generation took 170.59 seconds
2025-06-11 15:38:44,520 - src.core.embeddings - INFO - Memory usage: RSS=1204.40 MB, VMS=3603.73 MB
2025-06-11 15:38:44,521 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-11 15:38:45,180 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37709 vectors
2025-06-11 15:38:46,247 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-11 15:38:46,262 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-11 15:38:46,262 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-11 15:38:46,263 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.74 seconds
2025-06-11 15:38:46,264 - src.core.embeddings - INFO - Memory usage: RSS=1408.87 MB, VMS=3938.88 MB
2025-06-11 15:38:46,290 - src.core.embeddings - INFO - Total embedding generation took 246.88 seconds
2025-06-11 15:38:46,317 - main - INFO - [analyze] Embeddings generated.
2025-06-11 15:38:46,318 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-11 15:38:46,319 - src.utils.config - INFO - Loading environment variables
2025-06-11 15:38:46,352 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-11 15:38:46,354 - src.core.analysis - INFO - Validating input DataFrames
2025-06-11 15:38:46,432 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 15:38:46,433 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 15:38:46,435 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 15:38:46,435 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-11 15:38:46,436 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-11 15:38:46,446 - src.core.analysis - INFO - User IDs from user_details: 206
2025-06-11 15:38:46,446 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-11 15:38:46,447 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-11 15:38:46,447 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-11 15:38:46,448 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-11 15:38:48,137 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-11 15:38:48,166 - src.core.analysis - INFO - Starting analysis
2025-06-11 15:38:48,167 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-11 15:38:50,610 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-11 15:38:50,610 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-11 15:38:50,615 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-11 15:38:50,616 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-11 15:38:50,616 - src.analysis.anomaly_detector - INFO - User details shape: (206, 10)
2025-06-11 15:38:50,617 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 15:38:50,617 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5907, 12)
2025-06-11 15:38:50,617 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 15:38:50,626 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-11 15:38:50,641 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-11 15:38:50,666 - src.analysis.anomaly_detector - INFO - Successfully mapped 5900 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-11 15:38:50,670 - src.analysis.anomaly_detector - INFO - Total mapped users: 206
2025-06-11 15:38:50,672 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-11 15:38:50,672 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-11 15:38:50,672 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-11 15:38:50,673 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-11 15:38:50,673 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-11 15:38:50,674 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-11 15:38:50,675 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-11 15:38:50,675 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-11 15:38:50,676 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-11 15:38:50,676 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-11 15:38:50,676 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-11 15:38:50,677 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-11 15:38:50,677 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-11 15:38:50,678 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-11 15:38:50,678 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-11 15:38:50,679 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-11 15:38:50,679 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-11 15:38:51,590 - src.analysis.anomaly_detector - INFO - Detected 63 anomalies
2025-06-11 15:38:51,591 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-11 15:38:51,591 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> High sign-in frequency: 2483 sign-ins (avg: 83.2, threshold: 679.8) (Department: Air Arabia NOC); Un...
2025-06-11 15:38:51,591 - src.analysis.anomaly_detector - INFO - Example 2: Ajith Benny -> Unusual location: Delhi, IN at 2025-05-17 13:39:24. Typical: Bengaluru, IN (93.3%) (Department: Para...
2025-06-11 15:38:51,592 - src.analysis.anomaly_detector - INFO - Example 3: Sujan Upreti -> Unusual location: Birganj, NP at 2025-05-29 08:16:04. Typical: Kathmandu, NP (89.9%) (Department: Al...
2025-06-11 15:38:51,592 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-11 15:38:52,218 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-11 15:38:52,219 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-11 15:38:52,291 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-11 15:38:52,651 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-11 15:38:53,083 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-11 15:38:53,084 - src.core.analysis - INFO - Analyzing inactive users
2025-06-11 15:38:53,084 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-11 15:38:53,085 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 15:38:53,085 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 15:38:53,101 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 09:38:13+0000', tz='UTC'), Timestamp('2025-06-11 09:37:01+0000', tz='UTC'), Timestamp('2025-06-11 09:34:54+0000', tz='UTC'), Timestamp('2025-06-11 09:32:41+0000', tz='UTC'), Timestamp('2025-06-11 09:31:49+0000', tz='UTC')]
2025-06-11 15:38:53,102 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-11 15:38:53,110 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-13 18:52:49+0000', tz='UTC'), Timestamp('2025-03-13 20:19:13+0000', tz='UTC'), Timestamp('2025-03-13 22:30:19+0000', tz='UTC'), Timestamp('2025-03-13 22:30:24+0000', tz='UTC'), Timestamp('2025-03-13 22:30:29+0000', tz='UTC')]
2025-06-11 15:38:53,111 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-11 15:38:53,608 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 206 total users.
2025-06-11 15:38:53,610 - src.core.analysis - INFO - Total unique user IDs after analysis: 524
2025-06-11 15:38:53,644 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-11 15:38:53,645 - src.core.analysis - INFO - Using chunk size: 200 for 524 users
2025-06-11 15:38:53,646 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-11 15:38:53,648 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-11 15:38:53,650 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 165575 bytes
2025-06-11 15:39:07,283 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:39:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:39:32,519 - src.core.analysis - INFO - Findings chunk 1 completed in 38.87s
2025-06-11 15:39:32,520 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-11 15:39:32,521 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 159443 bytes
2025-06-11 15:40:07,286 - apscheduler.scheduler - WARNING - Execution of job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:40:07 IST)" skipped: maximum number of running instances reached (1)
2025-06-11 15:40:11,466 - src.core.analysis - INFO - Findings chunk 2 completed in 38.95s
2025-06-11 15:40:11,466 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-11 15:40:11,468 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 102075 bytes
2025-06-11 15:40:35,276 - src.core.analysis - INFO - Findings chunk 3 completed in 23.81s
2025-06-11 15:40:35,381 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-11 15:40:35,382 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-11 15:40:35,383 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-11 15:40:35,384 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-11 15:40:35,384 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-11 15:40:35,385 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-11 15:40:35,386 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-11 15:40:35,386 - src.core.analysis - INFO - Sequential processing completed in 101.74s
2025-06-11 15:40:35,387 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-11 15:40:35,387 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-11 15:40:35,387 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 524 users
2025-06-11 15:40:35,389 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-11 15:40:35,390 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-11 15:40:35,390 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-11 15:40:35,391 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 13500 bytes
2025-06-11 15:40:43,884 - src.core.analysis - INFO - Recommendations chunk 1 completed in 8.49s
2025-06-11 15:40:43,993 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-11 15:40:43,994 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-11 15:40:43,994 - src.core.analysis - INFO - Analysis completed successfully with 7 recommendations
2025-06-11 15:40:43,995 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:43,996 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-11 15:40:43,997 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-11 15:40:44,001 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:44,031 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '303673'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '560a1137-46ac-11f0-86ee-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:44,785 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:45 GMT'
    'ETag': '"0x8DDA8D03AD40836"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2a115865-001e-0088-14b9-dad524000000'
    'x-ms-client-request-id': '560a1137-46ac-11f0-86ee-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:44 GMT'
2025-06-11 15:40:44,787 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-11 15:40:44,790 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-11 15:40:44,791 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:44,817 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '56820efa-46ac-11f0-b69a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:45,410 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:45 GMT'
    'ETag': '"0x8DDA8D03B3432E8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '56a4212e-301e-0015-50b9-da279e000000'
    'x-ms-client-request-id': '56820efa-46ac-11f0-b69a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:45 GMT'
2025-06-11 15:40:45,411 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-11 15:40:45,415 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-11 15:40:45,417 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:45,445 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '56e1db62-46ac-11f0-be76-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:46,188 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:46 GMT'
    'ETag': '"0x8DDA8D03BAB276C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0e08b60f-d01e-008b-43b9-da3440000000'
    'x-ms-client-request-id': '56e1db62-46ac-11f0-be76-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:46 GMT'
2025-06-11 15:40:46,189 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-11 15:40:46,190 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-11 15:40:46,192 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:46,210 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5756a686-46ac-11f0-8500-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:46,770 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:47 GMT'
    'ETag': '"0x8DDA8D03C045513"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c052cb78-d01e-006f-34b9-da3ade000000'
    'x-ms-client-request-id': '5756a686-46ac-11f0-8500-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:47 GMT'
2025-06-11 15:40:46,772 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-11 15:40:46,775 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-11 15:40:46,776 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:46,790 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '57af2e22-46ac-11f0-8688-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:47,455 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:47 GMT'
    'ETag': '"0x8DDA8D03C6C662F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4d4db85f-601e-008e-7cb9-dae69b000000'
    'x-ms-client-request-id': '57af2e22-46ac-11f0-8688-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:47 GMT'
2025-06-11 15:40:47,456 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-11 15:40:47,456 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-11 15:40:47,457 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:47,474 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1971794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '581793eb-46ac-11f0-9350-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:48,402 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:48 GMT'
    'ETag': '"0x8DDA8D03CFCE090"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fb618d30-401e-0052-7fb9-da4cc5000000'
    'x-ms-client-request-id': '581793eb-46ac-11f0-9350-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:48 GMT'
2025-06-11 15:40:48,403 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-11 15:40:48,404 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-11 15:40:48,405 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:48,427 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '58a90666-46ac-11f0-a1d0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:49,666 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:49 GMT'
    'ETag': '"0x8DDA8D03DBEE1C3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '93fec78c-501e-0003-2cb9-dad149000000'
    'x-ms-client-request-id': '58a90666-46ac-11f0-a1d0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:49 GMT'
2025-06-11 15:40:49,668 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-11 15:40:49,669 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-11 15:40:49,670 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:49,689 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '596988a1-46ac-11f0-a3de-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:50,026 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:50 GMT'
    'ETag': '"0x8DDA8D03DF4A986"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'cdedb74c-d01e-001d-5db9-da3d91000000'
    'x-ms-client-request-id': '596988a1-46ac-11f0-a3de-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:49 GMT'
2025-06-11 15:40:50,028 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-11 15:40:50,029 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-11 15:40:50,031 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:50,051 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '59a0c08d-46ac-11f0-aa8d-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:50,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:50 GMT'
    'ETag': '"0x8DDA8D03E5AC10A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2b8f6435-701e-00ad-05b9-da7c58000000'
    'x-ms-client-request-id': '59a0c08d-46ac-11f0-aa8d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:50 GMT'
2025-06-11 15:40:50,693 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-11 15:40:50,694 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-11 15:40:50,697 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:50,717 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5a065294-46ac-11f0-9662-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:51,258 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:51 GMT'
    'ETag': '"0x8DDA8D03EB0E4DA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1048996d-f01e-009c-3ab9-da9d4b000000'
    'x-ms-client-request-id': '5a065294-46ac-11f0-9662-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:51 GMT'
2025-06-11 15:40:51,260 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-11 15:40:51,261 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-11 15:40:51,262 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:51,280 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5a5c4a02-46ac-11f0-9223-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:51,773 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:52 GMT'
    'ETag': '"0x8DDA8D03EFF96F4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b7719aa5-101e-004f-2cb9-da4179000000'
    'x-ms-client-request-id': '5a5c4a02-46ac-11f0-9223-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:51 GMT'
2025-06-11 15:40:51,774 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-11 15:40:51,775 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-11 15:40:51,777 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:51,799 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1510671'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5aab64e1-46ac-11f0-aa12-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:52,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:52 GMT'
    'ETag': '"0x8DDA8D03F91E408"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '46bfd5a7-b01e-0069-3eb9-da0961000000'
    'x-ms-client-request-id': '5aab64e1-46ac-11f0-aa12-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:52 GMT'
2025-06-11 15:40:52,743 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-11 15:40:52,746 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-11 15:40:52,747 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:52,768 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5b3f6ae8-46ac-11f0-bcd5-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:54,364 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:54 GMT'
    'ETag': '"0x8DDA8D0408875E2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9cb4173-701e-0076-0eb9-daba65000000'
    'x-ms-client-request-id': '5b3f6ae8-46ac-11f0-bcd5-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:54 GMT'
2025-06-11 15:40:54,366 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-11 15:40:54,367 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-11 15:40:54,369 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:54,388 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5c367c13-46ac-11f0-a414-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:54,830 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:55 GMT'
    'ETag': '"0x8DDA8D040D1FDA9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '81cd6e83-901e-008a-62b9-da6b9c000000'
    'x-ms-client-request-id': '5c367c13-46ac-11f0-a414-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:54 GMT'
2025-06-11 15:40:54,831 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-11 15:40:54,832 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-11 15:40:54,833 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:54,851 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5c7d37ac-46ac-11f0-8cff-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:55,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:55 GMT'
    'ETag': '"0x8DDA8D0412392B1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f7eb80c0-901e-009a-11b9-daaef4000000'
    'x-ms-client-request-id': '5c7d37ac-46ac-11f0-8cff-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:54 GMT'
2025-06-11 15:40:55,359 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-11 15:40:55,360 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-11 15:40:55,361 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:55,380 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5ccdd9bd-46ac-11f0-84c3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:55,888 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:56 GMT'
    'ETag': '"0x8DDA8D041735501"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '13f287a3-801e-004d-08b9-daffc1000000'
    'x-ms-client-request-id': '5ccdd9bd-46ac-11f0-84c3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:55 GMT'
2025-06-11 15:40:55,889 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-11 15:40:55,890 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-11 15:40:55,891 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:55,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5d1e0b77-46ac-11f0-a443-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:56,410 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:56 GMT'
    'ETag': '"0x8DDA8D041C3B2F1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8d641aee-501e-0071-38b9-dad606000000'
    'x-ms-client-request-id': '5d1e0b77-46ac-11f0-a443-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:56 GMT'
2025-06-11 15:40:56,411 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-11 15:40:56,412 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-11 15:40:56,413 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:56,429 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5d6df5b4-46ac-11f0-969a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:57,004 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:57 GMT'
    'ETag': '"0x8DDA8D0421DC9F0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0ba6bb35-801e-0096-16b9-da39fc000000'
    'x-ms-client-request-id': '5d6df5b4-46ac-11f0-969a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:56 GMT'
2025-06-11 15:40:57,005 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-11 15:40:57,006 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-11 15:40:57,008 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 15:40:57,025 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5dc8e1aa-46ac-11f0-9000-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:57,696 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:57 GMT'
    'ETag': '"0x8DDA8D04286C45D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4a5e5b9c-901e-007e-6cb9-daa06a000000'
    'x-ms-client-request-id': '5dc8e1aa-46ac-11f0-9000-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:57 GMT'
2025-06-11 15:40:57,697 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-11 15:40:57,699 - main - INFO - [analyze] Analysis completed.
2025-06-11 15:40:57,711 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-11 15:40:57,723 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '94213'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5e336350-46ac-11f0-8a7d-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:58,226 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:58 GMT'
    'ETag': '"0x8DDA8D042D4DAE6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5ac1-101e-002d-76b9-da835e000000'
    'x-ms-client-request-id': '5e336350-46ac-11f0-8a7d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:57 GMT'
2025-06-11 15:40:58,229 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5e80acfb-46ac-11f0-a58e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:58,440 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:58 GMT'
    'ETag': '"0x8DDA8D042F867A3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5ac6-101e-002d-78b9-da835e000000'
    'x-ms-client-request-id': '5e80acfb-46ac-11f0-a58e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:57 GMT'
2025-06-11 15:40:58,443 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5ea14355-46ac-11f0-a3d8-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:58,617 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:58 GMT'
    'ETag': '"0x8DDA8D04313E724"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5ac9-101e-002d-7bb9-da835e000000'
    'x-ms-client-request-id': '5ea14355-46ac-11f0-a3d8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:58 GMT'
2025-06-11 15:40:58,621 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5ebc7a7f-46ac-11f0-977e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:58,718 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:58 GMT'
    'ETag': '"0x8DDA8D0432255DB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5ad8-101e-002d-06b9-da835e000000'
    'x-ms-client-request-id': '5ebc7a7f-46ac-11f0-977e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:58 GMT'
2025-06-11 15:40:58,721 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5ecbbd26-46ac-11f0-956d-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:58,836 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:59 GMT'
    'ETag': '"0x8DDA8D0433380A8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5ae0-101e-002d-0eb9-da835e000000'
    'x-ms-client-request-id': '5ecbbd26-46ac-11f0-956d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:58 GMT'
2025-06-11 15:40:58,841 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1971794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5ede0fbc-46ac-11f0-847e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:59,178 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:10:59 GMT'
    'ETag': '"0x8DDA8D043694872"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5ae4-101e-002d-11b9-da835e000000'
    'x-ms-client-request-id': '5ede0fbc-46ac-11f0-847e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:58 GMT'
2025-06-11 15:40:59,185 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5f12849e-46ac-11f0-9caf-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:40:59,916 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:00 GMT'
    'ETag': '"0x8DDA8D043D9DB77"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5aea-101e-002d-17b9-da835e000000'
    'x-ms-client-request-id': '5f12849e-46ac-11f0-9caf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:59 GMT'
2025-06-11 15:40:59,921 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5f82d9ad-46ac-11f0-9492-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:00,021 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:00 GMT'
    'ETag': '"0x8DDA8D043E787C3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b0c-101e-002d-35b9-da835e000000'
    'x-ms-client-request-id': '5f82d9ad-46ac-11f0-9492-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:59 GMT'
2025-06-11 15:41:00,024 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5f9276cf-46ac-11f0-aec0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:00,133 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:00 GMT'
    'ETag': '"0x8DDA8D043F72DAC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b2e-101e-002d-3fb9-da835e000000'
    'x-ms-client-request-id': '5f9276cf-46ac-11f0-aec0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:59 GMT'
2025-06-11 15:41:00,138 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5fa3ffc7-46ac-11f0-9220-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:00,237 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:00 GMT'
    'ETag': '"0x8DDA8D0440968B3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b34-101e-002d-44b9-da835e000000'
    'x-ms-client-request-id': '5fa3ffc7-46ac-11f0-9220-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:59 GMT'
2025-06-11 15:41:00,240 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5fb37b1d-46ac-11f0-9060-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:00,335 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:00 GMT'
    'ETag': '"0x8DDA8D0441A1ED2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b39-101e-002d-47b9-da835e000000'
    'x-ms-client-request-id': '5fb37b1d-46ac-11f0-9060-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:10:59 GMT'
2025-06-11 15:41:00,339 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1510671'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5fc2a426-46ac-11f0-b256-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:00,571 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:00 GMT'
    'ETag': '"0x8DDA8D0443CE919"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b3f-101e-002d-4db9-da835e000000'
    'x-ms-client-request-id': '5fc2a426-46ac-11f0-b256-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:00 GMT'
2025-06-11 15:41:00,578 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5fe7146c-46ac-11f0-b449-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:01,160 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:01 GMT'
    'ETag': '"0x8DDA8D04497C28C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b49-101e-002d-56b9-da835e000000'
    'x-ms-client-request-id': '5fe7146c-46ac-11f0-b449-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:00 GMT'
2025-06-11 15:41:01,166 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6040c240-46ac-11f0-823e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:01,258 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:01 GMT'
    'ETag': '"0x8DDA8D044A6CCDD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b5e-101e-002d-65b9-da835e000000'
    'x-ms-client-request-id': '6040c240-46ac-11f0-823e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:00 GMT'
2025-06-11 15:41:01,261 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '604f54c6-46ac-11f0-a93a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:01,375 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:01 GMT'
    'ETag': '"0x8DDA8D044B45242"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b61-101e-002d-67b9-da835e000000'
    'x-ms-client-request-id': '604f54c6-46ac-11f0-a93a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:00 GMT'
2025-06-11 15:41:01,380 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '60617921-46ac-11f0-804b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:01,469 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:01 GMT'
    'ETag': '"0x8DDA8D044C728E0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b63-101e-002d-69b9-da835e000000'
    'x-ms-client-request-id': '60617921-46ac-11f0-804b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:00 GMT'
2025-06-11 15:41:01,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '606f6749-46ac-11f0-95e9-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:01,558 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:01 GMT'
    'ETag': '"0x8DDA8D044D4AE48"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b64-101e-002d-6ab9-da835e000000'
    'x-ms-client-request-id': '606f6749-46ac-11f0-95e9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:01 GMT'
2025-06-11 15:41:01,562 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108297'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '607d26a4-46ac-11f0-a84a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:01,647 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:01 GMT'
    'ETag': '"0x8DDA8D044E25A91"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b65-101e-002d-6bb9-da835e000000'
    'x-ms-client-request-id': '607d26a4-46ac-11f0-a84a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:01 GMT'
2025-06-11 15:41:01,650 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '608aadb9-46ac-11f0-8b8a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 15:41:01,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 10:11:02 GMT'
    'ETag': '"0x8DDA8D044F50A48"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3ec5b67-101e-002d-6db9-da835e000000'
    'x-ms-client-request-id': '608aadb9-46ac-11f0-8b8a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 10:11:01 GMT'
2025-06-11 15:41:02,092 - main - INFO - Scheduled analysis completed successfully
2025-06-11 15:41:02,095 - apscheduler.executors.default - INFO - Job "Run analysis every 12 hours (trigger: interval[0:01:00], next run at: 2025-06-11 15:41:07 IST)" executed successfully
2025-06-11 15:41:02,101 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 15:41:02,103 - main - INFO - FastAPI application shutdown
2025-06-11 15:41:23,430 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 15:41:47,345 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 15:41:47,345 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 15:41:47,346 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 15:41:47,347 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 15:41:47,347 - main - INFO - FastAPI application started
2025-06-11 17:52:15,053 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 17:52:15,105 - main - INFO - FastAPI application shutdown
2025-06-11 17:52:42,748 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 17:53:05,428 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 17:53:05,428 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 17:53:05,429 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 17:53:05,430 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 17:53:05,431 - main - INFO - FastAPI application started
2025-06-11 17:55:27,652 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 17:55:27,653 - main - INFO - FastAPI application shutdown
2025-06-11 17:55:47,462 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 17:56:11,109 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 17:56:11,112 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 17:56:11,112 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 17:56:11,114 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 17:56:11,114 - main - INFO - FastAPI application started
2025-06-11 17:59:56,960 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 17:59:56,963 - main - INFO - FastAPI application shutdown
2025-06-11 18:00:05,972 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 18:00:15,330 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 18:00:15,332 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 18:00:15,332 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 18:00:15,336 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 18:00:15,337 - main - INFO - FastAPI application started
2025-06-11 18:03:05,964 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 18:03:05,965 - main - INFO - FastAPI application shutdown
2025-06-11 18:03:21,620 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 18:03:35,792 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 18:03:35,793 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 18:03:35,794 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 18:03:35,796 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 18:03:35,797 - main - INFO - FastAPI application started
2025-06-11 20:49:46,684 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 20:49:46,725 - main - INFO - FastAPI application shutdown
2025-06-11 20:50:22,381 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 20:50:49,850 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 20:50:49,851 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 20:50:49,851 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 20:50:49,853 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 20:50:49,853 - main - INFO - FastAPI application started
2025-06-11 20:51:03,788 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 20:51:03,790 - main - INFO - FastAPI application shutdown
2025-06-11 20:51:13,524 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 20:51:18,621 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 20:51:18,622 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 20:51:18,623 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 20:51:18,625 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 20:51:18,626 - main - INFO - FastAPI application started
2025-06-11 20:51:49,889 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 20:51:49,890 - main - INFO - FastAPI application shutdown
2025-06-11 20:51:57,906 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 20:52:02,834 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 20:52:02,834 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 20:52:02,835 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 20:52:02,836 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 20:52:02,836 - main - INFO - FastAPI application started
2025-06-11 20:52:02,838 - d365 - INFO - Loading D365 data
2025-06-11 20:52:02,840 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:52:03,031 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '644c1b73-cfb6-4db8-8cba-70946b66d200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:22:02 GMT'
    'Content-Length': '1753'
2025-06-11 20:52:03,047 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:52:03,276 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'becfbaf2-025f-4964-9506-ed580d72ea00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:22:03 GMT'
    'Content-Length': '1651'
2025-06-11 20:52:03,277 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:52:03,277 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 20:52:03,278 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T15:22:03Z)
2025-06-11 20:52:07,816 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 20:52:10,861 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 20:52:13,910 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 20:52:16,948 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 20:52:20,553 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 20:52:23,625 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 20:52:25,072 - d365 - INFO - Progress: Fetched 31903 audit logs after 7 pages
2025-06-11 20:52:25,102 - d365 - INFO - Fetched 31903 D365 audit logs via Dataverse
2025-06-11 20:52:25,183 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 20:52:25,187 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:52:25,350 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '676b25bc-bb06-4ff0-bbc4-3fd80daa9f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:22:25 GMT'
    'Content-Length': '1753'
2025-06-11 20:52:25,352 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:52:25,532 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0c4e5852-8b9a-4d63-b3f3-8e472c05fb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:22:25 GMT'
    'Content-Length': '1995'
2025-06-11 20:52:25,533 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:52:25,534 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 20:52:25,534 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T15:22:25Z)
2025-06-11 20:52:25,534 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 20:52:43,081 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 3.4 req/min | Time: 0:00:17
2025-06-11 20:53:02,819 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.2 req/min | Time: 0:00:37
2025-06-11 20:53:15,986 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 3.6 req/min | Time: 0:00:50
2025-06-11 20:53:29,527 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 3.8 req/min | Time: 0:01:03
2025-06-11 20:53:40,410 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.0 req/min | Time: 0:01:14
2025-06-11 20:53:53,577 - d365 - INFO - Progress: 5,923 records | Pages: 6 | Requests: 6 | Rate: 4.1 req/min | Time: 0:01:28
2025-06-11 20:53:54,081 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T16:15:21Z to 2025-06-11T15:17:33Z
2025-06-11 20:53:54,179 - d365 - INFO - Fetch completed: 5,923 records in 0:01:28
2025-06-11 20:53:54,179 - d365 - INFO - Total requests made: 6
2025-06-11 20:53:54,190 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:53:54,623 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '89fc69d8-d72c-457e-ba49-2477f012e100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:23:54 GMT'
    'Content-Length': '1753'
2025-06-11 20:53:54,624 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:53:54,834 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8145e4c2-7386-46cb-8064-d695c594e200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:23:54 GMT'
    'Content-Length': '1648'
2025-06-11 20:53:54,835 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:53:54,836 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 20:53:54,837 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:53:55,027 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9963198a-9027-4572-a06e-11f7acb68000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:23:54 GMT'
    'Content-Length': '1753'
2025-06-11 20:53:55,030 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:53:55,150 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '478d373c-a3f1-47f3-9385-0ae1c245be00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:23:54 GMT'
    'Content-Length': '1997'
2025-06-11 20:53:55,151 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:53:55,152 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 20:53:55,153 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:53:55,360 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c65371ae-9faa-4438-a04d-e0d5b35c0701'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:23:55 GMT'
    'Content-Length': '1753'
2025-06-11 20:53:55,361 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:53:55,525 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '423d117b-9bc5-4b08-b87d-b686aac1ab00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:23:55 GMT'
    'Content-Length': '1992'
2025-06-11 20:53:55,526 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:53:55,527 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 20:53:57,801 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 20:53:57,802 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 20:53:59,584 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 20:55:02,725 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 20:55:02,726 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 20:55:42,940 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 20:55:42,941 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 20:55:45,200 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 20:55:45,202 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 20:55:50,126 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 20:55:50,127 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 20:56:36,907 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 20:56:36,908 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 20:57:02,859 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 20:57:02,860 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 20:57:18,920 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 20:57:18,921 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 20:57:58,134 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 20:57:58,135 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 20:57:58,135 - d365 - INFO - Final user count after filtering: 206
2025-06-11 20:57:58,137 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 20:57:58,145 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 20:57:58,158 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 20:57:58,164 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 20:57:58,171 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:57:58,368 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'becfbaf2-025f-4964-9506-ed581e8bea00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:27:57 GMT'
    'Content-Length': '1753'
2025-06-11 20:57:58,370 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:57:58,554 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e7021404-a3ec-45eb-ad85-dd174873fd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:27:57 GMT'
    'Content-Length': '1651'
2025-06-11 20:57:58,555 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:57:58,556 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 20:57:59,744 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 20:57:59,750 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 20:57:59,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:57:59,928 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3c80a5b7-5ebc-467e-81bb-eb9089e0a200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:27:59 GMT'
    'Content-Length': '1753'
2025-06-11 20:57:59,929 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:58:00,128 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3c80a5b7-5ebc-467e-81bb-eb908fe0a200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:27:59 GMT'
    'Content-Length': '1647'
2025-06-11 20:58:00,129 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:58:00,129 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 20:58:02,494 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 20:58:02,507 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 20:58:02,509 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:58:02,736 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e3d32bd5-09e7-4050-89ab-f2d2fe260601'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:28:02 GMT'
    'Content-Length': '1753'
2025-06-11 20:58:02,738 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:58:02,942 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9963198a-9027-4572-a06e-11f747c28000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:28:03 GMT'
    'Content-Length': '1996'
2025-06-11 20:58:02,943 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:58:02,943 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 20:58:06,211 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 20:58:06,215 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 20:58:06,217 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 20:58:06,991 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0672aafb-d719-4d94-b86c-180d57a6c500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:28:06 GMT'
    'Content-Length': '1753'
2025-06-11 20:58:06,992 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 20:58:07,277 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '44028da0-80ca-485f-bb10-426622dca000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:28:07 GMT'
    'Content-Length': '1648'
2025-06-11 20:58:07,278 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 20:58:07,278 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 20:58:07,980 - d365 - INFO - Fetched 11 business units
2025-06-11 20:58:07,983 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 20:58:08,046 - d365 - INFO - D365 data loaded successfully
2025-06-11 20:58:08,066 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 20:58:08,069 - main - INFO - Loading data from CSV files
2025-06-11 20:58:08,220 - main - INFO - Loaded audit_logs with 31903 rows
2025-06-11 20:58:08,283 - main - INFO - Loaded signin_logs with 5923 rows
2025-06-11 20:58:08,294 - main - INFO - Loaded user_details with 206 rows
2025-06-11 20:58:08,305 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 20:58:08,317 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 20:58:08,486 - main - INFO - Created group_memberships with 3306 rows
2025-06-11 20:58:08,595 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 20:58:08,613 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 20:58:08,614 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['828a0c6f-7972-442a-afd6-d0a6e2f0057c', '8c21304f-41d0-474f-bb19-d49eba150fb0', 'd716f427-0faf-4441-9cfa-96b8931e3bca', 'b547f4bc-a21b-428d-b1ea-4cabca29522b', '905f7514-8838-4b46-80ed-cc10a32827ea']...
2025-06-11 20:58:08,615 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['626fe506-9bf2-eb11-94ef-000d3aba6d30', '27b5c94e-8533-ec11-b6e6-0022489bd51d', '50e7a382-f8bc-ec11-9840-0022489e2e28', 'a239aad0-0aaa-eb11-8236-0022489b4c66', 'edba1d70-e5be-eb11-bacc-000d3ade3348']...
2025-06-11 20:58:08,615 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 20:58:08,733 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 20:58:08,735 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 20:58:08,737 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 20:58:08,737 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 20:58:08,743 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 20:58:53,340 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 20:58:58,344 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 20:58:58,344 - src.core.embeddings - INFO - Embedding initialization took 49.60 seconds
2025-06-11 20:58:58,346 - src.core.embeddings - INFO - Memory usage: RSS=440.65 MB, VMS=2703.77 MB
2025-06-11 20:58:58,347 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 20:58:58,347 - src.core.embeddings - INFO - Using all logs: audit_logs=31903 rows, signin_logs=5923 rows
2025-06-11 20:58:58,353 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 20:58:58,386 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-11 20:58:59,401 - src.core.embeddings - INFO - Text generation took 1.05 seconds
2025-06-11 20:58:59,402 - src.core.embeddings - INFO - Memory usage: RSS=465.46 MB, VMS=2728.74 MB
2025-06-11 20:58:59,402 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 20:59:02,251 - src.core.embeddings - INFO - Total documents to embed: 37826
2025-06-11 20:59:02,251 - src.core.embeddings - INFO - Document conversion took 2.85 seconds
2025-06-11 20:59:02,252 - src.core.embeddings - INFO - Memory usage: RSS=495.27 MB, VMS=2758.80 MB
2025-06-11 20:59:02,253 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 20:59:02,255 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 20:59:16,765 - src.core.embeddings - INFO - Memory usage: RSS=661.01 MB, VMS=2942.24 MB
2025-06-11 20:59:16,766 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-11 20:59:31,886 - src.core.embeddings - INFO - Memory usage: RSS=735.98 MB, VMS=3016.71 MB
2025-06-11 20:59:31,887 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-11 20:59:48,226 - src.core.embeddings - INFO - Memory usage: RSS=808.21 MB, VMS=3091.17 MB
2025-06-11 20:59:48,227 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-11 21:00:04,373 - src.core.embeddings - INFO - Memory usage: RSS=881.92 MB, VMS=3165.38 MB
2025-06-11 21:00:04,374 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-11 21:00:20,338 - src.core.embeddings - INFO - Memory usage: RSS=955.50 MB, VMS=3239.70 MB
2025-06-11 21:00:20,339 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-11 21:00:34,195 - src.core.embeddings - INFO - Memory usage: RSS=1029.61 MB, VMS=3313.39 MB
2025-06-11 21:00:34,195 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-11 21:01:11,981 - src.core.embeddings - INFO - Memory usage: RSS=1242.16 MB, VMS=3554.14 MB
2025-06-11 21:01:11,982 - src.core.embeddings - INFO - Embedding chunk 8/8 (2826 documents)
2025-06-11 21:01:46,666 - src.core.embeddings - INFO - Memory usage: RSS=1275.98 MB, VMS=3607.27 MB
2025-06-11 21:01:47,014 - src.core.embeddings - INFO - Embedding generation took 164.76 seconds
2025-06-11 21:01:47,015 - src.core.embeddings - INFO - Memory usage: RSS=1275.98 MB, VMS=3607.27 MB
2025-06-11 21:01:47,015 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-11 21:01:47,921 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37826 vectors
2025-06-11 21:01:49,168 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-11 21:01:49,196 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-11 21:01:49,197 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-11 21:01:49,197 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.18 seconds
2025-06-11 21:01:49,198 - src.core.embeddings - INFO - Memory usage: RSS=1477.22 MB, VMS=3939.01 MB
2025-06-11 21:01:49,205 - src.core.embeddings - INFO - Total embedding generation took 220.47 seconds
2025-06-11 21:01:49,271 - main - INFO - [analyze] Embeddings generated.
2025-06-11 21:01:49,272 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-11 21:01:49,272 - src.utils.config - INFO - Loading environment variables
2025-06-11 21:01:49,306 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-11 21:01:49,307 - src.core.analysis - INFO - Validating input DataFrames
2025-06-11 21:01:49,384 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:01:49,385 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 21:01:49,385 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 21:01:49,386 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-11 21:01:49,387 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-11 21:01:49,404 - src.core.analysis - INFO - User IDs from user_details: 206
2025-06-11 21:01:49,404 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-11 21:01:49,405 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-11 21:01:49,405 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-11 21:01:49,406 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-11 21:01:51,800 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-11 21:01:51,852 - src.core.analysis - INFO - Starting analysis
2025-06-11 21:01:51,853 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-11 21:01:55,654 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-11 21:01:55,655 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-11 21:01:55,657 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-11 21:01:55,657 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-11 21:01:55,658 - src.analysis.anomaly_detector - INFO - User details shape: (206, 10)
2025-06-11 21:01:55,658 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:01:55,658 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5923, 12)
2025-06-11 21:01:55,659 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 21:01:55,668 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:01:55,700 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-11 21:01:55,729 - src.analysis.anomaly_detector - INFO - Successfully mapped 5916 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-11 21:01:55,737 - src.analysis.anomaly_detector - INFO - Total mapped users: 206
2025-06-11 21:01:55,738 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-11 21:01:55,738 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-11 21:01:55,739 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-11 21:01:55,740 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-11 21:01:55,740 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-11 21:01:55,741 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-11 21:01:55,742 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-11 21:01:55,743 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-11 21:01:55,743 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-11 21:01:55,744 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-11 21:01:55,745 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-11 21:01:55,745 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-11 21:01:55,747 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-11 21:01:55,749 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-11 21:01:55,749 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-11 21:01:55,750 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-11 21:01:55,751 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-11 21:01:57,179 - src.analysis.anomaly_detector - INFO - Detected 63 anomalies
2025-06-11 21:01:57,180 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-11 21:01:57,180 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> High sign-in frequency: 2486 sign-ins (avg: 83.4, threshold: 680.6) (Department: Air Arabia NOC); Un...
2025-06-11 21:01:57,181 - src.analysis.anomaly_detector - INFO - Example 2: Lhakpa Tsheri Sherpa -> Unusual location: Unknown, NP at 2025-06-11 15:17:33. Typical: Kathmandu, NP (77.4%) (Department: Al...
2025-06-11 21:01:57,181 - src.analysis.anomaly_detector - INFO - Example 3: Ajith Benny -> Unusual location: Delhi, IN at 2025-05-17 13:39:24. Typical: Bengaluru, IN (94.7%) (Department: Para...
2025-06-11 21:01:57,182 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches
2025-06-11 21:01:58,281 - src.analysis.permission_mismatch - INFO - Permission mismatch analysis completed
2025-06-11 21:01:58,282 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-11 21:01:58,373 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-11 21:01:58,781 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:01:59,454 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-11 21:01:59,455 - src.core.analysis - INFO - Analyzing inactive users
2025-06-11 21:01:59,455 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-11 21:01:59,456 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 21:01:59,456 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:01:59,469 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 15:17:33+0000', tz='UTC'), Timestamp('2025-06-11 15:14:08+0000', tz='UTC'), Timestamp('2025-06-11 14:15:06+0000', tz='UTC'), Timestamp('2025-06-11 14:14:11+0000', tz='UTC'), Timestamp('2025-06-11 14:08:08+0000', tz='UTC')]
2025-06-11 21:01:59,472 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:01:59,485 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-13 18:52:49+0000', tz='UTC'), Timestamp('2025-03-13 20:19:13+0000', tz='UTC'), Timestamp('2025-03-13 22:30:19+0000', tz='UTC'), Timestamp('2025-03-13 22:30:24+0000', tz='UTC'), Timestamp('2025-03-13 22:30:29+0000', tz='UTC')]
2025-06-11 21:01:59,486 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-11 21:02:00,066 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 206 total users.
2025-06-11 21:02:00,067 - src.core.analysis - INFO - Total unique user IDs after analysis: 524
2025-06-11 21:02:00,117 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-11 21:02:00,117 - src.core.analysis - INFO - Using chunk size: 200 for 524 users
2025-06-11 21:02:00,119 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-11 21:02:00,122 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-11 21:02:00,124 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 169350 bytes
2025-06-11 21:02:36,661 - src.core.analysis - INFO - Findings chunk 1 completed in 36.54s
2025-06-11 21:02:36,661 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-11 21:02:36,663 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 165976 bytes
2025-06-11 21:03:08,523 - src.core.analysis - INFO - Findings chunk 2 completed in 31.86s
2025-06-11 21:03:08,524 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-11 21:03:08,525 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 91674 bytes
2025-06-11 21:03:39,035 - src.core.analysis - INFO - Findings chunk 3 completed in 30.51s
2025-06-11 21:03:39,146 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-11 21:03:39,148 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-11 21:03:39,149 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-11 21:03:39,151 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-11 21:03:39,152 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-11 21:03:39,153 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-11 21:03:39,154 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-11 21:03:39,155 - src.core.analysis - INFO - Sequential processing completed in 99.03s
2025-06-11 21:03:39,156 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-11 21:03:39,159 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-11 21:03:39,160 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 524 users
2025-06-11 21:03:39,164 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-11 21:03:39,166 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-11 21:03:39,167 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-11 21:03:39,168 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 20187 bytes
2025-06-11 21:03:59,010 - src.core.analysis - INFO - Recommendations chunk 1 completed in 19.84s
2025-06-11 21:03:59,113 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-11 21:03:59,116 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-11 21:03:59,116 - src.core.analysis - INFO - Analysis completed successfully with 12 recommendations
2025-06-11 21:03:59,117 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:03:59,119 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-11 21:03:59,120 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-11 21:03:59,125 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:03:59,160 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '94213'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7e700c57-46d9-11f0-bebf-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:03:59,659 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:00 GMT'
    'ETag': '"0x8DDA8FD632A1356"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9957f87e-e01e-0006-15e6-da0392000000'
    'x-ms-client-request-id': '7e700c57-46d9-11f0-bebf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:33:59 GMT'
2025-06-11 21:03:59,660 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-11 21:03:59,662 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-11 21:03:59,663 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:03:59,668 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7ebd8886-46d9-11f0-8f76-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:00,410 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:00 GMT'
    'ETag': '"0x8DDA8FD639DD735"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75dc503-601e-0027-0ae6-da27e9000000'
    'x-ms-client-request-id': '7ebd8886-46d9-11f0-8f76-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:00 GMT'
2025-06-11 21:04:00,412 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-11 21:04:00,415 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-11 21:04:00,416 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:00,448 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7f34867c-46d9-11f0-be53-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:00,988 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:01 GMT'
    'ETag': '"0x8DDA8FD63F5A6E1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '51071722-401e-0042-04e6-da89ad000000'
    'x-ms-client-request-id': '7f34867c-46d9-11f0-be53-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:01 GMT'
2025-06-11 21:04:00,989 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-11 21:04:00,990 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-11 21:04:00,992 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:00,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7f88814a-46d9-11f0-a1aa-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:01,735 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:02 GMT'
    'ETag': '"0x8DDA8FD64685A87"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '11394638-e01e-0080-55e6-dacf2b000000'
    'x-ms-client-request-id': '7f88814a-46d9-11f0-a1aa-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:01 GMT'
2025-06-11 21:04:01,736 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-11 21:04:01,738 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-11 21:04:01,739 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:01,757 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7ffc441c-46d9-11f0-b23b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:02,281 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:02 GMT'
    'ETag': '"0x8DDA8FD64BA644B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '940781e0-501e-0003-4ae6-dad149000000'
    'x-ms-client-request-id': '7ffc441c-46d9-11f0-b23b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:02 GMT'
2025-06-11 21:04:02,282 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-11 21:04:02,285 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-11 21:04:02,286 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:02,295 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1978056'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '804e5196-46d9-11f0-a08a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:03,281 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:03 GMT'
    'ETag': '"0x8DDA8FD6552EC18"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '74c744ed-501e-0095-51e6-dad898000000'
    'x-ms-client-request-id': '804e5196-46d9-11f0-a08a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:02 GMT'
2025-06-11 21:04:03,283 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-11 21:04:03,283 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-11 21:04:03,284 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:03,317 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '80ea58c7-46d9-11f0-ad43-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:06,046 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:06 GMT'
    'ETag': '"0x8DDA8FD66F9DFFF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2a291ed3-901e-0051-56e6-daada1000000'
    'x-ms-client-request-id': '80ea58c7-46d9-11f0-ad43-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:05 GMT'
2025-06-11 21:04:06,048 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-11 21:04:06,049 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-11 21:04:06,051 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:06,055 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '828c0519-46d9-11f0-8142-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:06,363 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:06 GMT'
    'ETag': '"0x8DDA8FD6729465E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5e0d98cb-a01e-00ae-71e6-da9d3c000000'
    'x-ms-client-request-id': '828c0519-46d9-11f0-8142-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:06 GMT'
2025-06-11 21:04:06,364 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-11 21:04:06,365 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-11 21:04:06,366 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:06,390 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '82bf2f8f-46d9-11f0-8210-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:06,699 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:07 GMT'
    'ETag': '"0x8DDA8FD675C045C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '47d1210a-901e-009a-50e6-daaef4000000'
    'x-ms-client-request-id': '82bf2f8f-46d9-11f0-8210-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:07 GMT'
2025-06-11 21:04:06,700 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-11 21:04:06,701 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-11 21:04:06,702 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:06,711 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '82f0165e-46d9-11f0-8290-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:07,116 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:07 GMT'
    'ETag': '"0x8DDA8FD679D311C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6a02879a-a01e-0075-2fe6-da5b01000000'
    'x-ms-client-request-id': '82f0165e-46d9-11f0-8290-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:06 GMT'
2025-06-11 21:04:07,117 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-11 21:04:07,118 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-11 21:04:07,120 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:07,147 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8332c2ca-46d9-11f0-bb4f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:07,568 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:07 GMT'
    'ETag': '"0x8DDA8FD67E22A2B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ea63c380-e01e-005b-42e6-da0916000000'
    'x-ms-client-request-id': '8332c2ca-46d9-11f0-bb4f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:07 GMT'
2025-06-11 21:04:07,569 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-11 21:04:07,570 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-11 21:04:07,572 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:07,583 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514505'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8375227d-46d9-11f0-aa9f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:08,915 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:09 GMT'
    'ETag': '"0x8DDA8FD68AECDF6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9ba1d9d5-e01e-0074-06e6-da04dd000000'
    'x-ms-client-request-id': '8375227d-46d9-11f0-aa9f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:08 GMT'
2025-06-11 21:04:08,917 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-11 21:04:08,918 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-11 21:04:08,919 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:08,954 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '84467f2a-46d9-11f0-a607-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:11,873 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:12 GMT'
    'ETag': '"0x8DDA8FD6A72ED25"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ba019bf7-501e-0061-20e6-da136e000000'
    'x-ms-client-request-id': '84467f2a-46d9-11f0-a607-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:11 GMT'
2025-06-11 21:04:11,874 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-11 21:04:11,875 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-11 21:04:11,876 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:11,880 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8604feb2-46d9-11f0-b550-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:12,218 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:12 GMT'
    'ETag': '"0x8DDA8FD6AA7CB9B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0074f3a0-601e-0037-62e6-dae281000000'
    'x-ms-client-request-id': '8604feb2-46d9-11f0-b550-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:12 GMT'
2025-06-11 21:04:12,220 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-11 21:04:12,221 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-11 21:04:12,222 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:12,242 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '863c1e7c-46d9-11f0-b956-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:12,655 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:13 GMT'
    'ETag': '"0x8DDA8FD6AEA7D45"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '14e23f07-e01e-0016-67e6-dac6fa000000'
    'x-ms-client-request-id': '863c1e7c-46d9-11f0-b956-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:12 GMT'
2025-06-11 21:04:12,656 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-11 21:04:12,657 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-11 21:04:12,659 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:12,662 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '867c4ced-46d9-11f0-8843-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:13,062 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:13 GMT'
    'ETag': '"0x8DDA8FD6B28A02E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '102fd980-d01e-000d-43e6-daf8f9000000'
    'x-ms-client-request-id': '867c4ced-46d9-11f0-8843-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:12 GMT'
2025-06-11 21:04:13,063 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-11 21:04:13,066 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-11 21:04:13,067 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:13,084 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '86bcb7fa-46d9-11f0-8d69-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:13,544 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:13 GMT'
    'ETag': '"0x8DDA8FD6B718C72"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '46d91d89-801e-0010-0ae6-daf545000000'
    'x-ms-client-request-id': '86bcb7fa-46d9-11f0-8d69-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:13 GMT'
2025-06-11 21:04:13,545 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-11 21:04:13,546 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-11 21:04:13,547 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:13,552 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108248'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8703f9f7-46d9-11f0-8766-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:14,026 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:14 GMT'
    'ETag': '"0x8DDA8FD6BBA51C6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '14a5e3b6-501e-0085-66e6-da1df0000000'
    'x-ms-client-request-id': '8703f9f7-46d9-11f0-8766-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:13 GMT'
2025-06-11 21:04:14,027 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-11 21:04:14,028 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-11 21:04:14,029 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:04:14,055 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8750dc2e-46d9-11f0-9430-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:14,524 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:14 GMT'
    'ETag': '"0x8DDA8FD6C077F04"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fb6a7be6-401e-0052-07e6-da4cc5000000'
    'x-ms-client-request-id': '8750dc2e-46d9-11f0-9430-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:14 GMT'
2025-06-11 21:04:14,526 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-11 21:04:14,605 - main - INFO - [analyze] Analysis completed.
2025-06-11 21:04:14,702 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-11 21:04:14,746 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '324595'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '87ba29a1-46d9-11f0-939f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:15,332 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:15 GMT'
    'ETag': '"0x8DDA8FD6C82B490"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7c65-001e-006c-0ae6-dadbba000000'
    'x-ms-client-request-id': '87ba29a1-46d9-11f0-939f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:15 GMT'
2025-06-11 21:04:15,336 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '88143820-46d9-11f0-95b4-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:15,423 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:15 GMT'
    'ETag': '"0x8DDA8FD6C90FC72"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7c72-001e-006c-14e6-dadbba000000'
    'x-ms-client-request-id': '88143820-46d9-11f0-95b4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:15 GMT'
2025-06-11 21:04:15,428 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8822506e-46d9-11f0-9e0c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:15,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:15 GMT'
    'ETag': '"0x8DDA8FD6CA1B294"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7c78-001e-006c-19e6-dadbba000000'
    'x-ms-client-request-id': '8822506e-46d9-11f0-9e0c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:15 GMT'
2025-06-11 21:04:15,549 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8834b565-46d9-11f0-8ae8-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:15,636 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:16 GMT'
    'ETag': '"0x8DDA8FD6CB10AAE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7c80-001e-006c-1fe6-dadbba000000'
    'x-ms-client-request-id': '8834b565-46d9-11f0-8ae8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:15 GMT'
2025-06-11 21:04:15,640 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8842ab18-46d9-11f0-9031-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:15,729 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:16 GMT'
    'ETag': '"0x8DDA8FD6CBF2BA7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7c86-001e-006c-24e6-dadbba000000'
    'x-ms-client-request-id': '8842ab18-46d9-11f0-9031-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:15 GMT'
2025-06-11 21:04:15,735 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1978056'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '885132ce-46d9-11f0-a274-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:16,342 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:16 GMT'
    'ETag': '"0x8DDA8FD6D1BFEC5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7c88-001e-006c-26e6-dadbba000000'
    'x-ms-client-request-id': '885132ce-46d9-11f0-a274-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:16 GMT'
2025-06-11 21:04:16,354 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '88af9d04-46d9-11f0-9ae5-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:18,239 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:18 GMT'
    'ETag': '"0x8DDA8FD6E3E51C0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7c8e-001e-006c-2ce6-dadbba000000'
    'x-ms-client-request-id': '88af9d04-46d9-11f0-9ae5-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:18 GMT'
2025-06-11 21:04:18,244 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '89cffa3f-46d9-11f0-9d47-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:18,316 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:18 GMT'
    'ETag': '"0x8DDA8FD6E4A2B4F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7caa-001e-006c-40e6-dadbba000000'
    'x-ms-client-request-id': '89cffa3f-46d9-11f0-9d47-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:18 GMT'
2025-06-11 21:04:18,320 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '89db8470-46d9-11f0-bef3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:18,393 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:18 GMT'
    'ETag': '"0x8DDA8FD6E55B71D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7cab-001e-006c-41e6-dadbba000000'
    'x-ms-client-request-id': '89db8470-46d9-11f0-bef3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:18 GMT'
2025-06-11 21:04:18,398 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '89e78268-46d9-11f0-a92a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:18,473 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:18 GMT'
    'ETag': '"0x8DDA8FD6E620561"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7cad-001e-006c-43e6-dadbba000000'
    'x-ms-client-request-id': '89e78268-46d9-11f0-a92a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:18 GMT'
2025-06-11 21:04:18,477 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '89f391dc-46d9-11f0-8975-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:18,555 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:18 GMT'
    'ETag': '"0x8DDA8FD6E6EA16B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7cb0-001e-006c-46e6-dadbba000000'
    'x-ms-client-request-id': '89f391dc-46d9-11f0-8975-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:18 GMT'
2025-06-11 21:04:18,560 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514505'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8a00435a-46d9-11f0-8c60-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:18,955 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:19 GMT'
    'ETag': '"0x8DDA8FD6EABB416"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7cb2-001e-006c-47e6-dadbba000000'
    'x-ms-client-request-id': '8a00435a-46d9-11f0-8c60-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:18 GMT'
2025-06-11 21:04:18,962 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8a3d94b8-46d9-11f0-820a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:20,465 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:20 GMT'
    'ETag': '"0x8DDA8FD6F91DDB9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7ccf-001e-006c-63e6-dadbba000000'
    'x-ms-client-request-id': '8a3d94b8-46d9-11f0-820a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:20 GMT'
2025-06-11 21:04:20,472 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8b23eff1-46d9-11f0-be4d-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:20,544 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:20 GMT'
    'ETag': '"0x8DDA8FD6F9E2BFD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7ce1-001e-006c-73e6-dadbba000000'
    'x-ms-client-request-id': '8b23eff1-46d9-11f0-be4d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:20 GMT'
2025-06-11 21:04:20,550 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8b2fed24-46d9-11f0-9c74-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:20,626 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:21 GMT'
    'ETag': '"0x8DDA8FD6FAAC80A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7ce3-001e-006c-75e6-dadbba000000'
    'x-ms-client-request-id': '8b2fed24-46d9-11f0-9c74-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:20 GMT'
2025-06-11 21:04:20,631 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8b3c34ec-46d9-11f0-8022-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:20,705 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:21 GMT'
    'ETag': '"0x8DDA8FD6FB6EF6E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7ce8-001e-006c-78e6-dadbba000000'
    'x-ms-client-request-id': '8b3c34ec-46d9-11f0-8022-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:20 GMT'
2025-06-11 21:04:20,709 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8b4822a8-46d9-11f0-9288-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:20,788 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:21 GMT'
    'ETag': '"0x8DDA8FD6FC38B76"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7ce9-001e-006c-79e6-dadbba000000'
    'x-ms-client-request-id': '8b4822a8-46d9-11f0-9288-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:20 GMT'
2025-06-11 21:04:20,792 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108248'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8b54d9db-46d9-11f0-856e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:20,877 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:21 GMT'
    'ETag': '"0x8DDA8FD6FD110DD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7cec-001e-006c-7be6-dadbba000000'
    'x-ms-client-request-id': '8b54d9db-46d9-11f0-856e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:20 GMT'
2025-06-11 21:04:20,881 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8b6250c5-46d9-11f0-ae57-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:04:20,958 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:34:21 GMT'
    'ETag': '"0x8DDA8FD6FDD8606"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceaa7d01-001e-006c-10e6-dadbba000000'
    'x-ms-client-request-id': '8b6250c5-46d9-11f0-ae57-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:34:20 GMT'
2025-06-11 21:07:32,558 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 21:07:32,575 - main - INFO - FastAPI application shutdown
2025-06-11 21:07:53,781 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 21:08:10,554 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 21:08:10,554 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 21:08:10,555 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 21:08:10,556 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 21:08:10,556 - main - INFO - FastAPI application started
2025-06-11 21:08:10,558 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 21:08:10,559 - main - INFO - FastAPI application shutdown
2025-06-11 21:08:17,556 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 21:08:21,919 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 21:08:21,920 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 21:08:21,920 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 21:08:21,922 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 21:08:21,922 - main - INFO - FastAPI application started
2025-06-11 21:09:04,689 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 21:09:04,693 - main - INFO - FastAPI application shutdown
2025-06-11 21:09:12,009 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 21:09:17,060 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 21:09:17,060 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 21:09:17,061 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 21:09:17,062 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 21:09:17,063 - main - INFO - FastAPI application started
2025-06-11 21:09:29,471 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 21:09:29,473 - main - INFO - FastAPI application shutdown
2025-06-11 21:09:48,726 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 21:10:11,926 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 21:10:11,927 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 21:10:11,927 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 21:10:11,929 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 21:10:11,929 - main - INFO - FastAPI application started
2025-06-11 21:10:11,932 - d365 - INFO - Loading D365 data
2025-06-11 21:10:11,940 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:10:12,147 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6e7618a1-14e5-4a43-af59-1554af216600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:40:11 GMT'
    'Content-Length': '1753'
2025-06-11 21:10:12,163 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:10:12,285 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6e7618a1-14e5-4a43-af59-1554b2216600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:40:11 GMT'
    'Content-Length': '1653'
2025-06-11 21:10:12,287 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:10:12,288 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:10:12,288 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T15:40:12Z)
2025-06-11 21:10:16,044 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 21:10:18,701 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 21:10:21,300 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 21:10:23,871 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 21:10:26,607 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 21:10:29,132 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 21:10:30,259 - d365 - INFO - Progress: Fetched 31904 audit logs after 7 pages
2025-06-11 21:10:30,290 - d365 - INFO - Fetched 31904 D365 audit logs via Dataverse
2025-06-11 21:10:30,376 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 21:10:30,380 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:10:30,595 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b8ba65ff-c6ec-4817-bc65-de02d3b20100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:40:30 GMT'
    'Content-Length': '1753'
2025-06-11 21:10:30,597 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:10:30,776 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ab6fe320-57f2-4e35-8a53-c1ead5daf100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:40:30 GMT'
    'Content-Length': '1995'
2025-06-11 21:10:30,777 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:10:30,778 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:10:30,778 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T15:40:30Z)
2025-06-11 21:10:30,778 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 21:10:41,200 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 5.8 req/min | Time: 0:00:10
2025-06-11 21:10:55,717 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 4.8 req/min | Time: 0:00:24
2025-06-11 21:11:06,998 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.0 req/min | Time: 0:00:36
2025-06-11 21:11:16,918 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.2 req/min | Time: 0:00:46
2025-06-11 21:11:25,680 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.5 req/min | Time: 0:00:54
2025-06-11 21:11:33,728 - d365 - INFO - Progress: 5,923 records | Pages: 6 | Requests: 6 | Rate: 5.7 req/min | Time: 0:01:02
2025-06-11 21:11:34,230 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T16:15:21Z to 2025-06-11T15:17:33Z
2025-06-11 21:11:34,306 - d365 - INFO - Fetch completed: 5,923 records in 0:01:03
2025-06-11 21:11:34,307 - d365 - INFO - Total requests made: 6
2025-06-11 21:11:34,317 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:11:34,496 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9bb7ba80-e453-4b02-b83d-8c198265f600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:41:34 GMT'
    'Content-Length': '1753'
2025-06-11 21:11:34,497 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:11:34,698 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '87ff9ded-5527-4ba4-816b-457efb63fd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:41:34 GMT'
    'Content-Length': '1645'
2025-06-11 21:11:34,699 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:11:34,700 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:11:34,701 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:11:34,935 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a22b0b62-447b-49b1-9f92-be355143e800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:41:34 GMT'
    'Content-Length': '1753'
2025-06-11 21:11:34,937 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:11:35,129 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f2f7c52a-2f7f-4f88-a3a3-fb71442feb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:41:35 GMT'
    'Content-Length': '1996'
2025-06-11 21:11:35,130 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:11:35,131 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:11:35,131 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:11:35,389 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9bd10b27-8465-47b6-8d28-390f9cab1e01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:41:35 GMT'
    'Content-Length': '1753'
2025-06-11 21:11:35,391 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:11:35,632 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a83e5deb-72a7-4744-a368-437177f8fa00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:41:35 GMT'
    'Content-Length': '1991'
2025-06-11 21:11:35,632 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:11:35,633 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:11:38,030 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 21:11:38,031 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 21:11:39,141 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 21:12:40,703 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 21:12:40,704 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 21:13:22,841 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 21:13:22,842 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 21:13:25,989 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 21:13:25,990 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 21:13:32,854 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 21:13:32,855 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 21:14:35,476 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 21:14:35,477 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 21:15:09,686 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 21:15:09,687 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 21:15:30,226 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 21:15:30,227 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 21:16:23,252 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 21:16:23,253 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 21:16:23,254 - d365 - INFO - Final user count after filtering: 206
2025-06-11 21:16:23,262 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 21:16:23,268 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 21:16:23,274 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 21:16:23,279 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 21:16:23,281 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:16:23,562 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4802aa95-b5bb-4aa6-ac02-0ffe6921d700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:23 GMT'
    'Content-Length': '1753'
2025-06-11 21:16:23,564 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:16:23,790 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'becfbaf2-025f-4964-9506-ed582ce6ea00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:23 GMT'
    'Content-Length': '1652'
2025-06-11 21:16:23,791 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:16:23,791 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:16:24,925 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 21:16:24,931 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 21:16:24,932 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:16:25,364 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c64924a7-e2f2-486b-9277-4250b7193d01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:24 GMT'
    'Content-Length': '1753'
2025-06-11 21:16:25,365 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:16:25,629 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b9000117-0b04-4076-b537-31c2b5491400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:25 GMT'
    'Content-Length': '1652'
2025-06-11 21:16:25,630 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:16:25,633 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:16:27,701 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 21:16:27,705 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 21:16:27,707 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:16:27,996 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b05bd332-eaed-4f6f-ada4-27c5ba786c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:27 GMT'
    'Content-Length': '1753'
2025-06-11 21:16:27,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:16:28,172 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '409adb88-f3d1-4a21-a1a0-81b9db0e8300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:27 GMT'
    'Content-Length': '1996'
2025-06-11 21:16:28,173 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:16:28,174 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:16:29,785 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 21:16:29,791 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 21:16:29,793 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:16:30,004 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9408906f-394d-4c00-a472-cc683db7c200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:30 GMT'
    'Content-Length': '1753'
2025-06-11 21:16:30,005 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:16:30,235 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'becfbaf2-025f-4964-9506-ed5897e6ea00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:46:30 GMT'
    'Content-Length': '1652'
2025-06-11 21:16:30,235 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:16:30,236 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:16:30,920 - d365 - INFO - Fetched 11 business units
2025-06-11 21:16:30,922 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 21:16:30,933 - d365 - INFO - D365 data loaded successfully
2025-06-11 21:16:30,945 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 21:16:30,946 - main - INFO - Loading data from CSV files
2025-06-11 21:16:31,001 - main - INFO - Loaded audit_logs with 31904 rows
2025-06-11 21:16:31,052 - main - INFO - Loaded signin_logs with 5923 rows
2025-06-11 21:16:31,060 - main - INFO - Loaded user_details with 206 rows
2025-06-11 21:16:31,067 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 21:16:31,094 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 21:16:31,201 - main - INFO - Created group_memberships with 3306 rows
2025-06-11 21:16:31,236 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 21:16:31,245 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 21:16:31,246 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['9405e3c4-34fa-4514-aa16-161cb1e01532', 'b57b029f-ea18-44a1-aad4-df795c4bf226', '25e4481b-88cd-43c3-8875-93a1ab52df0a', '5b13bd8c-aeb8-4a36-80a6-effca05ae94a', 'f930eecf-94a2-492d-a317-ab8c86b0e56c']...
2025-06-11 21:16:31,247 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['2d3d92b3-76b4-eb11-8236-000d3ab5a61f', '55b271d9-a4fb-ef11-bae4-000d3ab483e3', '12c77f51-1434-f011-8c4e-000d3a69161a', 'd0d8ac80-177d-ef11-ac21-0022489ba102', '4a50733f-13aa-eb11-8236-0022489b4c66']...
2025-06-11 21:16:31,248 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 21:16:31,252 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 21:16:31,253 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 21:16:31,253 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 21:16:31,253 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 21:16:31,254 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 21:17:06,250 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 21:17:11,587 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 21:17:11,588 - src.core.embeddings - INFO - Embedding initialization took 40.33 seconds
2025-06-11 21:17:11,589 - src.core.embeddings - INFO - Memory usage: RSS=511.25 MB, VMS=2703.75 MB
2025-06-11 21:17:11,590 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 21:17:11,590 - src.core.embeddings - INFO - Using all logs: audit_logs=31904 rows, signin_logs=5923 rows
2025-06-11 21:17:11,596 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 21:17:11,622 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-11 21:17:12,392 - src.core.embeddings - INFO - Text generation took 0.80 seconds
2025-06-11 21:17:12,393 - src.core.embeddings - INFO - Memory usage: RSS=535.21 MB, VMS=2728.23 MB
2025-06-11 21:17:12,394 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 21:17:14,952 - src.core.embeddings - INFO - Total documents to embed: 37827
2025-06-11 21:17:14,953 - src.core.embeddings - INFO - Document conversion took 2.56 seconds
2025-06-11 21:17:14,953 - src.core.embeddings - INFO - Memory usage: RSS=565.02 MB, VMS=2758.29 MB
2025-06-11 21:17:14,954 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 21:17:14,956 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 21:17:28,225 - src.core.embeddings - INFO - Memory usage: RSS=730.34 MB, VMS=2941.89 MB
2025-06-11 21:17:28,226 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-11 21:17:41,165 - src.core.embeddings - INFO - Memory usage: RSS=805.43 MB, VMS=3016.62 MB
2025-06-11 21:17:41,166 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-11 21:17:54,512 - src.core.embeddings - INFO - Memory usage: RSS=880.32 MB, VMS=3091.12 MB
2025-06-11 21:17:54,513 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-11 21:18:07,352 - src.core.embeddings - INFO - Memory usage: RSS=953.99 MB, VMS=3165.31 MB
2025-06-11 21:18:07,353 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-11 21:18:21,387 - src.core.embeddings - INFO - Memory usage: RSS=1027.69 MB, VMS=3239.57 MB
2025-06-11 21:18:21,387 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-11 21:18:34,921 - src.core.embeddings - INFO - Memory usage: RSS=1101.43 MB, VMS=3312.86 MB
2025-06-11 21:18:34,922 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-11 21:19:06,299 - src.core.embeddings - INFO - Memory usage: RSS=1358.45 MB, VMS=3568.71 MB
2025-06-11 21:19:06,300 - src.core.embeddings - INFO - Embedding chunk 8/8 (2827 documents)
2025-06-11 21:19:33,330 - src.core.embeddings - INFO - Memory usage: RSS=1396.12 MB, VMS=3611.15 MB
2025-06-11 21:19:33,742 - src.core.embeddings - INFO - Embedding generation took 138.79 seconds
2025-06-11 21:19:33,743 - src.core.embeddings - INFO - Memory usage: RSS=1396.12 MB, VMS=3611.15 MB
2025-06-11 21:19:33,744 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-11 21:19:34,793 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37827 vectors
2025-06-11 21:19:36,259 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-11 21:19:36,279 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-11 21:19:36,280 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-11 21:19:36,280 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.54 seconds
2025-06-11 21:19:36,281 - src.core.embeddings - INFO - Memory usage: RSS=1597.78 MB, VMS=3948.82 MB
2025-06-11 21:19:36,290 - src.core.embeddings - INFO - Total embedding generation took 185.04 seconds
2025-06-11 21:19:36,344 - main - INFO - [analyze] Embeddings generated.
2025-06-11 21:19:36,345 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-11 21:19:36,345 - src.utils.config - INFO - Loading environment variables
2025-06-11 21:19:36,348 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-11 21:19:36,349 - src.core.analysis - INFO - Validating input DataFrames
2025-06-11 21:19:36,457 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:19:36,457 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 21:19:36,458 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 21:19:36,459 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-11 21:19:36,459 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-11 21:19:36,471 - src.core.analysis - INFO - User IDs from user_details: 206
2025-06-11 21:19:36,472 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-11 21:19:36,473 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-11 21:19:36,473 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-11 21:19:36,474 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-11 21:19:38,678 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-11 21:19:38,709 - src.core.analysis - INFO - Starting analysis
2025-06-11 21:19:38,710 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-11 21:19:42,009 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-11 21:19:42,010 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-11 21:19:42,011 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-11 21:19:42,012 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-11 21:19:42,012 - src.analysis.anomaly_detector - INFO - User details shape: (206, 10)
2025-06-11 21:19:42,013 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:19:42,013 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5923, 12)
2025-06-11 21:19:42,013 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 21:19:42,023 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:19:42,041 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-11 21:19:42,067 - src.analysis.anomaly_detector - INFO - Successfully mapped 5916 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-11 21:19:42,072 - src.analysis.anomaly_detector - INFO - Total mapped users: 206
2025-06-11 21:19:42,073 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-11 21:19:42,073 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-11 21:19:42,074 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-11 21:19:42,074 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-11 21:19:42,075 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-11 21:19:42,075 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-11 21:19:42,076 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-11 21:19:42,076 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-11 21:19:42,077 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-11 21:19:42,077 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-11 21:19:42,078 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-11 21:19:42,078 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-11 21:19:42,079 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-11 21:19:42,079 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-11 21:19:42,080 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-11 21:19:42,080 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-11 21:19:42,081 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-11 21:19:43,403 - src.analysis.anomaly_detector - INFO - Detected 63 anomalies
2025-06-11 21:19:43,403 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-11 21:19:43,404 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> High sign-in frequency: 2486 sign-ins (avg: 83.4, threshold: 680.6) (Department: Air Arabia NOC); Un...
2025-06-11 21:19:43,405 - src.analysis.anomaly_detector - INFO - Example 2: Lhakpa Tsheri Sherpa -> Unusual location: Unknown, NP at 2025-06-11 15:17:33. Typical: Kathmandu, NP (77.4%) (Department: Al...
2025-06-11 21:19:43,405 - src.analysis.anomaly_detector - INFO - Example 3: Ajith Benny -> Unusual location: Delhi, IN at 2025-05-17 13:39:24. Typical: Bengaluru, IN (94.7%) (Department: Para...
2025-06-11 21:19:43,406 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-11 21:19:44,308 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-11 21:19:44,309 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-11 21:19:44,423 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-11 21:19:44,921 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:19:45,519 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-11 21:19:45,520 - src.core.analysis - INFO - Analyzing inactive users
2025-06-11 21:19:45,521 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-11 21:19:45,522 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 21:19:45,523 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:19:45,535 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 15:17:33+0000', tz='UTC'), Timestamp('2025-06-11 15:14:08+0000', tz='UTC'), Timestamp('2025-06-11 14:15:06+0000', tz='UTC'), Timestamp('2025-06-11 14:14:11+0000', tz='UTC'), Timestamp('2025-06-11 14:08:08+0000', tz='UTC')]
2025-06-11 21:19:45,536 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:19:45,545 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-13 18:52:49+0000', tz='UTC'), Timestamp('2025-03-13 20:19:13+0000', tz='UTC'), Timestamp('2025-03-13 22:30:19+0000', tz='UTC'), Timestamp('2025-03-13 22:30:24+0000', tz='UTC'), Timestamp('2025-03-13 22:30:29+0000', tz='UTC')]
2025-06-11 21:19:45,546 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-11 21:19:46,187 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 206 total users.
2025-06-11 21:19:46,189 - src.core.analysis - INFO - Total unique user IDs after analysis: 617
2025-06-11 21:19:46,259 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-11 21:19:46,259 - src.core.analysis - INFO - Using chunk size: 200 for 617 users
2025-06-11 21:19:46,262 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-11 21:19:46,263 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-11 21:19:46,265 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 137187 bytes
2025-06-11 21:20:24,634 - src.core.analysis - INFO - Findings chunk 1 completed in 38.37s
2025-06-11 21:20:24,635 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-11 21:20:24,636 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 147878 bytes
2025-06-11 21:20:58,190 - src.core.analysis - INFO - Findings chunk 2 completed in 33.55s
2025-06-11 21:20:58,191 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-11 21:20:58,192 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 148317 bytes
2025-06-11 21:21:28,490 - src.core.analysis - INFO - Findings chunk 3 completed in 30.30s
2025-06-11 21:21:28,490 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-11 21:21:28,491 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 20643 bytes
2025-06-11 21:21:48,153 - src.core.analysis - INFO - Findings chunk 4 completed in 19.66s
2025-06-11 21:21:48,274 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-11 21:21:48,278 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-11 21:21:48,279 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-11 21:21:48,280 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-11 21:21:48,280 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-11 21:21:48,281 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-11 21:21:48,281 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-11 21:21:48,282 - src.core.analysis - INFO - Processed 4/4 chunks (95%)
2025-06-11 21:21:48,284 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-11 21:21:48,284 - src.core.analysis - INFO - Sequential processing completed in 122.02s
2025-06-11 21:21:48,285 - src.core.analysis - INFO - Successfully processed 4/4 chunks
2025-06-11 21:21:48,286 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-11 21:21:48,286 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 617 users
2025-06-11 21:21:48,290 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-11 21:21:48,292 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-11 21:21:48,293 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-11 21:21:48,294 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 21018 bytes
2025-06-11 21:21:57,738 - src.core.analysis - INFO - Recommendations chunk 1 completed in 9.45s
2025-06-11 21:21:57,851 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-11 21:21:57,851 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-11 21:21:57,852 - src.core.analysis - INFO - Analysis completed successfully with 13 recommendations
2025-06-11 21:21:57,853 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:21:57,854 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-11 21:21:57,855 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-11 21:21:57,859 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:21:57,913 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '324595'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '016c6eaa-46dc-11f0-84ed-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:21:58,557 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:51:58 GMT'
    'ETag': '"0x8DDA8FFE63D485F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '60750739-301e-0058-7ae8-dae872000000'
    'x-ms-client-request-id': '016c6eaa-46dc-11f0-84ed-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:51:58 GMT'
2025-06-11 21:21:58,559 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-11 21:21:58,561 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-11 21:21:58,562 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:21:58,576 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '01d1aac7-46dc-11f0-8c1a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:21:59,354 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:51:59 GMT'
    'ETag': '"0x8DDA8FFE6B8F285"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '05a18ce3-b01e-000b-7fe8-dacb46000000'
    'x-ms-client-request-id': '01d1aac7-46dc-11f0-8c1a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:51:58 GMT'
2025-06-11 21:21:59,355 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-11 21:21:59,355 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-11 21:21:59,357 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:21:59,398 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '024f2c21-46dc-11f0-82ab-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:21:59,980 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:00 GMT'
    'ETag': '"0x8DDA8FFE7185ACC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '35a7a381-701e-0014-33e8-da7842000000'
    'x-ms-client-request-id': '024f2c21-46dc-11f0-82ab-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:51:59 GMT'
2025-06-11 21:21:59,981 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-11 21:21:59,983 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-11 21:21:59,984 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:21:59,991 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '02a9a3de-46dc-11f0-afaf-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:00,484 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:00 GMT'
    'ETag': '"0x8DDA8FFE7658802"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '47428b1f-c01e-00a8-53e8-daae83000000'
    'x-ms-client-request-id': '02a9a3de-46dc-11f0-afaf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:00 GMT'
2025-06-11 21:22:00,486 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-11 21:22:00,487 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-11 21:22:00,489 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:00,535 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '02fcc8c0-46dc-11f0-8231-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:01,081 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:01 GMT'
    'ETag': '"0x8DDA8FFE7C0617D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fa7ae2ac-c01e-0087-1de8-daa348000000'
    'x-ms-client-request-id': '02fcc8c0-46dc-11f0-8231-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:01 GMT'
2025-06-11 21:22:01,082 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-11 21:22:01,083 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-11 21:22:01,083 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:01,089 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1978118'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '035149d4-46dc-11f0-bd14-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:02,039 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:02 GMT'
    'ETag': '"0x8DDA8FFE852AE99"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9ba2724e-e01e-0074-6ae8-da04dd000000'
    'x-ms-client-request-id': '035149d4-46dc-11f0-bd14-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:02 GMT'
2025-06-11 21:22:02,041 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-11 21:22:02,042 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-11 21:22:02,043 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:02,091 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '03ea262f-46dc-11f0-8764-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:04,275 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:04 GMT'
    'ETag': '"0x8DDA8FFE9A7BF67"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd1567fd8-201e-0019-3ee8-dab096000000'
    'x-ms-client-request-id': '03ea262f-46dc-11f0-8764-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:04 GMT'
2025-06-11 21:22:04,277 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-11 21:22:04,292 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-11 21:22:04,293 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:04,383 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0547dde1-46dc-11f0-b03a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:04,674 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:05 GMT'
    'ETag': '"0x8DDA8FFE9E4D206"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd727e1db-501e-004e-3ee8-da1ea5000000'
    'x-ms-client-request-id': '0547dde1-46dc-11f0-b03a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:05 GMT'
2025-06-11 21:22:04,675 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-11 21:22:04,676 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-11 21:22:04,677 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:04,869 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0591fb6c-46dc-11f0-889e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:05,179 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:05 GMT'
    'ETag': '"0x8DDA8FFEA31D855"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bf2c9fb4-801e-0000-7ee8-da302d000000'
    'x-ms-client-request-id': '0591fb6c-46dc-11f0-889e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:05 GMT'
2025-06-11 21:22:05,182 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-11 21:22:05,221 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-11 21:22:05,223 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:05,314 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '05d5e379-46dc-11f0-96ac-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:05,739 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:06 GMT'
    'ETag': '"0x8DDA8FFEA876098"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd1568028-201e-0019-7de8-dab096000000'
    'x-ms-client-request-id': '05d5e379-46dc-11f0-96ac-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:05 GMT'
2025-06-11 21:22:05,742 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-11 21:22:05,743 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-11 21:22:05,744 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:05,968 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0639af42-46dc-11f0-bb20-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:06,425 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:06 GMT'
    'ETag': '"0x8DDA8FFEAF00D3F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '671bdaf1-001e-0021-13e8-da1456000000'
    'x-ms-client-request-id': '0639af42-46dc-11f0-bb20-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:06 GMT'
2025-06-11 21:22:06,426 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-11 21:22:06,447 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-11 21:22:06,448 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:06,537 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514505'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '06908315-46dc-11f0-b128-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:07,307 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:07 GMT'
    'ETag': '"0x8DDA8FFEB74604A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3481f5a-101e-0002-43e8-da8e95000000'
    'x-ms-client-request-id': '06908315-46dc-11f0-b128-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:07 GMT'
2025-06-11 21:22:07,308 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-11 21:22:07,347 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-11 21:22:07,348 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:07,393 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '07132d6e-46dc-11f0-9bdb-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:09,414 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:09 GMT'
    'ETag': '"0x8DDA8FFECB81F5B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '46c94e5b-b01e-0069-64e8-da0961000000'
    'x-ms-client-request-id': '07132d6e-46dc-11f0-9bdb-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:09 GMT'
2025-06-11 21:22:09,416 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-11 21:22:09,417 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-11 21:22:09,418 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:09,423 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0848df73-46dc-11f0-9d61-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:09,782 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:10 GMT'
    'ETag': '"0x8DDA8FFECF02E88"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9ee026b5-901e-000c-51e8-daa725000000'
    'x-ms-client-request-id': '0848df73-46dc-11f0-9d61-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:09 GMT'
2025-06-11 21:22:09,783 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-11 21:22:09,784 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-11 21:22:09,786 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:09,890 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '08903b6e-46dc-11f0-a3ac-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:10,317 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:10 GMT'
    'ETag': '"0x8DDA8FFED419CB4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6160263a-601e-0045-29e8-dae5ce000000'
    'x-ms-client-request-id': '08903b6e-46dc-11f0-a3ac-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:09 GMT'
2025-06-11 21:22:10,318 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-11 21:22:10,321 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-11 21:22:10,322 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:10,327 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '08d2e701-46dc-11f0-9736-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:10,747 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:11 GMT'
    'ETag': '"0x8DDA8FFED838BDF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a3e9ee2e-d01e-007f-24e8-daffb6000000'
    'x-ms-client-request-id': '08d2e701-46dc-11f0-9736-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:10 GMT'
2025-06-11 21:22:10,748 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-11 21:22:10,794 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-11 21:22:10,796 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:10,822 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '091e6763-46dc-11f0-8ce0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:11,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:11 GMT'
    'ETag': '"0x8DDA8FFEDE0ACC1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '82c8c8d7-a01e-0028-4be8-da5185000000'
    'x-ms-client-request-id': '091e6763-46dc-11f0-8ce0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:11 GMT'
2025-06-11 21:22:11,359 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-11 21:22:11,381 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-11 21:22:11,383 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:11,391 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108248'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '09753083-46dc-11f0-9605-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:11,870 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:12 GMT'
    'ETag': '"0x8DDA8FFEE2EC346"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '318771ce-f01e-0057-62e8-da9e1e000000'
    'x-ms-client-request-id': '09753083-46dc-11f0-9605-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:11 GMT'
2025-06-11 21:22:11,872 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-11 21:22:11,873 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-11 21:22:11,874 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:22:11,963 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '09cc78e2-46dc-11f0-9fb2-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:22:12,496 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 15:52:12 GMT'
    'ETag': '"0x8DDA8FFEE8D690B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6abd8433-e01e-0064-7de8-dac1b5000000'
    'x-ms-client-request-id': '09cc78e2-46dc-11f0-9fb2-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:52:12 GMT'
2025-06-11 21:22:12,497 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-11 21:22:12,984 - src.core.analysis - ERROR - Error during analysis: 'userId'
Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'userId'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 885, in analyze
    assignments = app_role_assignments[app_role_assignments['userId'] == details['userId']]
                                                                         ~~~~~~~^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'userId'
2025-06-11 21:22:13,445 - src.core.analysis - ERROR - Failed to run analysis: 'userId'
Traceback (most recent call last):
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'userId'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 935, in run_analysis
    result = await app.ainvoke({
             ^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    })
    ^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2788, in ainvoke
    async for chunk in self.astream(
    ...<19 lines>...
            chunks.append(chunk)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2655, in astream
    async for _ in runner.atick(
    ...<7 lines>...
            yield o
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\runner.py", line 294, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\retry.py", line 136, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 672, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
        step.ainvoke(input, config, **kwargs), context=context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 440, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Production\backend\src\core\analysis.py", line 885, in analyze
    assignments = app_role_assignments[app_role_assignments['userId'] == details['userId']]
                                                                         ~~~~~~~^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'userId'
During task with name 'analyze' and id 'e8b0e335-4306-e09c-46fc-5cf01a36ad08'
2025-06-11 21:22:13,662 - main - ERROR - [analyze] Analysis failed: 'userId'
2025-06-11 21:23:25,268 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 21:23:25,290 - main - INFO - FastAPI application shutdown
2025-06-11 21:23:39,323 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 21:23:45,793 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 21:23:45,794 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 21:23:45,794 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 21:23:45,796 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 21:23:45,796 - main - INFO - FastAPI application started
2025-06-11 21:23:58,660 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-11 21:23:58,662 - main - INFO - FastAPI application shutdown
2025-06-11 21:24:07,164 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 21:24:13,752 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 21:24:13,753 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 21:24:13,753 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 21:24:13,755 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 21:24:13,755 - main - INFO - FastAPI application started
2025-06-11 21:24:13,758 - d365 - INFO - Loading D365 data
2025-06-11 21:24:13,760 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:24:13,999 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '51df0c20-a90c-4e2f-9831-cc3fdb3d0101'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:54:14 GMT'
    'Content-Length': '1753'
2025-06-11 21:24:14,015 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:24:14,220 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '51df0c20-a90c-4e2f-9831-cc3fdd3d0101'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:54:14 GMT'
    'Content-Length': '1647'
2025-06-11 21:24:14,221 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:24:14,222 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:24:14,223 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T15:54:14Z)
2025-06-11 21:24:17,807 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 21:24:20,487 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 21:24:23,227 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 21:24:25,822 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 21:24:28,464 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 21:24:30,928 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 21:24:32,283 - d365 - INFO - Progress: Fetched 31903 audit logs after 7 pages
2025-06-11 21:24:32,321 - d365 - INFO - Fetched 31903 D365 audit logs via Dataverse
2025-06-11 21:24:32,385 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 21:24:32,389 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:24:32,616 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '55ab15c0-5c9f-482a-b7b9-e346c9ab9900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:54:32 GMT'
    'Content-Length': '1753'
2025-06-11 21:24:32,618 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:24:32,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '39401663-a86a-4865-a554-bd327079a300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:54:32 GMT'
    'Content-Length': '1997'
2025-06-11 21:24:32,746 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:24:32,747 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:24:32,747 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T15:54:32Z)
2025-06-11 21:24:32,748 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 21:24:42,595 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 6.1 req/min | Time: 0:00:09
2025-06-11 21:24:54,128 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 5.6 req/min | Time: 0:00:21
2025-06-11 21:25:03,244 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.9 req/min | Time: 0:00:30
2025-06-11 21:25:13,834 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.8 req/min | Time: 0:00:41
2025-06-11 21:25:21,093 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 6.2 req/min | Time: 0:00:48
2025-06-11 21:25:30,965 - d365 - INFO - Progress: 5,924 records | Pages: 6 | Requests: 6 | Rate: 6.2 req/min | Time: 0:00:58
2025-06-11 21:25:31,467 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T16:15:21Z to 2025-06-11T15:44:43Z
2025-06-11 21:25:31,539 - d365 - INFO - Fetch completed: 5,924 records in 0:00:58
2025-06-11 21:25:31,540 - d365 - INFO - Total requests made: 6
2025-06-11 21:25:31,550 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:25:31,729 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'eac14ef9-8a32-435c-9242-94d43244a100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:55:31 GMT'
    'Content-Length': '1753'
2025-06-11 21:25:31,730 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:25:31,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'caceb5db-32ed-4dc3-8ac2-f91b4ed21101'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:55:31 GMT'
    'Content-Length': '1652'
2025-06-11 21:25:31,906 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:25:31,907 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:25:31,908 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:25:32,101 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '00d4c74a-7e8b-4cad-bbcd-5f0ef3071401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:55:32 GMT'
    'Content-Length': '1753'
2025-06-11 21:25:32,103 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:25:32,290 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '95232a91-5d30-471a-aa71-986452d30f01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:55:32 GMT'
    'Content-Length': '1995'
2025-06-11 21:25:32,292 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:25:32,293 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:25:32,294 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:25:32,506 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4b5dff66-27b7-44a7-a0a8-2471535e4900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:55:31 GMT'
    'Content-Length': '1753'
2025-06-11 21:25:32,508 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:25:32,717 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c3f29031-d3a0-4eda-baed-b4092b56cb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:55:32 GMT'
    'Content-Length': '1996'
2025-06-11 21:25:32,718 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:25:32,719 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:25:34,744 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 21:25:34,745 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 21:25:35,992 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 21:26:43,096 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 21:26:43,098 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 21:27:21,800 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 21:27:21,801 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 21:27:24,200 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 21:27:24,201 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 21:27:28,906 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 21:27:28,907 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 21:28:14,025 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 21:28:14,026 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 21:28:39,251 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 21:28:39,252 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 21:28:54,208 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 21:28:54,210 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 21:29:31,438 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 21:29:31,439 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 21:29:31,439 - d365 - INFO - Final user count after filtering: 206
2025-06-11 21:29:31,441 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 21:29:31,445 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 21:29:31,449 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 21:29:31,455 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 21:29:31,458 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:29:31,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '359f8a61-d36b-410a-bb93-3ef466d1cc00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:31 GMT'
    'Content-Length': '1753'
2025-06-11 21:29:31,743 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:29:31,945 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f394b009-5ae0-4a1a-93ad-05458e9e1300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:31 GMT'
    'Content-Length': '1647'
2025-06-11 21:29:31,946 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:29:31,946 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:29:33,231 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 21:29:33,236 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 21:29:33,238 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:29:33,496 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6fba9e4f-0655-4e9f-b352-88b477fd0c01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:33 GMT'
    'Content-Length': '1753'
2025-06-11 21:29:33,497 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:29:33,636 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3e097796-59f0-4f0e-aced-0d8a0877de00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:33 GMT'
    'Content-Length': '1653'
2025-06-11 21:29:33,637 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:29:33,637 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:29:36,443 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 21:29:36,447 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 21:29:36,449 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:29:36,741 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '931f90b4-bcae-4163-9d8c-199c069c1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:36 GMT'
    'Content-Length': '1753'
2025-06-11 21:29:36,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:29:36,897 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5ec93042-0a3c-4d17-b5c4-6bd0d6cd6400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:36 GMT'
    'Content-Length': '1997'
2025-06-11 21:29:36,898 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:29:36,898 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:29:40,954 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 21:29:40,957 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 21:29:40,958 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:29:41,202 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ae8cfd87-25f4-4612-a9da-c092a4d82700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:40 GMT'
    'Content-Length': '1753'
2025-06-11 21:29:41,204 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:29:41,346 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e84d56ad-36b3-427b-ac94-f62fa0e11501'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 15:59:40 GMT'
    'Content-Length': '1652'
2025-06-11 21:29:41,347 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:29:41,348 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:29:42,118 - d365 - INFO - Fetched 11 business units
2025-06-11 21:29:42,120 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 21:29:42,122 - d365 - INFO - D365 data loaded successfully
2025-06-11 21:29:42,140 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 21:29:42,141 - main - INFO - Loading data from CSV files
2025-06-11 21:29:42,226 - main - INFO - Loaded audit_logs with 31903 rows
2025-06-11 21:29:42,292 - main - INFO - Loaded signin_logs with 5924 rows
2025-06-11 21:29:42,302 - main - INFO - Loaded user_details with 206 rows
2025-06-11 21:29:42,315 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 21:29:42,328 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 21:29:42,488 - main - INFO - Created group_memberships with 3306 rows
2025-06-11 21:29:42,524 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 21:29:42,547 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 21:29:42,550 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['005a3324-6c26-484a-be06-07d829df9a76', 'b57b029f-ea18-44a1-aad4-df795c4bf226', 'c9a68d4d-342a-416c-b54c-ec2cdabc0c3f', '3c36d97e-3ab6-4843-906a-4046a5a6e056', 'd373c19a-2bb2-4488-94a2-db96409ca507']...
2025-06-11 21:29:42,552 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['dfc9fddf-a4fb-ef11-bae4-000d3ab483e3', '7db153c8-ab7d-ec11-8d21-0022489bef85', 'eb1833bb-d023-ec11-b6e5-000d3adb194e', '41b4c94e-8533-ec11-b6e6-0022489bd51d', 'd4e70ea6-76b4-eb11-8236-000d3ab6406f']...
2025-06-11 21:29:42,553 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 21:29:42,559 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 21:29:42,568 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 21:29:42,569 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 21:29:42,570 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 21:29:42,571 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 21:30:15,931 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 21:30:21,268 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 21:30:21,269 - src.core.embeddings - INFO - Embedding initialization took 38.70 seconds
2025-06-11 21:30:21,270 - src.core.embeddings - INFO - Memory usage: RSS=516.44 MB, VMS=2703.88 MB
2025-06-11 21:30:21,271 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 21:30:21,271 - src.core.embeddings - INFO - Using all logs: audit_logs=31903 rows, signin_logs=5924 rows
2025-06-11 21:30:21,277 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 21:30:21,289 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-11 21:30:22,049 - src.core.embeddings - INFO - Text generation took 0.78 seconds
2025-06-11 21:30:22,050 - src.core.embeddings - INFO - Memory usage: RSS=540.40 MB, VMS=2728.36 MB
2025-06-11 21:30:22,051 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 21:30:24,336 - src.core.embeddings - INFO - Total documents to embed: 37827
2025-06-11 21:30:24,337 - src.core.embeddings - INFO - Document conversion took 2.29 seconds
2025-06-11 21:30:24,337 - src.core.embeddings - INFO - Memory usage: RSS=570.20 MB, VMS=2758.42 MB
2025-06-11 21:30:24,338 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 21:30:24,340 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 21:30:54,110 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-11 21:31:16,163 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-11 21:31:16,164 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-11 21:31:16,165 - apscheduler.scheduler - INFO - Scheduler started
2025-06-11 21:31:16,166 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-11 21:31:16,167 - main - INFO - FastAPI application started
2025-06-11 21:31:32,332 - d365 - INFO - Loading D365 data
2025-06-11 21:31:32,333 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:31:32,611 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1f9deace-565f-4ff3-ad69-7c9071576b01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:01:32 GMT'
    'Content-Length': '1753'
2025-06-11 21:31:32,621 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:31:32,855 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd507f7b2-54af-4b6b-940f-b7d7ab5e0e01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:01:32 GMT'
    'Content-Length': '1652'
2025-06-11 21:31:32,857 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:31:32,857 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:31:32,858 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-13T16:01:32Z)
2025-06-11 21:31:36,471 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-11 21:31:39,475 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-11 21:31:42,595 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-11 21:31:45,326 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-11 21:31:48,415 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-11 21:31:51,203 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-11 21:31:52,418 - d365 - INFO - Progress: Fetched 31916 audit logs after 7 pages
2025-06-11 21:31:52,444 - d365 - INFO - Fetched 31916 D365 audit logs via Dataverse
2025-06-11 21:31:52,524 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-11 21:31:52,528 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:31:52,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '29bb4fda-55c9-45c9-afcf-7076ad8be400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:01:53 GMT'
    'Content-Length': '1753'
2025-06-11 21:31:52,835 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:31:53,077 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6efa9cb3-4e7f-4804-8143-903ec179e800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:01:53 GMT'
    'Content-Length': '1991'
2025-06-11 21:31:53,078 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:31:53,079 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:31:53,080 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-13T16:01:53Z)
2025-06-11 21:31:53,080 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-11 21:32:01,761 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 6.9 req/min | Time: 0:00:08
2025-06-11 21:32:11,694 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 6.4 req/min | Time: 0:00:18
2025-06-11 21:32:20,835 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 6.5 req/min | Time: 0:00:27
2025-06-11 21:32:31,219 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 6.3 req/min | Time: 0:00:38
2025-06-11 21:32:40,539 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 6.3 req/min | Time: 0:00:47
2025-06-11 21:32:47,023 - d365 - INFO - Progress: 5,924 records | Pages: 6 | Requests: 6 | Rate: 6.7 req/min | Time: 0:00:53
2025-06-11 21:32:47,525 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-12T16:15:21Z to 2025-06-11T15:44:43Z
2025-06-11 21:32:47,639 - d365 - INFO - Fetch completed: 5,924 records in 0:00:54
2025-06-11 21:32:47,640 - d365 - INFO - Total requests made: 6
2025-06-11 21:32:47,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:32:47,820 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b656fd75-3bbf-4d6b-ae16-073c6e22d600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:02:48 GMT'
    'Content-Length': '1753'
2025-06-11 21:32:47,821 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:32:47,934 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8f22db63-54e5-4c6d-ad27-9e465156bb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:02:48 GMT'
    'Content-Length': '1653'
2025-06-11 21:32:47,935 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:32:47,936 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:32:47,937 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:32:48,146 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6041de96-dd2a-4cff-ad6b-1c314bd29d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:02:48 GMT'
    'Content-Length': '1753'
2025-06-11 21:32:48,148 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:32:48,327 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6041de96-dd2a-4cff-ad6b-1c314ed29d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:02:48 GMT'
    'Content-Length': '1991'
2025-06-11 21:32:48,328 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:32:48,328 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:32:48,329 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:32:48,541 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c250f42b-6e8f-4a89-822a-01ea183de000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:02:48 GMT'
    'Content-Length': '1753'
2025-06-11 21:32:48,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:32:48,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e196d5ea-1af9-48d4-b430-3634b39e0201'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:02:48 GMT'
    'Content-Length': '1996'
2025-06-11 21:32:48,678 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:32:48,679 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:32:51,198 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-11 21:32:51,199 - d365 - INFO - Found 975 users in Entra ID
2025-06-11 21:32:52,301 - d365 - INFO - Fetched 934 user records from D365
2025-06-11 21:33:56,654 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-11 21:33:56,656 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-11 21:34:35,230 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-11 21:34:35,232 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-11 21:34:37,604 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-11 21:34:37,605 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-11 21:34:42,462 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-11 21:34:42,464 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-11 21:35:27,147 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-11 21:35:27,148 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-11 21:35:52,571 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-11 21:35:52,572 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-11 21:36:11,739 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-11 21:36:11,740 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-11 21:36:51,123 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-11 21:36:51,123 - d365 - INFO - Filtered out 313 D365 users without a D365 license
2025-06-11 21:36:51,124 - d365 - INFO - Final user count after filtering: 206
2025-06-11 21:36:51,125 - d365 - INFO - Fetched 206 user details after filtering
2025-06-11 21:36:51,131 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-11 21:36:51,144 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-11 21:36:51,151 - d365 - INFO - Saved 313 users without D365 license to data/users_without_d365_license.csv
2025-06-11 21:36:51,157 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:36:51,396 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2a72fe50-2304-46c3-98de-3812e4030e01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:50 GMT'
    'Content-Length': '1753'
2025-06-11 21:36:51,397 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:36:51,646 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '105b4e62-7b4f-4ac5-b577-58780f051601'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:51 GMT'
    'Content-Length': '1647'
2025-06-11 21:36:51,647 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:36:51,648 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:36:52,799 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-11 21:36:52,807 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-11 21:36:52,808 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:36:53,047 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '782cdf8c-6b41-432c-93b1-1fdd498bd500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:52 GMT'
    'Content-Length': '1753'
2025-06-11 21:36:53,049 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:36:53,203 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd8737d54-48a1-4989-8d29-145517bd2001'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:53 GMT'
    'Content-Length': '1653'
2025-06-11 21:36:53,204 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:36:53,205 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:36:55,289 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-11 21:36:55,298 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-11 21:36:55,302 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:36:55,530 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e0c01375-7661-401a-a08f-fbbc3dd9e300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:55 GMT'
    'Content-Length': '1753'
2025-06-11 21:36:55,531 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:36:55,755 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1c3e6c75-a349-4b41-a6ea-1781c08ce200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:55 GMT'
    'Content-Length': '1996'
2025-06-11 21:36:55,756 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:36:55,756 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-11 21:36:59,389 - d365 - INFO - Fetched 35 conditional access policies
2025-06-11 21:36:59,394 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-11 21:36:59,396 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-11 21:36:59,807 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7d9f47c3-f3fe-4879-8a41-7c3e3a4ce400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:59 GMT'
    'Content-Length': '1753'
2025-06-11 21:36:59,809 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-11 21:37:00,064 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7da8a74d-997a-4ef6-9e10-ca53df49eb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:06:59 GMT'
    'Content-Length': '1647'
2025-06-11 21:37:00,065 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-11 21:37:00,066 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-11 21:37:01,213 - d365 - INFO - Fetched 11 business units
2025-06-11 21:37:01,215 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-11 21:37:01,226 - d365 - INFO - D365 data loaded successfully
2025-06-11 21:37:01,244 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-11 21:37:01,245 - main - INFO - Loading data from CSV files
2025-06-11 21:37:01,359 - main - INFO - Loaded audit_logs with 31916 rows
2025-06-11 21:37:01,434 - main - INFO - Loaded signin_logs with 5924 rows
2025-06-11 21:37:01,445 - main - INFO - Loaded user_details with 206 rows
2025-06-11 21:37:01,459 - main - INFO - Loaded app_roles with 2112 rows
2025-06-11 21:37:01,473 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-11 21:37:01,587 - main - INFO - Created group_memberships with 3306 rows
2025-06-11 21:37:01,632 - main - INFO - Created role_matrix with 2112 rows
2025-06-11 21:37:01,645 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-11 21:37:01,646 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['63c81bce-6d95-449f-b366-f4c36cba8712', 'f5171746-0248-4d03-8228-86376434a4e2', '401b998a-bb2f-4dd4-887e-c0045a3964bf', '005a3324-6c26-484a-be06-07d829df9a76', 'd716f427-0faf-4441-9cfa-96b8931e3bca']...
2025-06-11 21:37:01,647 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['2ad0086a-e5be-eb11-bacc-000d3ade3348', 'a9b4c94e-8533-ec11-b6e6-0022489bd51d', 'ee82b819-4229-ec11-b6e5-000d3ada45f6', '9be70ea6-76b4-eb11-8236-000d3ab6406f', '4050733f-13aa-eb11-8236-0022489b4c66']...
2025-06-11 21:37:01,648 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-11 21:37:01,663 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-11 21:37:01,665 - src.core.embeddings - INFO - Starting embedding generation
2025-06-11 21:37:01,667 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-11 21:37:01,669 - src.core.embeddings - INFO - Using batch_size=64
2025-06-11 21:37:01,670 - src.core.embeddings - INFO - Using device: cpu
2025-06-11 21:37:11,115 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-11 21:37:17,222 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-11 21:37:17,223 - src.core.embeddings - INFO - Embedding initialization took 15.55 seconds
2025-06-11 21:37:17,224 - src.core.embeddings - INFO - Memory usage: RSS=479.77 MB, VMS=2703.07 MB
2025-06-11 21:37:17,225 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-11 21:37:17,226 - src.core.embeddings - INFO - Using all logs: audit_logs=31916 rows, signin_logs=5924 rows
2025-06-11 21:37:17,234 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-11 21:37:17,276 - src.core.embeddings - INFO - Precomputed location history in 0.04 seconds
2025-06-11 21:37:18,807 - src.core.embeddings - INFO - Text generation took 1.58 seconds
2025-06-11 21:37:18,808 - src.core.embeddings - INFO - Memory usage: RSS=504.02 MB, VMS=2727.56 MB
2025-06-11 21:37:18,808 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-11 21:37:23,917 - src.core.embeddings - INFO - Total documents to embed: 37840
2025-06-11 21:37:23,918 - src.core.embeddings - INFO - Document conversion took 5.11 seconds
2025-06-11 21:37:23,919 - src.core.embeddings - INFO - Memory usage: RSS=533.81 MB, VMS=2757.58 MB
2025-06-11 21:37:23,919 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-11 21:37:23,922 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-11 21:37:43,575 - src.core.embeddings - INFO - Memory usage: RSS=697.91 MB, VMS=2939.51 MB
2025-06-11 21:37:43,575 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-11 21:38:03,263 - src.core.embeddings - INFO - Memory usage: RSS=773.58 MB, VMS=3014.95 MB
2025-06-11 21:38:03,264 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-11 21:38:23,528 - src.core.embeddings - INFO - Memory usage: RSS=848.10 MB, VMS=3089.09 MB
2025-06-11 21:38:23,529 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-11 21:38:43,562 - src.core.embeddings - INFO - Memory usage: RSS=922.02 MB, VMS=3163.55 MB
2025-06-11 21:38:43,563 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-11 21:39:03,544 - src.core.embeddings - INFO - Memory usage: RSS=996.20 MB, VMS=3238.26 MB
2025-06-11 21:39:03,544 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-11 21:39:25,635 - src.core.embeddings - INFO - Memory usage: RSS=1069.82 MB, VMS=3311.45 MB
2025-06-11 21:39:25,636 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-11 21:40:11,856 - src.core.embeddings - INFO - Memory usage: RSS=1226.04 MB, VMS=3568.12 MB
2025-06-11 21:40:11,857 - src.core.embeddings - INFO - Embedding chunk 8/8 (2840 documents)
2025-06-11 21:40:46,128 - src.core.embeddings - INFO - Memory usage: RSS=1271.12 MB, VMS=3664.81 MB
2025-06-11 21:40:46,604 - src.core.embeddings - INFO - Embedding generation took 202.68 seconds
2025-06-11 21:40:46,605 - src.core.embeddings - INFO - Memory usage: RSS=1271.12 MB, VMS=3664.81 MB
2025-06-11 21:40:46,606 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-11 21:40:47,689 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37840 vectors
2025-06-11 21:40:49,278 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-11 21:40:49,301 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-11 21:40:49,302 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-11 21:40:49,303 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.70 seconds
2025-06-11 21:40:49,304 - src.core.embeddings - INFO - Memory usage: RSS=1474.78 MB, VMS=3998.61 MB
2025-06-11 21:40:49,327 - src.core.embeddings - INFO - Total embedding generation took 227.66 seconds
2025-06-11 21:40:49,383 - main - INFO - [analyze] Embeddings generated.
2025-06-11 21:40:49,384 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-11 21:40:49,385 - src.utils.config - INFO - Loading environment variables
2025-06-11 21:40:49,424 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-11 21:40:49,425 - src.core.analysis - INFO - Validating input DataFrames
2025-06-11 21:40:49,556 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:40:49,557 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 21:40:49,558 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 21:40:49,558 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-11 21:40:49,559 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-11 21:40:49,569 - src.core.analysis - INFO - User IDs from user_details: 206
2025-06-11 21:40:49,570 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-11 21:40:49,570 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-11 21:40:49,571 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-11 21:40:49,571 - src.core.analysis - INFO - Total unique user IDs: 512
2025-06-11 21:40:52,079 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-11 21:40:52,125 - src.core.analysis - INFO - Starting analysis
2025-06-11 21:40:52,125 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-11 21:40:56,728 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-11 21:40:56,729 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-11 21:40:56,730 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-11 21:40:56,731 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-11 21:40:56,732 - src.analysis.anomaly_detector - INFO - User details shape: (206, 10)
2025-06-11 21:40:56,732 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:40:56,733 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5924, 12)
2025-06-11 21:40:56,734 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-11 21:40:56,751 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:40:56,777 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-11 21:40:56,818 - src.analysis.anomaly_detector - INFO - Successfully mapped 5917 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-11 21:40:56,825 - src.analysis.anomaly_detector - INFO - Total mapped users: 206
2025-06-11 21:40:56,826 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-11 21:40:56,827 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-11 21:40:56,827 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-11 21:40:56,828 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-11 21:40:56,828 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-11 21:40:56,829 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-11 21:40:56,830 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-11 21:40:56,830 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-11 21:40:56,831 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-11 21:40:56,831 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-11 21:40:56,832 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-11 21:40:56,833 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-11 21:40:56,833 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-11 21:40:56,834 - src.analysis.anomaly_detector - INFO - Successfully mapped 208 users
2025-06-11 21:40:56,835 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-11 21:40:56,835 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-11 21:40:56,836 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-11 21:40:58,690 - src.analysis.anomaly_detector - INFO - Detected 63 anomalies
2025-06-11 21:40:58,691 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-11 21:40:58,692 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> High sign-in frequency: 2486 sign-ins (avg: 83.4, threshold: 680.6) (Department: Air Arabia NOC); Un...
2025-06-11 21:40:58,693 - src.analysis.anomaly_detector - INFO - Example 2: Ajith Benny -> Unusual location: Delhi, IN at 2025-05-17 13:39:24. Typical: Bengaluru, IN (94.7%) (Department: Para...
2025-06-11 21:40:58,694 - src.analysis.anomaly_detector - INFO - Example 3: Lhakpa Tsheri Sherpa -> Unusual location: Unknown, NP at 2025-06-11 15:17:33. Typical: Kathmandu, NP (77.4%) (Department: Al...
2025-06-11 21:40:58,695 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-11 21:40:59,770 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-11 21:40:59,771 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-11 21:40:59,917 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-11 21:41:00,532 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:41:01,280 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-11 21:41:01,281 - src.core.analysis - INFO - Analyzing inactive users
2025-06-11 21:41:01,281 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-11 21:41:01,282 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-11 21:41:01,283 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-11 21:41:01,298 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 15:44:43+0000', tz='UTC'), Timestamp('2025-06-11 15:17:33+0000', tz='UTC'), Timestamp('2025-06-11 15:14:08+0000', tz='UTC'), Timestamp('2025-06-11 14:15:06+0000', tz='UTC'), Timestamp('2025-06-11 14:14:11+0000', tz='UTC')]
2025-06-11 21:41:01,299 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-11 21:41:01,309 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-13 18:52:49+0000', tz='UTC'), Timestamp('2025-03-13 20:19:13+0000', tz='UTC'), Timestamp('2025-03-13 22:30:19+0000', tz='UTC'), Timestamp('2025-03-13 22:30:24+0000', tz='UTC'), Timestamp('2025-03-13 22:30:29+0000', tz='UTC')]
2025-06-11 21:41:01,310 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-11 21:41:02,003 - src.analysis.inactive_users - INFO - Found 136 inactive users out of 206 total users.
2025-06-11 21:41:02,005 - src.core.analysis - INFO - Total unique user IDs after analysis: 617
2025-06-11 21:41:02,070 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-11 21:41:02,071 - src.core.analysis - INFO - Using chunk size: 200 for 617 users
2025-06-11 21:41:02,073 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-11 21:41:02,075 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-11 21:41:02,078 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 145711 bytes
2025-06-11 21:41:28,785 - src.core.analysis - INFO - Findings chunk 1 completed in 26.71s
2025-06-11 21:41:28,786 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-11 21:41:28,788 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 135862 bytes
2025-06-11 21:41:49,507 - src.core.analysis - INFO - Findings chunk 2 completed in 20.72s
2025-06-11 21:41:49,508 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-11 21:41:49,510 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 151742 bytes
2025-06-11 21:42:16,193 - src.core.analysis - INFO - Findings chunk 3 completed in 26.68s
2025-06-11 21:42:16,194 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-11 21:42:16,195 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 20710 bytes
2025-06-11 21:43:01,927 - src.core.analysis - INFO - Findings chunk 4 completed in 45.73s
2025-06-11 21:43:02,044 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-11 21:43:02,045 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-11 21:43:02,046 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-11 21:43:02,047 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-11 21:43:02,050 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-11 21:43:02,051 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-11 21:43:02,053 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-11 21:43:02,055 - src.core.analysis - INFO - Processed 4/4 chunks (95%)
2025-06-11 21:43:02,057 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-11 21:43:02,060 - src.core.analysis - INFO - Sequential processing completed in 119.99s
2025-06-11 21:43:02,061 - src.core.analysis - INFO - Successfully processed 4/4 chunks
2025-06-11 21:43:02,062 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-11 21:43:02,062 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 617 users
2025-06-11 21:43:02,065 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-11 21:43:02,066 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-11 21:43:02,066 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-11 21:43:02,067 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 25737 bytes
2025-06-11 21:43:10,176 - src.core.analysis - INFO - Recommendations chunk 1 completed in 8.11s
2025-06-11 21:43:10,285 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-11 21:43:10,286 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-11 21:43:10,286 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-11 21:43:10,287 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:10,288 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-11 21:43:10,288 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-11 21:43:10,290 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:10,294 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '324595'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f7d29658-46de-11f0-b892-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:11,217 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:11 GMT'
    'ETag': '"0x8DDA902DCD047A8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'dfdb542f-a01e-0017-65eb-da9926000000'
    'x-ms-client-request-id': 'f7d29658-46de-11f0-b892-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:10 GMT'
2025-06-11 21:43:11,218 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-11 21:43:11,220 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-11 21:43:11,221 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:11,241 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f8631c09-46de-11f0-9f38-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:11,700 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:12 GMT'
    'ETag': '"0x8DDA902DD1ADF86"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9b0d9a1c-a01e-005a-77eb-da56ca000000'
    'x-ms-client-request-id': 'f8631c09-46de-11f0-9f38-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:11 GMT'
2025-06-11 21:43:11,701 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-11 21:43:11,702 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-11 21:43:11,703 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:11,727 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f8ad4274-46de-11f0-836a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:12,592 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:12 GMT'
    'ETag': '"0x8DDA902DDA2FE90"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '14e393d3-e01e-0016-35eb-dac6fa000000'
    'x-ms-client-request-id': 'f8ad4274-46de-11f0-836a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:12 GMT'
2025-06-11 21:43:12,593 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-11 21:43:12,594 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-11 21:43:12,596 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:12,625 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f9364537-46de-11f0-a37b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:13,109 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:13 GMT'
    'ETag': '"0x8DDA902DDF1FE4D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ca2307ee-601e-0055-45eb-da20a6000000'
    'x-ms-client-request-id': 'f9364537-46de-11f0-a37b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:13 GMT'
2025-06-11 21:43:13,110 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-11 21:43:13,113 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-11 21:43:13,114 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:13,136 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f9843e9b-46de-11f0-86f7-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:13,656 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:14 GMT'
    'ETag': '"0x8DDA902DE4565E6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '654dcd13-b01e-0024-48eb-dac68d000000'
    'x-ms-client-request-id': 'f9843e9b-46de-11f0-86f7-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:13 GMT'
2025-06-11 21:43:13,658 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-11 21:43:13,660 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-11 21:43:13,661 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:13,690 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1978862'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f9d8b9f3-46de-11f0-84cd-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:14,633 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:15 GMT'
    'ETag': '"0x8DDA902DED84E4C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f4a76dd6-501e-0071-26eb-dad606000000'
    'x-ms-client-request-id': 'f9d8b9f3-46de-11f0-84cd-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:14 GMT'
2025-06-11 21:43:14,635 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-11 21:43:14,636 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-11 21:43:14,638 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:14,671 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fa6e74a0-46de-11f0-8c3b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:16,970 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:17 GMT'
    'ETag': '"0x8DDA902E02C2730"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fb6ba4e3-401e-0052-32eb-da4cc5000000'
    'x-ms-client-request-id': 'fa6e74a0-46de-11f0-8c3b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:16 GMT'
2025-06-11 21:43:16,972 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-11 21:43:16,974 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-11 21:43:16,975 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:16,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fbd18cab-46de-11f0-863f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:17,289 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:17 GMT'
    'ETag': '"0x8DDA902E06FC20A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9f59af47-301e-0005-3feb-dae2f6000000'
    'x-ms-client-request-id': 'fbd18cab-46de-11f0-863f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:17 GMT'
2025-06-11 21:43:17,291 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-11 21:43:17,292 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-11 21:43:17,293 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:17,315 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fc01d5cb-46de-11f0-a6a8-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:17,607 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:18 GMT'
    'ETag': '"0x8DDA902E0A0388B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '46da63b4-801e-0010-08eb-daf545000000'
    'x-ms-client-request-id': 'fc01d5cb-46de-11f0-a6a8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:17 GMT'
2025-06-11 21:43:17,609 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-11 21:43:17,611 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-11 21:43:17,612 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:17,642 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fc33c55e-46de-11f0-9d2c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:18,065 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:18 GMT'
    'ETag': '"0x8DDA902E0E61ABE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5fa24901-101e-0094-04eb-da8744000000'
    'x-ms-client-request-id': 'fc33c55e-46de-11f0-9d2c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:18 GMT'
2025-06-11 21:43:18,066 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-11 21:43:18,067 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-11 21:43:18,069 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:18,087 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fc77b8c9-46de-11f0-8506-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:18,543 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:18 GMT'
    'ETag': '"0x8DDA902E12EDFE9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '21618d4c-601e-00a1-6ceb-daeb50000000'
    'x-ms-client-request-id': 'fc77b8c9-46de-11f0-8506-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:18 GMT'
2025-06-11 21:43:18,544 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-11 21:43:18,545 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-11 21:43:18,547 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:18,568 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fcc125f7-46de-11f0-95c9-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:19,417 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:19 GMT'
    'ETag': '"0x8DDA902E1B469CE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '075cbbe5-f01e-00b3-70eb-da9080000000'
    'x-ms-client-request-id': 'fcc125f7-46de-11f0-95c9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:18 GMT'
2025-06-11 21:43:19,418 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-11 21:43:19,420 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-11 21:43:19,421 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:19,449 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fd4779fa-46de-11f0-a297-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:21,401 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:21 GMT'
    'ETag': '"0x8DDA902E2E3312B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8f03fa5a-901e-0041-54eb-da68c9000000'
    'x-ms-client-request-id': 'fd4779fa-46de-11f0-a297-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:21 GMT'
2025-06-11 21:43:21,403 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-11 21:43:21,404 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-11 21:43:21,406 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:21,424 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fe74e142-46de-11f0-ad97-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:21,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:22 GMT'
    'ETag': '"0x8DDA902E31B4032"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '59bd108d-f01e-009c-0beb-da9d4b000000'
    'x-ms-client-request-id': 'fe74e142-46de-11f0-ad97-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:21 GMT'
2025-06-11 21:43:21,770 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-11 21:43:21,772 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-11 21:43:21,773 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:21,794 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fead58c7-46de-11f0-a926-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:22,238 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:22 GMT'
    'ETag': '"0x8DDA902E362F51D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ded83824-801e-00a9-2feb-daf15f000000'
    'x-ms-client-request-id': 'fead58c7-46de-11f0-a926-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:22 GMT'
2025-06-11 21:43:22,239 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-11 21:43:22,240 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-11 21:43:22,242 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:22,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fef55924-46de-11f0-99b0-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:22,706 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:23 GMT'
    'ETag': '"0x8DDA902E3AA355D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ceab8ac0-001e-006c-53eb-dadbba000000'
    'x-ms-client-request-id': 'fef55924-46de-11f0-99b0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:22 GMT'
2025-06-11 21:43:22,708 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-11 21:43:22,709 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-11 21:43:22,710 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:22,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ff3e0388-46de-11f0-a021-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:23,248 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:23 GMT'
    'ETag': '"0x8DDA902E3FD2846"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e41773d9-001e-0043-2aeb-dad671000000'
    'x-ms-client-request-id': 'ff3e0388-46de-11f0-a021-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:23 GMT'
2025-06-11 21:43:23,250 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-11 21:43:23,251 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-11 21:43:23,252 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:23,277 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108248'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ff8fa858-46de-11f0-ae27-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:23,825 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:24 GMT'
    'ETag': '"0x8DDA902E454F7BB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '390cb042-d01e-0050-7aeb-daf27d000000'
    'x-ms-client-request-id': 'ff8fa858-46de-11f0-ae27-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:23 GMT'
2025-06-11 21:43:23,826 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-11 21:43:23,827 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-11 21:43:23,829 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-11 21:43:23,850 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ffe700f1-46de-11f0-8a7f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:24,332 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:24 GMT'
    'ETag': '"0x8DDA902E4A2728B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c3819797-001e-0053-6eeb-da1319000000'
    'x-ms-client-request-id': 'ffe700f1-46de-11f0-8a7f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:24 GMT'
2025-06-11 21:43:24,334 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-11 21:43:34,419 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-11 21:43:34,449 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-11 21:43:35,390 - main - INFO - [analyze] Analysis completed.
2025-06-11 21:43:35,529 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-11 21:43:35,569 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '385911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '06e338f7-46df-11f0-b47f-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:36,163 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:36 GMT'
    'ETag': '"0x8DDA902EBAF6BC9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eea71-601e-0027-5eeb-da27e9000000'
    'x-ms-client-request-id': '06e338f7-46df-11f0-b47f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:36 GMT'
2025-06-11 21:43:36,166 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '073e6307-46df-11f0-827c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:36,252 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:36 GMT'
    'ETag': '"0x8DDA902EBBD180D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eea76-601e-0027-62eb-da27e9000000'
    'x-ms-client-request-id': '073e6307-46df-11f0-827c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:36 GMT'
2025-06-11 21:43:36,255 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '074bf7aa-46df-11f0-a305-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:36,363 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:36 GMT'
    'ETag': '"0x8DDA902EBCDCE25"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eea77-601e-0027-63eb-da27e9000000'
    'x-ms-client-request-id': '074bf7aa-46df-11f0-a305-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:36 GMT'
2025-06-11 21:43:36,368 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '075d178b-46df-11f0-8b56-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:36,451 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:36 GMT'
    'ETag': '"0x8DDA902EBDBA14C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eea7b-601e-0027-67eb-da27e9000000'
    'x-ms-client-request-id': '075d178b-46df-11f0-8b56-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:36 GMT'
2025-06-11 21:43:36,455 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '076a6941-46df-11f0-81f3-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:36,551 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:36 GMT'
    'ETag': '"0x8DDA902EBEAD278"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eea7f-601e-0027-6beb-da27e9000000'
    'x-ms-client-request-id': '076a6941-46df-11f0-81f3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:36 GMT'
2025-06-11 21:43:36,557 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1978862'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '077a0647-46df-11f0-91c8-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:37,078 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:37 GMT'
    'ETag': '"0x8DDA902EC3ABB83"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eea81-601e-0027-6deb-da27e9000000'
    'x-ms-client-request-id': '077a0647-46df-11f0-91c8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:37 GMT'
2025-06-11 21:43:37,090 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '07cb5b00-46df-11f0-8214-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:39,262 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:39 GMT'
    'ETag': '"0x8DDA902ED87BE52"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eea8c-601e-0027-77eb-da27e9000000'
    'x-ms-client-request-id': '07cb5b00-46df-11f0-8214-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:39 GMT'
2025-06-11 21:43:39,268 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '09179fb9-46df-11f0-864c-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:39,340 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:39 GMT'
    'ETag': '"0x8DDA902ED943372"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeace-601e-0027-22eb-da27e9000000'
    'x-ms-client-request-id': '09179fb9-46df-11f0-864c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:39 GMT'
2025-06-11 21:43:39,344 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '09233d96-46df-11f0-aa8b-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:39,434 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:39 GMT'
    'ETag': '"0x8DDA902ED9FBF35"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eead3-601e-0027-26eb-da27e9000000'
    'x-ms-client-request-id': '09233d96-46df-11f0-aa8b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:39 GMT'
2025-06-11 21:43:39,438 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0931aed8-46df-11f0-bd3a-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:39,521 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:39 GMT'
    'ETag': '"0x8DDA902EDAF3E2F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eead7-601e-0027-2aeb-da27e9000000'
    'x-ms-client-request-id': '0931aed8-46df-11f0-bd3a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:39 GMT'
2025-06-11 21:43:39,525 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '093ee9a7-46df-11f0-90d6-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:39,626 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:40 GMT'
    'ETag': '"0x8DDA902EDBC9CA7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eead9-601e-0027-2ceb-da27e9000000'
    'x-ms-client-request-id': '093ee9a7-46df-11f0-90d6-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:39 GMT'
2025-06-11 21:43:39,630 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '094ef72e-46df-11f0-8085-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:40,078 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:40 GMT'
    'ETag': '"0x8DDA902EE045196"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeada-601e-0027-2deb-da27e9000000'
    'x-ms-client-request-id': '094ef72e-46df-11f0-8085-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:40 GMT'
2025-06-11 21:43:40,086 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0994835f-46df-11f0-8b13-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:41,448 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:41 GMT'
    'ETag': '"0x8DDA902EED3FE9F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeadd-601e-0027-2feb-da27e9000000'
    'x-ms-client-request-id': '0994835f-46df-11f0-8b13-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:41 GMT'
2025-06-11 21:43:41,454 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40480'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0a65298f-46df-11f0-b93e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:41,526 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:41 GMT'
    'ETag': '"0x8DDA902EEE21F91"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeaf8-601e-0027-47eb-da27e9000000'
    'x-ms-client-request-id': '0a65298f-46df-11f0-b93e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:41 GMT'
2025-06-11 21:43:41,530 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0a70d8d1-46df-11f0-91cd-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:41,617 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:42 GMT'
    'ETag': '"0x8DDA902EEEFF2BC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeafb-601e-0027-4aeb-da27e9000000'
    'x-ms-client-request-id': '0a70d8d1-46df-11f0-91cd-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:41 GMT'
2025-06-11 21:43:41,622 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0a7ec932-46df-11f0-b4e5-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:41,702 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:42 GMT'
    'ETag': '"0x8DDA902EEFCB5A1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeafd-601e-0027-4ceb-da27e9000000'
    'x-ms-client-request-id': '0a7ec932-46df-11f0-b4e5-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:41 GMT'
2025-06-11 21:43:41,705 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0a8b94fe-46df-11f0-b694-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:41,800 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:42 GMT'
    'ETag': '"0x8DDA902EF0A141A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeaff-601e-0027-4eeb-da27e9000000'
    'x-ms-client-request-id': '0a8b94fe-46df-11f0-b694-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:41 GMT'
2025-06-11 21:43:41,805 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '108248'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0a9ac0ac-46df-11f0-a183-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:41,896 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:42 GMT'
    'ETag': '"0x8DDA902EF1A7C68"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeb01-601e-0027-50eb-da27e9000000'
    'x-ms-client-request-id': '0a9ac0ac-46df-11f0-a183-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:41 GMT'
2025-06-11 21:43:41,900 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0aa94fcc-46df-11f0-a95e-ec4c8c6ceba6'
A body is sent with the request
2025-06-11 21:43:41,987 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Wed, 11 Jun 2025 16:13:42 GMT'
    'ETag': '"0x8DDA902EF287674"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c75eeb0a-601e-0027-57eb-da27e9000000'
    'x-ms-client-request-id': '0aa94fcc-46df-11f0-a95e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Wed, 11 Jun 2025 16:13:42 GMT'
2025-06-12 13:28:56,359 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 13:28:56,413 - main - INFO - FastAPI application shutdown
2025-06-12 13:29:25,657 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 13:29:47,370 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 13:29:47,371 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 13:29:47,373 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 13:29:47,377 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 13:29:47,377 - main - INFO - FastAPI application started
2025-06-12 13:29:47,379 - d365 - INFO - Loading D365 data
2025-06-12 13:29:47,380 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:29:47,643 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ed3e8c87-6711-41f7-8244-a68f48ca7b01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 07:59:48 GMT'
    'Content-Length': '1753'
2025-06-12 13:29:47,654 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:29:47,883 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7d62a363-ef6e-43ae-9ae7-d64db88ff100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 07:59:48 GMT'
    'Content-Length': '1647'
2025-06-12 13:29:47,884 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:29:47,887 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 13:29:47,888 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-14T07:59:47Z)
2025-06-12 13:29:53,273 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-12 13:29:56,384 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-12 13:30:00,224 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-12 13:30:04,729 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-12 13:30:09,375 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-12 13:30:14,011 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-12 13:30:15,590 - d365 - INFO - Progress: Fetched 31927 audit logs after 7 pages
2025-06-12 13:30:15,640 - d365 - INFO - Fetched 31927 D365 audit logs via Dataverse
2025-06-12 13:30:15,763 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-12 13:30:15,772 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:30:15,982 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '37f4fe07-48c7-4aa6-bb7a-0828f6b3bd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:16 GMT'
    'Content-Length': '1753'
2025-06-12 13:30:15,984 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:30:16,175 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2103c012-8985-4820-b2a9-d29d666eee00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:16 GMT'
    'Content-Length': '1996'
2025-06-12 13:30:16,176 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:30:16,177 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 13:30:16,177 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-14T08:00:16Z)
2025-06-12 13:30:16,178 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-12 13:30:36,368 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime ge 2025-03-14T08:00:16Z and appId eq 'a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a': HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-12 13:30:36,373 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime ge 2025-03-14T08:00:16Z and appId eq 'a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a': HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-12 13:30:36,381 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-12 13:30:36,678 - d365 - INFO - Loaded 5924 sign-in logs from CSV
2025-06-12 13:30:36,680 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:30:36,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd105a9c9-f5b1-45a2-819d-419dc5b67001'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:37 GMT'
    'Content-Length': '1753'
2025-06-12 13:30:36,960 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:30:37,202 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2cca4cba-9a22-42d9-ab53-9054f4adeb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:37 GMT'
    'Content-Length': '1651'
2025-06-12 13:30:37,214 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:30:37,227 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 13:30:37,239 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:30:37,548 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a47aab75-cc1d-41da-8794-ab686a20fe00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:38 GMT'
    'Content-Length': '1753'
2025-06-12 13:30:37,557 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:30:37,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ab1cccb3-4048-4469-8baa-258012750601'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:38 GMT'
    'Content-Length': '1996'
2025-06-12 13:30:37,780 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:30:37,792 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 13:30:37,810 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:30:38,214 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '51820b58-1621-416b-9aa6-4a0dcc21a400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:38 GMT'
    'Content-Length': '1753'
2025-06-12 13:30:38,259 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:30:38,547 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4688c5b6-ca7e-409d-aa9a-dbc6645c4401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:00:39 GMT'
    'Content-Length': '1997'
2025-06-12 13:30:38,551 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:30:38,556 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 13:30:42,510 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-12 13:30:42,513 - d365 - INFO - Found 975 users in Entra ID
2025-06-12 13:30:43,928 - d365 - INFO - Fetched 934 user records from D365
2025-06-12 13:31:53,909 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-12 13:31:53,910 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-12 13:32:35,825 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-12 13:32:35,827 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-12 13:32:38,655 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-12 13:32:38,656 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-12 13:32:43,710 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-12 13:32:43,711 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-12 13:33:44,360 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-12 13:33:44,361 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-12 13:34:31,906 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-12 13:34:31,908 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-12 13:35:02,366 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-12 13:35:02,367 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-12 13:36:11,070 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-12 13:36:11,070 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-12 13:36:11,071 - d365 - INFO - Final user count after filtering: 205
2025-06-12 13:36:11,086 - d365 - INFO - Fetched 205 user details after filtering
2025-06-12 13:36:11,110 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-12 13:36:11,122 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-12 13:36:11,131 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-12 13:36:11,148 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:36:11,302 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0c984c9f-f34c-4d81-a900-f02eeb88e500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:11 GMT'
    'Content-Length': '1753'
2025-06-12 13:36:11,309 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:36:11,513 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '01ed969b-e644-4963-befb-0bd9d3e41f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:11 GMT'
    'Content-Length': '1647'
2025-06-12 13:36:11,515 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:36:11,515 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 13:36:13,535 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-12 13:36:13,543 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-12 13:36:13,546 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:36:13,757 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ff6c616a-0bdb-4f64-ad8d-1c2be31b0501'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:13 GMT'
    'Content-Length': '1753'
2025-06-12 13:36:13,758 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:36:13,934 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd69bccc9-19b8-445b-b37c-fcc4aae40001'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:14 GMT'
    'Content-Length': '1651'
2025-06-12 13:36:13,935 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:36:13,936 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 13:36:16,659 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-12 13:36:16,668 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-12 13:36:16,671 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:36:16,815 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3758b817-787f-4850-83e8-55b9e6c5da00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:17 GMT'
    'Content-Length': '1753'
2025-06-12 13:36:16,817 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:36:16,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3758b817-787f-4850-83e8-55b9eac5da00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:17 GMT'
    'Content-Length': '1997'
2025-06-12 13:36:16,948 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:36:16,949 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 13:36:19,965 - d365 - INFO - Fetched 35 conditional access policies
2025-06-12 13:36:19,969 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-12 13:36:19,970 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 13:36:20,114 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9a15e9d6-13cd-4a5c-9f31-c975e52a1100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:20 GMT'
    'Content-Length': '1753'
2025-06-12 13:36:20,115 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 13:36:20,250 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '34393804-1d17-42ab-88b9-49493f84d900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:06:20 GMT'
    'Content-Length': '1653'
2025-06-12 13:36:20,251 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 13:36:20,252 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 13:36:20,990 - d365 - INFO - Fetched 11 business units
2025-06-12 13:36:20,991 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-12 13:36:21,036 - d365 - INFO - D365 data loaded successfully
2025-06-12 13:36:21,070 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-12 13:36:21,071 - main - INFO - Loading data from CSV files
2025-06-12 13:36:21,155 - main - INFO - Loaded audit_logs with 31927 rows
2025-06-12 13:36:21,219 - main - INFO - Loaded signin_logs with 5924 rows
2025-06-12 13:36:21,229 - main - INFO - Loaded user_details with 205 rows
2025-06-12 13:36:21,239 - main - INFO - Loaded app_roles with 2112 rows
2025-06-12 13:36:21,272 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-12 13:36:21,399 - main - INFO - Created group_memberships with 3288 rows
2025-06-12 13:36:21,474 - main - INFO - Created role_matrix with 2112 rows
2025-06-12 13:36:21,486 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-12 13:36:21,486 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['1f2b9261-b13b-4cee-be32-8721d0a0a8ac', 'bfa5d2b9-f1ec-454e-82e1-9dad0275f657', '183830e5-7716-4f65-820e-79f9be388c9f', 'ef1c2a87-16f1-4b8a-80ea-085461674495', '2e186776-244e-4c01-a4d4-97102c86ff32']...
2025-06-12 13:36:21,487 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['21e8a382-f8bc-ec11-9840-0022489e2e28', '27b5c94e-8533-ec11-b6e6-0022489bd51d', '350b30af-3bc6-eb11-8235-000d3ab68dd4', '066e2276-08aa-eb11-8236-0022489b4c66', 'f23b92b3-76b4-eb11-8236-000d3ab5a61f']...
2025-06-12 13:36:21,488 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-12 13:36:21,553 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-12 13:36:21,556 - src.core.embeddings - INFO - Starting embedding generation
2025-06-12 13:36:21,558 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-12 13:36:21,559 - src.core.embeddings - INFO - Using batch_size=64
2025-06-12 13:36:21,566 - src.core.embeddings - INFO - Using device: cpu
2025-06-12 13:37:10,463 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-12 13:37:15,510 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-12 13:37:15,511 - src.core.embeddings - INFO - Embedding initialization took 53.94 seconds
2025-06-12 13:37:15,512 - src.core.embeddings - INFO - Memory usage: RSS=385.72 MB, VMS=2702.04 MB
2025-06-12 13:37:15,513 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-12 13:37:15,514 - src.core.embeddings - INFO - Using all logs: audit_logs=31927 rows, signin_logs=5924 rows
2025-06-12 13:37:15,521 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-12 13:37:15,558 - src.core.embeddings - INFO - Precomputed location history in 0.04 seconds
2025-06-12 13:37:16,607 - src.core.embeddings - INFO - Text generation took 1.09 seconds
2025-06-12 13:37:16,608 - src.core.embeddings - INFO - Memory usage: RSS=409.89 MB, VMS=2726.52 MB
2025-06-12 13:37:16,609 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-12 13:37:19,721 - src.core.embeddings - INFO - Total documents to embed: 37851
2025-06-12 13:37:19,722 - src.core.embeddings - INFO - Document conversion took 3.11 seconds
2025-06-12 13:37:19,723 - src.core.embeddings - INFO - Memory usage: RSS=439.95 MB, VMS=2756.58 MB
2025-06-12 13:37:19,724 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-12 13:37:19,726 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-12 13:37:32,365 - src.core.embeddings - INFO - Memory usage: RSS=607.18 MB, VMS=2941.02 MB
2025-06-12 13:37:32,366 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-12 13:37:45,479 - src.core.embeddings - INFO - Memory usage: RSS=682.46 MB, VMS=3015.92 MB
2025-06-12 13:37:45,480 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-12 13:37:58,170 - src.core.embeddings - INFO - Memory usage: RSS=757.44 MB, VMS=3090.51 MB
2025-06-12 13:37:58,172 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-12 13:38:10,033 - src.core.embeddings - INFO - Memory usage: RSS=831.18 MB, VMS=3164.71 MB
2025-06-12 13:38:10,034 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-12 13:38:21,883 - src.core.embeddings - INFO - Memory usage: RSS=904.89 MB, VMS=3238.97 MB
2025-06-12 13:38:21,885 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-12 13:38:34,456 - src.core.embeddings - INFO - Memory usage: RSS=978.46 MB, VMS=3312.13 MB
2025-06-12 13:38:34,457 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-12 13:39:03,719 - src.core.embeddings - INFO - Memory usage: RSS=1233.07 MB, VMS=3569.07 MB
2025-06-12 13:39:03,720 - src.core.embeddings - INFO - Embedding chunk 8/8 (2851 documents)
2025-06-12 13:39:25,725 - src.core.embeddings - INFO - Memory usage: RSS=1278.42 MB, VMS=3665.60 MB
2025-06-12 13:39:26,071 - src.core.embeddings - INFO - Embedding generation took 126.35 seconds
2025-06-12 13:39:26,072 - src.core.embeddings - INFO - Memory usage: RSS=1278.42 MB, VMS=3665.60 MB
2025-06-12 13:39:26,073 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-12 13:39:27,016 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37851 vectors
2025-06-12 13:39:28,293 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-12 13:39:28,311 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-12 13:39:28,312 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-12 13:39:28,313 - src.core.embeddings - INFO - FAISS vectorstore creation took 2.24 seconds
2025-06-12 13:39:28,313 - src.core.embeddings - INFO - Memory usage: RSS=1480.43 MB, VMS=4000.25 MB
2025-06-12 13:39:28,325 - src.core.embeddings - INFO - Total embedding generation took 186.77 seconds
2025-06-12 13:39:28,365 - main - INFO - [analyze] Embeddings generated.
2025-06-12 13:39:28,366 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-12 13:39:28,366 - src.utils.config - INFO - Loading environment variables
2025-06-12 13:39:28,397 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-12 13:39:28,397 - src.core.analysis - INFO - Validating input DataFrames
2025-06-12 13:39:28,504 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 13:39:28,504 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 13:39:28,505 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 13:39:28,505 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-12 13:39:28,506 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-12 13:39:28,513 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-12 13:39:28,513 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-12 13:39:28,514 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-12 13:39:28,514 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-12 13:39:28,514 - src.core.analysis - INFO - Total unique user IDs: 511
2025-06-12 13:39:30,230 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-12 13:39:30,256 - src.core.analysis - INFO - Starting analysis
2025-06-12 13:39:30,257 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-12 13:39:33,590 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-12 13:39:33,590 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-12 13:39:33,592 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-12 13:39:33,592 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-12 13:39:33,594 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-12 13:39:33,594 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 13:39:33,595 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5924, 12)
2025-06-12 13:39:33,595 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 13:39:33,604 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-12 13:39:33,618 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-12 13:39:33,643 - src.analysis.anomaly_detector - INFO - Successfully mapped 5917 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-12 13:39:33,648 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-12 13:39:33,648 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-12 13:39:33,649 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-12 13:39:33,649 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-12 13:39:33,650 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-12 13:39:33,650 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-12 13:39:33,651 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-12 13:39:33,651 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-12 13:39:33,652 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-12 13:39:33,652 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-12 13:39:33,653 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-12 13:39:33,653 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-12 13:39:33,653 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-12 13:39:33,654 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-12 13:39:33,654 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-12 13:39:33,655 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-12 13:39:33,655 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-12 13:39:33,655 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-12 13:39:35,231 - src.analysis.anomaly_detector - INFO - Detected 63 anomalies
2025-06-12 13:39:35,232 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-12 13:39:35,233 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> High sign-in frequency: 2486 sign-ins (avg: 83.4, threshold: 680.6) (Department: Air Arabia NOC); Us...
2025-06-12 13:39:35,233 - src.analysis.anomaly_detector - INFO - Example 2: Ajith Benny -> User usually signs in from Bengaluru, IN (94.7%), but on 2025-05-17 signed in from Delhi, IN.; User ...
2025-06-12 13:39:35,234 - src.analysis.anomaly_detector - INFO - Example 3: Lhakpa Tsheri Sherpa -> User usually signs in from Kathmandu, NP (77.4%), but on 2025-06-11 signed in from Unknown, NP.; Use...
2025-06-12 13:39:35,235 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-12 13:39:36,097 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-12 13:39:36,098 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-12 13:39:36,262 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-12 13:39:36,771 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-12 13:39:37,483 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-12 13:39:37,484 - src.core.analysis - INFO - Analyzing inactive users
2025-06-12 13:39:37,485 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-12 13:39:37,486 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 13:39:37,486 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 13:39:37,501 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 15:44:43+0000', tz='UTC'), Timestamp('2025-06-11 15:17:33+0000', tz='UTC'), Timestamp('2025-06-11 15:14:08+0000', tz='UTC'), Timestamp('2025-06-11 14:15:06+0000', tz='UTC'), Timestamp('2025-06-11 14:14:11+0000', tz='UTC')]
2025-06-12 13:39:37,502 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-12 13:39:37,508 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-14 19:06:19+0000', tz='UTC'), Timestamp('2025-03-14 21:43:44+0000', tz='UTC'), Timestamp('2025-03-14 22:30:26+0000', tz='UTC'), Timestamp('2025-03-14 22:31:09+0000', tz='UTC'), Timestamp('2025-03-14 22:31:17+0000', tz='UTC')]
2025-06-12 13:39:37,509 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-12 13:39:38,093 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-12 13:39:38,095 - src.core.analysis - INFO - Total unique user IDs after analysis: 616
2025-06-12 13:39:38,161 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-12 13:39:38,162 - src.core.analysis - INFO - Using chunk size: 200 for 616 users
2025-06-12 13:39:38,164 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-12 13:39:38,167 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-12 13:39:38,168 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 144035 bytes
2025-06-12 13:40:14,079 - src.core.analysis - INFO - Findings chunk 1 completed in 35.91s
2025-06-12 13:40:14,080 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-12 13:40:14,081 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 151350 bytes
2025-06-12 13:40:46,154 - src.core.analysis - INFO - Findings chunk 2 completed in 32.07s
2025-06-12 13:40:46,155 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-12 13:40:46,156 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 139652 bytes
2025-06-12 13:41:14,849 - src.core.analysis - INFO - Findings chunk 3 completed in 28.69s
2025-06-12 13:41:14,849 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-12 13:41:14,850 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 17278 bytes
2025-06-12 13:41:58,208 - src.core.analysis - INFO - Findings chunk 4 completed in 43.36s
2025-06-12 13:41:58,322 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-12 13:41:58,324 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-12 13:41:58,325 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-12 13:41:58,326 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-12 13:41:58,327 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-12 13:41:58,328 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-12 13:41:58,329 - src.core.analysis - WARNING - JSON parsing error: Unterminated string starting at: line 427 column 17 (char 18620). Attempting to fix unterminated string.
2025-06-12 13:41:58,330 - src.core.analysis - ERROR - Failed to parse even after truncation: {
    "underutilized": {
        "e99de6d9-2515-f011-998a-7c1e52362954": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "357a97ad-76b4-eb11-8236-000d3ab5a61f": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "acf332cb-2443-ed11-bba3-0022489ba382": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "31389a7f-9e27-ef11-840a-000d3ab64ef2": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ],
        "7fb153c8-ab7d-ec11-8d21-0022489bef85": [
            "Basic User: No usage in 90 days",
            "Customer service app access: No usage in 90 days",
            "Dynamics 365 App for Outlook User: No usage in 90 days",
            "Environment Maker: No usage in 90 days",
            "PCS BU Manager: No usage in 90 days",
            "PCS Business Development Manager: No usage in 90 days",
            "PCS Country Manager: No usage in 90 days",
            "PCS Management User: No usage in 90 days",
            "PCS Marketing User: No usage in 90 days",
            "PCS Presales User: No usage in 90 days",
            "PCS Renewal Sales: No usage in 90 days",
            "PCS Sales User: No usage in 90 days",
            "Paramount MSS Analyst: No usage in 90 days",
            "Paramount MSS Engineer: No usage in 90 days",
            "Paramount MSS Shift Lead: No usage in 90 days",
            "Paramount Support Admin: No usage in 90 days",
            "Paramount Support Associate: No usage in 90 days",
            "Paramount Support BU Manager: No usage in 90 days",
            "Sales Enterprise app access: No usage in 90 days",
            "System Administrator: No usage in 90 days",
            "System Customizer: No usage in 90 days"
        ]
    },
    "anomalies": {
        "Sridhar Adhikari": "User usually signs in from Kathmandu, NP (54.5%), but recent activity detected from an unknown location.",
        "Sooraj Kovval": "User usually signs in from Dubayy, AE (54.5%), but recent activity detected from an unknown location."
    },
    "mismatches": {
        "Asheesh Shukla": [
            "Has permission 'Sales Enterprise app access', but this is excessive for their assigned role/group (PCS Employees - Qatar).",
            "Permission 'Sales Enterprise app access' assigned but no activity in app 'unknown'."
        ]
    },
    "trends": {
        "low_usage_permissions": "Permissions underutilized across multiple users, particularly in PCS and Paramount roles.",
        "unused_roles": {
            "PCS-Related": [
                "PCS-GRC-LAB-USERS",
                "PCS-LAB-USERS",
                "PCS MSO XDR Monitoring Team",
                "PCS-MSS-MBRHE",
                "PCSUAEBiz",
                "PCS- GII- Infosec Team",
                "PCS-MSS-ALWASL",
                "PCS XDR Monitoring",
                "PCS-MSS-DCAA",
                "PCS-MSS-AIR-ARABIA",
                "PCS- KSA Freelancers",
                "PCS-IT-ADMIN",
                "PCS_UAE-Internal",
                "PCS-MSS-TAMKEEN",
                "PCS-MSS-MIRAL",
                "PCS-ELASTIC-LAB-USERS",
                "PCS-Sentinel",
                "PCS Technical",
                "PCS MSS Team",
                "PCS -LDP",
                "PCS-QAPCO-USERS",
                "PCS-Consulting Services",
                "PCS - Outsourced Team",
                "PCS-ELSATIC-LAB-USERS",
                "PCS-BRM",
                "PCSAIPOLD",
                "PCS Qatar - Delivery",
                "PCS-MSS-BM",
                "PCS-Dubai Culture",
                "PCS Employees - Bahrain",
                "PCS - Ajman Municipality",
                "PCS_Qatar_SOC",
                "PCS Outsourced Team",
                "PCS_Jumaalmajid",
                "PCS Qatar - Presales",
                "PCS AIP Users",
                "PCS Admin",
                "PCS Alfanar Manual Tracker Data",
                "PCS Employees - Saudi",
                "PCS- Kuwait Support",
                "PCS MATRIX",
                "SOC - PCS",
                "PCS-NBK Project Team",
                "PCSKWT",
                "PCS Business Reviews",
                "PCS-Sales",
                "PCS Employees - Kuwait"
            ],
            "Paramount-Related": [
                "Paramount Delivery Team",
                "Paramount global",
                "Paramount Intune Enrolled Users Group",
                "Paramount XDR360 team",
                "Paramount CSR",
                "Paramount Audit",
                "Silver-ParamountMXDR360",
                "Paramount Sales Team",
                "Paramount Awards & Certification"
            ],
            "General": [
                "The Executive Council",
                "Qatar Sales",
                "Submission of Pending TNA Forms",
                "Security Sales Department",
                "IAM Delivery Team",
                "DAG Group - Security Assessment",
                "KFCA IT IOT Assessment",
                "OT - Reading resources",
                "DEWA BCM",
                "SOC MBRHE",
                "Sharing Weekly Internal PPT",
                "SG_Data Security_Users",
                "Microsoft Fasttrack-RFA",
                "Security Operator",
                "Farah",
                "PAM Team",
                "Intune MAM Policy Exclusion",
                "Tamkeen-Data Classification Project",
                "Qatar OPAS",
                "Department_Finance",
                "MSS SOC Team",
                "Department_Administration",
                "Department_OT Security",
                "Microsoft 365 Business Premium Licensed Users",
                "Internship",
                "Weekly Summary - Compliance",
                "SG_Cloud Services_Users",
                "Weekly Sales Report",
                "BUPA Microsoft Security Project",
                "Intune Compliance windows 10",
                "Project Management Office - Consulting",
                "Test Team - SOC",
                "SailPoint Training",
                "Target",
                "MS-Channel",
                "Global Reader",
                "ISO 27001:2022 LA Training",
                "Securus 360",
                "Al-Turki Holding LLC",
                "Department_Marketing",
                "SOC Tamkeen",
                "Emaar Data classification/AIP/FP",
                "Team Bahrain",
                "Alpheya_Sentinel_Soc",
                "Conditional Access: Risky sign-in multifactor authentication (a4ea6c0f-b8fb-4d29-91f1-9f8cf0601e98)",
                "CyberNxt - Dashboard",
                "Data Privacy",
                "SCS-Employee",
                "SOC Banque Misr",
                "Intune MAM light Policy",
                "Scope Investment",
                "Presales_TechMSS",
                "Teams_Group_MSO_EDGE",
                "OT-D-A-V-S",
                "SG_Sales_Users",
                "RLS-Project Plan",
                "Department_Data Security",
                "Paramout-KSA",
                "SG_Management_Users",
                "Consulting-Presales",
                "NBF- AIP Project",
                "Department_Renewals - Core Security",
                "Finance Team",
                "Billing Details",
                "Salama Insurance - Consulting",
                "SG_Infrastructure Security_Users",
                "IT Test",
                "Qatar CSR",
                "Fifa game test",
                "Microsoft 365 Business Basic Licensed Users",
                "DC-SOC",
                "Team Qatar",
                "ISO Delivery",
                "MSS-EDGE",
                "Qatar -Presales",
                "DHA Offshore SOC Team",
                "HR-ConfidentialLabel",
                "KSA Invoicing",
                "Partnership Kuwait",
                "Dynamics 365 Sales",
                "SG_Renewals- Core Security_Users",
                "Intune MAM & Defender",
                "Support_CVOwners_3402C73A-EB24-4FDC-A5AE-2DCA9E99CBE7",
                "Team Kuwait",
                "Corporate Governing Council",
                "Presales - OT Security",
                "CSNxxT-Employees",
                "Mashreq Data Classification Project",
                "SOC - Scope Investment",
                "DHA Sentinel Offshore",
                "Azure Information Protection Administrator",
                "STC Project",
                "SCT Project Delivery",
                "Teams_Group_KYNDRYL",
                "Ahlan Cyber -Presales",
                "Department_MSS",
                "KIB_GRC",
                "Excellence Driving Centre",
                "MSS Security Advisory",
                "Internship 2024",
                "sales group",
                "IGA Project",
                "Group_core_security",
                "KFCA IT-IoT Assessment",
                "MSS-ABG",
                "Cloud Sec Documents",
                "PartnerCenter_MPNAdmin",
                "Teams_Group_Qatar_proposals",
                "Cloud Services Team",
                "Intune App Testing",
                "Global Administrator",
                "MRM Submission 2024",
                "Miral SOC Group",
                "SG_MSS_Users",
                "4.x- Schneider-OT",
                "FP&A",
                "AKI_SOC",
                "User Administrator",
                "RLS-Project-Group",
                "Alpheya_Sentinel_Siem_Admins",
                "SG_Staffing Solutions_Users",
                "Learning Plan",
                "Sales Assistant",
                "Infra Security BU",
                "Order Booking",
                "Talent Acquisition",
                "KSA Region-Internal",
                "CyberNxt - Talent Cloud",
                "MSS-EWEC-Admin",
                "Coresecurity/Tech Projects",
                "Sentinel Documents",
                "Microsoft Projects",
                "Global PMO CoE",
                "Microsoft Elite",
                "Daily Tasks",
                "Ahlan Cyber Knowledge Base",
                "Department_Staffing Solutions",
                "Sentinel Projects",
                "Microsoft 365 Business Standard Licensed Users",
                "IAM Projects",
                "DLP Flow test",
                "Pre-Sales - Consulting",
                "Gulf Islamic Investment (GII)",
                "Department_IAM",
                "Department_Data Privacy",
                "CybersecurityNxxT Team",
                "AUB Project Files",
                "altaf",
                "Edge week and month report",
                "From GulfIT- QNB CLM Keyfacotr",
                "MSS-EWEC-SOC",
                "Dynamics 365 Administrator",
                "Department_Consulting Services",
                "Mashreq Archer Implementation",
                "MyITBuddy",
                "BFSI and O&G",
                "Bahrain Support",
                "EDGE Service Delivery",
                "Data Protection Cloud Services",
                "MSS-DCAA",
                "Intune Enroll Excluded Users",
                "HelpdeskAgents",
                "Power BI Administrator",
                "Cybersecurity NxxT Team",
                "Microsoft Core Team",
                "PMO",
                "SALES TEAM - BAHRAIN",
                "Teams_Group_MSS_projects",
                "Team MSS",
                "CISCO FIFA RFP",
                "SG_GRC_Users",
                "SOC Notification",
                "DATA SECURITY TEAM",
                "ahalnees",
                "Ahlanees",
                "Network Security Champs!",
                "Content Management Group",
                "Office 365 Security",
                "Department_Cloud Services",
                "Qatar SOC 2 Audit",
                "Evanssion Visit",
                "Dubai Metro Blue Line",
                "Ahlan Cyber - OPAS",
                "Resource Management",
                "Teams_Group_FARAH EXPERIENCES",
                "COO conversations",
                "IAM - Presales",
                "IAM Projects - Test",
                "Dukhan Bank IAM Assessment",
                "Flyadeal - Data Classification_Privacy_DLP Phase 1",
                "SG_Administration_Users",
                "KAFD Project",
                "CISSP Training 2021",
                "Sales-UAE",
                "Testing",
                "Communication compliance",
                "Daman Project",
                "Business Excellence",
                "IDO Meeting RAK",
                "KIB_GROUP",
                "6clicks-role-Administrator",
                "Project Status",
                "MSS-JAMG",
                "customer facing employees",
                "Pcs DLP Policy Group",
                "Security Co-Pilot",
                "Critical Infra Security- D-A-V-S",
                "Dukhan Bank IAM assessment project",
                "Department_GRC",
                "SentinelSME",
                "Project1 PLAN",
                "Woqod - Qatar Fuel",
                "SG_Finance_Users",
                "IDAM Team",
                "Identity Workshop",
                "Team Kuwait Projects",
                "Microsoft 365 E5 Licensed Users",
                "CA002 Policy exclusion -  non admins",
                "MSS-SOC-Sentinel-India",
                "Ahlan Sales",
                "SG_Consulting Services_Users",
                "SG_Data Privacy_Users",
                "MSS-ALFANAR",
                "SG_OT Security_Users",
                "Department_Infrastructure Security",
                "MOCA",
                "Department_Sales",
                "Test RLS-Project plan",
                "NBO Project",
                "FortiGate SSL VPN Access",
                "M365 Copilot",
                "Department_Management",
                "LetsDefend SOC Alerts",
                "Cloud Security",
                "
2025-06-12 13:41:58,341 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-12 13:41:58,341 - src.core.analysis - ERROR - Missing expected keys ['underutilized', 'anomalies', 'mismatches', 'trends', 'inactive'] in chunk 4 response: {}
2025-06-12 13:41:58,342 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-12 13:41:58,342 - src.core.analysis - INFO - Sequential processing completed in 140.18s
2025-06-12 13:41:58,343 - src.core.analysis - INFO - Successfully processed 3/4 chunks
2025-06-12 13:41:58,344 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-12 13:41:58,344 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 616 users
2025-06-12 13:41:58,346 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-12 13:41:58,347 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-12 13:41:58,348 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-12 13:41:58,349 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 12395 bytes
2025-06-12 13:42:08,018 - src.core.analysis - INFO - Recommendations chunk 1 completed in 9.67s
2025-06-12 13:42:08,123 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-12 13:42:08,124 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-12 13:42:08,125 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-12 13:42:08,125 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:08,129 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-12 13:42:08,129 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-12 13:42:08,131 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:08,154 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '385911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef0f40c6-4764-11f0-b50b-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:09,168 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:09 GMT'
    'ETag': '"0x8DDA988D4541854"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '595d4288-001e-0088-5e71-dbd524000000'
    'x-ms-client-request-id': 'ef0f40c6-4764-11f0-b50b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:09 GMT'
2025-06-12 13:42:09,170 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-12 13:42:09,171 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-12 13:42:09,172 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:09,175 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'efab1471-4764-11f0-bd98-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:09,787 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:10 GMT'
    'ETag': '"0x8DDA988D4B579E5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a33702bd-301e-0058-6071-dbe872000000'
    'x-ms-client-request-id': 'efab1471-4764-11f0-bd98-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:10 GMT'
2025-06-12 13:42:09,788 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-12 13:42:09,788 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-12 13:42:09,791 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:09,811 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f00c0b11-4764-11f0-be8f-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:10,918 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:11 GMT'
    'ETag': '"0x8DDA988D561258C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '194169d0-b01e-000b-8071-dbcb46000000'
    'x-ms-client-request-id': 'f00c0b11-4764-11f0-be8f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:11 GMT'
2025-06-12 13:42:10,919 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-12 13:42:10,920 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-12 13:42:10,921 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:10,927 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f0b65ab4-4764-11f0-9895-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:11,414 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:12 GMT'
    'ETag': '"0x8DDA988D5AE5294"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3d9d8598-c01e-00a8-4a71-dbae83000000'
    'x-ms-client-request-id': 'f0b65ab4-4764-11f0-9895-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:12 GMT'
2025-06-12 13:42:11,415 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-12 13:42:11,418 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-12 13:42:11,419 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:11,438 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f1044dad-4764-11f0-8fe8-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:12,082 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:12 GMT'
    'ETag': '"0x8DDA988D613CE42"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8baaaae8-401e-007d-7671-db410e000000'
    'x-ms-client-request-id': 'f1044dad-4764-11f0-8fe8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:12 GMT'
2025-06-12 13:42:12,083 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-12 13:42:12,084 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-12 13:42:12,085 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:12,092 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979544'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f1683ca9-4764-11f0-8b54-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:14,593 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:15 GMT'
    'ETag': '"0x8DDA988D7931A17"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '460e08c1-c01e-0087-4071-dba348000000'
    'x-ms-client-request-id': 'f1683ca9-4764-11f0-8b54-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:14 GMT'
2025-06-12 13:42:14,595 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-12 13:42:14,595 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-12 13:42:14,596 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:14,619 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f2e9c2dd-4764-11f0-9861-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:21,893 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:22 GMT'
    'ETag': '"0x8DDA988DBED231A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6138ab00-201e-0019-6371-dbb096000000'
    'x-ms-client-request-id': 'f2e9c2dd-4764-11f0-9861-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:22 GMT'
2025-06-12 13:42:21,896 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-12 13:42:21,897 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-12 13:42:21,899 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:21,913 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f742c617-4764-11f0-8ea1-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:22,326 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:23 GMT'
    'ETag': '"0x8DDA988DC2D8D3C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a2b465e2-a01e-0028-7071-db5185000000'
    'x-ms-client-request-id': 'f742c617-4764-11f0-8ea1-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:22 GMT'
2025-06-12 13:42:22,327 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-12 13:42:22,328 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-12 13:42:22,329 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:22,346 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f784e165-4764-11f0-825c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:22,702 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:23 GMT'
    'ETag': '"0x8DDA988DC67BCC5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '303ea1b0-801e-0000-3c71-db302d000000'
    'x-ms-client-request-id': 'f784e165-4764-11f0-825c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:23 GMT'
2025-06-12 13:42:22,704 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-12 13:42:22,705 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-12 13:42:22,706 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:22,719 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f7bdc459-4764-11f0-b139-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:23,187 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:23 GMT'
    'ETag': '"0x8DDA988DCB11D77"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '81dec382-501e-0013-1c71-db1421000000'
    'x-ms-client-request-id': 'f7bdc459-4764-11f0-b139-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:23 GMT'
2025-06-12 13:42:23,188 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-12 13:42:23,189 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-12 13:42:23,198 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:23,222 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f80a7021-4764-11f0-878f-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:24,101 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:24 GMT'
    'ETag': '"0x8DDA988DD3C6D2E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '39202187-c01e-0011-2e71-dbaa99000000'
    'x-ms-client-request-id': 'f80a7021-4764-11f0-878f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:24 GMT'
2025-06-12 13:42:24,102 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-12 13:42:24,103 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-12 13:42:24,105 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:24,115 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f892c259-4764-11f0-a596-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:27,762 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:28 GMT'
    'ETag': '"0x8DDA988DF6CB5D9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2cbcbfa7-001e-0098-5c71-db104c000000'
    'x-ms-client-request-id': 'f892c259-4764-11f0-a596-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:27 GMT'
2025-06-12 13:42:27,763 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-12 13:42:27,771 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-12 13:42:27,773 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:27,795 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fac42f9b-4764-11f0-979c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:35,305 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:36 GMT'
    'ETag': '"0x8DDA988E3EAE721"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a3bd7813-b01e-008d-7571-db07ff000000'
    'x-ms-client-request-id': 'fac42f9b-4764-11f0-979c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:35 GMT'
2025-06-12 13:42:35,307 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-12 13:42:35,308 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-12 13:42:35,309 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:35,314 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ff3f933e-4764-11f0-a7b2-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:36,113 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:36 GMT'
    'ETag': '"0x8DDA988E46705AA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8eb4a854-b01e-0079-2971-dbcc09000000'
    'x-ms-client-request-id': 'ff3f933e-4764-11f0-a7b2-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:36 GMT'
2025-06-12 13:42:36,114 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-12 13:42:36,115 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-12 13:42:36,116 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:36,134 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ffbc9e40-4764-11f0-9d72-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:36,580 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:37 GMT'
    'ETag': '"0x8DDA988E4ADD137"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5b65caff-401e-001f-1671-db8329000000'
    'x-ms-client-request-id': 'ffbc9e40-4764-11f0-9d72-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:36 GMT'
2025-06-12 13:42:36,581 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-12 13:42:36,582 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-12 13:42:36,583 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:36,588 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '000207a5-4765-11f0-b502-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:37,068 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:37 GMT'
    'ETag': '"0x8DDA988E4F7F462"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '26abcc37-601e-00b1-3871-db2e38000000'
    'x-ms-client-request-id': '000207a5-4765-11f0-b502-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:37 GMT'
2025-06-12 13:42:37,069 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-12 13:42:37,071 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-12 13:42:37,073 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:37,088 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '004e55d6-4765-11f0-8833-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:37,670 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:38 GMT'
    'ETag': '"0x8DDA988E553424D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '63e25343-901e-00a5-0b71-db6657000000'
    'x-ms-client-request-id': '004e55d6-4765-11f0-8833-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:37 GMT'
2025-06-12 13:42:37,671 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-12 13:42:37,672 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-12 13:42:37,673 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:37,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107661'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '00a84f56-4765-11f0-84d1-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:38,284 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:39 GMT'
    'ETag': '"0x8DDA988E5B2AA50"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '031ac7e4-f01e-001a-4c71-db51f2000000'
    'x-ms-client-request-id': '00a84f56-4765-11f0-84d1-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:38 GMT'
2025-06-12 13:42:38,285 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-12 13:42:38,286 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-12 13:42:38,287 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 13:42:38,305 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0107f689-4765-11f0-b48c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:38,863 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:39 GMT'
    'ETag': '"0x8DDA988E609B73A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bf4b0462-e01e-005b-1871-db0916000000'
    'x-ms-client-request-id': '0107f689-4765-11f0-b48c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:39 GMT'
2025-06-12 13:42:38,864 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-12 13:42:50,605 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-12 13:42:50,638 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-12 13:42:51,423 - main - INFO - [analyze] Analysis completed.
2025-06-12 13:42:51,502 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-12 13:42:51,532 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '339525'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '08ea4c00-4765-11f0-bf2c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:52,227 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:53 GMT'
    'ETag': '"0x8DDA988EDFF2067"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae4a-901e-007e-3571-dba06a000000'
    'x-ms-client-request-id': '08ea4c00-4765-11f0-bf2c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:52 GMT'
2025-06-12 13:42:52,231 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0954dd1e-4765-11f0-9551-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:52,338 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:53 GMT'
    'ETag': '"0x8DDA988EE0F3AF0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae6d-901e-007e-4071-dba06a000000'
    'x-ms-client-request-id': '0954dd1e-4765-11f0-9551-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:52 GMT'
2025-06-12 13:42:52,341 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0965bb47-4765-11f0-ae67-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:52,463 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:53 GMT'
    'ETag': '"0x8DDA988EE22FAE2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae72-901e-007e-4371-dba06a000000'
    'x-ms-client-request-id': '0965bb47-4765-11f0-ae67-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:53 GMT'
2025-06-12 13:42:52,466 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0978d1d9-4765-11f0-8a30-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:52,580 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:53 GMT'
    'ETag': '"0x8DDA988EE33D7E0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae75-901e-007e-4671-dba06a000000'
    'x-ms-client-request-id': '0978d1d9-4765-11f0-8a30-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:53 GMT'
2025-06-12 13:42:52,584 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '098abeda-4765-11f0-a251-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:52,687 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:53 GMT'
    'ETag': '"0x8DDA988EE459E3C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae76-901e-007e-4771-dba06a000000'
    'x-ms-client-request-id': '098abeda-4765-11f0-a251-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:53 GMT'
2025-06-12 13:42:52,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979544'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '099b4ba5-4765-11f0-9e57-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:53,065 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:53 GMT'
    'ETag': '"0x8DDA988EE7E6FC8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae78-901e-007e-4871-dba06a000000'
    'x-ms-client-request-id': '099b4ba5-4765-11f0-9e57-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:53 GMT'
2025-06-12 13:42:53,072 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '09d54401-4765-11f0-ab9c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:54,475 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:55 GMT'
    'ETag': '"0x8DDA988EF57FCE7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae79-901e-007e-4971-dba06a000000'
    'x-ms-client-request-id': '09d54401-4765-11f0-ab9c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:55 GMT'
2025-06-12 13:42:54,480 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0aac055d-4765-11f0-8baf-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:54,563 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:55 GMT'
    'ETag': '"0x8DDA988EF64BFD2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae7e-901e-007e-4c71-dba06a000000'
    'x-ms-client-request-id': '0aac055d-4765-11f0-8baf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:55 GMT'
2025-06-12 13:42:54,566 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0ab94166-4765-11f0-a433-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:54,659 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:55 GMT'
    'ETag': '"0x8DDA988EF71D082"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae80-901e-007e-4e71-dba06a000000'
    'x-ms-client-request-id': '0ab94166-4765-11f0-a433-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:55 GMT'
2025-06-12 13:42:54,663 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0ac80e3b-4765-11f0-80ef-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:54,744 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:55 GMT'
    'ETag': '"0x8DDA988EF812897"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae81-901e-007e-4f71-dba06a000000'
    'x-ms-client-request-id': '0ac80e3b-4765-11f0-80ef-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:55 GMT'
2025-06-12 13:42:54,747 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0ad4cadd-4765-11f0-b93e-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:54,826 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:55 GMT'
    'ETag': '"0x8DDA988EF8D9DB6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae83-901e-007e-5171-dba06a000000'
    'x-ms-client-request-id': '0ad4cadd-4765-11f0-b93e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:55 GMT'
2025-06-12 13:42:54,830 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0ae166f5-4765-11f0-a934-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:54,989 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:55 GMT'
    'ETag': '"0x8DDA988EFA66117"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae86-901e-007e-5471-dba06a000000'
    'x-ms-client-request-id': '0ae166f5-4765-11f0-a934-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:55 GMT'
2025-06-12 13:42:54,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0afb0d64-4765-11f0-be5a-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:56,247 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:57 GMT'
    'ETag': '"0x8DDA988F066417B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae87-901e-007e-5571-dba06a000000'
    'x-ms-client-request-id': '0afb0d64-4765-11f0-be5a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:56 GMT'
2025-06-12 13:42:56,252 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0bba7151-4765-11f0-a9cf-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:56,330 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:57 GMT'
    'ETag': '"0x8DDA988F0732B49"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae91-901e-007e-5c71-dba06a000000'
    'x-ms-client-request-id': '0bba7151-4765-11f0-a9cf-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:56 GMT'
2025-06-12 13:42:56,333 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0bc6d70d-4765-11f0-a448-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:56,413 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:57 GMT'
    'ETag': '"0x8DDA988F07FC750"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae94-901e-007e-5e71-dba06a000000'
    'x-ms-client-request-id': '0bc6d70d-4765-11f0-a448-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:57 GMT'
2025-06-12 13:42:56,417 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0bd39b0f-4765-11f0-bc3b-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:56,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:57 GMT'
    'ETag': '"0x8DDA988F08CD7F9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae95-901e-007e-5f71-dba06a000000'
    'x-ms-client-request-id': '0bd39b0f-4765-11f0-bc3b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:57 GMT'
2025-06-12 13:42:56,502 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0be09f53-4765-11f0-8c5e-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:56,585 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:57 GMT'
    'ETag': '"0x8DDA988F099C1D1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae97-901e-007e-6171-dba06a000000'
    'x-ms-client-request-id': '0be09f53-4765-11f0-8c5e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:57 GMT'
2025-06-12 13:42:56,589 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107661'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0bedd876-4765-11f0-9f8e-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:56,674 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:57 GMT'
    'ETag': '"0x8DDA988F0A7204B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae98-901e-007e-6271-dba06a000000'
    'x-ms-client-request-id': '0bedd876-4765-11f0-9f8e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:57 GMT'
2025-06-12 13:42:56,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0bfb628e-4765-11f0-ac8f-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 13:42:56,761 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 08:12:57 GMT'
    'ETag': '"0x8DDA988F0B4F374"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3264ae9a-901e-007e-6471-dba06a000000'
    'x-ms-client-request-id': '0bfb628e-4765-11f0-ac8f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:12:57 GMT'
2025-06-12 13:42:57,089 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 13:42:57,091 - main - INFO - FastAPI application shutdown
2025-06-12 13:43:18,339 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 13:43:38,448 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 13:43:38,448 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 13:43:38,449 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 13:43:38,450 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 13:43:38,451 - main - INFO - FastAPI application started
2025-06-12 14:20:55,036 - d365 - INFO - Loading D365 data
2025-06-12 14:20:55,040 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:20:55,378 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '057de8be-8857-43e8-863c-682bb7f5d600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:50:55 GMT'
    'Content-Length': '1753'
2025-06-12 14:20:55,397 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:20:55,613 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '51820b58-1621-416b-9aa6-4a0de803a600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:50:55 GMT'
    'Content-Length': '1648'
2025-06-12 14:20:55,614 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:20:55,615 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 14:20:55,616 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-14T08:50:55Z)
2025-06-12 14:21:03,253 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-12 14:21:10,659 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-12 14:21:18,696 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-12 14:21:25,675 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-12 14:21:32,561 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-12 14:21:40,014 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-12 14:21:43,534 - d365 - INFO - Progress: Fetched 31932 audit logs after 7 pages
2025-06-12 14:21:43,569 - d365 - INFO - Fetched 31932 D365 audit logs via Dataverse
2025-06-12 14:21:43,641 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-12 14:21:43,645 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:21:44,020 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '276749cd-c4b0-4b33-9462-3160015a3101'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:51:43 GMT'
    'Content-Length': '1753'
2025-06-12 14:21:44,024 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:21:44,240 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f99357ed-9b92-4549-8a6c-9ef6c00e6700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:51:44 GMT'
    'Content-Length': '1991'
2025-06-12 14:21:44,242 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:21:44,242 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 14:21:44,243 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-14T08:51:44Z)
2025-06-12 14:21:44,243 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-12 14:21:57,853 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 4.4 req/min | Time: 0:00:13
2025-06-12 14:22:18,255 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.5 req/min | Time: 0:00:34
2025-06-12 14:22:32,556 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 3.7 req/min | Time: 0:00:48
2025-06-12 14:22:49,054 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 3.7 req/min | Time: 0:01:04
2025-06-12 14:23:09,565 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-14T08%3a51%3a44Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=1b2ce2328bf8a5777530b9df5ace9d120bd9ea3d866ae4b697a6e3fdad1b37e8: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-12 14:23:09,566 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-14T08%3a51%3a44Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=1b2ce2328bf8a5777530b9df5ace9d120bd9ea3d866ae4b697a6e3fdad1b37e8: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-12 14:23:09,567 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-12 14:23:09,611 - d365 - INFO - Loaded 5924 sign-in logs from CSV
2025-06-12 14:23:09,612 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:23:09,870 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '63e160c0-cb0d-4fd5-9abd-726b68c73900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:53:09 GMT'
    'Content-Length': '1753'
2025-06-12 14:23:09,871 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:23:10,091 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd69bccc9-19b8-445b-b37c-fcc4190d0301'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:53:10 GMT'
    'Content-Length': '1652'
2025-06-12 14:23:10,092 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:23:10,093 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 14:23:10,093 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:23:10,486 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f4a18ff2-6f4c-483a-b280-f1ee467f0401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:53:10 GMT'
    'Content-Length': '1753'
2025-06-12 14:23:10,487 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:23:10,991 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'dad1e203-640f-46d6-8ef6-fa98aac31500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:53:10 GMT'
    'Content-Length': '1992'
2025-06-12 14:23:10,992 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:23:10,993 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 14:23:10,993 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:23:11,311 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9f9ec922-781a-42a3-a8e5-4d9065c52501'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:53:11 GMT'
    'Content-Length': '1753'
2025-06-12 14:23:11,312 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:23:11,584 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2d915ee3-8e0d-437e-bb22-cb2efefd9800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:53:12 GMT'
    'Content-Length': '1992'
2025-06-12 14:23:11,585 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:23:11,587 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 14:23:14,308 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-12 14:23:14,310 - d365 - INFO - Found 975 users in Entra ID
2025-06-12 14:23:16,222 - d365 - INFO - Fetched 934 user records from D365
2025-06-12 14:24:21,591 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-12 14:24:21,592 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-12 14:25:07,906 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-12 14:25:07,907 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-12 14:25:11,099 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-12 14:25:11,101 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-12 14:25:16,051 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-12 14:25:16,052 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-12 14:26:10,864 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-12 14:26:10,865 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-12 14:26:40,702 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-12 14:26:40,706 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-12 14:26:58,574 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-12 14:26:58,576 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-12 14:28:03,639 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-12 14:28:03,641 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-12 14:28:03,642 - d365 - INFO - Final user count after filtering: 205
2025-06-12 14:28:03,675 - d365 - INFO - Fetched 205 user details after filtering
2025-06-12 14:28:03,717 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-12 14:28:03,736 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-12 14:28:03,741 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-12 14:28:03,801 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:28:04,131 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f4a18ff2-6f4c-483a-b280-f1ee18ae0401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:03 GMT'
    'Content-Length': '1753'
2025-06-12 14:28:04,141 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:28:04,376 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f695f606-1f73-4bea-8f27-f977483a2801'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:04 GMT'
    'Content-Length': '1645'
2025-06-12 14:28:04,381 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:28:04,382 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 14:28:06,576 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-12 14:28:06,589 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-12 14:28:06,591 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:28:06,939 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'cd6c300c-358d-4e26-9aed-62b54ccbeb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:07 GMT'
    'Content-Length': '1753'
2025-06-12 14:28:06,940 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:28:07,170 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'cd6c300c-358d-4e26-9aed-62b555cbeb00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:07 GMT'
    'Content-Length': '1651'
2025-06-12 14:28:07,172 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:28:07,172 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 14:28:11,393 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-12 14:28:11,402 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-12 14:28:11,405 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:28:11,654 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ef7c733d-4f5a-4004-bbc2-cc87ca0f1f01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:12 GMT'
    'Content-Length': '1753'
2025-06-12 14:28:11,655 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:28:11,868 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7691a07f-dd03-4919-92f7-ea274e1d7300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:12 GMT'
    'Content-Length': '1992'
2025-06-12 14:28:11,869 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:28:11,869 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 14:28:14,630 - d365 - INFO - Fetched 35 conditional access policies
2025-06-12 14:28:14,636 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-12 14:28:14,639 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 14:28:14,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3449885b-1f12-4a39-9566-35b186354f01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:15 GMT'
    'Content-Length': '1753'
2025-06-12 14:28:15,000 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 14:28:15,248 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3449885b-1f12-4a39-9566-35b18d354f01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 08:58:15 GMT'
    'Content-Length': '1647'
2025-06-12 14:28:15,249 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 14:28:15,250 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 14:28:15,972 - d365 - INFO - Fetched 11 business units
2025-06-12 14:28:15,977 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-12 14:28:16,076 - d365 - INFO - D365 data loaded successfully
2025-06-12 14:28:16,157 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-12 14:28:16,162 - main - INFO - Loading data from CSV files
2025-06-12 14:28:16,332 - main - INFO - Loaded audit_logs with 31932 rows
2025-06-12 14:28:16,379 - main - INFO - Loaded signin_logs with 5924 rows
2025-06-12 14:28:16,393 - main - INFO - Loaded user_details with 205 rows
2025-06-12 14:28:16,402 - main - INFO - Loaded app_roles with 2112 rows
2025-06-12 14:28:16,415 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-12 14:28:16,656 - main - INFO - Created group_memberships with 3289 rows
2025-06-12 14:28:16,826 - main - INFO - Created role_matrix with 2112 rows
2025-06-12 14:28:16,849 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-12 14:28:16,850 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '39a7e1a9-6575-4f38-be71-e743fd54ef91', '236a938b-9c25-43ba-9a64-0549d5b3de1c', '38638d06-9c44-418f-8be6-2247be5924ec', 'd716f427-0faf-4441-9cfa-96b8931e3bca']...
2025-06-12 14:28:16,852 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['41b4c94e-8533-ec11-b6e6-0022489bd51d', '627997ad-76b4-eb11-8236-000d3ab5a61f', '1492dbd6-9c58-ed11-9562-0022489b4de1', '6f8c1c7c-f8bc-ec11-9840-0022489e2e28', '464f568b-197d-ef11-ac21-0022489b4696']...
2025-06-12 14:28:16,852 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-12 14:28:16,940 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-12 14:28:16,946 - src.core.embeddings - INFO - Starting embedding generation
2025-06-12 14:28:16,947 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-12 14:28:16,948 - src.core.embeddings - INFO - Using batch_size=64
2025-06-12 14:28:16,955 - src.core.embeddings - INFO - Using device: cpu
2025-06-12 14:29:11,437 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-12 14:29:17,076 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-12 14:29:17,076 - src.core.embeddings - INFO - Embedding initialization took 60.12 seconds
2025-06-12 14:29:17,078 - src.core.embeddings - INFO - Memory usage: RSS=364.68 MB, VMS=2703.32 MB
2025-06-12 14:29:17,078 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-12 14:29:17,078 - src.core.embeddings - INFO - Using all logs: audit_logs=31932 rows, signin_logs=5924 rows
2025-06-12 14:29:17,088 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-12 14:29:17,124 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-12 14:29:18,203 - src.core.embeddings - INFO - Text generation took 1.12 seconds
2025-06-12 14:29:18,203 - src.core.embeddings - INFO - Memory usage: RSS=388.50 MB, VMS=2727.31 MB
2025-06-12 14:29:18,204 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-12 14:29:21,139 - src.core.embeddings - INFO - Total documents to embed: 37856
2025-06-12 14:29:21,140 - src.core.embeddings - INFO - Document conversion took 2.94 seconds
2025-06-12 14:29:21,141 - src.core.embeddings - INFO - Memory usage: RSS=418.49 MB, VMS=2757.37 MB
2025-06-12 14:29:21,141 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-12 14:29:21,144 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-12 14:29:38,182 - src.core.embeddings - INFO - Memory usage: RSS=586.23 MB, VMS=2942.03 MB
2025-06-12 14:29:38,183 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-12 14:29:53,231 - src.core.embeddings - INFO - Memory usage: RSS=661.50 MB, VMS=3017.09 MB
2025-06-12 14:29:53,232 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-12 14:30:08,929 - src.core.embeddings - INFO - Memory usage: RSS=736.24 MB, VMS=3091.61 MB
2025-06-12 14:30:08,930 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-12 14:30:25,953 - src.core.embeddings - INFO - Memory usage: RSS=809.86 MB, VMS=3165.81 MB
2025-06-12 14:30:25,953 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-12 14:30:41,401 - src.core.embeddings - INFO - Memory usage: RSS=883.94 MB, VMS=3240.46 MB
2025-06-12 14:30:41,401 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-12 14:31:00,451 - src.core.embeddings - INFO - Memory usage: RSS=954.30 MB, VMS=3313.49 MB
2025-06-12 14:31:00,452 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-12 14:31:41,380 - src.core.embeddings - INFO - Memory usage: RSS=1162.28 MB, VMS=3549.32 MB
2025-06-12 14:31:41,381 - src.core.embeddings - INFO - Embedding chunk 8/8 (2856 documents)
2025-06-12 14:32:09,727 - src.core.embeddings - INFO - Memory usage: RSS=1208.31 MB, VMS=3662.55 MB
2025-06-12 14:32:10,140 - src.core.embeddings - INFO - Embedding generation took 169.00 seconds
2025-06-12 14:32:10,141 - src.core.embeddings - INFO - Memory usage: RSS=1208.31 MB, VMS=3662.55 MB
2025-06-12 14:32:10,142 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-12 14:32:11,344 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37856 vectors
2025-06-12 14:32:13,536 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-12 14:32:13,556 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-12 14:32:13,557 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-12 14:32:13,558 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.42 seconds
2025-06-12 14:32:13,559 - src.core.embeddings - INFO - Memory usage: RSS=1413.39 MB, VMS=3997.91 MB
2025-06-12 14:32:13,659 - src.core.embeddings - INFO - Total embedding generation took 236.71 seconds
2025-06-12 14:32:13,775 - main - INFO - [analyze] Embeddings generated.
2025-06-12 14:32:13,777 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-12 14:32:13,777 - src.utils.config - INFO - Loading environment variables
2025-06-12 14:32:13,845 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-12 14:32:13,846 - src.core.analysis - INFO - Validating input DataFrames
2025-06-12 14:32:14,013 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 14:32:14,013 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 14:32:14,014 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 14:32:14,015 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-12 14:32:14,015 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-12 14:32:14,031 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-12 14:32:14,032 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-12 14:32:14,033 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-12 14:32:14,033 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-12 14:32:14,034 - src.core.analysis - INFO - Total unique user IDs: 511
2025-06-12 14:32:17,910 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-12 14:32:17,964 - src.core.analysis - INFO - Starting analysis
2025-06-12 14:32:17,964 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-12 14:32:27,426 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-12 14:32:27,429 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-12 14:32:27,431 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-12 14:32:27,431 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-12 14:32:27,431 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-12 14:32:27,432 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 14:32:27,432 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5924, 12)
2025-06-12 14:32:27,432 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 14:32:27,445 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-12 14:32:27,471 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-12 14:32:27,519 - src.analysis.anomaly_detector - INFO - Successfully mapped 5917 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-12 14:32:27,525 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-12 14:32:27,527 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-12 14:32:27,529 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-12 14:32:27,531 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-12 14:32:27,532 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-12 14:32:27,532 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-12 14:32:27,533 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-12 14:32:27,533 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-12 14:32:27,534 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-12 14:32:27,534 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-12 14:32:27,535 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-12 14:32:27,535 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-12 14:32:27,536 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-12 14:32:27,536 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-12 14:32:27,537 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-12 14:32:27,537 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-12 14:32:27,538 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-12 14:32:27,538 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-12 14:32:30,126 - src.analysis.anomaly_detector - INFO - Detected 63 anomalies
2025-06-12 14:32:30,126 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-12 14:32:30,127 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> User Vikneshkumar Palanisamy had 2486 sign-ins (avg: 83.4, threshold: 680.6) in the period.; User us...
2025-06-12 14:32:30,127 - src.analysis.anomaly_detector - INFO - Example 2: Ajith Benny -> User usually signs in from Bengaluru, IN (94.7%), but on 2025-05-17 signed in from Delhi, IN.; User ...
2025-06-12 14:32:30,128 - src.analysis.anomaly_detector - INFO - Example 3: Lhakpa Tsheri Sherpa -> User usually signs in from Kathmandu, NP (77.4%), but on 2025-06-11 signed in from Unknown, NP.; Use...
2025-06-12 14:32:30,129 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-12 14:32:31,005 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-12 14:32:31,005 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-12 14:32:31,116 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-12 14:32:31,567 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-12 14:32:32,350 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-12 14:32:32,350 - src.core.analysis - INFO - Analyzing inactive users
2025-06-12 14:32:32,351 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-12 14:32:32,351 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 14:32:32,352 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 14:32:32,370 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-11 15:44:43+0000', tz='UTC'), Timestamp('2025-06-11 15:17:33+0000', tz='UTC'), Timestamp('2025-06-11 15:14:08+0000', tz='UTC'), Timestamp('2025-06-11 14:15:06+0000', tz='UTC'), Timestamp('2025-06-11 14:14:11+0000', tz='UTC')]
2025-06-12 14:32:32,371 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-12 14:32:32,382 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-14 19:06:19+0000', tz='UTC'), Timestamp('2025-03-14 21:43:44+0000', tz='UTC'), Timestamp('2025-03-14 22:30:26+0000', tz='UTC'), Timestamp('2025-03-14 22:31:09+0000', tz='UTC'), Timestamp('2025-03-14 22:31:17+0000', tz='UTC')]
2025-06-12 14:32:32,383 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-12 14:32:33,113 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-12 14:32:33,115 - src.core.analysis - INFO - Total unique user IDs after analysis: 616
2025-06-12 14:32:33,174 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-12 14:32:33,175 - src.core.analysis - INFO - Using chunk size: 200 for 616 users
2025-06-12 14:32:33,177 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-12 14:32:33,179 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-12 14:32:33,181 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 140701 bytes
2025-06-12 14:32:53,252 - src.core.analysis - INFO - Findings chunk 1 completed in 20.07s
2025-06-12 14:32:53,253 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-12 14:32:53,257 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 139822 bytes
2025-06-12 14:33:18,864 - src.core.analysis - INFO - Findings chunk 2 completed in 25.61s
2025-06-12 14:33:18,865 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-12 14:33:18,871 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 151178 bytes
2025-06-12 14:33:39,460 - src.core.analysis - INFO - Findings chunk 3 completed in 20.59s
2025-06-12 14:33:39,461 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-12 14:33:39,462 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 20714 bytes
2025-06-12 14:34:07,074 - src.core.analysis - INFO - Findings chunk 4 completed in 27.61s
2025-06-12 14:34:07,189 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-12 14:34:07,191 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-12 14:34:07,191 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-12 14:34:07,192 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-12 14:34:07,193 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-12 14:34:07,194 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-12 14:34:07,194 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-12 14:34:07,195 - src.core.analysis - INFO - Processed 4/4 chunks (95%)
2025-06-12 14:34:07,196 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-12 14:34:07,196 - src.core.analysis - INFO - Sequential processing completed in 94.02s
2025-06-12 14:34:07,197 - src.core.analysis - INFO - Successfully processed 4/4 chunks
2025-06-12 14:34:07,198 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-12 14:34:07,199 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 616 users
2025-06-12 14:34:07,203 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-12 14:34:07,205 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-12 14:34:07,207 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-12 14:34:07,208 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 10996 bytes
2025-06-12 14:34:16,529 - src.core.analysis - INFO - Recommendations chunk 1 completed in 9.32s
2025-06-12 14:34:16,635 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-12 14:34:16,636 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-12 14:34:16,637 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-12 14:34:16,642 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:16,661 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-12 14:34:16,663 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-12 14:34:16,703 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:16,781 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '339525'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '37dc836f-476c-11f0-ad87-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:17,806 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:18 GMT'
    'ETag': '"0x8DDA9901D1BFE78"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4241d1cd-901e-0023-5378-dbaaee000000'
    'x-ms-client-request-id': '37dc836f-476c-11f0-ad87-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:17 GMT'
2025-06-12 14:34:17,822 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-12 14:34:17,825 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-12 14:34:17,828 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:17,871 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3884324b-476c-11f0-ac5a-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:18,361 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:19 GMT'
    'ETag': '"0x8DDA9901D8090DB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2c988cad-201e-0026-6d78-db7835000000'
    'x-ms-client-request-id': '3884324b-476c-11f0-ac5a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:18 GMT'
2025-06-12 14:34:18,363 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-12 14:34:18,364 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-12 14:34:18,365 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:18,390 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '38d35760-476c-11f0-bdb4-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:18,985 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:19 GMT'
    'ETag': '"0x8DDA9901DDEC1DA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'da1fb09f-a01e-0065-1578-db9e69000000'
    'x-ms-client-request-id': '38d35760-476c-11f0-bdb4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:19 GMT'
2025-06-12 14:34:18,986 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-12 14:34:18,994 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-12 14:34:18,996 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:19,020 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '393373cd-476c-11f0-9088-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:19,516 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:20 GMT'
    'ETag': '"0x8DDA9901E307DA2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0d31797b-801e-005d-1878-db3aa9000000'
    'x-ms-client-request-id': '393373cd-476c-11f0-9088-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:19 GMT'
2025-06-12 14:34:19,517 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-12 14:34:19,518 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-12 14:34:19,520 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:19,547 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3983da1c-476c-11f0-a716-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:20,110 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:20 GMT'
    'ETag': '"0x8DDA9901E8BA4B2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3c78c3f-a01e-0038-4e78-db94ed000000'
    'x-ms-client-request-id': '3983da1c-476c-11f0-a716-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:20 GMT'
2025-06-12 14:34:20,112 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-12 14:34:20,115 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-12 14:34:20,118 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:20,143 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979854'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '39dec033-476c-11f0-bef5-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:21,069 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:21 GMT'
    'ETag': '"0x8DDA9901F1C1EDE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '84f86f6d-a01e-005a-7378-db56ca000000'
    'x-ms-client-request-id': '39dec033-476c-11f0-bef5-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:21 GMT'
2025-06-12 14:34:21,072 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-12 14:34:21,074 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-12 14:34:21,075 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:21,126 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3a74e068-476c-11f0-bee9-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:22,621 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:23 GMT'
    'ETag': '"0x8DDA990200992D1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '276613fc-701e-003b-7678-db7589000000'
    'x-ms-client-request-id': '3a74e068-476c-11f0-bee9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:22 GMT'
2025-06-12 14:34:22,624 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-12 14:34:22,626 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-12 14:34:22,627 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:22,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3b5d6fab-476c-11f0-8677-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:22,965 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:23 GMT'
    'ETag': '"0x8DDA990203E236D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '40d48f4d-501e-0061-3678-db136e000000'
    'x-ms-client-request-id': '3b5d6fab-476c-11f0-8677-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:23 GMT'
2025-06-12 14:34:22,966 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-12 14:34:22,967 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-12 14:34:22,969 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:22,991 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3b916f50-476c-11f0-9447-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:23,357 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:24 GMT'
    'ETag': '"0x8DDA990207B0F0D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '63ef9dca-d01e-0050-4378-dbf27d000000'
    'x-ms-client-request-id': '3b916f50-476c-11f0-9447-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:23 GMT'
2025-06-12 14:34:23,358 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-12 14:34:23,360 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-12 14:34:23,361 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:23,389 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3bce1a86-476c-11f0-abf0-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:23,852 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:24 GMT'
    'ETag': '"0x8DDA99020C55929"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '40d749af-201e-00b0-5a78-db71e4000000'
    'x-ms-client-request-id': '3bce1a86-476c-11f0-abf0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:23 GMT'
2025-06-12 14:34:23,853 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-12 14:34:23,854 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-12 14:34:23,856 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:23,886 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3c19fe97-476c-11f0-8fa4-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:24,368 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:25 GMT'
    'ETag': '"0x8DDA990210EE0D2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f87d18e3-401e-000f-4678-db4641000000'
    'x-ms-client-request-id': '3c19fe97-476c-11f0-8fa4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:25 GMT'
2025-06-12 14:34:24,370 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-12 14:34:24,371 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-12 14:34:24,372 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:24,379 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3c65410b-476c-11f0-803d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:25,238 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:26 GMT'
    'ETag': '"0x8DDA9902193CF2E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e597fd6f-901e-0041-1778-db68c9000000'
    'x-ms-client-request-id': '3c65410b-476c-11f0-803d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:25 GMT'
2025-06-12 14:34:25,240 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-12 14:34:25,241 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-12 14:34:25,242 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:25,260 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3ceb7d55-476c-11f0-be0a-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:26,794 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:27 GMT'
    'ETag': '"0x8DDA99022855D36"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8ad83b43-001e-000e-4e78-db199d000000'
    'x-ms-client-request-id': '3ceb7d55-476c-11f0-be0a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:27 GMT'
2025-06-12 14:34:26,796 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-12 14:34:26,798 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-12 14:34:26,800 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:26,838 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3ddc72f7-476c-11f0-b13e-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:27,237 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:28 GMT'
    'ETag': '"0x8DDA99022CAF1B1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'eba2a48f-d01e-000d-0b79-dbf8f9000000'
    'x-ms-client-request-id': '3ddc72f7-476c-11f0-b13e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:28 GMT'
2025-06-12 14:34:27,238 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-12 14:34:27,239 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-12 14:34:27,241 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:27,268 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3e1e0f61-476c-11f0-952b-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:28,011 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:28 GMT'
    'ETag': '"0x8DDA99023403A2F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'af60f3ff-801e-003f-0c79-dbf88e000000'
    'x-ms-client-request-id': '3e1e0f61-476c-11f0-952b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:28 GMT'
2025-06-12 14:34:28,012 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-12 14:34:28,013 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-12 14:34:28,015 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:28,041 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3e940c55-476c-11f0-af4d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:28,497 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:29 GMT'
    'ETag': '"0x8DDA990238A367C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bf4cad2a-e01e-005b-6679-db0916000000'
    'x-ms-client-request-id': '3e940c55-476c-11f0-af4d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:29 GMT'
2025-06-12 14:34:28,498 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-12 14:34:28,499 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-12 14:34:28,501 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:28,525 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3edde864-476c-11f0-b541-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:29,142 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:29 GMT'
    'ETag': '"0x8DDA99023ECA86B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '509a71af-901e-0051-0f79-dbada1000000'
    'x-ms-client-request-id': '3edde864-476c-11f0-b541-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:29 GMT'
2025-06-12 14:34:29,143 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-12 14:34:29,144 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-12 14:34:29,146 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:29,150 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107683'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3f3d483d-476c-11f0-a512-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:29,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:30 GMT'
    'ETag': '"0x8DDA99024470D12"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '14db283e-001e-0043-6579-dbd671000000'
    'x-ms-client-request-id': '3f3d483d-476c-11f0-a512-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:30 GMT'
2025-06-12 14:34:29,747 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-12 14:34:29,748 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-12 14:34:29,749 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 14:34:29,753 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3f9944f0-476c-11f0-9166-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:30,286 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:31 GMT'
    'ETag': '"0x8DDA990249B5E0A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061236ce-e01e-0080-2579-dbcf2b000000'
    'x-ms-client-request-id': '3f9944f0-476c-11f0-9166-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:30 GMT'
2025-06-12 14:34:30,288 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-12 14:34:44,171 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-12 14:34:44,281 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-12 14:34:45,628 - main - INFO - [analyze] Analysis completed.
2025-06-12 14:34:45,840 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-12 14:34:45,876 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '104328'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '49355ec0-476c-11f0-950d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:46,534 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:47 GMT'
    'ETag': '"0x8DDA9902E4AB8CC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6024-601e-0037-1979-dbe281000000'
    'x-ms-client-request-id': '49355ec0-476c-11f0-950d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:47 GMT'
2025-06-12 14:34:46,539 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '499a8588-476c-11f0-b806-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:46,711 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:47 GMT'
    'ETag': '"0x8DDA9902E6527FB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6049-601e-0037-3c79-dbe281000000'
    'x-ms-client-request-id': '499a8588-476c-11f0-b806-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:47 GMT'
2025-06-12 14:34:46,714 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '49b5432b-476c-11f0-a9b9-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:46,910 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:47 GMT'
    'ETag': '"0x8DDA9902E82056D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6058-601e-0037-4b79-dbe281000000'
    'x-ms-client-request-id': '49b5432b-476c-11f0-a9b9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:47 GMT'
2025-06-12 14:34:46,916 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '49d4179a-476c-11f0-9703-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:47,008 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:47 GMT'
    'ETag': '"0x8DDA9902E930950"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6063-601e-0037-5679-dbe281000000'
    'x-ms-client-request-id': '49d4179a-476c-11f0-9703-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:47 GMT'
2025-06-12 14:34:47,013 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '49e2d4cf-476c-11f0-9c6c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:47,113 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:47 GMT'
    'ETag': '"0x8DDA9902EA1ECBA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c606c-601e-0037-5f79-dbe281000000'
    'x-ms-client-request-id': '49e2d4cf-476c-11f0-9c6c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:47 GMT'
2025-06-12 14:34:47,120 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979854'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '49f32b95-476c-11f0-87d2-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:47,381 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:48 GMT'
    'ETag': '"0x8DDA9902ECBB3F6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6074-601e-0037-6679-dbe281000000'
    'x-ms-client-request-id': '49f32b95-476c-11f0-87d2-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:48 GMT'
2025-06-12 14:34:47,393 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4a1cdd49-476c-11f0-9b67-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:48,063 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:48 GMT'
    'ETag': '"0x8DDA9902F33EBC7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c608b-601e-0037-7b79-dbe281000000'
    'x-ms-client-request-id': '4a1cdd49-476c-11f0-9b67-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:48 GMT'
2025-06-12 14:34:48,071 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4a845839-476c-11f0-b15d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:48,449 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:48 GMT'
    'ETag': '"0x8DDA9902F41235F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c60c7-601e-0037-2e79-dbe281000000'
    'x-ms-client-request-id': '4a845839-476c-11f0-b15d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:48 GMT'
2025-06-12 14:34:48,453 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4abea5af-476c-11f0-9d1a-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:48,530 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:49 GMT'
    'ETag': '"0x8DDA9902F7B52E9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c60e0-601e-0037-4579-dbe281000000'
    'x-ms-client-request-id': '4abea5af-476c-11f0-9d1a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:49 GMT'
2025-06-12 14:34:48,535 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4acb3445-476c-11f0-a900-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:48,616 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:49 GMT'
    'ETag': '"0x8DDA9902F883CBB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c60e7-601e-0037-4c79-dbe281000000'
    'x-ms-client-request-id': '4acb3445-476c-11f0-a900-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:49 GMT'
2025-06-12 14:34:48,620 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4ad814eb-476c-11f0-a9a3-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:48,707 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:49 GMT'
    'ETag': '"0x8DDA9902F94FFA4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c60f5-601e-0037-5a79-dbe281000000'
    'x-ms-client-request-id': '4ad814eb-476c-11f0-a9a3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:49 GMT'
2025-06-12 14:34:48,713 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1514837'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4ae65b79-476c-11f0-ad02-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:48,881 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:49 GMT'
    'ETag': '"0x8DDA9902FB00A61"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c60fa-601e-0037-5f79-dbe281000000'
    'x-ms-client-request-id': '4ae65b79-476c-11f0-ad02-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:49 GMT'
2025-06-12 14:34:48,890 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4b014454-476c-11f0-9563-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:49,330 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:50 GMT'
    'ETag': '"0x8DDA9902FF52A2B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6106-601e-0037-6979-dbe281000000'
    'x-ms-client-request-id': '4b014454-476c-11f0-9563-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:50 GMT'
2025-06-12 14:34:49,335 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4b454423-476c-11f0-97c4-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:49,416 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:50 GMT'
    'ETag': '"0x8DDA990300213FB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c611b-601e-0037-7c79-dbe281000000'
    'x-ms-client-request-id': '4b454423-476c-11f0-97c4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:50 GMT'
2025-06-12 14:34:49,420 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4b52377d-476c-11f0-9b68-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:49,502 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:50 GMT'
    'ETag': '"0x8DDA990300F7273"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c611d-601e-0037-7e79-dbe281000000'
    'x-ms-client-request-id': '4b52377d-476c-11f0-9b68-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:50 GMT'
2025-06-12 14:34:49,507 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4b5f69a8-476c-11f0-bab5-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:49,586 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:50 GMT'
    'ETag': '"0x8DDA990301C5C42"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6132-601e-0037-0379-dbe281000000'
    'x-ms-client-request-id': '4b5f69a8-476c-11f0-bab5-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:50 GMT'
2025-06-12 14:34:49,592 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4b6c5eaa-476c-11f0-b92e-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:49,682 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:50 GMT'
    'ETag': '"0x8DDA990302B18BA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6139-601e-0037-0a79-dbe281000000'
    'x-ms-client-request-id': '4b6c5eaa-476c-11f0-b92e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:50 GMT'
2025-06-12 14:34:49,687 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107683'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4b7afa58-476c-11f0-b378-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:49,774 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:50 GMT'
    'ETag': '"0x8DDA990303912D3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c613e-601e-0037-0f79-dbe281000000'
    'x-ms-client-request-id': '4b7afa58-476c-11f0-b378-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:50 GMT'
2025-06-12 14:34:49,779 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4b88e5a8-476c-11f0-a651-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 14:34:49,876 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 09:04:50 GMT'
    'ETag': '"0x8DDA990304891CB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '206c6145-601e-0037-1679-dbe281000000'
    'x-ms-client-request-id': '4b88e5a8-476c-11f0-a651-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 09:04:50 GMT'
2025-06-12 14:42:56,716 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 14:42:56,735 - main - INFO - FastAPI application shutdown
2025-06-12 15:16:05,431 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 15:16:30,900 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 15:16:30,900 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 15:16:30,901 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 15:16:30,903 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 15:16:30,903 - main - INFO - FastAPI application started
2025-06-12 15:30:34,490 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 15:30:34,523 - main - INFO - FastAPI application shutdown
2025-06-12 15:31:05,117 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 15:31:29,199 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 15:31:29,199 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 15:31:29,200 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 15:31:29,201 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 15:31:29,202 - main - INFO - FastAPI application started
2025-06-12 15:31:29,204 - d365 - INFO - Loading D365 data
2025-06-12 15:31:29,206 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:31:29,465 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2c24d5b9-8c5e-4b3c-92cc-1da5c8760901'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:01:29 GMT'
    'Content-Length': '1753'
2025-06-12 15:31:29,480 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:31:29,709 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'fdb0bb37-5fca-43fc-886a-475d66b1d200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:01:30 GMT'
    'Content-Length': '1648'
2025-06-12 15:31:29,710 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:31:29,711 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 15:31:29,711 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-14T10:01:29Z)
2025-06-12 15:31:37,490 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-12 15:31:45,369 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-12 15:31:52,590 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-12 15:32:01,169 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-12 15:32:13,370 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-12 15:32:19,849 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-12 15:32:22,625 - d365 - INFO - Progress: Fetched 31931 audit logs after 7 pages
2025-06-12 15:32:22,660 - d365 - INFO - Fetched 31931 D365 audit logs via Dataverse
2025-06-12 15:32:22,747 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-12 15:32:22,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:32:24,124 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '627a3608-3892-4682-9ce9-9daa9cb05f01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:02:24 GMT'
    'Content-Length': '1753'
2025-06-12 15:32:24,125 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:32:24,363 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b02c75f2-ab55-462b-a5e6-d4ae2e8b7701'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:02:24 GMT'
    'Content-Length': '1991'
2025-06-12 15:32:24,364 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:32:24,364 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 15:32:24,365 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-14T10:02:24Z)
2025-06-12 15:32:24,365 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-12 15:32:38,352 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 4.3 req/min | Time: 0:00:13
2025-06-12 15:32:55,613 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.8 req/min | Time: 0:00:31
2025-06-12 15:33:05,188 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 4.4 req/min | Time: 0:00:40
2025-06-12 15:33:17,292 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 4.5 req/min | Time: 0:00:52
2025-06-12 15:33:27,180 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.8 req/min | Time: 0:01:02
2025-06-12 15:33:37,216 - d365 - INFO - Progress: 5,898 records | Pages: 6 | Requests: 6 | Rate: 4.9 req/min | Time: 0:01:12
2025-06-12 15:33:37,718 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-13T10:07:56Z to 2025-06-12T09:57:29Z
2025-06-12 15:33:37,814 - d365 - INFO - Fetch completed: 5,898 records in 0:01:13
2025-06-12 15:33:37,814 - d365 - INFO - Total requests made: 6
2025-06-12 15:33:37,824 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:33:38,039 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ab6fe320-57f2-4e35-8a53-c1ea366e1201'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:03:38 GMT'
    'Content-Length': '1753'
2025-06-12 15:33:38,040 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:33:38,245 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'fe279d52-7af7-4ab7-a7aa-24e37ab2c800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:03:38 GMT'
    'Content-Length': '1651'
2025-06-12 15:33:38,246 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:33:38,247 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 15:33:38,248 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:33:38,462 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '37f4fe07-48c7-4aa6-bb7a-08289574c200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:03:38 GMT'
    'Content-Length': '1753'
2025-06-12 15:33:38,463 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:33:38,586 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '57427779-54ed-437f-9f2e-250dabbbf500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:03:38 GMT'
    'Content-Length': '1996'
2025-06-12 15:33:38,587 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:33:38,588 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 15:33:38,588 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:33:38,737 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4cdcef46-4776-4579-8c7b-7cf089383d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:03:39 GMT'
    'Content-Length': '1753'
2025-06-12 15:33:38,738 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:33:38,945 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c3af2fb7-457c-4152-9cc2-fbe5c45d1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:03:39 GMT'
    'Content-Length': '1996'
2025-06-12 15:33:38,946 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:33:38,947 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 15:33:42,437 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-12 15:33:42,438 - d365 - INFO - Found 975 users in Entra ID
2025-06-12 15:33:43,839 - d365 - INFO - Fetched 934 user records from D365
2025-06-12 15:35:04,154 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-12 15:35:04,156 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-12 15:35:45,671 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-12 15:35:45,673 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-12 15:35:48,117 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-12 15:35:48,119 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-12 15:35:52,811 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-12 15:35:52,813 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-12 15:36:41,293 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-12 15:36:41,294 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-12 15:37:09,375 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-12 15:37:09,377 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-12 15:37:26,121 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-12 15:37:26,123 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-12 15:38:10,511 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-12 15:38:10,512 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-12 15:38:10,513 - d365 - INFO - Final user count after filtering: 205
2025-06-12 15:38:10,644 - d365 - INFO - Fetched 205 user details after filtering
2025-06-12 15:38:10,719 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-12 15:38:10,756 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-12 15:38:10,774 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-12 15:38:10,863 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:38:11,163 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '927c0459-6c02-4ccf-bffe-4c5264afe700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:11 GMT'
    'Content-Length': '1753'
2025-06-12 15:38:11,195 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:38:11,440 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '67e27a01-3ded-456a-ba22-c6d0e21a1e01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:11 GMT'
    'Content-Length': '1652'
2025-06-12 15:38:11,480 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:38:11,487 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 15:38:13,217 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-12 15:38:13,232 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-12 15:38:13,237 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:38:13,600 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2a520106-45fa-48d4-949b-9b46224dd400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:14 GMT'
    'Content-Length': '1753'
2025-06-12 15:38:13,602 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:38:13,874 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '07461b0e-c168-4996-b13c-407802fb8f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:14 GMT'
    'Content-Length': '1647'
2025-06-12 15:38:13,876 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:38:13,878 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 15:38:20,824 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-12 15:38:20,851 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-12 15:38:20,863 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:38:21,171 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fa6755fc-5c6d-41d6-bb43-c0d9f8b1dc00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:21 GMT'
    'Content-Length': '1753'
2025-06-12 15:38:21,174 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:38:21,365 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'da36e584-22b7-493e-a7d3-fb97b15e2a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:21 GMT'
    'Content-Length': '1996'
2025-06-12 15:38:21,367 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:38:21,369 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 15:38:24,342 - d365 - INFO - Fetched 35 conditional access policies
2025-06-12 15:38:24,359 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-12 15:38:24,361 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 15:38:24,592 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1f9deace-565f-4ff3-ad69-7c90e28d8601'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:24 GMT'
    'Content-Length': '1753'
2025-06-12 15:38:24,593 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 15:38:24,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e6f51d63-4cef-4fb8-9af3-f57a7f101701'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:08:25 GMT'
    'Content-Length': '1648'
2025-06-12 15:38:24,773 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 15:38:24,773 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 15:38:25,471 - d365 - INFO - Fetched 11 business units
2025-06-12 15:38:25,475 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-12 15:38:25,625 - d365 - INFO - D365 data loaded successfully
2025-06-12 15:38:26,286 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-12 15:38:26,286 - main - INFO - Loading data from CSV files
2025-06-12 15:38:26,489 - main - INFO - Loaded audit_logs with 31931 rows
2025-06-12 15:38:26,538 - main - INFO - Loaded signin_logs with 5898 rows
2025-06-12 15:38:26,548 - main - INFO - Loaded user_details with 205 rows
2025-06-12 15:38:26,565 - main - INFO - Loaded app_roles with 2112 rows
2025-06-12 15:38:26,580 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-12 15:38:26,815 - main - INFO - Created group_memberships with 3289 rows
2025-06-12 15:38:26,927 - main - INFO - Created role_matrix with 2112 rows
2025-06-12 15:38:26,941 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-12 15:38:26,942 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['005a3324-6c26-484a-be06-07d829df9a76', '1f2b9261-b13b-4cee-be32-8721d0a0a8ac', 'd716f427-0faf-4441-9cfa-96b8931e3bca', '96b02617-0dcb-4cc2-a8ec-3aad9bead04a', 'ee7ab89d-7719-4787-bae3-623f27404cd8']...
2025-06-12 15:38:26,943 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['eb1833bb-d023-ec11-b6e5-000d3adb194e', '63e7a382-f8bc-ec11-9840-0022489e2e28', '64a962c2-ab09-ec11-b6e6-000d3ab1f3c0', 'dfc9fddf-a4fb-ef11-bae4-000d3ab483e3', 'c4071676-e5be-eb11-bacc-000d3ade3348']...
2025-06-12 15:38:26,944 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-12 15:38:27,021 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-12 15:38:27,024 - src.core.embeddings - INFO - Starting embedding generation
2025-06-12 15:38:27,025 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-12 15:38:27,026 - src.core.embeddings - INFO - Using batch_size=64
2025-06-12 15:38:27,028 - src.core.embeddings - INFO - Using device: cpu
2025-06-12 15:39:21,461 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-12 15:39:27,255 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-12 15:39:27,256 - src.core.embeddings - INFO - Embedding initialization took 60.23 seconds
2025-06-12 15:39:27,257 - src.core.embeddings - INFO - Memory usage: RSS=361.89 MB, VMS=2701.91 MB
2025-06-12 15:39:27,258 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-12 15:39:27,258 - src.core.embeddings - INFO - Using all logs: audit_logs=31931 rows, signin_logs=5898 rows
2025-06-12 15:39:27,267 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-12 15:39:27,319 - src.core.embeddings - INFO - Precomputed location history in 0.05 seconds
2025-06-12 15:39:29,199 - src.core.embeddings - INFO - Text generation took 1.94 seconds
2025-06-12 15:39:29,200 - src.core.embeddings - INFO - Memory usage: RSS=387.82 MB, VMS=2726.87 MB
2025-06-12 15:39:29,200 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-12 15:39:34,476 - src.core.embeddings - INFO - Total documents to embed: 37829
2025-06-12 15:39:34,477 - src.core.embeddings - INFO - Document conversion took 5.28 seconds
2025-06-12 15:39:34,477 - src.core.embeddings - INFO - Memory usage: RSS=417.59 MB, VMS=2756.93 MB
2025-06-12 15:39:34,478 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-12 15:39:34,481 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-12 15:40:06,972 - src.core.embeddings - INFO - Memory usage: RSS=584.39 MB, VMS=2941.97 MB
2025-06-12 15:40:06,974 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-12 15:40:43,366 - src.core.embeddings - INFO - Memory usage: RSS=558.95 MB, VMS=2958.62 MB
2025-06-12 15:40:43,367 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-12 15:41:22,059 - src.core.embeddings - INFO - Memory usage: RSS=656.63 MB, VMS=3074.82 MB
2025-06-12 15:41:22,060 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-12 15:41:57,406 - src.core.embeddings - INFO - Memory usage: RSS=693.23 MB, VMS=3105.84 MB
2025-06-12 15:41:57,407 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-12 15:42:30,864 - src.core.embeddings - INFO - Memory usage: RSS=817.72 MB, VMS=3239.15 MB
2025-06-12 15:42:30,866 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-12 15:43:07,236 - src.core.embeddings - INFO - Memory usage: RSS=891.21 MB, VMS=3313.32 MB
2025-06-12 15:43:07,236 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-12 15:44:29,463 - src.core.embeddings - INFO - Memory usage: RSS=1059.68 MB, VMS=3481.15 MB
2025-06-12 15:44:29,464 - src.core.embeddings - INFO - Embedding chunk 8/8 (2829 documents)
2025-06-12 15:45:30,780 - src.core.embeddings - INFO - Memory usage: RSS=1079.05 MB, VMS=3515.27 MB
2025-06-12 15:45:31,285 - src.core.embeddings - INFO - Embedding generation took 356.81 seconds
2025-06-12 15:45:31,286 - src.core.embeddings - INFO - Memory usage: RSS=1079.05 MB, VMS=3515.27 MB
2025-06-12 15:45:31,287 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-12 15:45:32,559 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37829 vectors
2025-06-12 15:45:34,766 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-12 15:45:34,788 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-12 15:45:34,789 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-12 15:45:34,789 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.50 seconds
2025-06-12 15:45:34,790 - src.core.embeddings - INFO - Memory usage: RSS=1274.38 MB, VMS=3850.06 MB
2025-06-12 15:45:34,899 - src.core.embeddings - INFO - Total embedding generation took 427.87 seconds
2025-06-12 15:45:34,986 - main - INFO - [analyze] Embeddings generated.
2025-06-12 15:45:34,987 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-12 15:45:34,989 - src.utils.config - INFO - Loading environment variables
2025-06-12 15:45:35,077 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-12 15:45:35,077 - src.core.analysis - INFO - Validating input DataFrames
2025-06-12 15:45:35,261 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 15:45:35,262 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 15:45:35,262 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 15:45:35,263 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-12 15:45:35,264 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-12 15:45:35,292 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-12 15:45:35,293 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-12 15:45:35,293 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-12 15:45:35,294 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-12 15:45:35,294 - src.core.analysis - INFO - Total unique user IDs: 511
2025-06-12 15:45:38,884 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-12 15:45:38,944 - src.core.analysis - INFO - Starting analysis
2025-06-12 15:45:38,945 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-12 15:45:44,660 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-12 15:45:44,664 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-12 15:45:44,665 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-12 15:45:44,666 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-12 15:45:44,666 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-12 15:45:44,666 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 15:45:44,667 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5898, 12)
2025-06-12 15:45:44,667 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 15:45:44,692 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-12 15:45:44,738 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-12 15:45:44,807 - src.analysis.anomaly_detector - INFO - Successfully mapped 5892 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-12 15:45:44,815 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-12 15:45:44,816 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-12 15:45:44,816 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-12 15:45:44,817 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-12 15:45:44,817 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-12 15:45:44,817 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-12 15:45:44,818 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-12 15:45:44,818 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-12 15:45:44,818 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-12 15:45:44,819 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-12 15:45:44,820 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-12 15:45:44,821 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-12 15:45:44,822 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-12 15:45:44,823 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-12 15:45:44,824 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-12 15:45:44,825 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-12 15:45:44,825 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-12 15:45:44,826 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-12 15:45:48,128 - src.analysis.anomaly_detector - INFO - Detected 63 anomalies
2025-06-12 15:45:48,129 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-12 15:45:48,130 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> User Vikneshkumar Palanisamy had 2486 sign-ins (avg: 83.1, threshold: 679.3) in the period.; User us...
2025-06-12 15:45:48,131 - src.analysis.anomaly_detector - INFO - Example 2: Vinay Dasari -> User usually signs in from Visakhapatnam, IN (97.7%), but on 2025-06-12 signed in from Sanath Nagar,...
2025-06-12 15:45:48,132 - src.analysis.anomaly_detector - INFO - Example 3: Sujan Upreti -> User usually signs in from Kathmandu, NP (89.6%), but on 2025-05-29 signed in from Birganj, NP.; Use...
2025-06-12 15:45:48,139 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-12 15:45:49,802 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-12 15:45:49,803 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-12 15:45:50,171 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-12 15:45:51,122 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-12 15:45:52,507 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-12 15:45:52,508 - src.core.analysis - INFO - Analyzing inactive users
2025-06-12 15:45:52,509 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-12 15:45:52,510 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 15:45:52,510 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 15:45:52,528 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-12 09:57:29+0000', tz='UTC'), Timestamp('2025-06-12 09:53:10+0000', tz='UTC'), Timestamp('2025-06-12 09:51:28+0000', tz='UTC'), Timestamp('2025-06-12 09:49:11+0000', tz='UTC'), Timestamp('2025-06-12 09:47:23+0000', tz='UTC')]
2025-06-12 15:45:52,529 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-12 15:45:52,544 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-14 19:06:19+0000', tz='UTC'), Timestamp('2025-03-14 21:43:44+0000', tz='UTC'), Timestamp('2025-03-14 22:30:26+0000', tz='UTC'), Timestamp('2025-03-14 22:31:09+0000', tz='UTC'), Timestamp('2025-03-14 22:31:17+0000', tz='UTC')]
2025-06-12 15:45:52,545 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-12 15:45:53,512 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-12 15:45:53,514 - src.core.analysis - INFO - Total unique user IDs after analysis: 616
2025-06-12 15:45:53,597 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-12 15:45:53,597 - src.core.analysis - INFO - Using chunk size: 200 for 616 users
2025-06-12 15:45:53,602 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-12 15:45:53,604 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-12 15:45:53,606 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 149848 bytes
2025-06-12 15:46:48,564 - src.core.analysis - INFO - Findings chunk 1 completed in 54.96s
2025-06-12 15:46:48,565 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-12 15:46:48,567 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 142056 bytes
2025-06-12 15:47:14,111 - src.core.analysis - INFO - Findings chunk 2 completed in 25.55s
2025-06-12 15:47:14,112 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-12 15:47:14,114 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 145133 bytes
2025-06-12 15:47:43,796 - src.core.analysis - INFO - Findings chunk 3 completed in 29.68s
2025-06-12 15:47:43,797 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-12 15:47:43,798 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 15378 bytes
2025-06-12 15:48:29,762 - src.core.analysis - INFO - Findings chunk 4 completed in 45.96s
2025-06-12 15:48:29,878 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-12 15:48:29,879 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-12 15:48:29,880 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-12 15:48:29,881 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-12 15:48:29,881 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-12 15:48:29,882 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-12 15:48:29,883 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-12 15:48:29,884 - src.core.analysis - INFO - Processed 4/4 chunks (95%)
2025-06-12 15:48:29,884 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-12 15:48:29,885 - src.core.analysis - INFO - Sequential processing completed in 156.28s
2025-06-12 15:48:29,885 - src.core.analysis - INFO - Successfully processed 4/4 chunks
2025-06-12 15:48:29,886 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-12 15:48:29,886 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 616 users
2025-06-12 15:48:29,888 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-12 15:48:29,889 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-12 15:48:29,890 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-12 15:48:29,891 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 18582 bytes
2025-06-12 15:48:39,056 - src.core.analysis - INFO - Recommendations chunk 1 completed in 9.16s
2025-06-12 15:48:39,170 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-12 15:48:39,171 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-12 15:48:39,172 - src.core.analysis - INFO - Analysis completed successfully with 12 recommendations
2025-06-12 15:48:39,173 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:39,174 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-12 15:48:39,176 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-12 15:48:39,181 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:39,206 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '104328'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9badbe70-4776-11f0-ae2b-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:39,774 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:40 GMT'
    'ETag': '"0x8DDA99A80B9E10D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2cf71e32-d01e-007f-3c83-dbffb6000000'
    'x-ms-client-request-id': '9badbe70-4776-11f0-ae2b-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:40 GMT'
2025-06-12 15:48:39,777 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-12 15:48:39,779 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-12 15:48:39,780 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:39,804 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9c09289e-4776-11f0-ac99-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:40,322 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:41 GMT'
    'ETag': '"0x8DDA99A810F6925"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '651dcd04-101e-0012-6f83-db4bfd000000'
    'x-ms-client-request-id': '9c09289e-4776-11f0-ac99-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:40 GMT'
2025-06-12 15:48:40,323 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-12 15:48:40,324 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-12 15:48:40,325 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:40,352 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9c5cbfda-4776-11f0-b889-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:40,987 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:41 GMT'
    'ETag': '"0x8DDA99A8174BE07"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9a781142-f01e-0035-5f83-db5c39000000'
    'x-ms-client-request-id': '9c5cbfda-4776-11f0-b889-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:41 GMT'
2025-06-12 15:48:40,988 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-12 15:48:40,991 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-12 15:48:40,992 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:41,018 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9cc240f8-4776-11f0-9320-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:41,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:42 GMT'
    'ETag': '"0x8DDA99A81C983B1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'eb5a4d62-a01e-0075-6e83-db5b01000000'
    'x-ms-client-request-id': '9cc240f8-4776-11f0-9320-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:42 GMT'
2025-06-12 15:48:41,543 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-12 15:48:41,544 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-12 15:48:41,546 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:41,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9d15d999-4776-11f0-84ca-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:42,162 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:43 GMT'
    'ETag': '"0x8DDA99A82280271"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c3141bd9-c01e-004c-0f83-dba01d000000'
    'x-ms-client-request-id': '9d15d999-4776-11f0-84ca-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:42 GMT'
2025-06-12 15:48:42,163 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-12 15:48:42,164 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-12 15:48:42,165 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:42,190 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979792'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9d752639-4776-11f0-a56f-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:44,637 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:45 GMT'
    'ETag': '"0x8DDA99A83A0ED37"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '536ef603-f01e-0068-4c83-db56bd000000'
    'x-ms-client-request-id': '9d752639-4776-11f0-a56f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:45 GMT'
2025-06-12 15:48:44,639 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-12 15:48:44,640 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-12 15:48:44,641 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:44,670 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9eef93b1-4776-11f0-9519-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:51,188 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:52 GMT'
    'ETag': '"0x8DDA99A87895430"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9604e900-a01e-0091-4683-db559f000000'
    'x-ms-client-request-id': '9eef93b1-4776-11f0-9519-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:51 GMT'
2025-06-12 15:48:51,190 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-12 15:48:51,192 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-12 15:48:51,194 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:51,220 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a2d70936-4776-11f0-87bc-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:51,527 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:52 GMT'
    'ETag': '"0x8DDA99A87BD2249"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7bdd1d18-601e-0045-0283-dbe5ce000000'
    'x-ms-client-request-id': 'a2d70936-4776-11f0-87bc-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:51 GMT'
2025-06-12 15:48:51,528 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-12 15:48:51,530 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-12 15:48:51,531 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:51,561 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a30b07c5-4776-11f0-b682-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:51,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:52 GMT'
    'ETag': '"0x8DDA99A87F1B2EE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'dc9c08be-001e-0031-6983-dbd13e000000'
    'x-ms-client-request-id': 'a30b07c5-4776-11f0-b682-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:52 GMT'
2025-06-12 15:48:51,873 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-12 15:48:51,875 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-12 15:48:51,877 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:51,919 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a341b98c-4776-11f0-968d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:52,364 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:53 GMT'
    'ETag': '"0x8DDA99A883C71B3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3042decf-801e-0000-2283-db302d000000'
    'x-ms-client-request-id': 'a341b98c-4776-11f0-968d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:52 GMT'
2025-06-12 15:48:52,366 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-12 15:48:52,367 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-12 15:48:52,369 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:52,391 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a389c343-4776-11f0-8110-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:52,880 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:53 GMT'
    'ETag': '"0x8DDA99A888AD5E9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '047c9f3e-401e-0042-3d83-db89ad000000'
    'x-ms-client-request-id': 'a389c343-4776-11f0-8110-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:53 GMT'
2025-06-12 15:48:52,882 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-12 15:48:52,885 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-12 15:48:52,886 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:52,913 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1508345'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a3d95425-4776-11f0-85cb-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:48:54,799 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:18:55 GMT'
    'ETag': '"0x8DDA99A89B0321B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e6985110-b01e-00a2-0f83-db0a34000000'
    'x-ms-client-request-id': 'a3d95425-4776-11f0-85cb-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:18:55 GMT'
2025-06-12 15:48:54,801 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-12 15:48:54,804 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-12 15:48:54,805 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:48:54,830 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a4fdd94f-4776-11f0-be1d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:01,297 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:02 GMT'
    'ETag': '"0x8DDA99A8D8F54B0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '613c3c13-201e-0019-6883-dbb096000000'
    'x-ms-client-request-id': 'a4fdd94f-4776-11f0-be1d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:01 GMT'
2025-06-12 15:49:01,299 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-12 15:49:01,303 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-12 15:49:01,304 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:49:01,331 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a8ddf009-4776-11f0-8882-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:01,690 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:02 GMT'
    'ETag': '"0x8DDA99A8DCBCB97"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ef4e507f-c01e-0073-5983-db68be000000'
    'x-ms-client-request-id': 'a8ddf009-4776-11f0-8882-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:02 GMT'
2025-06-12 15:49:01,691 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-12 15:49:01,692 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-12 15:49:01,693 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:49:01,720 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a91943f3-4776-11f0-800c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:02,166 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:03 GMT'
    'ETag': '"0x8DDA99A8E1490CF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2748a0b5-701e-0066-6983-db7f0d000000'
    'x-ms-client-request-id': 'a91943f3-4776-11f0-800c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:02 GMT'
2025-06-12 15:49:02,167 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-12 15:49:02,171 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-12 15:49:02,172 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:49:02,191 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a961123c-4776-11f0-82e6-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:02,609 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:03 GMT'
    'ETag': '"0x8DDA99A8E582BB4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0d34d08b-801e-005d-5283-db3aa9000000'
    'x-ms-client-request-id': 'a961123c-4776-11f0-82e6-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:02 GMT'
2025-06-12 15:49:02,610 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-12 15:49:02,612 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-12 15:49:02,613 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:49:02,633 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a9a47aeb-4776-11f0-8f05-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:03,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:04 GMT'
    'ETag': '"0x8DDA99A8EAA354F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b13dd50c-001e-0053-2083-db1319000000'
    'x-ms-client-request-id': 'a9a47aeb-4776-11f0-8f05-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:03 GMT'
2025-06-12 15:49:03,156 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-12 15:49:03,160 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-12 15:49:03,162 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:49:03,185 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107683'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a9f8c77b-4776-11f0-8508-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:03,665 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:04 GMT'
    'ETag': '"0x8DDA99A8EF95BF8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd3cb99d7-a01e-0038-7f83-db94ed000000'
    'x-ms-client-request-id': 'a9f8c77b-4776-11f0-8508-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:04 GMT'
2025-06-12 15:49:03,667 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-12 15:49:03,668 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-12 15:49:03,670 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 15:49:03,693 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'aa464eb8-4776-11f0-b8b5-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:04,221 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:05 GMT'
    'ETag': '"0x8DDA99A8F4DACF0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '367ec181-601e-0018-3083-dbef4a000000'
    'x-ms-client-request-id': 'aa464eb8-4776-11f0-b8b5-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:04 GMT'
2025-06-12 15:49:04,222 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-12 15:49:20,312 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-12 15:49:20,370 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-12 15:49:21,875 - main - INFO - [analyze] Analysis completed.
2025-06-12 15:49:22,009 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-12 15:49:22,037 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '341220'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b5356eeb-4776-11f0-809a-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:22,779 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:23 GMT'
    'ETag': '"0x8DDA99A9A5D0871"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3d78-701e-0004-4e83-dbbd2a000000'
    'x-ms-client-request-id': 'b5356eeb-4776-11f0-809a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:23 GMT'
2025-06-12 15:49:22,783 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b5a72e00-4776-11f0-ad47-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:23,007 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:23 GMT'
    'ETag': '"0x8DDA99A9A802070"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3d7e-701e-0004-5383-dbbd2a000000'
    'x-ms-client-request-id': 'b5a72e00-4776-11f0-ad47-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:23 GMT'
2025-06-12 15:49:23,012 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b5ca2788-4776-11f0-9d8a-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:23,372 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:24 GMT'
    'ETag': '"0x8DDA99A9AB7E1C8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3d82-701e-0004-5783-dbbd2a000000'
    'x-ms-client-request-id': 'b5ca2788-4776-11f0-9d8a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:23 GMT'
2025-06-12 15:49:23,377 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b601d3c3-4776-11f0-9ce2-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:23,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:24 GMT'
    'ETag': '"0x8DDA99A9AD533E6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3d88-701e-0004-5c83-dbbd2a000000'
    'x-ms-client-request-id': 'b601d3c3-4776-11f0-9ce2-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:23 GMT'
2025-06-12 15:49:23,569 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b61f204e-4776-11f0-bfa4-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:23,874 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:24 GMT'
    'ETag': '"0x8DDA99A9B02C772"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3d92-701e-0004-6483-dbbd2a000000'
    'x-ms-client-request-id': 'b61f204e-4776-11f0-bfa4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:24 GMT'
2025-06-12 15:49:23,880 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979792'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b64e9707-4776-11f0-ac31-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:26,112 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:26 GMT'
    'ETag': '"0x8DDA99A9C59D141"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3d96-701e-0004-6783-dbbd2a000000'
    'x-ms-client-request-id': 'b64e9707-4776-11f0-ac31-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:26 GMT'
2025-06-12 15:49:26,121 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b7a482e6-4776-11f0-aa8f-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:32,666 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:33 GMT'
    'ETag': '"0x8DDA99AA041C35F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3da9-701e-0004-7483-dbbd2a000000'
    'x-ms-client-request-id': 'b7a482e6-4776-11f0-aa8f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:32 GMT'
2025-06-12 15:49:32,671 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bb8bf6d5-4776-11f0-92f3-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:32,750 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:33 GMT'
    'ETag': '"0x8DDA99AA04E8648"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3e40-701e-0004-6183-dbbd2a000000'
    'x-ms-client-request-id': 'bb8bf6d5-4776-11f0-92f3-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:32 GMT'
2025-06-12 15:49:32,754 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bb9898f1-4776-11f0-9925-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:32,832 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:33 GMT'
    'ETag': '"0x8DDA99AA05B4930"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3e42-701e-0004-6383-dbbd2a000000'
    'x-ms-client-request-id': 'bb9898f1-4776-11f0-9925-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:33 GMT'
2025-06-12 15:49:32,835 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bba50919-4776-11f0-8dc7-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:32,920 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:33 GMT'
    'ETag': '"0x8DDA99AA06859E2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3e45-701e-0004-6583-dbbd2a000000'
    'x-ms-client-request-id': 'bba50919-4776-11f0-8dc7-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:33 GMT'
2025-06-12 15:49:32,928 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bbb3317e-4776-11f0-97b8-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:33,088 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:33 GMT'
    'ETag': '"0x8DDA99AA0825464"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3e48-701e-0004-6783-dbbd2a000000'
    'x-ms-client-request-id': 'bbb3317e-4776-11f0-97b8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:33 GMT'
2025-06-12 15:49:33,093 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1508345'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bbcc68b4-4776-11f0-9551-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:34,801 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:35 GMT'
    'ETag': '"0x8DDA99AA187A257"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3e49-701e-0004-6883-dbbd2a000000'
    'x-ms-client-request-id': 'bbcc68b4-4776-11f0-9551-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:34 GMT'
2025-06-12 15:49:34,810 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bcd270b7-4776-11f0-9c35-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:40,929 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:41 GMT'
    'ETag': '"0x8DDA99AA52E8EB8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3e5e-701e-0004-7883-dbbd2a000000'
    'x-ms-client-request-id': 'bcd270b7-4776-11f0-9c35-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:41 GMT'
2025-06-12 15:49:40,932 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c07896d1-4776-11f0-bb5c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:41,011 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:41 GMT'
    'ETag': '"0x8DDA99AA53B2ABF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3f06-701e-0004-5f83-dbbd2a000000'
    'x-ms-client-request-id': 'c07896d1-4776-11f0-bb5c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:41 GMT'
2025-06-12 15:49:41,017 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0858af2-4776-11f0-a620-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:41,169 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:42 GMT'
    'ETag': '"0x8DDA99AA5532BA8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3f09-701e-0004-6283-dbbd2a000000'
    'x-ms-client-request-id': 'c0858af2-4776-11f0-a620-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:41 GMT'
2025-06-12 15:49:41,174 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c09d6d63-4776-11f0-aa09-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:41,259 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:42 GMT'
    'ETag': '"0x8DDA99AA560D7EE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3f10-701e-0004-6883-dbbd2a000000'
    'x-ms-client-request-id': 'c09d6d63-4776-11f0-aa09-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:41 GMT'
2025-06-12 15:49:41,269 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0abdaa0-4776-11f0-9ed8-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:41,466 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:42 GMT'
    'ETag': '"0x8DDA99AA580BF36"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3f12-701e-0004-6a83-dbbd2a000000'
    'x-ms-client-request-id': 'c0abdaa0-4776-11f0-9ed8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:41 GMT'
2025-06-12 15:49:41,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107683'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0cab762-4776-11f0-9ebb-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:41,623 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:42 GMT'
    'ETag': '"0x8DDA99AA598C020"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3f13-701e-0004-6b83-dbbd2a000000'
    'x-ms-client-request-id': 'c0cab762-4776-11f0-9ebb-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:41 GMT'
2025-06-12 15:49:41,626 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0e277fa-4776-11f0-bdd9-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 15:49:41,848 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 10:19:42 GMT'
    'ETag': '"0x8DDA99AA5BAEEC8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '061a3f16-701e-0004-6d83-dbbd2a000000'
    'x-ms-client-request-id': 'c0e277fa-4776-11f0-bdd9-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 10:19:42 GMT'
2025-06-12 16:29:06,405 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 16:29:06,422 - main - INFO - FastAPI application shutdown
2025-06-12 16:29:38,214 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 16:30:09,356 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:30:09,356 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 16:30:09,357 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 16:30:09,359 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 16:30:09,360 - main - INFO - FastAPI application started
2025-06-12 16:38:22,858 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 16:38:22,861 - main - INFO - FastAPI application shutdown
2025-06-12 16:38:32,021 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 16:38:38,000 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:38:38,001 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 16:38:38,001 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 16:38:38,012 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 16:38:38,012 - main - INFO - FastAPI application started
2025-06-12 16:39:22,007 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 16:39:22,009 - main - INFO - FastAPI application shutdown
2025-06-12 16:39:29,612 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 16:39:34,215 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:39:34,215 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 16:39:34,216 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 16:39:34,218 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 16:39:34,219 - main - INFO - FastAPI application started
2025-06-12 16:40:08,367 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 16:40:08,368 - main - INFO - FastAPI application shutdown
2025-06-12 16:40:15,259 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 16:40:20,355 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:40:20,355 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 16:40:20,356 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 16:40:20,358 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 16:40:20,358 - main - INFO - FastAPI application started
2025-06-12 16:41:15,900 - d365 - INFO - Loading D365 data
2025-06-12 16:41:15,901 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:41:16,151 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0ffc2e24-1e70-4d05-988f-4a067f831401'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:11:17 GMT'
    'Content-Length': '1753'
2025-06-12 16:41:16,163 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:41:16,362 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '65ce2cc9-94f8-4190-85da-17345e7ef300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:11:17 GMT'
    'Content-Length': '1647'
2025-06-12 16:41:16,363 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:41:16,364 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 16:41:16,365 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-14T11:11:16Z)
2025-06-12 16:41:28,845 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-12 16:41:39,658 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-12 16:41:50,298 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-12 16:42:02,793 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-12 16:42:15,503 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-12 16:42:27,132 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-12 16:42:31,875 - d365 - INFO - Progress: Fetched 31934 audit logs after 7 pages
2025-06-12 16:42:31,904 - d365 - INFO - Fetched 31934 D365 audit logs via Dataverse
2025-06-12 16:42:31,977 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-12 16:42:31,982 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:42:32,173 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '371cdfac-2712-46a5-b1f1-d496402cd800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:12:32 GMT'
    'Content-Length': '1753'
2025-06-12 16:42:32,175 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:42:32,298 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '782cdf8c-6b41-432c-93b1-1fddf7fff600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:12:32 GMT'
    'Content-Length': '1997'
2025-06-12 16:42:32,300 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:42:32,302 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 16:42:32,303 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-14T11:12:32Z)
2025-06-12 16:42:32,304 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-12 16:42:44,058 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 5.1 req/min | Time: 0:00:11
2025-06-12 16:42:56,884 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 4.9 req/min | Time: 0:00:24
2025-06-12 16:43:05,622 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.4 req/min | Time: 0:00:33
2025-06-12 16:43:16,972 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.4 req/min | Time: 0:00:44
2025-06-12 16:43:27,077 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.5 req/min | Time: 0:00:54
2025-06-12 16:43:35,412 - d365 - INFO - Progress: 5,882 records | Pages: 6 | Requests: 6 | Rate: 5.7 req/min | Time: 0:01:03
2025-06-12 16:43:35,913 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-13T11:13:32Z to 2025-06-12T11:06:05Z
2025-06-12 16:43:35,982 - d365 - INFO - Fetch completed: 5,882 records in 0:01:03
2025-06-12 16:43:35,983 - d365 - INFO - Total requests made: 6
2025-06-12 16:43:35,992 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:43:36,245 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5b7de397-7218-4ac0-9b4b-b96d89f9a900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:13:37 GMT'
    'Content-Length': '1753'
2025-06-12 16:43:36,247 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:43:36,426 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f2f7c52a-2f7f-4f88-a3a3-fb717fc51001'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:13:37 GMT'
    'Content-Length': '1652'
2025-06-12 16:43:36,427 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:43:36,428 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 16:43:36,429 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:43:36,600 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '782cdf8c-6b41-432c-93b1-1fdded06f700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:13:36 GMT'
    'Content-Length': '1753'
2025-06-12 16:43:36,601 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:43:36,799 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ff54b99f-2dda-44f7-8b46-8a424b68f800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:13:37 GMT'
    'Content-Length': '1989'
2025-06-12 16:43:36,802 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:43:36,802 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 16:43:36,803 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:43:36,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3f161535-37ba-4c8b-a03a-1a5d28288a01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:13:37 GMT'
    'Content-Length': '1753'
2025-06-12 16:43:36,999 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:43:37,196 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '294cd5e1-dad8-4529-a68c-a247d5a02b01'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:13:37 GMT'
    'Content-Length': '1996'
2025-06-12 16:43:37,197 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:43:37,198 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 16:43:39,709 - d365 - INFO - Fetched 975 users from Entra ID
2025-06-12 16:43:39,710 - d365 - INFO - Found 975 users in Entra ID
2025-06-12 16:43:42,369 - d365 - INFO - Fetched 934 user records from D365
2025-06-12 16:44:46,091 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-12 16:44:46,092 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-12 16:45:28,128 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-12 16:45:28,129 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-12 16:45:30,863 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-12 16:45:30,864 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-12 16:45:35,953 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-12 16:45:35,955 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-12 16:46:22,796 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-12 16:46:22,797 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-12 16:46:48,445 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-12 16:46:48,446 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-12 16:47:03,556 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-12 16:47:03,557 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-12 16:47:43,492 - d365 - INFO - Filtered out 415 D365 users not present in Entra ID
2025-06-12 16:47:43,492 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-12 16:47:43,493 - d365 - INFO - Final user count after filtering: 205
2025-06-12 16:47:43,494 - d365 - INFO - Fetched 205 user details after filtering
2025-06-12 16:47:43,502 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-12 16:47:43,509 - d365 - INFO - Saved 415 users without Entra ID to data/users_without_entra_id.csv
2025-06-12 16:47:43,513 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-12 16:47:43,515 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:47:43,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '51df0c20-a90c-4e2f-9831-cc3f1e1f2501'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:43 GMT'
    'Content-Length': '1753'
2025-06-12 16:47:43,747 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:47:43,936 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5952f6a5-90d3-40a4-b21b-a2420e8b1001'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:44 GMT'
    'Content-Length': '1652'
2025-06-12 16:47:43,938 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:47:43,939 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 16:47:45,352 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-12 16:47:45,356 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-12 16:47:45,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:47:45,598 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2103c012-8985-4820-b2a9-d29db1e8f500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:46 GMT'
    'Content-Length': '1753'
2025-06-12 16:47:45,600 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:47:45,799 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1bce1a23-fbde-43dc-ada6-211f0aaeda00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:46 GMT'
    'Content-Length': '1647'
2025-06-12 16:47:45,801 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:47:45,802 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 16:47:48,051 - d365 - INFO - Fetched 691 D365 user role assignments
2025-06-12 16:47:48,057 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-12 16:47:48,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:47:48,212 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2d02d11a-3669-47e0-a9d9-aafb9df31400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:48 GMT'
    'Content-Length': '1753'
2025-06-12 16:47:48,213 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:47:48,412 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1e33ca2a-33e4-48e9-9dc0-431501135901'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:49 GMT'
    'Content-Length': '1996'
2025-06-12 16:47:48,413 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:47:48,414 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-12 16:47:51,156 - d365 - INFO - Fetched 35 conditional access policies
2025-06-12 16:47:51,164 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-12 16:47:51,167 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-12 16:47:51,372 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fef9e0bf-0444-45af-8d45-665838f60000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:51 GMT'
    'Content-Length': '1753'
2025-06-12 16:47:51,373 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-12 16:47:51,572 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '07e0040b-445e-4197-8f92-3f371fa8ff00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:17:51 GMT'
    'Content-Length': '1647'
2025-06-12 16:47:51,573 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-12 16:47:51,574 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-12 16:47:52,297 - d365 - INFO - Fetched 11 business units
2025-06-12 16:47:52,301 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-12 16:47:52,319 - d365 - INFO - D365 data loaded successfully
2025-06-12 16:47:52,335 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-12 16:47:52,336 - main - INFO - Loading data from CSV files
2025-06-12 16:47:52,418 - main - INFO - Loaded audit_logs with 31934 rows
2025-06-12 16:47:52,472 - main - INFO - Loaded signin_logs with 5882 rows
2025-06-12 16:47:52,485 - main - INFO - Loaded user_details with 205 rows
2025-06-12 16:47:52,494 - main - INFO - Loaded app_roles with 2112 rows
2025-06-12 16:47:52,539 - main - INFO - Loaded app_role_assignments with 691 rows
2025-06-12 16:47:52,634 - main - INFO - Created group_memberships with 3289 rows
2025-06-12 16:47:52,809 - main - INFO - Created role_matrix with 2112 rows
2025-06-12 16:47:52,819 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-12 16:47:52,820 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['69ff8819-44af-409a-90cd-29f8df54df5c', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', '05bd23ee-2229-4eff-8de9-b0810c16a1f1', '401b998a-bb2f-4dd4-887e-c0045a3964bf', '00e5df59-0081-4e43-9ae0-7c9969f698dc']...
2025-06-12 16:47:52,821 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['ba878ab9-76b4-eb11-8236-000d3ab5a61f', '8b5606a1-3fba-ee11-a569-0022489b4de1', '4f3d92b3-76b4-eb11-8236-000d3ab5a61f', '60502afb-a2c2-eb11-bacc-0022489c4a92', '6d8bc30e-16d6-eb11-bacb-000d3ab15843']...
2025-06-12 16:47:52,822 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-12 16:47:52,829 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-12 16:47:52,829 - src.core.embeddings - INFO - Starting embedding generation
2025-06-12 16:47:52,830 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-12 16:47:52,830 - src.core.embeddings - INFO - Using batch_size=64
2025-06-12 16:47:52,832 - src.core.embeddings - INFO - Using device: cpu
2025-06-12 16:48:57,093 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-12 16:49:01,618 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-12 16:49:01,618 - src.core.embeddings - INFO - Embedding initialization took 68.78 seconds
2025-06-12 16:49:01,620 - src.core.embeddings - INFO - Memory usage: RSS=363.36 MB, VMS=2703.77 MB
2025-06-12 16:49:01,620 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-12 16:49:01,620 - src.core.embeddings - INFO - Using all logs: audit_logs=31934 rows, signin_logs=5882 rows
2025-06-12 16:49:01,625 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-12 16:49:01,645 - src.core.embeddings - INFO - Precomputed location history in 0.02 seconds
2025-06-12 16:49:02,284 - src.core.embeddings - INFO - Text generation took 0.66 seconds
2025-06-12 16:49:02,285 - src.core.embeddings - INFO - Memory usage: RSS=389.35 MB, VMS=2728.99 MB
2025-06-12 16:49:02,287 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-12 16:49:03,947 - src.core.embeddings - INFO - Total documents to embed: 37816
2025-06-12 16:49:03,948 - src.core.embeddings - INFO - Document conversion took 1.66 seconds
2025-06-12 16:49:03,949 - src.core.embeddings - INFO - Memory usage: RSS=419.18 MB, VMS=2759.05 MB
2025-06-12 16:49:03,950 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-12 16:49:03,952 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-12 16:49:16,588 - src.core.embeddings - INFO - Memory usage: RSS=586.00 MB, VMS=2943.94 MB
2025-06-12 16:49:16,589 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-12 16:49:29,876 - src.core.embeddings - INFO - Memory usage: RSS=660.93 MB, VMS=3018.67 MB
2025-06-12 16:49:29,877 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-12 16:49:42,629 - src.core.embeddings - INFO - Memory usage: RSS=735.72 MB, VMS=3091.94 MB
2025-06-12 16:49:42,629 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-12 16:50:00,399 - src.core.embeddings - INFO - Memory usage: RSS=807.54 MB, VMS=3166.26 MB
2025-06-12 16:50:00,401 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-12 16:50:44,423 - src.core.embeddings - INFO - Memory usage: RSS=881.61 MB, VMS=3240.66 MB
2025-06-12 16:50:44,424 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-12 16:51:36,054 - src.core.embeddings - INFO - Memory usage: RSS=951.96 MB, VMS=3311.29 MB
2025-06-12 16:51:36,054 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-12 16:52:12,863 - src.core.embeddings - INFO - Memory usage: RSS=1193.85 MB, VMS=3553.98 MB
2025-06-12 16:52:12,864 - src.core.embeddings - INFO - Embedding chunk 8/8 (2816 documents)
2025-06-12 16:52:33,628 - src.core.embeddings - INFO - Memory usage: RSS=1246.29 MB, VMS=3606.87 MB
2025-06-12 16:52:33,931 - src.core.embeddings - INFO - Embedding generation took 209.98 seconds
2025-06-12 16:52:33,932 - src.core.embeddings - INFO - Memory usage: RSS=1246.29 MB, VMS=3606.87 MB
2025-06-12 16:52:33,934 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-12 16:52:34,505 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37816 vectors
2025-06-12 16:52:35,515 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-12 16:52:35,529 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-12 16:52:35,530 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-12 16:52:35,530 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.60 seconds
2025-06-12 16:52:35,531 - src.core.embeddings - INFO - Memory usage: RSS=1400.25 MB, VMS=3942.41 MB
2025-06-12 16:52:35,566 - src.core.embeddings - INFO - Total embedding generation took 282.74 seconds
2025-06-12 16:52:35,589 - main - INFO - [analyze] Embeddings generated.
2025-06-12 16:52:35,591 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-12 16:52:35,591 - src.utils.config - INFO - Loading environment variables
2025-06-12 16:52:35,626 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-12 16:52:35,626 - src.core.analysis - INFO - Validating input DataFrames
2025-06-12 16:52:35,696 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 16:52:35,697 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 16:52:35,697 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 16:52:35,698 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-12 16:52:35,698 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-12 16:52:35,710 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-12 16:52:35,710 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-12 16:52:35,711 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-12 16:52:35,711 - src.core.analysis - INFO - User IDs from app_role_assignments: 336
2025-06-12 16:52:35,711 - src.core.analysis - INFO - Total unique user IDs: 511
2025-06-12 16:52:37,581 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-12 16:52:37,617 - src.core.analysis - INFO - Starting analysis
2025-06-12 16:52:37,617 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-12 16:52:40,738 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-12 16:52:40,740 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-12 16:52:40,741 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-12 16:52:40,742 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-12 16:52:40,742 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-12 16:52:40,743 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 16:52:40,743 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5882, 12)
2025-06-12 16:52:40,743 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-12 16:52:40,753 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-12 16:52:40,769 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-12 16:52:40,797 - src.analysis.anomaly_detector - INFO - Successfully mapped 5876 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-12 16:52:40,800 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-12 16:52:40,800 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-12 16:52:40,801 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 21
2025-06-12 16:52:40,801 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-12 16:52:40,801 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-12 16:52:40,802 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-12 16:52:40,802 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-12 16:52:40,802 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-12 16:52:40,803 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-12 16:52:40,803 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-12 16:52:40,803 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-12 16:52:40,803 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-12 16:52:40,804 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-12 16:52:40,804 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-12 16:52:40,805 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-12 16:52:40,805 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-12 16:52:42,120 - src.analysis.anomaly_detector - INFO - Detected 49 anomalies
2025-06-12 16:52:42,121 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-12 16:52:42,122 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> User Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 has an unusual activity pattern (Roles: Unkno...
2025-06-12 16:52:42,122 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-f956b637-d19e-48a5-bde4-01ab0f111c5b -> User Unknown-User-f956b637-d19e-48a5-bde4-01ab0f111c5b has an unusual activity pattern (Roles: Unkno...
2025-06-12 16:52:42,123 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> User Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e has an unusual activity pattern (Roles: Unkno...
2025-06-12 16:52:42,124 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-12 16:52:42,850 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-12 16:52:42,851 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-12 16:52:42,932 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-12 16:52:43,288 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-12 16:52:43,705 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-12 16:52:43,706 - src.core.analysis - INFO - Analyzing inactive users
2025-06-12 16:52:43,707 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-12 16:52:43,707 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-12 16:52:43,707 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-12 16:52:43,715 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-12 11:06:05+0000', tz='UTC'), Timestamp('2025-06-12 11:02:22+0000', tz='UTC'), Timestamp('2025-06-12 10:52:18+0000', tz='UTC'), Timestamp('2025-06-12 10:50:39+0000', tz='UTC'), Timestamp('2025-06-12 10:42:48+0000', tz='UTC')]
2025-06-12 16:52:43,716 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-12 16:52:43,722 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-14 19:06:19+0000', tz='UTC'), Timestamp('2025-03-14 21:43:44+0000', tz='UTC'), Timestamp('2025-03-14 22:30:26+0000', tz='UTC'), Timestamp('2025-03-14 22:31:09+0000', tz='UTC'), Timestamp('2025-03-14 22:31:17+0000', tz='UTC')]
2025-06-12 16:52:43,723 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-12 16:52:44,087 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-12 16:52:44,088 - src.core.analysis - INFO - Total unique user IDs after analysis: 604
2025-06-12 16:52:44,113 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-12 16:52:44,114 - src.core.analysis - INFO - Using chunk size: 200 for 604 users
2025-06-12 16:52:44,115 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-12 16:52:44,118 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-12 16:52:44,119 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 145979 bytes
2025-06-12 16:53:10,468 - src.core.analysis - INFO - Findings chunk 1 completed in 26.35s
2025-06-12 16:53:10,469 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-12 16:53:10,471 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 156791 bytes
2025-06-12 16:53:36,479 - src.core.analysis - INFO - Findings chunk 2 completed in 26.01s
2025-06-12 16:53:36,480 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-12 16:53:36,483 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 139821 bytes
2025-06-12 16:54:06,807 - src.core.analysis - INFO - Findings chunk 3 completed in 30.33s
2025-06-12 16:54:06,808 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-12 16:54:06,808 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 9304 bytes
2025-06-12 16:54:39,856 - src.core.analysis - INFO - Findings chunk 4 completed in 33.05s
2025-06-12 16:54:39,974 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-12 16:54:39,976 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-12 16:54:39,976 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-12 16:54:39,978 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-12 16:54:39,990 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-12 16:54:39,996 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-12 16:54:39,998 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-12 16:54:39,999 - src.core.analysis - INFO - Processed 4/4 chunks (95%)
2025-06-12 16:54:40,001 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-12 16:54:40,001 - src.core.analysis - INFO - Sequential processing completed in 115.88s
2025-06-12 16:54:40,002 - src.core.analysis - INFO - Successfully processed 4/4 chunks
2025-06-12 16:54:40,003 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-12 16:54:40,004 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 604 users
2025-06-12 16:54:40,005 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-12 16:54:40,007 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-12 16:54:40,007 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-12 16:54:40,008 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 18886 bytes
2025-06-12 16:54:57,116 - src.core.analysis - INFO - Recommendations chunk 1 completed in 17.11s
2025-06-12 16:54:57,228 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-12 16:54:57,228 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-12 16:54:57,229 - src.core.analysis - INFO - Analysis completed successfully with 9 recommendations
2025-06-12 16:54:57,230 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:54:57,233 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-12 16:54:57,234 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-12 16:54:57,249 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:54:57,339 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '341220'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ded4bcb8-477f-11f0-a042-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:54:58,095 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:24:58 GMT'
    'ETag': '"0x8DDA9A3C3FD78C8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6049ebdd-d01e-0040-318c-db3715000000'
    'x-ms-client-request-id': 'ded4bcb8-477f-11f0-a042-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:24:58 GMT'
2025-06-12 16:54:58,102 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-12 16:54:58,103 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-12 16:54:58,105 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:54:58,116 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'df4b6f85-477f-11f0-a59a-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:54:58,603 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:24:59 GMT'
    'ETag': '"0x8DDA9A3C4528C35"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd27a6be4-201e-009f-588c-db7c2f000000'
    'x-ms-client-request-id': 'df4b6f85-477f-11f0-a59a-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:24:59 GMT'
2025-06-12 16:54:58,604 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-12 16:54:58,604 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-12 16:54:58,605 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:54:58,654 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'df9d66d4-477f-11f0-b9f0-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:54:59,434 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:00 GMT'
    'ETag': '"0x8DDA9A3C4D02FBE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '474ac6bd-901e-0033-678c-db6f86000000'
    'x-ms-client-request-id': 'df9d66d4-477f-11f0-b9f0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:00 GMT'
2025-06-12 16:54:59,435 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-12 16:54:59,436 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-12 16:54:59,438 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:54:59,442 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e015c762-477f-11f0-a919-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:00,004 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:00 GMT'
    'ETag': '"0x8DDA9A3C526A132"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f0e69e55-a01e-00ae-678c-db9d3c000000'
    'x-ms-client-request-id': 'e015c762-477f-11f0-a919-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:00 GMT'
2025-06-12 16:55:00,006 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-12 16:55:00,007 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-12 16:55:00,009 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:00,042 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e0713eb2-477f-11f0-a8d4-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:00,658 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:01 GMT'
    'ETag': '"0x8DDA9A3C58AE5D0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6b4560ad-a01e-004a-418c-db93a2000000'
    'x-ms-client-request-id': 'e0713eb2-477f-11f0-a8d4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:01 GMT'
2025-06-12 16:55:00,660 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-12 16:55:00,661 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-12 16:55:00,663 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:00,672 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979978'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e0d14dbc-477f-11f0-8ae0-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:01,599 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:02 GMT'
    'ETag': '"0x8DDA9A3C61A7692"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8332b6b0-201e-008f-728c-dbb947000000'
    'x-ms-client-request-id': 'e0d14dbc-477f-11f0-8ae0-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:01 GMT'
2025-06-12 16:55:01,600 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-12 16:55:01,601 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-12 16:55:01,601 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:01,644 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e165c39e-477f-11f0-8d88-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:02,873 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:03 GMT'
    'ETag': '"0x8DDA9A3C6DD1302"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '031f82c7-f01e-001a-178c-db51f2000000'
    'x-ms-client-request-id': 'e165c39e-477f-11f0-8d88-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:02 GMT'
2025-06-12 16:55:02,875 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-12 16:55:02,876 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-12 16:55:02,877 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:02,881 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e2226b24-477f-11f0-bbfe-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:03,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:04 GMT'
    'ETag': '"0x8DDA9A3C7193C24"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '115b8aff-301e-0005-7f8c-dbe2f6000000'
    'x-ms-client-request-id': 'e2226b24-477f-11f0-bbfe-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:03 GMT'
2025-06-12 16:55:03,268 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-12 16:55:03,268 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-12 16:55:03,269 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:03,276 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e25eb4df-477f-11f0-911e-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:03,699 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:04 GMT'
    'ETag': '"0x8DDA9A3C75B2B4C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '20705f27-601e-0037-2f8c-dbe281000000'
    'x-ms-client-request-id': 'e25eb4df-477f-11f0-911e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:03 GMT'
2025-06-12 16:55:03,700 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-12 16:55:03,701 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-12 16:55:03,702 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:03,707 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e2a07673-477f-11f0-87ff-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:04,176 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:05 GMT'
    'ETag': '"0x8DDA9A3C7A4174B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8bb2e96b-401e-007d-478c-db410e000000'
    'x-ms-client-request-id': 'e2a07673-477f-11f0-87ff-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:04 GMT'
2025-06-12 16:55:04,177 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-12 16:55:04,178 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-12 16:55:04,179 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:04,182 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e2e90578-477f-11f0-be2d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:04,598 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:05 GMT'
    'ETag': '"0x8DDA9A3C7E56AC6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6aff8bc2-301e-002a-168c-dbef3d000000'
    'x-ms-client-request-id': 'e2e90578-477f-11f0-be2d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:05 GMT'
2025-06-12 16:55:04,599 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-12 16:55:04,600 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-12 16:55:04,601 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:04,607 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1504207'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e329e581-477f-11f0-9020-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:05,452 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:06 GMT'
    'ETag': '"0x8DDA9A3C866B3B6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd029b53d-001e-006c-708c-dbdbba000000'
    'x-ms-client-request-id': 'e329e581-477f-11f0-9020-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:05 GMT'
2025-06-12 16:55:05,453 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-12 16:55:05,454 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-12 16:55:05,455 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:05,500 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e3b2022f-477f-11f0-9732-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:06,586 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:07 GMT'
    'ETag': '"0x8DDA9A3C913969B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a08d41e0-b01e-009d-598c-dbc297000000'
    'x-ms-client-request-id': 'e3b2022f-477f-11f0-9732-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:06 GMT'
2025-06-12 16:55:06,588 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-12 16:55:06,588 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-12 16:55:06,611 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:06,615 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e45c3e82-477f-11f0-b4c7-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:07,030 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:07 GMT'
    'ETag': '"0x8DDA9A3C9577F41"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'acd645f5-f01e-0025-3d8c-db9951000000'
    'x-ms-client-request-id': 'e45c3e82-477f-11f0-b4c7-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:06 GMT'
2025-06-12 16:55:07,031 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-12 16:55:07,032 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-12 16:55:07,033 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:07,113 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e4a842b5-477f-11f0-a4df-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:07,609 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:08 GMT'
    'ETag': '"0x8DDA9A3C9AFC367"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '37d4a440-b01e-0046-5c8c-db04aa000000'
    'x-ms-client-request-id': 'e4a842b5-477f-11f0-a4df-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:07 GMT'
2025-06-12 16:55:07,610 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-12 16:55:07,694 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-12 16:55:07,695 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:07,699 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e501b4de-477f-11f0-bd31-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:08,527 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:09 GMT'
    'ETag': '"0x8DDA9A3CA0EDDAC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '62533733-101e-0084-378c-db422c000000'
    'x-ms-client-request-id': 'e501b4de-477f-11f0-bd31-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:08 GMT'
2025-06-12 16:55:08,528 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-12 16:55:08,529 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-12 16:55:08,530 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:08,558 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e584b6a2-477f-11f0-80c4-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:09,084 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:09 GMT'
    'ETag': '"0x8DDA9A3CA91849F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8497a4a3-c01e-0097-458c-db6620000000'
    'x-ms-client-request-id': 'e584b6a2-477f-11f0-80c4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:09 GMT'
2025-06-12 16:55:09,085 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-12 16:55:09,086 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-12 16:55:09,087 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:09,091 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107683'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e5d5f630-477f-11f0-b04c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:09,661 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:10 GMT'
    'ETag': '"0x8DDA9A3CAE9EFAE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2b4479ac-101e-003d-1b8c-db4636000000'
    'x-ms-client-request-id': 'e5d5f630-477f-11f0-b04c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:10 GMT'
2025-06-12 16:55:09,663 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-12 16:55:09,664 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-12 16:55:09,665 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-12 16:55:09,697 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e6328a91-477f-11f0-944d-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:10,640 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:11 GMT'
    'ETag': '"0x8DDA9A3CB50A28D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8db9cfd3-f01e-0057-688c-db9e1e000000'
    'x-ms-client-request-id': 'e6328a91-477f-11f0-944d-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:10 GMT'
2025-06-12 16:55:10,642 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-12 16:55:22,237 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-12 16:55:22,318 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-12 16:55:23,009 - main - INFO - [analyze] Analysis completed.
2025-06-12 16:55:23,094 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-12 16:55:23,118 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '201323'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ee325e5c-477f-11f0-9d26-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:23,689 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:24 GMT'
    'ETag': '"0x8DDA9A3D34329C0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53ce-e01e-0006-608c-db0392000000'
    'x-ms-client-request-id': 'ee325e5c-477f-11f0-9d26-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:24 GMT'
2025-06-12 16:55:23,693 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ee8a24b1-477f-11f0-9278-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:23,781 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:24 GMT'
    'ETag': '"0x8DDA9A3D3534448"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53d3-e01e-0006-648c-db0392000000'
    'x-ms-client-request-id': 'ee8a24b1-477f-11f0-9278-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:24 GMT'
2025-06-12 16:55:23,784 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ee980ff3-477f-11f0-a7c8-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:23,882 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:24 GMT'
    'ETag': '"0x8DDA9A3D362C33E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53d4-e01e-0006-658c-db0392000000'
    'x-ms-client-request-id': 'ee980ff3-477f-11f0-a7c8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:24 GMT'
2025-06-12 16:55:23,885 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '122075'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eea77951-477f-11f0-8887-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:23,970 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:24 GMT'
    'ETag': '"0x8DDA9A3D370489D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53d5-e01e-0006-668c-db0392000000'
    'x-ms-client-request-id': 'eea77951-477f-11f0-8887-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:24 GMT'
2025-06-12 16:55:23,973 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eeb4cb6c-477f-11f0-b247-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:24,063 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:24 GMT'
    'ETag': '"0x8DDA9A3D37E907B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53d7-e01e-0006-678c-db0392000000'
    'x-ms-client-request-id': 'eeb4cb6c-477f-11f0-b247-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:24 GMT'
2025-06-12 16:55:24,068 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1979978'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eec35d4b-477f-11f0-8b61-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:24,333 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:25 GMT'
    'ETag': '"0x8DDA9A3D3A7953D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53d8-e01e-0006-688c-db0392000000'
    'x-ms-client-request-id': 'eec35d4b-477f-11f0-8b61-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:25 GMT'
2025-06-12 16:55:24,341 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eeecf5f4-477f-11f0-acb8-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:24,767 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:25 GMT'
    'ETag': '"0x8DDA9A3D3E9D213"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53da-e01e-0006-6a8c-db0392000000'
    'x-ms-client-request-id': 'eeecf5f4-477f-11f0-acb8-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:25 GMT'
2025-06-12 16:55:24,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef2eaa17-477f-11f0-835c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:24,853 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:25 GMT'
    'ETag': '"0x8DDA9A3D3F709A9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53e0-e01e-0006-6d8c-db0392000000'
    'x-ms-client-request-id': 'ef2eaa17-477f-11f0-835c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:25 GMT'
2025-06-12 16:55:24,856 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef3ba1e8-477f-11f0-bed4-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:24,937 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:25 GMT'
    'ETag': '"0x8DDA9A3D403F36F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53e1-e01e-0006-6e8c-db0392000000'
    'x-ms-client-request-id': 'ef3ba1e8-477f-11f0-bed4-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:25 GMT'
2025-06-12 16:55:24,942 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61993'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef48a12f-477f-11f0-9e64-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:25,037 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:25 GMT'
    'ETag': '"0x8DDA9A3D4134B8A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53e2-e01e-0006-6f8c-db0392000000'
    'x-ms-client-request-id': 'ef48a12f-477f-11f0-9e64-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:25 GMT'
2025-06-12 16:55:25,041 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef57c822-477f-11f0-9577-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:25,137 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:26 GMT'
    'ETag': '"0x8DDA9A3D42255D2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53e4-e01e-0006-718c-db0392000000'
    'x-ms-client-request-id': 'ef57c822-477f-11f0-9577-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:26 GMT'
2025-06-12 16:55:25,141 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1504207'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef6712e6-477f-11f0-a50e-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:25,323 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:26 GMT'
    'ETag': '"0x8DDA9A3D43E97B3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53e5-e01e-0006-728c-db0392000000'
    'x-ms-client-request-id': 'ef6712e6-477f-11f0-a50e-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:26 GMT'
2025-06-12 16:55:25,330 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef83edad-477f-11f0-aa2f-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:25,824 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:26 GMT'
    'ETag': '"0x8DDA9A3D48ADB69"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53e9-e01e-0006-758c-db0392000000'
    'x-ms-client-request-id': 'ef83edad-477f-11f0-aa2f-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:26 GMT'
2025-06-12 16:55:25,827 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40610'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'efcfc862-477f-11f0-b324-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:25,909 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:26 GMT'
    'ETag': '"0x8DDA9A3D49812FB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53ed-e01e-0006-788c-db0392000000'
    'x-ms-client-request-id': 'efcfc862-477f-11f0-b324-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:26 GMT'
2025-06-12 16:55:25,911 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'efdc9aec-477f-11f0-8257-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:25,993 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:26 GMT'
    'ETag': '"0x8DDA9A3D4A523B0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53ee-e01e-0006-798c-db0392000000'
    'x-ms-client-request-id': 'efdc9aec-477f-11f0-8257-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:26 GMT'
2025-06-12 16:55:25,996 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50310'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'efe98935-477f-11f0-b94c-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:26,077 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:26 GMT'
    'ETag': '"0x8DDA9A3D4B1E699"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53f1-e01e-0006-7c8c-db0392000000'
    'x-ms-client-request-id': 'efe98935-477f-11f0-b94c-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:26 GMT'
2025-06-12 16:55:26,080 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eff65f0b-477f-11f0-9a24-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:26,165 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:27 GMT'
    'ETag': '"0x8DDA9A3D4BF4509"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53f3-e01e-0006-7e8c-db0392000000'
    'x-ms-client-request-id': 'eff65f0b-477f-11f0-9a24-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:27 GMT'
2025-06-12 16:55:26,168 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107683'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f003d435-477f-11f0-b797-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:26,253 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:27 GMT'
    'ETag': '"0x8DDA9A3D4CCCA79"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53f5-e01e-0006-808c-db0392000000'
    'x-ms-client-request-id': 'f003d435-477f-11f0-b797-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:27 GMT'
2025-06-12 16:55:26,256 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f0112bc7-477f-11f0-bc74-ec4c8c6ceba6'
A body is sent with the request
2025-06-12 16:55:26,340 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Thu, 12 Jun 2025 11:25:27 GMT'
    'ETag': '"0x8DDA9A3D4DA0208"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '338c53f7-e01e-0006-028c-db0392000000'
    'x-ms-client-request-id': 'f0112bc7-477f-11f0-bc74-ec4c8c6ceba6'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Thu, 12 Jun 2025 11:25:27 GMT'
2025-06-12 16:55:26,972 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-12 16:55:27,144 - main - INFO - FastAPI application shutdown
2025-06-12 16:55:55,066 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-12 16:56:23,127 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:56:23,128 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-12 16:56:23,128 - apscheduler.scheduler - INFO - Scheduler started
2025-06-12 16:56:23,130 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-12 16:56:23,130 - main - INFO - FastAPI application started
2025-06-13 15:34:18,063 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-13 15:34:18,095 - main - INFO - FastAPI application shutdown
2025-06-13 15:34:37,133 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-13 15:35:02,815 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 15:35:02,816 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-13 15:35:02,817 - apscheduler.scheduler - INFO - Scheduler started
2025-06-13 15:35:02,818 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-13 15:35:02,818 - main - INFO - FastAPI application started
2025-06-13 15:35:12,582 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-13 15:35:12,583 - main - INFO - FastAPI application shutdown
2025-06-13 15:35:20,786 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-13 15:35:25,536 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 15:35:25,537 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-13 15:35:25,537 - apscheduler.scheduler - INFO - Scheduler started
2025-06-13 15:35:25,538 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-13 15:35:25,539 - main - INFO - FastAPI application started
2025-06-14 09:43:49,523 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 09:43:49,549 - main - INFO - FastAPI application shutdown
2025-06-14 09:44:15,848 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 09:44:42,688 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 09:44:42,689 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 09:44:42,691 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 09:44:42,693 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 09:44:42,693 - main - INFO - FastAPI application started
2025-06-14 09:50:13,807 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 09:50:13,815 - main - INFO - FastAPI application shutdown
2025-06-14 09:50:27,209 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 09:50:33,872 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 09:50:33,873 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 09:50:33,874 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 09:50:33,876 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 09:50:33,877 - main - INFO - FastAPI application started
2025-06-14 09:50:37,671 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 09:50:37,672 - main - INFO - FastAPI application shutdown
2025-06-14 09:50:45,373 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 09:50:50,038 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 09:50:50,039 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 09:50:50,039 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 09:50:50,041 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 09:50:50,042 - main - INFO - FastAPI application started
2025-06-14 09:59:35,136 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 09:59:35,149 - main - INFO - FastAPI application shutdown
2025-06-14 09:59:59,791 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 10:00:18,985 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 10:00:18,986 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 10:00:18,987 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 10:00:18,988 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 10:00:18,989 - main - INFO - FastAPI application started
2025-06-14 10:00:18,991 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 10:00:18,992 - main - INFO - FastAPI application shutdown
2025-06-14 10:00:29,376 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 10:00:36,233 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 10:00:36,234 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 10:00:36,235 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 10:00:36,236 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 10:00:36,237 - main - INFO - FastAPI application started
2025-06-14 10:00:45,281 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 10:00:45,282 - main - INFO - FastAPI application shutdown
2025-06-14 10:00:52,735 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 10:00:57,945 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 10:00:57,946 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 10:00:57,946 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 10:00:57,948 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 10:00:57,949 - main - INFO - FastAPI application started
2025-06-14 10:05:05,813 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 10:05:05,814 - main - INFO - FastAPI application shutdown
2025-06-14 10:05:14,804 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 10:05:20,608 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 10:05:20,609 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 10:05:20,609 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 10:05:20,611 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 10:05:20,611 - main - INFO - FastAPI application started
2025-06-14 10:05:23,382 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-14 10:05:23,385 - main - INFO - FastAPI application shutdown
2025-06-14 10:05:33,041 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-14 10:05:39,259 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-14 10:05:39,260 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-14 10:05:39,261 - apscheduler.scheduler - INFO - Scheduler started
2025-06-14 10:05:39,263 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-14 10:05:39,263 - main - INFO - FastAPI application started
2025-06-16 13:31:20,438 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-16 13:31:20,463 - main - INFO - FastAPI application shutdown
2025-06-16 13:31:59,753 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-16 13:32:29,559 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-16 13:32:29,560 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-16 13:32:29,561 - apscheduler.scheduler - INFO - Scheduler started
2025-06-16 13:32:29,563 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-16 13:32:29,565 - main - INFO - FastAPI application started
2025-06-17 10:58:32,328 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 10:58:32,361 - main - INFO - FastAPI application shutdown
2025-06-17 10:58:58,969 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 10:59:20,175 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 10:59:20,175 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 10:59:20,176 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 10:59:20,178 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 10:59:20,178 - main - INFO - FastAPI application started
2025-06-17 11:17:03,293 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 11:17:03,324 - main - INFO - FastAPI application shutdown
2025-06-17 11:17:34,395 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 11:18:03,557 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 11:18:03,559 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 11:18:03,559 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 11:18:03,563 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 11:18:03,564 - main - INFO - FastAPI application started
2025-06-17 13:12:54,267 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 13:12:54,292 - main - INFO - FastAPI application shutdown
2025-06-17 13:13:17,194 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 13:13:35,377 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 13:13:35,378 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 13:13:35,379 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 13:13:35,381 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 13:13:35,381 - main - INFO - FastAPI application started
2025-06-17 13:14:23,066 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 13:14:23,067 - main - INFO - FastAPI application shutdown
2025-06-17 13:14:31,233 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 13:14:36,504 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 13:14:36,505 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 13:14:36,505 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 13:14:36,508 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 13:14:36,509 - main - INFO - FastAPI application started
2025-06-17 13:43:06,316 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 13:43:06,349 - main - INFO - FastAPI application shutdown
2025-06-17 13:43:45,102 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 13:44:16,605 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 13:44:16,606 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 13:44:16,607 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 13:44:16,608 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 13:44:16,609 - main - INFO - FastAPI application started
2025-06-17 14:40:43,446 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 14:40:43,477 - main - INFO - FastAPI application shutdown
2025-06-17 14:41:05,119 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 14:41:28,368 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 14:41:28,369 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 14:41:28,370 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 14:41:28,372 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 14:41:28,372 - main - INFO - FastAPI application started
2025-06-17 14:51:45,321 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 14:51:45,328 - main - INFO - FastAPI application shutdown
2025-06-17 14:52:07,690 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 14:52:15,823 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 14:52:15,824 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 14:52:15,825 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 14:52:15,826 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 14:52:15,827 - main - INFO - FastAPI application started
2025-06-17 14:56:38,670 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 14:56:38,677 - main - INFO - FastAPI application shutdown
2025-06-17 14:56:57,587 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 14:57:25,894 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 14:57:25,895 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 14:57:25,895 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 14:57:25,897 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 14:57:25,898 - main - INFO - FastAPI application started
2025-06-17 14:59:19,142 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 14:59:19,145 - main - INFO - FastAPI application shutdown
2025-06-17 14:59:30,218 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 14:59:37,784 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 14:59:37,785 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 14:59:37,786 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 14:59:37,788 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 14:59:37,788 - main - INFO - FastAPI application started
2025-06-17 15:29:41,195 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 15:29:41,219 - main - INFO - FastAPI application shutdown
2025-06-17 15:29:59,299 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 15:30:22,101 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 15:30:22,102 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 15:30:22,102 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 15:30:22,104 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 15:30:22,104 - main - INFO - FastAPI application started
2025-06-17 15:30:22,106 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 15:30:22,108 - main - INFO - FastAPI application shutdown
2025-06-17 15:30:31,047 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 15:30:35,983 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 15:30:35,984 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 15:30:35,985 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 15:30:35,987 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 15:30:35,987 - main - INFO - FastAPI application started
2025-06-17 15:32:47,524 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 15:32:47,525 - main - INFO - FastAPI application shutdown
2025-06-17 15:32:55,161 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 15:33:01,372 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 15:33:01,373 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 15:33:01,373 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 15:33:01,375 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 15:33:01,376 - main - INFO - FastAPI application started
2025-06-17 15:35:06,734 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-17 15:35:06,735 - main - INFO - FastAPI application shutdown
2025-06-17 15:35:14,062 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-17 15:35:19,631 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-17 15:35:19,631 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-17 15:35:19,632 - apscheduler.scheduler - INFO - Scheduler started
2025-06-17 15:35:19,634 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-17 15:35:19,634 - main - INFO - FastAPI application started
2025-06-18 16:57:40,108 - apscheduler.executors.default - WARNING - Run time of job "Run analysis every 12 hours (trigger: interval[12:00:00], next run at: 2025-06-18 03:35:19 IST)" was missed by 1:22:20.470935
2025-06-19 15:38:40,220 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-19 15:38:40,233 - main - INFO - FastAPI application shutdown
2025-06-19 15:39:03,891 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-19 15:39:27,377 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-19 15:39:27,378 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-19 15:39:27,378 - apscheduler.scheduler - INFO - Scheduler started
2025-06-19 15:39:27,380 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-19 15:39:27,381 - main - INFO - FastAPI application started
2025-06-19 15:41:18,264 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-19 15:41:18,266 - main - INFO - FastAPI application shutdown
2025-06-19 15:41:29,900 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-19 15:41:36,053 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-19 15:41:36,053 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-19 15:41:36,054 - apscheduler.scheduler - INFO - Scheduler started
2025-06-19 15:41:36,056 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-19 15:41:36,056 - main - INFO - FastAPI application started
2025-06-19 15:43:31,745 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-19 15:43:31,746 - main - INFO - FastAPI application shutdown
2025-06-19 15:43:39,037 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-19 15:43:44,648 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-19 15:43:44,648 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-19 15:43:44,649 - apscheduler.scheduler - INFO - Scheduler started
2025-06-19 15:43:44,650 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-19 15:43:44,651 - main - INFO - FastAPI application started
2025-06-19 15:46:20,171 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-19 15:46:20,175 - main - INFO - FastAPI application shutdown
2025-06-19 15:46:30,439 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-19 15:46:37,026 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-19 15:46:37,027 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-19 15:46:37,028 - apscheduler.scheduler - INFO - Scheduler started
2025-06-19 15:46:37,030 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-19 15:46:37,030 - main - INFO - FastAPI application started
2025-06-19 15:46:40,484 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-19 15:46:40,485 - main - INFO - FastAPI application shutdown
2025-06-19 15:46:47,855 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-19 15:46:55,300 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-19 15:46:55,301 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-19 15:46:55,302 - apscheduler.scheduler - INFO - Scheduler started
2025-06-19 15:46:55,304 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-19 15:46:55,305 - main - INFO - FastAPI application started
2025-06-19 15:47:47,179 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-19 15:47:47,180 - main - INFO - FastAPI application shutdown
2025-06-19 15:48:01,177 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-19 15:48:22,535 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-19 15:48:22,536 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-19 15:48:22,537 - apscheduler.scheduler - INFO - Scheduler started
2025-06-19 15:48:22,539 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-19 15:48:22,540 - main - INFO - FastAPI application started
2025-06-20 14:12:51,081 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:13:08,533 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:13:08,533 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:13:08,536 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:13:08,537 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:13:08,537 - main - INFO - FastAPI application started
2025-06-20 14:17:11,284 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:17:11,285 - main - INFO - FastAPI application shutdown
2025-06-20 14:17:28,725 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:17:42,431 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:17:42,432 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:17:42,433 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:17:42,434 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:17:42,435 - main - INFO - FastAPI application started
2025-06-20 14:18:48,231 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:18:48,232 - main - INFO - FastAPI application shutdown
2025-06-20 14:18:54,526 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:18:58,477 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:18:58,478 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:18:58,478 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:18:58,480 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:18:58,480 - main - INFO - FastAPI application started
2025-06-20 14:19:23,330 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:19:23,332 - main - INFO - FastAPI application shutdown
2025-06-20 14:19:28,986 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:19:32,964 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:19:32,965 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:19:32,965 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:19:32,966 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:19:32,967 - main - INFO - FastAPI application started
2025-06-20 14:21:21,651 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:21:21,652 - main - INFO - FastAPI application shutdown
2025-06-20 14:21:26,862 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:21:30,473 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:21:30,474 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:21:30,474 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:21:30,475 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:21:30,476 - main - INFO - FastAPI application started
2025-06-20 14:24:07,659 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:24:07,661 - main - INFO - FastAPI application shutdown
2025-06-20 14:24:13,543 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:24:17,335 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:24:17,335 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:24:17,335 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:24:17,337 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:24:17,337 - main - INFO - FastAPI application started
2025-06-20 14:53:11,984 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:53:12,004 - main - INFO - FastAPI application shutdown
2025-06-20 14:53:34,315 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:53:54,168 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:53:54,169 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:53:54,169 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:53:54,171 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:53:54,171 - main - INFO - FastAPI application started
2025-06-20 14:58:43,691 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:58:43,695 - main - INFO - FastAPI application shutdown
2025-06-20 14:58:49,966 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:58:54,108 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:58:54,109 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:58:54,109 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:58:54,110 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:58:54,111 - main - INFO - FastAPI application started
2025-06-20 14:59:30,922 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 14:59:30,923 - main - INFO - FastAPI application shutdown
2025-06-20 14:59:38,039 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 14:59:41,673 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 14:59:41,673 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 14:59:41,674 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 14:59:41,675 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 14:59:41,675 - main - INFO - FastAPI application started
2025-06-20 15:00:51,809 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:00:51,810 - main - INFO - FastAPI application shutdown
2025-06-20 15:00:57,756 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:01:01,906 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:01:01,907 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:01:01,907 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:01:01,909 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:01:01,909 - main - INFO - FastAPI application started
2025-06-20 15:01:06,820 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:01:06,821 - main - INFO - FastAPI application shutdown
2025-06-20 15:01:12,717 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:01:17,770 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:01:17,771 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:01:17,771 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:01:17,773 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:01:17,774 - main - INFO - FastAPI application started
2025-06-20 15:04:15,283 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:04:15,283 - main - INFO - FastAPI application shutdown
2025-06-20 15:04:33,877 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:04:52,629 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:04:52,631 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:04:52,631 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:04:52,633 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:04:52,633 - main - INFO - FastAPI application started
2025-06-20 15:08:15,696 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:08:15,698 - main - INFO - FastAPI application shutdown
2025-06-20 15:08:22,523 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:08:28,303 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:08:28,304 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:08:28,305 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:08:28,306 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:08:28,307 - main - INFO - FastAPI application started
2025-06-20 15:15:02,549 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:15:02,551 - main - INFO - FastAPI application shutdown
2025-06-20 15:15:08,488 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:15:12,464 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:15:12,465 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:15:12,466 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:15:12,467 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:15:12,467 - main - INFO - FastAPI application started
2025-06-20 15:16:38,549 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:16:38,550 - main - INFO - FastAPI application shutdown
2025-06-20 15:16:45,660 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:16:49,912 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:16:49,913 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:16:49,914 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:16:49,915 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:16:49,916 - main - INFO - FastAPI application started
2025-06-20 15:16:55,903 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:16:55,904 - main - INFO - FastAPI application shutdown
2025-06-20 15:17:07,691 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:17:27,095 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:17:27,096 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:17:27,096 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:17:27,098 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:17:27,098 - main - INFO - FastAPI application started
2025-06-20 15:18:48,272 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 15:18:48,274 - main - INFO - FastAPI application shutdown
2025-06-20 15:19:01,163 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 15:19:06,151 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 15:19:06,152 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 15:19:06,153 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 15:19:06,154 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 15:19:06,155 - main - INFO - FastAPI application started
2025-06-20 18:19:40,947 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:19:40,973 - main - INFO - FastAPI application shutdown
2025-06-20 18:20:00,573 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:20:17,340 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:20:17,340 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:20:17,341 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:20:17,341 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:20:17,342 - main - INFO - FastAPI application started
2025-06-20 18:20:17,344 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:20:17,344 - main - INFO - FastAPI application shutdown
2025-06-20 18:20:23,033 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:20:26,411 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:20:26,411 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:20:26,412 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:20:26,413 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:20:26,413 - main - INFO - FastAPI application started
2025-06-20 18:21:12,188 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:21:12,189 - main - INFO - FastAPI application shutdown
2025-06-20 18:21:17,570 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:21:21,147 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:21:21,148 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:21:21,148 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:21:21,149 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:21:21,150 - main - INFO - FastAPI application started
2025-06-20 18:22:15,216 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:22:15,218 - main - INFO - FastAPI application shutdown
2025-06-20 18:22:20,154 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:22:24,113 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:22:24,113 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:22:24,114 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:22:24,115 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:22:24,115 - main - INFO - FastAPI application started
2025-06-20 18:23:29,648 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:23:29,649 - main - INFO - FastAPI application shutdown
2025-06-20 18:23:35,881 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:23:39,634 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:23:39,638 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:23:39,639 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:23:39,641 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:23:39,641 - main - INFO - FastAPI application started
2025-06-20 18:23:44,654 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:23:44,655 - main - INFO - FastAPI application shutdown
2025-06-20 18:23:50,023 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:23:53,395 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:23:53,396 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:23:53,396 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:23:53,397 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:23:53,398 - main - INFO - FastAPI application started
2025-06-20 18:24:09,202 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:24:09,203 - main - INFO - FastAPI application shutdown
2025-06-20 18:24:16,179 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:24:20,263 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:24:20,264 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:24:20,264 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:24:20,265 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:24:20,266 - main - INFO - FastAPI application started
2025-06-20 18:25:08,412 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 18:25:08,413 - main - INFO - FastAPI application shutdown
2025-06-20 18:25:14,346 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 18:25:18,701 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 18:25:18,702 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 18:25:18,703 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 18:25:18,704 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 18:25:18,705 - main - INFO - FastAPI application started
2025-06-20 18:27:57,770 - d365 - INFO - Loading D365 data
2025-06-20 18:27:57,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:27:58,122 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '382080fd-1a60-4984-ab36-200b3b9c1b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:57:58 GMT'
    'Content-Length': '1753'
2025-06-20 18:27:58,135 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:27:58,346 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c0f1a706-e6aa-4d2c-bffe-1ff095321500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:57:58 GMT'
    'Content-Length': '1648'
2025-06-20 18:27:58,347 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:27:58,347 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 18:27:58,348 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-22T12:57:58Z)
2025-06-20 18:28:04,029 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-20 18:28:07,133 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-20 18:28:10,063 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-20 18:28:13,094 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-20 18:28:16,302 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-20 18:28:19,201 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-20 18:28:21,003 - d365 - INFO - Progress: Fetched 32311 audit logs after 7 pages
2025-06-20 18:28:21,037 - d365 - INFO - Fetched 32311 D365 audit logs via Dataverse
2025-06-20 18:28:21,106 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-20 18:28:21,114 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:28:21,332 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a3d0462a-3cc9-40e6-985e-fa7c41e31000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:58:21 GMT'
    'Content-Length': '1753'
2025-06-20 18:28:21,333 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:28:21,576 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3a66b594-43d9-41d0-bb1c-593736da1000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:58:21 GMT'
    'Content-Length': '1991'
2025-06-20 18:28:21,577 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:28:21,577 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 18:28:21,577 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-22T12:58:21Z)
2025-06-20 18:28:21,578 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-20 18:28:40,417 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 3.2 req/min | Time: 0:00:18
2025-06-20 18:29:00,929 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-22T12%3a58%3a21Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=65d5eabd9d7ad057a2c313371a065560ff3e13a4b13f2c6c242d53351876ba2b: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 18:29:00,930 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-22T12%3a58%3a21Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=65d5eabd9d7ad057a2c313371a065560ff3e13a4b13f2c6c242d53351876ba2b: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 18:29:00,932 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 18:29:00,984 - d365 - INFO - Loaded 5882 sign-in logs from CSV
2025-06-20 18:29:00,985 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:29:01,298 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7fff2b54-15e8-438c-8d46-5a20f9c61300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:59:01 GMT'
    'Content-Length': '1753'
2025-06-20 18:29:01,299 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:29:01,557 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd0b55f77-a60e-40a6-9ac3-f32afd941200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:59:01 GMT'
    'Content-Length': '1647'
2025-06-20 18:29:01,558 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:29:01,559 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 18:29:01,560 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:29:01,803 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7f2f963d-a6b9-4240-a849-98adcdca1200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:59:01 GMT'
    'Content-Length': '1753'
2025-06-20 18:29:01,804 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:29:02,071 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'eb4656e5-50a8-4f26-b47d-4b33bc021200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:59:02 GMT'
    'Content-Length': '1996'
2025-06-20 18:29:02,072 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:29:02,073 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 18:29:02,074 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:29:02,419 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3a66b594-43d9-41d0-bb1c-593731dd1000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:59:02 GMT'
    'Content-Length': '1753'
2025-06-20 18:29:02,420 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:29:02,693 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '53fff2a5-6086-488d-97c9-5de472511100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 12:59:02 GMT'
    'Content-Length': '1989'
2025-06-20 18:29:02,694 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:29:02,694 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 18:29:05,689 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-20 18:29:05,690 - d365 - INFO - Found 981 users in Entra ID
2025-06-20 18:29:07,011 - d365 - INFO - Fetched 936 user records from D365
2025-06-20 18:30:37,810 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-20 18:30:37,811 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-20 18:31:30,872 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-20 18:31:30,874 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-20 18:31:34,101 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-20 18:31:34,103 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-20 18:31:40,541 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-20 18:31:40,543 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-20 18:32:26,487 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-20 18:32:26,488 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-20 18:32:51,628 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-20 18:32:51,629 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-20 18:33:06,129 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-20 18:33:06,130 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-20 18:33:45,866 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-20 18:33:45,867 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-20 18:33:45,868 - d365 - INFO - Final user count after filtering: 205
2025-06-20 18:33:45,871 - d365 - INFO - Fetched 205 user details after filtering
2025-06-20 18:33:45,884 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-20 18:33:45,909 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-20 18:33:45,936 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-20 18:33:45,943 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:33:46,184 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '566dfb18-ca45-46f8-9d4a-ebc554d61500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:46 GMT'
    'Content-Length': '1753'
2025-06-20 18:33:46,185 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:33:46,385 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7bfb08ab-0f1e-4d72-8e7d-610ee73b1600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:46 GMT'
    'Content-Length': '1652'
2025-06-20 18:33:46,387 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:33:46,388 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 18:33:47,947 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-20 18:33:47,963 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-20 18:33:47,968 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:33:48,127 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fe455092-2b11-4058-8bf4-ba362b0c1200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:48 GMT'
    'Content-Length': '1753'
2025-06-20 18:33:48,129 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:33:48,315 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5dcf58dd-db94-4c74-b9ae-4f30582b0c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:48 GMT'
    'Content-Length': '1652'
2025-06-20 18:33:48,316 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:33:48,317 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 18:33:51,057 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-20 18:33:51,071 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-20 18:33:51,076 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:33:51,294 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd5dba252-97e6-4f48-bc0f-619c347b1200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:51 GMT'
    'Content-Length': '1753'
2025-06-20 18:33:51,297 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:33:51,493 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd5dba252-97e6-4f48-bc0f-619c367b1200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:51 GMT'
    'Content-Length': '1996'
2025-06-20 18:33:51,495 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:33:51,496 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 18:33:54,495 - d365 - INFO - Fetched 35 conditional access policies
2025-06-20 18:33:54,504 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-20 18:33:54,506 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 18:33:54,764 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '73acca24-52da-4602-bc14-e3fdd23a0500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:55 GMT'
    'Content-Length': '1753'
2025-06-20 18:33:54,766 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 18:33:54,940 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '73acca24-52da-4602-bc14-e3fdd43a0500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:03:55 GMT'
    'Content-Length': '1651'
2025-06-20 18:33:54,942 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 18:33:54,943 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 18:33:55,673 - d365 - INFO - Fetched 11 business units
2025-06-20 18:33:55,677 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-20 18:33:55,711 - d365 - INFO - D365 data loaded successfully
2025-06-20 18:33:55,727 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-20 18:33:55,728 - main - INFO - Loading data from CSV files
2025-06-20 18:33:55,879 - main - INFO - Loaded audit_logs with 32311 rows
2025-06-20 18:33:55,975 - main - INFO - Loaded signin_logs with 5882 rows
2025-06-20 18:33:56,004 - main - INFO - Loaded user_details with 205 rows
2025-06-20 18:33:56,011 - main - INFO - Loaded app_roles with 2112 rows
2025-06-20 18:33:56,053 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-20 18:33:56,233 - main - INFO - Created group_memberships with 3296 rows
2025-06-20 18:33:56,314 - main - INFO - Created role_matrix with 2112 rows
2025-06-20 18:33:56,326 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-20 18:33:56,328 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['8d5429c6-df27-449e-baca-523753e23005', 'c513748e-b901-4066-8af2-8fd89aad704c', '3cac4936-d302-442e-be13-d025ceb75f3a', 'b547f4bc-a21b-428d-b1ea-4cabca29522b', '3c36d97e-3ab6-4843-906a-4046a5a6e056']...
2025-06-20 18:33:56,330 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['dfc9fddf-a4fb-ef11-bae4-000d3ab483e3', '55b271d9-a4fb-ef11-bae4-000d3ab483e3', '21dcaf28-4cab-ec11-983f-000d3adf9c9b', 'e58458c7-0baa-eb11-8236-0022489b4c66', '376654e0-28a4-ed11-aad1-0022489b4de1']...
2025-06-20 18:33:56,332 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-20 18:33:56,350 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-20 18:33:56,352 - src.core.embeddings - INFO - Starting embedding generation
2025-06-20 18:33:56,353 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-20 18:33:56,354 - src.core.embeddings - INFO - Using batch_size=64
2025-06-20 18:33:56,356 - src.core.embeddings - INFO - Using device: cpu
2025-06-20 18:34:51,322 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-20 18:34:58,017 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-20 18:34:58,019 - src.core.embeddings - INFO - Embedding initialization took 61.66 seconds
2025-06-20 18:34:58,021 - src.core.embeddings - INFO - Memory usage: RSS=513.70 MB, VMS=2701.67 MB
2025-06-20 18:34:58,022 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-20 18:34:58,023 - src.core.embeddings - INFO - Using all logs: audit_logs=32311 rows, signin_logs=5882 rows
2025-06-20 18:34:58,045 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-20 18:34:58,112 - src.core.embeddings - INFO - Precomputed location history in 0.07 seconds
2025-06-20 18:35:00,105 - src.core.embeddings - INFO - Text generation took 2.08 seconds
2025-06-20 18:35:00,106 - src.core.embeddings - INFO - Memory usage: RSS=539.73 MB, VMS=2726.69 MB
2025-06-20 18:35:00,107 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-20 18:35:05,706 - src.core.embeddings - INFO - Total documents to embed: 38193
2025-06-20 18:35:05,707 - src.core.embeddings - INFO - Document conversion took 5.60 seconds
2025-06-20 18:35:05,708 - src.core.embeddings - INFO - Memory usage: RSS=569.80 MB, VMS=2757.75 MB
2025-06-20 18:35:05,709 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-20 18:35:05,714 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-20 18:35:21,568 - src.core.embeddings - INFO - Memory usage: RSS=735.91 MB, VMS=2942.41 MB
2025-06-20 18:35:21,569 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-20 18:35:37,727 - src.core.embeddings - INFO - Memory usage: RSS=811.10 MB, VMS=3016.95 MB
2025-06-20 18:35:37,728 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-20 18:35:54,678 - src.core.embeddings - INFO - Memory usage: RSS=885.69 MB, VMS=3091.40 MB
2025-06-20 18:35:54,680 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-20 18:36:11,926 - src.core.embeddings - INFO - Memory usage: RSS=959.23 MB, VMS=3165.47 MB
2025-06-20 18:36:11,928 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-20 18:36:29,645 - src.core.embeddings - INFO - Memory usage: RSS=1032.84 MB, VMS=3238.66 MB
2025-06-20 18:36:29,646 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-20 18:36:48,473 - src.core.embeddings - INFO - Memory usage: RSS=1106.21 MB, VMS=3312.47 MB
2025-06-20 18:36:48,474 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-20 18:37:22,755 - src.core.embeddings - INFO - Memory usage: RSS=1362.90 MB, VMS=3567.73 MB
2025-06-20 18:37:22,757 - src.core.embeddings - INFO - Embedding chunk 8/8 (3193 documents)
2025-06-20 18:37:54,931 - src.core.embeddings - INFO - Memory usage: RSS=1411.68 MB, VMS=3616.79 MB
2025-06-20 18:37:55,609 - src.core.embeddings - INFO - Embedding generation took 169.90 seconds
2025-06-20 18:37:55,610 - src.core.embeddings - INFO - Memory usage: RSS=1411.68 MB, VMS=3616.79 MB
2025-06-20 18:37:55,612 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-20 18:37:57,202 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 38193 vectors
2025-06-20 18:37:58,889 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-20 18:37:58,916 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-20 18:37:58,916 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-20 18:37:58,917 - src.core.embeddings - INFO - FAISS vectorstore creation took 3.30 seconds
2025-06-20 18:37:58,918 - src.core.embeddings - INFO - Memory usage: RSS=1615.95 MB, VMS=3958.93 MB
2025-06-20 18:37:58,932 - src.core.embeddings - INFO - Total embedding generation took 242.58 seconds
2025-06-20 18:37:58,990 - main - INFO - [analyze] Embeddings generated.
2025-06-20 18:37:58,991 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-20 18:37:58,991 - src.utils.config - INFO - Loading environment variables
2025-06-20 18:37:59,043 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-20 18:37:59,044 - src.core.analysis - INFO - Validating input DataFrames
2025-06-20 18:37:59,214 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 18:37:59,215 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 18:37:59,216 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 18:37:59,216 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-20 18:37:59,217 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-20 18:37:59,228 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-20 18:37:59,229 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-20 18:37:59,229 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-20 18:37:59,230 - src.core.analysis - INFO - User IDs from app_role_assignments: 335
2025-06-20 18:37:59,230 - src.core.analysis - INFO - Total unique user IDs: 511
2025-06-20 18:38:01,954 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-20 18:38:01,998 - src.core.analysis - INFO - Starting analysis
2025-06-20 18:38:01,999 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-20 18:38:08,536 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-20 18:38:08,538 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-20 18:38:08,540 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-20 18:38:08,541 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-20 18:38:08,542 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-20 18:38:08,542 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 18:38:08,543 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5882, 12)
2025-06-20 18:38:08,543 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 18:38:08,560 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-20 18:38:08,597 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-20 18:38:08,658 - src.analysis.anomaly_detector - INFO - Successfully mapped 5876 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-20 18:38:08,668 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-20 18:38:08,669 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-20 18:38:08,670 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-20 18:38:08,671 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-20 18:38:08,672 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-20 18:38:08,673 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-20 18:38:08,675 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-20 18:38:08,676 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-20 18:38:08,677 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-20 18:38:08,678 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-20 18:38:08,679 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-20 18:38:08,680 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-20 18:38:08,681 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-20 18:38:08,682 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-20 18:38:08,683 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-20 18:38:08,684 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-20 18:38:08,685 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-20 18:38:08,686 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-20 18:38:12,147 - src.analysis.anomaly_detector - INFO - Detected 39 anomalies
2025-06-20 18:38:12,148 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-20 18:38:12,149 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> User Vikneshkumar Palanisamy had 2467 sign-ins (avg: 82.8, threshold: 674.9) in the period.; User us...
2025-06-20 18:38:12,150 - src.analysis.anomaly_detector - INFO - Example 2: Lhakpa Tsheri Sherpa -> User usually signs in from Kathmandu, NP (78.8%), but on 2025-06-11 signed in from Unknown, NP.; Use...
2025-06-20 18:38:12,152 - src.analysis.anomaly_detector - INFO - Example 3: Ramakrishna V -> User usually signs in from Bengaluru, IN (98.0%), but on 2025-06-02 signed in from Delhi, IN....
2025-06-20 18:38:12,153 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-20 18:38:14,012 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-20 18:38:14,012 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-20 18:38:14,280 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-20 18:38:15,012 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-20 18:38:16,069 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-20 18:38:16,070 - src.core.analysis - INFO - Analyzing inactive users
2025-06-20 18:38:16,071 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-20 18:38:16,071 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 18:38:16,072 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 18:38:16,082 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-12 11:06:05+0000', tz='UTC'), Timestamp('2025-06-12 11:02:22+0000', tz='UTC'), Timestamp('2025-06-12 10:52:18+0000', tz='UTC'), Timestamp('2025-06-12 10:50:39+0000', tz='UTC'), Timestamp('2025-06-12 10:42:48+0000', tz='UTC')]
2025-06-20 18:38:16,083 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-20 18:38:16,093 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-22 16:47:30+0000', tz='UTC'), Timestamp('2025-03-22 19:47:30+0000', tz='UTC'), Timestamp('2025-03-22 22:23:41+0000', tz='UTC'), Timestamp('2025-03-22 22:30:24+0000', tz='UTC'), Timestamp('2025-03-22 22:30:40+0000', tz='UTC')]
2025-06-20 18:38:16,095 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-20 18:38:17,031 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-20 18:38:17,035 - src.core.analysis - INFO - Total unique user IDs after analysis: 593
2025-06-20 18:38:17,164 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-20 18:38:17,165 - src.core.analysis - INFO - Using chunk size: 200 for 593 users
2025-06-20 18:38:17,166 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-20 18:38:17,168 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-20 18:38:17,170 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 150622 bytes
2025-06-20 18:38:41,149 - src.core.analysis - INFO - Findings chunk 1 completed in 23.98s
2025-06-20 18:38:41,150 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-20 18:38:41,153 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 151514 bytes
2025-06-20 18:39:03,258 - src.core.analysis - INFO - Findings chunk 2 completed in 22.11s
2025-06-20 18:39:03,259 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-20 18:39:03,262 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 137796 bytes
2025-06-20 18:39:24,488 - src.core.analysis - INFO - Findings chunk 3 completed in 21.23s
2025-06-20 18:39:24,596 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-20 18:39:24,599 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-20 18:39:24,600 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-20 18:39:24,601 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-20 18:39:24,602 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-20 18:39:24,604 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-20 18:39:24,606 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-20 18:39:24,608 - src.core.analysis - INFO - Sequential processing completed in 67.44s
2025-06-20 18:39:24,609 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-20 18:39:24,611 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-20 18:39:24,612 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 593 users
2025-06-20 18:39:24,616 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-20 18:39:24,618 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-20 18:39:24,620 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-20 18:39:24,621 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 11947 bytes
2025-06-20 18:39:34,364 - src.core.analysis - INFO - Recommendations chunk 1 completed in 9.74s
2025-06-20 18:39:34,469 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-20 18:39:34,470 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-20 18:39:34,470 - src.core.analysis - INFO - Analysis completed successfully with 11 recommendations
2025-06-20 18:39:34,471 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:34,472 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\audit_logs_full_sample.csv', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\d365_roles.csv', 'D:\\Production\\backend\\data\\role_usage_heuristic_output.csv', 'D:\\Production\\backend\\data\\role_usage_per_user_summary.csv', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-20 18:39:34,475 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-20 18:39:34,477 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:34,519 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '201323'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cfa0598a-4dd7-11f0-8a09-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:35,244 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:35 GMT'
    'ETag': '"0x8DDAFFBB4AFE87C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '00a69789-101e-003d-6ce4-e14636000000'
    'x-ms-client-request-id': 'cfa0598a-4dd7-11f0-8a09-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:35 GMT'
2025-06-20 18:39:35,246 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-20 18:39:35,248 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-20 18:39:35,250 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:35,253 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd010756a-4dd7-11f0-a321-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:35,805 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:36 GMT'
    'ETag': '"0x8DDAFFBB506CE7A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '086b401a-f01e-0057-71e4-e19e1e000000'
    'x-ms-client-request-id': 'd010756a-4dd7-11f0-a321-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:36 GMT'
2025-06-20 18:39:35,806 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-20 18:39:35,808 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-20 18:39:35,810 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:35,879 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd06fd763-4dd7-11f0-b14c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:36,460 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:37 GMT'
    'ETag': '"0x8DDAFFBB56AEC09"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '187b380f-101e-0084-50e4-e1422c000000'
    'x-ms-client-request-id': 'd06fd763-4dd7-11f0-b14c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:36 GMT'
2025-06-20 18:39:36,462 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-20 18:39:36,464 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-20 18:39:36,466 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:36,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd0ca45ff-4dd7-11f0-8c6b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:37,017 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:37 GMT'
    'ETag': '"0x8DDAFFBB5BFD870"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b14e6a13-901e-006e-5ae4-e16502000000'
    'x-ms-client-request-id': 'd0ca45ff-4dd7-11f0-8c6b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:37 GMT'
2025-06-20 18:39:37,019 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-20 18:39:37,023 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-20 18:39:37,026 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:37,072 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd125fcee-4dd7-11f0-82c8-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:37,669 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:38 GMT'
    'ETag': '"0x8DDAFFBB6238153"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '00a69802-101e-003d-4fe4-e14636000000'
    'x-ms-client-request-id': 'd125fcee-4dd7-11f0-82c8-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:37 GMT'
2025-06-20 18:39:37,672 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-20 18:39:37,674 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-20 18:39:37,676 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:37,683 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003352'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd183331d-4dd7-11f0-bba1-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:40,222 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:40 GMT'
    'ETag': '"0x8DDAFFBB7A8E07C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '086b403b-f01e-0057-04e4-e19e1e000000'
    'x-ms-client-request-id': 'd183331d-4dd7-11f0-bba1-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:40 GMT'
2025-06-20 18:39:40,225 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-20 18:39:40,227 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-20 18:39:40,230 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:40,282 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd30fb94a-4dd7-11f0-bb31-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:42,206 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:42 GMT'
    'ETag': '"0x8DDAFFBB8D732C5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '83478917-801e-0062-4ce4-e1f20a000000'
    'x-ms-client-request-id': 'd30fb94a-4dd7-11f0-bb31-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:42 GMT'
2025-06-20 18:39:42,210 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-20 18:39:42,213 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs_full_sample.csv to blob as audit_logs_full_sample.csv
2025-06-20 18:39:42,216 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:42,284 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd4414451-4dd7-11f0-8eb4-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:43,268 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:43 GMT'
    'ETag': '"0x8DDAFFBB978FE51"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19cf2f61-c01e-00a8-79e4-e1ae83000000'
    'x-ms-client-request-id': 'd4414451-4dd7-11f0-8eb4-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:43 GMT'
2025-06-20 18:39:43,271 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs_full_sample.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv
2025-06-20 18:39:43,274 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-20 18:39:43,278 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:43,283 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd4d9bb44-4dd7-11f0-bcde-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:43,609 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:44 GMT'
    'ETag': '"0x8DDAFFBB9ADB5AE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'eff351dc-401e-0099-6de4-e14f90000000'
    'x-ms-client-request-id': 'd4d9bb44-4dd7-11f0-bcde-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:43 GMT'
2025-06-20 18:39:43,611 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-20 18:39:43,613 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-20 18:39:43,615 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:43,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd511edbb-4dd7-11f0-a120-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:43,972 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:44 GMT'
    'ETag': '"0x8DDAFFBB9E5291F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9155c1f1-e01e-0090-1fe4-e10a43000000'
    'x-ms-client-request-id': 'd511edbb-4dd7-11f0-a120-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:44 GMT'
2025-06-20 18:39:43,973 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-20 18:39:43,974 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-20 18:39:43,976 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:43,978 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd543cad8-4dd7-11f0-a1fd-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:44,417 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:45 GMT'
    'ETag': '"0x8DDAFFBBA28EAC3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3703a100-d01e-008b-44e4-e13440000000'
    'x-ms-client-request-id': 'd543cad8-4dd7-11f0-a1fd-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:45 GMT'
2025-06-20 18:39:44,418 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-20 18:39:44,420 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-20 18:39:44,421 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:44,460 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd58d48a5-4dd7-11f0-abb7-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:44,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:45 GMT'
    'ETag': '"0x8DDAFFBBA735BA4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3f0fe969-d01e-001d-40e4-e13d91000000'
    'x-ms-client-request-id': 'd58d48a5-4dd7-11f0-abb7-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:45 GMT'
2025-06-20 18:39:44,906 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-20 18:39:44,907 - src.core.analysis - INFO - Uploading D:\Production\backend\data\d365_roles.csv to blob as d365_roles.csv
2025-06-20 18:39:44,909 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:44,934 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd5d5a74b-4dd7-11f0-bc6b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:45,436 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:46 GMT'
    'ETag': '"0x8DDAFFBBAC4A2A6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '89608041-701e-0014-15e4-e17842000000'
    'x-ms-client-request-id': 'd5d5a74b-4dd7-11f0-bc6b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:45 GMT'
2025-06-20 18:39:45,437 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\d365_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv
2025-06-20 18:39:45,439 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_heuristic_output.csv to blob as role_usage_heuristic_output.csv
2025-06-20 18:39:45,441 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:45,480 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd628f4c4-4dd7-11f0-8911-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:45,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:46 GMT'
    'ETag': '"0x8DDAFFBBB1A7866"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '47770e7c-f01e-009c-6fe4-e19d4b000000'
    'x-ms-client-request-id': 'd628f4c4-4dd7-11f0-8911-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:45 GMT'
2025-06-20 18:39:45,999 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_heuristic_output.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv
2025-06-20 18:39:46,000 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_per_user_summary.csv to blob as role_usage_per_user_summary.csv
2025-06-20 18:39:46,001 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:46,007 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-blob-type': 'REDACTED'
    'Content-Length': '0'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd67947a4-4dd7-11f0-8883-c5823ebe3fa0'
No body was attached to the request
2025-06-20 18:39:46,320 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:47 GMT'
    'ETag': '"0x8DDAFFBBB4B3C99"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'eb319a23-b01e-0069-1de4-e10961000000'
    'x-ms-client-request-id': 'd67947a4-4dd7-11f0-8883-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:46 GMT'
2025-06-20 18:39:46,323 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_per_user_summary.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv
2025-06-20 18:39:46,326 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-20 18:39:46,331 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:46,344 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1504207'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd6accccc-4dd7-11f0-b960-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:47,292 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:48 GMT'
    'ETag': '"0x8DDAFFBBBDFD08C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '771ec4dc-d01e-009b-1be4-e1f128000000'
    'x-ms-client-request-id': 'd6accccc-4dd7-11f0-b960-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:47 GMT'
2025-06-20 18:39:47,294 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-20 18:39:47,297 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-20 18:39:47,299 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:47,353 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd746c4e8-4dd7-11f0-b833-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:49,221 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:49 GMT'
    'ETag': '"0x8DDAFFBBD05EEB8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e8eeeeb5-701e-0076-30e4-e1ba65000000'
    'x-ms-client-request-id': 'd746c4e8-4dd7-11f0-b833-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:49 GMT'
2025-06-20 18:39:49,229 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-20 18:39:49,232 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-20 18:39:49,235 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:49,240 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd866b38a-4dd7-11f0-8335-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:49,654 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:50 GMT'
    'ETag': '"0x8DDAFFBBD48048D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5a3f8662-901e-008a-69e4-e16b9c000000'
    'x-ms-client-request-id': 'd866b38a-4dd7-11f0-8335-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:49 GMT'
2025-06-20 18:39:49,656 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-20 18:39:49,657 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-20 18:39:49,659 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:49,698 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8ac81b1-4dd7-11f0-aa7a-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:50,256 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:50 GMT'
    'ETag': '"0x8DDAFFBBDA0BD42"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '85103b81-901e-009a-5ae4-e1aef4000000'
    'x-ms-client-request-id': 'd8ac81b1-4dd7-11f0-aa7a-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:50 GMT'
2025-06-20 18:39:50,258 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-20 18:39:50,260 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-20 18:39:50,262 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:50,267 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd90335e5-4dd7-11f0-a270-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:50,690 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:51 GMT'
    'ETag': '"0x8DDAFFBBDE6519C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6d60c427-801e-004d-3fe4-e1ffc1000000'
    'x-ms-client-request-id': 'd90335e5-4dd7-11f0-a270-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:51 GMT'
2025-06-20 18:39:50,691 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-20 18:39:50,693 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-20 18:39:50,695 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:50,731 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd94a2d96-4dd7-11f0-8aa4-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:51,247 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:51 GMT'
    'ETag': '"0x8DDAFFBBE3B64E1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '33820a53-501e-0071-4ee4-e1d606000000'
    'x-ms-client-request-id': 'd94a2d96-4dd7-11f0-8aa4-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:51 GMT'
2025-06-20 18:39:51,249 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-20 18:39:51,250 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-20 18:39:51,252 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:51,254 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107815'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd99a11f5-4dd7-11f0-941c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:51,760 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:52 GMT'
    'ETag': '"0x8DDAFFBBE89EFD6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c12f1269-a01e-0028-21e4-e15185000000'
    'x-ms-client-request-id': 'd99a11f5-4dd7-11f0-941c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:52 GMT'
2025-06-20 18:39:51,761 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-20 18:39:51,763 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-20 18:39:51,764 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 18:39:51,804 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd9edeea3-4dd7-11f0-9fa6-c5823ebe3fa0'
A body is sent with the request
2025-06-20 18:39:52,320 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 13:09:53 GMT'
    'ETag': '"0x8DDAFFBBEDF0328"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f3724eae-801e-0096-22e4-e139fc000000'
    'x-ms-client-request-id': 'd9edeea3-4dd7-11f0-9fa6-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 13:09:52 GMT'
2025-06-20 18:39:52,322 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-20 18:40:04,885 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-20 18:40:04,947 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-20 18:40:04,953 - src.core.analysis - ERROR - Error during analysis: No columns to parse from file
Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 947, in analyze
    combined_results["user_role_usage"] = load_role_usage_summary()
                                          ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Production\backend\src\core\analysis.py", line 933, in load_role_usage_summary
    df = pd.read_csv(csv_path)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
2025-06-20 18:40:05,071 - src.core.analysis - ERROR - Failed to run analysis: No columns to parse from file
Traceback (most recent call last):
  File "D:\Production\backend\src\core\analysis.py", line 963, in run_analysis
    result = await app.ainvoke({
             ^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    })
    ^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2788, in ainvoke
    async for chunk in self.astream(
    ...<19 lines>...
            chunks.append(chunk)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\__init__.py", line 2655, in astream
    async for _ in runner.atick(
    ...<7 lines>...
            yield o
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\runner.py", line 294, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\pregel\retry.py", line 136, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 672, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
        step.ainvoke(input, config, **kwargs), context=context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\langgraph\utils\runnable.py", line 440, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Production\backend\src\core\analysis.py", line 947, in analyze
    combined_results["user_role_usage"] = load_role_usage_summary()
                                          ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Production\backend\src\core\analysis.py", line 933, in load_role_usage_summary
    df = pd.read_csv(csv_path)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\backend\Production\backend\myenv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
During task with name 'analyze' and id '33d071d7-cdeb-7102-3199-4e4e321dfd6d'
2025-06-20 18:40:05,247 - main - ERROR - [analyze] Analysis failed: No columns to parse from file
2025-06-20 22:01:06,358 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 22:01:06,377 - main - INFO - FastAPI application shutdown
2025-06-20 22:01:25,921 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:01:40,761 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:01:40,762 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:01:40,762 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:01:40,764 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:01:40,764 - main - INFO - FastAPI application started
2025-06-20 22:03:08,874 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 22:03:08,875 - main - INFO - FastAPI application shutdown
2025-06-20 22:03:14,147 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:03:17,537 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:03:17,538 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:03:17,538 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:03:17,539 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:03:17,539 - main - INFO - FastAPI application started
2025-06-20 22:04:58,702 - d365 - INFO - Loading D365 data
2025-06-20 22:04:58,704 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:04:59,016 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e53776d5-11ca-422c-84ea-f9544a301500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:34:59 GMT'
    'Content-Length': '1753'
2025-06-20 22:04:59,025 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:04:59,265 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a8fc589a-5773-4e6d-a182-a1af91fd1600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:34:59 GMT'
    'Content-Length': '1647'
2025-06-20 22:04:59,266 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:04:59,266 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:04:59,267 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-22T16:34:59Z)
2025-06-20 22:05:04,036 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-20 22:05:07,721 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-20 22:05:11,601 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-20 22:05:15,385 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-20 22:05:18,971 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-20 22:05:22,280 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-20 22:05:24,280 - d365 - INFO - Progress: Fetched 32320 audit logs after 7 pages
2025-06-20 22:05:24,301 - d365 - INFO - Fetched 32320 D365 audit logs via Dataverse
2025-06-20 22:05:24,359 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-20 22:05:24,361 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:05:24,681 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '28275faf-c304-46a6-8235-f6bb9b9d1700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:35:24 GMT'
    'Content-Length': '1753'
2025-06-20 22:05:24,683 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:05:24,959 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6799d09c-abf5-45cd-abc2-44b23cca1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:35:25 GMT'
    'Content-Length': '1996'
2025-06-20 22:05:24,960 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:05:24,962 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:05:24,963 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-22T16:35:24Z)
2025-06-20 22:05:24,963 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-20 22:05:40,442 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 3.9 req/min | Time: 0:00:15
2025-06-20 22:05:57,291 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 3.7 req/min | Time: 0:00:32
2025-06-20 22:06:17,800 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-22T16%3a35%3a24Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=6904dc2d2beaa69e6f66a6039fdd4c9f1c9bedb710ee2c33952807327f1a2682: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 22:06:17,801 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-22T16%3a35%3a24Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=6904dc2d2beaa69e6f66a6039fdd4c9f1c9bedb710ee2c33952807327f1a2682: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 22:06:17,802 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 22:06:17,830 - d365 - INFO - Loaded 5882 sign-in logs from CSV
2025-06-20 22:06:17,831 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:06:18,172 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4cdb2825-64b4-4280-aed2-34caa3a31500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:36:18 GMT'
    'Content-Length': '1753'
2025-06-20 22:06:18,173 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:06:18,413 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '49b12553-b315-4cfa-b5f7-252cf6ad1400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:36:18 GMT'
    'Content-Length': '1647'
2025-06-20 22:06:18,414 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:06:18,414 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:06:18,415 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:06:18,729 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3a664103-7e73-44f2-80ad-dba1a1530600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:36:18 GMT'
    'Content-Length': '1753'
2025-06-20 22:06:18,731 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:06:18,968 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0c5f8771-bb48-47ad-baa9-e45380fe1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:36:19 GMT'
    'Content-Length': '1996'
2025-06-20 22:06:18,969 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:06:18,969 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:06:18,970 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:06:19,331 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '98ee7249-71e8-4651-88c4-f416f9d21f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:36:19 GMT'
    'Content-Length': '1753'
2025-06-20 22:06:19,332 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:06:19,581 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '865e4af0-d985-44c1-817d-abcc5bf81600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:36:19 GMT'
    'Content-Length': '1996'
2025-06-20 22:06:19,581 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:06:19,582 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:06:21,833 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-20 22:06:21,834 - d365 - INFO - Found 981 users in Entra ID
2025-06-20 22:07:00,623 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:07:18,194 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:07:18,195 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:07:18,195 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:07:18,196 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:07:18,196 - main - INFO - FastAPI application started
2025-06-20 22:07:25,557 - main - ERROR - [analyze] Analysis failed: name 'user_details' is not defined
2025-06-20 22:07:28,644 - main - ERROR - [analyze] Analysis failed: name 'user_details' is not defined
2025-06-20 22:07:45,624 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 22:07:45,625 - main - INFO - FastAPI application shutdown
2025-06-20 22:07:50,598 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:07:53,705 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:07:53,706 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:07:53,706 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:07:53,707 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:07:53,707 - main - INFO - FastAPI application started
2025-06-20 22:07:53,709 - d365 - INFO - Loading D365 data
2025-06-20 22:07:53,710 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:07:54,001 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8cf627dd-67e6-403a-8124-d4e3e2491700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:37:53 GMT'
    'Content-Length': '1753'
2025-06-20 22:07:54,007 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:07:54,229 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c0539770-ba21-41eb-a343-73979ee71600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:37:54 GMT'
    'Content-Length': '1652'
2025-06-20 22:07:54,231 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:07:54,231 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:07:54,231 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-22T16:37:54Z)
2025-06-20 22:07:58,157 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-20 22:08:00,793 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-20 22:08:03,877 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-20 22:08:06,483 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-20 22:08:09,373 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-20 22:08:11,977 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-20 22:08:13,618 - d365 - INFO - Progress: Fetched 32320 audit logs after 7 pages
2025-06-20 22:08:13,647 - d365 - INFO - Fetched 32320 D365 audit logs via Dataverse
2025-06-20 22:08:13,735 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-20 22:08:13,739 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:08:14,063 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0c5f8771-bb48-47ad-baa9-e4534d081b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:38:14 GMT'
    'Content-Length': '1753'
2025-06-20 22:08:14,065 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:08:14,289 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9285bb54-517f-4fcb-9bee-e0511ccb1b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:38:14 GMT'
    'Content-Length': '1992'
2025-06-20 22:08:14,290 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:08:14,291 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:08:14,292 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-22T16:38:14Z)
2025-06-20 22:08:14,293 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-20 22:08:22,121 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 7.7 req/min | Time: 0:00:07
2025-06-20 22:08:32,496 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 6.6 req/min | Time: 0:00:18
2025-06-20 22:08:47,632 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.4 req/min | Time: 0:00:33
2025-06-20 22:09:08,146 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-22T16%3a38%3a14Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=bbd537e50ee531a1d0040297ade1861146de0534ef96ac6d618f6a1cf3fc1aa2: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 22:09:08,147 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-22T16%3a38%3a14Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=bbd537e50ee531a1d0040297ade1861146de0534ef96ac6d618f6a1cf3fc1aa2: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 22:09:08,148 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-20 22:09:08,171 - d365 - INFO - Loaded 5882 sign-in logs from CSV
2025-06-20 22:09:08,173 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:09:08,540 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1e27830e-93b6-4b02-9dba-ca229f892000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:39:08 GMT'
    'Content-Length': '1753'
2025-06-20 22:09:08,544 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:09:08,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1e27830e-93b6-4b02-9dba-ca22a1892000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:39:09 GMT'
    'Content-Length': '1648'
2025-06-20 22:09:08,770 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:09:08,770 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:09:08,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:09:09,056 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8e6df969-80a9-4431-b9a3-9d5cbcb11b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:39:09 GMT'
    'Content-Length': '1753'
2025-06-20 22:09:09,058 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:09:09,256 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '49f5e548-66bd-4531-82de-b6ab44d21e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:39:09 GMT'
    'Content-Length': '1992'
2025-06-20 22:09:09,257 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:09:09,257 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:09:09,258 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:09:09,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b2b672d8-c816-4f2a-9e88-cde4b3871b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:39:10 GMT'
    'Content-Length': '1753'
2025-06-20 22:09:09,693 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:09:10,001 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'bcac245c-1e52-4e1b-9bd4-c24066461400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:39:10 GMT'
    'Content-Length': '1991'
2025-06-20 22:09:10,002 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:09:10,002 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:09:12,101 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-20 22:09:12,102 - d365 - INFO - Found 981 users in Entra ID
2025-06-20 22:09:14,943 - d365 - INFO - Fetched 936 user records from D365
2025-06-20 22:10:12,546 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-20 22:10:12,547 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-20 22:10:46,911 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-20 22:10:46,912 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-20 22:10:49,081 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-20 22:10:49,082 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-20 22:10:53,500 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-20 22:10:53,501 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-20 22:11:38,538 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-20 22:11:38,539 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-20 22:12:02,682 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-20 22:12:02,683 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-20 22:12:17,770 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-20 22:12:17,771 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-20 22:12:54,504 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-20 22:12:54,505 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-20 22:12:54,505 - d365 - INFO - Final user count after filtering: 205
2025-06-20 22:12:54,507 - d365 - INFO - Fetched 205 user details after filtering
2025-06-20 22:12:54,510 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-20 22:12:54,515 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-20 22:12:54,520 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-20 22:12:54,523 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:12:54,733 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '32c7c260-d955-4dca-814f-ac7832281a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:42:54 GMT'
    'Content-Length': '1753'
2025-06-20 22:12:54,734 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:12:54,880 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '32c7c260-d955-4dca-814f-ac7834281a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:42:54 GMT'
    'Content-Length': '1653'
2025-06-20 22:12:54,881 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:12:54,882 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:12:56,277 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-20 22:12:56,282 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-20 22:12:56,283 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:12:56,555 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd4f5924f-5110-426f-8646-5fb379f41500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:42:57 GMT'
    'Content-Length': '1753'
2025-06-20 22:12:56,555 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:12:56,787 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd870b0f8-7407-4450-bac6-a488fb351d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:42:57 GMT'
    'Content-Length': '1648'
2025-06-20 22:12:56,788 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:12:56,788 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:12:59,532 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-20 22:12:59,536 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-20 22:12:59,538 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:12:59,941 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '00c05d28-12b0-4189-a52e-8bec8cb01200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:42:59 GMT'
    'Content-Length': '1753'
2025-06-20 22:12:59,942 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:13:00,183 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '11e41a48-4390-494b-9d64-5be91b8d2300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:43:00 GMT'
    'Content-Length': '1992'
2025-06-20 22:13:00,184 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:13:00,185 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:13:04,559 - d365 - INFO - Fetched 35 conditional access policies
2025-06-20 22:13:04,562 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-20 22:13:04,563 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:13:04,997 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1a280845-b425-47e0-adcf-1936f2841e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:43:05 GMT'
    'Content-Length': '1753'
2025-06-20 22:13:05,001 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:13:05,259 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4967d07c-670e-43e1-9ace-8e1892491800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:43:05 GMT'
    'Content-Length': '1647'
2025-06-20 22:13:05,260 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:13:05,261 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:13:05,982 - d365 - INFO - Fetched 11 business units
2025-06-20 22:13:05,984 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-20 22:13:05,985 - d365 - INFO - D365 data loaded successfully
2025-06-20 22:13:05,988 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-20 22:13:05,988 - main - INFO - Loading data from CSV files
2025-06-20 22:13:06,045 - main - INFO - Loaded audit_logs with 32320 rows
2025-06-20 22:13:06,069 - main - INFO - Loaded signin_logs with 5882 rows
2025-06-20 22:13:06,104 - main - INFO - Loaded user_details with 205 rows
2025-06-20 22:13:06,108 - main - INFO - Loaded app_roles with 2112 rows
2025-06-20 22:13:06,141 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-20 22:13:06,268 - main - INFO - Created group_memberships with 3295 rows
2025-06-20 22:13:06,288 - main - INFO - Created role_matrix with 2112 rows
2025-06-20 22:13:06,296 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-20 22:13:06,297 - main - WARNING - Found 71 users in signin_logs not present in user_details: ['e5f47082-e16b-4429-9d36-09d4b1354a24', 'ccf6d52a-a45b-4d3a-810a-69bda63bec78', 'b547f4bc-a21b-428d-b1ea-4cabca29522b', 'b36d70a1-f635-4f11-9be8-c9cb51b84298', 'f777b683-9def-4137-98a3-06e33f07fcc7']...
2025-06-20 22:13:06,298 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['9050733f-13aa-eb11-8236-0022489b4c66', 'c2710d15-fe30-ee11-bdf4-000d3adc8967', 'ffecdb91-1bbe-eb11-bacc-000d3ade3348', '01f87407-2a28-ee11-9966-0022489ba102', '81080b83-9db5-ec11-983f-000d3a65fdcd']...
2025-06-20 22:13:06,299 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-20 22:13:06,304 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-20 22:13:06,305 - src.core.embeddings - INFO - Starting embedding generation
2025-06-20 22:13:06,305 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-20 22:13:06,306 - src.core.embeddings - INFO - Using batch_size=64
2025-06-20 22:13:06,306 - src.core.embeddings - INFO - Using device: cpu
2025-06-20 22:13:29,561 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-20 22:13:33,701 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-20 22:13:33,702 - src.core.embeddings - INFO - Embedding initialization took 27.39 seconds
2025-06-20 22:13:33,702 - src.core.embeddings - INFO - Memory usage: RSS=510.45 MB, VMS=2702.63 MB
2025-06-20 22:13:33,703 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-20 22:13:33,703 - src.core.embeddings - INFO - Using all logs: audit_logs=32320 rows, signin_logs=5882 rows
2025-06-20 22:13:33,707 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-20 22:13:33,715 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-20 22:13:34,337 - src.core.embeddings - INFO - Text generation took 0.63 seconds
2025-06-20 22:13:34,338 - src.core.embeddings - INFO - Memory usage: RSS=534.70 MB, VMS=2727.16 MB
2025-06-20 22:13:34,338 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-20 22:13:36,121 - src.core.embeddings - INFO - Total documents to embed: 38202
2025-06-20 22:13:36,121 - src.core.embeddings - INFO - Document conversion took 1.78 seconds
2025-06-20 22:13:36,122 - src.core.embeddings - INFO - Memory usage: RSS=565.02 MB, VMS=2757.22 MB
2025-06-20 22:13:36,122 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-20 22:13:36,125 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-20 22:13:48,324 - src.core.embeddings - INFO - Memory usage: RSS=731.95 MB, VMS=2943.77 MB
2025-06-20 22:13:48,325 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-20 22:14:01,249 - src.core.embeddings - INFO - Memory usage: RSS=807.15 MB, VMS=3018.25 MB
2025-06-20 22:14:01,249 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-20 22:14:14,199 - src.core.embeddings - INFO - Memory usage: RSS=881.99 MB, VMS=3091.91 MB
2025-06-20 22:14:14,200 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-20 22:14:26,888 - src.core.embeddings - INFO - Memory usage: RSS=955.85 MB, VMS=3166.38 MB
2025-06-20 22:14:26,889 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-20 22:14:39,892 - src.core.embeddings - INFO - Memory usage: RSS=1029.32 MB, VMS=3240.46 MB
2025-06-20 22:14:39,893 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-20 22:14:52,275 - src.core.embeddings - INFO - Memory usage: RSS=1102.65 MB, VMS=3314.53 MB
2025-06-20 22:14:52,276 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-20 22:15:17,995 - src.core.embeddings - INFO - Memory usage: RSS=1360.09 MB, VMS=3569.70 MB
2025-06-20 22:15:17,996 - src.core.embeddings - INFO - Embedding chunk 8/8 (3202 documents)
2025-06-20 22:15:42,606 - src.core.embeddings - INFO - Memory usage: RSS=1407.50 MB, VMS=3617.07 MB
2025-06-20 22:15:42,895 - src.core.embeddings - INFO - Embedding generation took 126.77 seconds
2025-06-20 22:15:42,895 - src.core.embeddings - INFO - Memory usage: RSS=1407.50 MB, VMS=3617.07 MB
2025-06-20 22:15:42,896 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-20 22:15:43,547 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 38202 vectors
2025-06-20 22:15:44,499 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-20 22:15:44,513 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-20 22:15:44,513 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-20 22:15:44,514 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.62 seconds
2025-06-20 22:15:44,515 - src.core.embeddings - INFO - Memory usage: RSS=1614.11 MB, VMS=3959.21 MB
2025-06-20 22:15:44,525 - src.core.embeddings - INFO - Total embedding generation took 158.22 seconds
2025-06-20 22:15:44,560 - main - INFO - [analyze] Embeddings generated.
2025-06-20 22:15:44,561 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-20 22:15:44,562 - src.utils.config - INFO - Loading environment variables
2025-06-20 22:15:44,565 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-20 22:15:44,565 - src.core.analysis - INFO - Validating input DataFrames
2025-06-20 22:15:44,621 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 22:15:44,623 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 22:15:44,624 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 22:15:44,624 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-20 22:15:44,625 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-20 22:15:44,633 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-20 22:15:44,634 - src.core.analysis - INFO - User IDs from signin_logs: 71
2025-06-20 22:15:44,634 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-20 22:15:44,635 - src.core.analysis - INFO - User IDs from app_role_assignments: 335
2025-06-20 22:15:44,635 - src.core.analysis - INFO - Total unique user IDs: 511
2025-06-20 22:15:46,127 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-20 22:15:46,146 - src.core.analysis - INFO - Starting analysis
2025-06-20 22:15:46,147 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-20 22:15:48,925 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-20 22:15:48,926 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-20 22:15:48,927 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-20 22:15:48,927 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-20 22:15:48,928 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-20 22:15:48,928 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 22:15:48,929 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5882, 12)
2025-06-20 22:15:48,929 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 22:15:48,934 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-20 22:15:48,949 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-20 22:15:48,964 - src.analysis.anomaly_detector - INFO - Successfully mapped 5876 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-20 22:15:48,967 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-20 22:15:48,967 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 71
2025-06-20 22:15:48,968 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 21
2025-06-20 22:15:48,968 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-20 22:15:48,969 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-20 22:15:48,969 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-20 22:15:48,969 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-20 22:15:48,970 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-20 22:15:48,970 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-20 22:15:48,970 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-20 22:15:48,970 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-20 22:15:48,973 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-20 22:15:48,974 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-20 22:15:48,975 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-20 22:15:48,976 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-20 22:15:48,976 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-20 22:15:50,156 - src.analysis.anomaly_detector - INFO - Detected 47 anomalies
2025-06-20 22:15:50,156 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-20 22:15:50,157 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 -> User Unknown-User-2e186776-244e-4c01-a4d4-97102c86ff32 has an unusual activity pattern (Roles: Unkno...
2025-06-20 22:15:50,157 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-f956b637-d19e-48a5-bde4-01ab0f111c5b -> User Unknown-User-f956b637-d19e-48a5-bde4-01ab0f111c5b has an unusual activity pattern (Roles: Unkno...
2025-06-20 22:15:50,157 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> User Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 has an unusual activity pattern (Roles: Unkno...
2025-06-20 22:15:50,158 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-20 22:15:50,807 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-20 22:15:50,808 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-20 22:15:50,896 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-20 22:15:51,302 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-20 22:15:51,744 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-20 22:15:51,745 - src.core.analysis - INFO - Analyzing inactive users
2025-06-20 22:15:51,746 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-20 22:15:51,746 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 22:15:51,746 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 22:15:51,751 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-12 11:06:05+0000', tz='UTC'), Timestamp('2025-06-12 11:02:22+0000', tz='UTC'), Timestamp('2025-06-12 10:52:18+0000', tz='UTC'), Timestamp('2025-06-12 10:50:39+0000', tz='UTC'), Timestamp('2025-06-12 10:42:48+0000', tz='UTC')]
2025-06-20 22:15:51,752 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-20 22:15:51,761 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-22 16:47:30+0000', tz='UTC'), Timestamp('2025-03-22 19:47:30+0000', tz='UTC'), Timestamp('2025-03-22 22:23:41+0000', tz='UTC'), Timestamp('2025-03-22 22:30:24+0000', tz='UTC'), Timestamp('2025-03-22 22:30:40+0000', tz='UTC')]
2025-06-20 22:15:51,762 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-20 22:15:52,205 - src.analysis.inactive_users - INFO - Found 135 inactive users out of 205 total users.
2025-06-20 22:15:52,206 - src.core.analysis - INFO - Total unique user IDs after analysis: 601
2025-06-20 22:15:52,235 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-20 22:15:52,236 - src.core.analysis - INFO - Using chunk size: 200 for 601 users
2025-06-20 22:15:52,237 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-20 22:15:52,238 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-20 22:15:52,240 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 145127 bytes
2025-06-20 22:16:14,798 - src.core.analysis - INFO - Findings chunk 1 completed in 22.56s
2025-06-20 22:16:14,798 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-20 22:16:14,799 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 156247 bytes
2025-06-20 22:16:47,564 - src.core.analysis - INFO - Findings chunk 2 completed in 32.77s
2025-06-20 22:16:47,565 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-20 22:16:47,566 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 140452 bytes
2025-06-20 22:17:13,761 - src.core.analysis - INFO - Findings chunk 3 completed in 26.20s
2025-06-20 22:17:13,762 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-20 22:17:13,763 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 8550 bytes
2025-06-20 22:17:43,380 - src.core.analysis - INFO - Findings chunk 4 completed in 29.62s
2025-06-20 22:17:43,484 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-20 22:17:43,486 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-20 22:17:43,487 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-20 22:17:43,489 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-20 22:17:43,490 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-20 22:17:43,491 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-20 22:17:43,492 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-20 22:17:43,493 - src.core.analysis - INFO - Processed 4/4 chunks (95%)
2025-06-20 22:17:43,493 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-20 22:17:43,494 - src.core.analysis - INFO - Sequential processing completed in 111.26s
2025-06-20 22:17:43,494 - src.core.analysis - INFO - Successfully processed 4/4 chunks
2025-06-20 22:17:43,495 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-20 22:17:43,495 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 601 users
2025-06-20 22:17:43,496 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-20 22:17:43,498 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-20 22:17:43,499 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-20 22:17:43,500 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 17852 bytes
2025-06-20 22:17:56,056 - src.core.analysis - INFO - Recommendations chunk 1 completed in 12.56s
2025-06-20 22:17:56,171 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-20 22:17:56,172 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-20 22:17:56,173 - src.core.analysis - INFO - Analysis completed successfully with 10 recommendations
2025-06-20 22:17:56,173 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:17:56,174 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\audit_logs_full_sample.csv', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\d365_roles.csv', 'D:\\Production\\backend\\data\\role_usage_heuristic_output.csv', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-20 22:17:56,175 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-20 22:17:56,176 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:17:56,195 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '201323'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '50d58d98-4df6-11f0-b50e-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:17:56,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:47:57 GMT'
    'ETag': '"0x8DDB01A35D93A9D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '706671c8-001e-0098-8003-e2104c000000'
    'x-ms-client-request-id': '50d58d98-4df6-11f0-b50e-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:47:57 GMT'
2025-06-20 22:17:56,746 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-20 22:17:56,747 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-20 22:17:56,748 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:17:56,749 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '512a2629-4df6-11f0-94e8-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:17:57,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:47:58 GMT'
    'ETag': '"0x8DDB01A36850D05"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4800a5f2-e01e-0006-7303-e20392000000'
    'x-ms-client-request-id': '512a2629-4df6-11f0-94e8-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:47:57 GMT'
2025-06-20 22:17:57,908 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-20 22:17:57,908 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-20 22:17:57,909 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:17:57,927 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '51dddb25-4df6-11f0-ba0b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:17:58,818 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:47:59 GMT'
    'ETag': '"0x8DDB01A37111F0D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b0ccd367-001e-007c-6b03-e21ed2000000'
    'x-ms-client-request-id': '51dddb25-4df6-11f0-ba0b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:47:58 GMT'
2025-06-20 22:17:58,819 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-20 22:17:58,820 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-20 22:17:58,821 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:17:58,822 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5266684f-4df6-11f0-9a20-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:17:59,452 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:00 GMT'
    'ETag': '"0x8DDB01A377515B9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19be47a9-101e-005f-6803-e28411000000'
    'x-ms-client-request-id': '5266684f-4df6-11f0-9a20-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:47:59 GMT'
2025-06-20 22:17:59,453 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-20 22:17:59,453 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-20 22:17:59,454 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:17:59,472 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '52c99a9e-4df6-11f0-8588-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:00,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:00 GMT'
    'ETag': '"0x8DDB01A37DCFF90"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bae56a4d-a01e-0065-4703-e29e69000000'
    'x-ms-client-request-id': '52c99a9e-4df6-11f0-8588-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:00 GMT'
2025-06-20 22:18:00,153 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-20 22:18:00,154 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-20 22:18:00,155 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:00,157 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003910'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '53321f9c-4df6-11f0-9140-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:01,156 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:01 GMT'
    'ETag': '"0x8DDB01A387B9A62"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2b4c6fe2-201e-00a0-7403-e2b48c000000'
    'x-ms-client-request-id': '53321f9c-4df6-11f0-9140-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:01 GMT'
2025-06-20 22:18:01,157 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-20 22:18:01,157 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-20 22:18:01,158 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:01,181 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '53ce5421-4df6-11f0-83ec-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:03,543 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:04 GMT'
    'ETag': '"0x8DDB01A39E3A773"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a6a2a30e-e01e-00af-1203-e2c2e0000000'
    'x-ms-client-request-id': '53ce5421-4df6-11f0-83ec-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:03 GMT'
2025-06-20 22:18:03,545 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-20 22:18:03,546 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs_full_sample.csv to blob as audit_logs_full_sample.csv
2025-06-20 22:18:03,547 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:03,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '553a1379-4df6-11f0-b0f6-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:05,103 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:05 GMT'
    'ETag': '"0x8DDB01A3AA4E58D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '12225f86-301e-0048-5203-e22d1a000000'
    'x-ms-client-request-id': '553a1379-4df6-11f0-b0f6-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:05 GMT'
2025-06-20 22:18:05,105 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs_full_sample.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv
2025-06-20 22:18:05,105 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-20 22:18:05,106 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:05,108 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '56259082-4df6-11f0-b8d4-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:05,586 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:06 GMT'
    'ETag': '"0x8DDB01A3B17E67D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4800a6af-e01e-0006-7503-e20392000000'
    'x-ms-client-request-id': '56259082-4df6-11f0-b8d4-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:05 GMT'
2025-06-20 22:18:05,587 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-20 22:18:05,588 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-20 22:18:05,589 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:05,608 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5671e9ef-4df6-11f0-9fcc-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:06,064 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:06 GMT'
    'ETag': '"0x8DDB01A3B62F2EF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bd601e34-401e-001f-7303-e28329000000'
    'x-ms-client-request-id': '5671e9ef-4df6-11f0-9fcc-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:06 GMT'
2025-06-20 22:18:06,066 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-20 22:18:06,067 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-20 22:18:06,067 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:06,069 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '56b83815-4df6-11f0-917c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:06,600 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:07 GMT'
    'ETag': '"0x8DDB01A3BB6A833"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e0aa0eb2-401e-007d-4503-e2410e000000'
    'x-ms-client-request-id': '56b83815-4df6-11f0-917c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:06 GMT'
2025-06-20 22:18:06,601 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-20 22:18:06,602 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-20 22:18:06,602 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:06,621 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '570c620f-4df6-11f0-af49-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:07,030 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:07 GMT'
    'ETag': '"0x8DDB01A3BFBEEC4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '29c5b72c-e01e-0080-3203-e2cf2b000000'
    'x-ms-client-request-id': '570c620f-4df6-11f0-af49-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:07 GMT'
2025-06-20 22:18:07,031 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-20 22:18:07,032 - src.core.analysis - INFO - Uploading D:\Production\backend\data\d365_roles.csv to blob as d365_roles.csv
2025-06-20 22:18:07,033 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:07,050 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '574ddea3-4df6-11f0-8d58-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:07,800 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:08 GMT'
    'ETag': '"0x8DDB01A3C6B9816"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '69d8c096-501e-0003-2d03-e2d149000000'
    'x-ms-client-request-id': '574ddea3-4df6-11f0-8d58-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:08 GMT'
2025-06-20 22:18:07,801 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\d365_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv
2025-06-20 22:18:07,802 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_heuristic_output.csv to blob as role_usage_heuristic_output.csv
2025-06-20 22:18:07,803 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:07,822 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '57c3b4d0-4df6-11f0-b3a0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:08,563 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:09 GMT'
    'ETag': '"0x8DDB01A3CE17BF5"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2597b605-101e-0060-0f03-e24cb2000000'
    'x-ms-client-request-id': '57c3b4d0-4df6-11f0-b3a0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:09 GMT'
2025-06-20 22:18:08,564 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_heuristic_output.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv
2025-06-20 22:18:08,565 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-20 22:18:08,566 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:08,569 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1504207'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5835a845-4df6-11f0-9f6b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:09,521 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:10 GMT'
    'ETag': '"0x8DDB01A3D76849B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '08704edc-f01e-0057-1a03-e29e1e000000'
    'x-ms-client-request-id': '5835a845-4df6-11f0-9f6b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:10 GMT'
2025-06-20 22:18:09,522 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-20 22:18:09,523 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-20 22:18:09,524 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:09,558 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '58cc95db-4df6-11f0-8526-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:11,387 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:12 GMT'
    'ETag': '"0x8DDB01A3E9420C4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1d60212f-501e-004e-2503-e21ea5000000'
    'x-ms-client-request-id': '58cc95db-4df6-11f0-8526-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:12 GMT'
2025-06-20 22:18:11,388 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-20 22:18:11,389 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-20 22:18:11,390 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:11,391 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '59e45fe2-4df6-11f0-87ac-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:11,758 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:12 GMT'
    'ETag': '"0x8DDB01A3ECC56B1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8517785a-901e-009a-4603-e2aef4000000'
    'x-ms-client-request-id': '59e45fe2-4df6-11f0-87ac-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:11 GMT'
2025-06-20 22:18:11,759 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-20 22:18:11,760 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-20 22:18:11,762 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:11,779 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5a1f8a68-4df6-11f0-9766-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:12,221 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:13 GMT'
    'ETag': '"0x8DDB01A3F13490E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3b198024-f01e-000a-4f03-e2949a000000'
    'x-ms-client-request-id': '5a1f8a68-4df6-11f0-9766-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:12 GMT'
2025-06-20 22:18:12,223 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-20 22:18:12,223 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-20 22:18:12,225 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:12,226 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5a63b2e5-4df6-11f0-ad33-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:12,914 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:13 GMT'
    'ETag': '"0x8DDB01A3F73E825"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '38b260d0-801e-0000-1e03-e2302d000000'
    'x-ms-client-request-id': '5a63b2e5-4df6-11f0-ad33-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:12 GMT'
2025-06-20 22:18:12,916 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-20 22:18:12,916 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-20 22:18:12,917 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:12,930 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5acf230f-4df6-11f0-bc3b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:13,541 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:14 GMT'
    'ETag': '"0x8DDB01A3FD85373"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3708b86d-d01e-008b-3b03-e23440000000'
    'x-ms-client-request-id': '5acf230f-4df6-11f0-bc3b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:13 GMT'
2025-06-20 22:18:13,542 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-20 22:18:13,543 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-20 22:18:13,544 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:13,546 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5b2d0e60-4df6-11f0-b6aa-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:14,050 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:14 GMT'
    'ETag': '"0x8DDB01A4029E83D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '15ee9c44-601e-0008-4903-e22a22000000'
    'x-ms-client-request-id': '5b2d0e60-4df6-11f0-b6aa-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:13 GMT'
2025-06-20 22:18:14,051 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-20 22:18:14,052 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-20 22:18:14,053 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:18:14,070 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5b7d1ff9-4df6-11f0-bb3a-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:14,537 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:15 GMT'
    'ETag': '"0x8DDB01A40751B92"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6b186c76-601e-0045-1803-e2e5ce000000'
    'x-ms-client-request-id': '5b7d1ff9-4df6-11f0-bb3a-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:15 GMT'
2025-06-20 22:18:14,538 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-20 22:18:26,949 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-20 22:18:26,962 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-20 22:18:26,963 - src.core.analysis - INFO - Generating D:\Production\backend\src\core\../../data/role_usage_per_user_summary.csv by running D:\Production\backend\src\core\../analysis/role_usage_heuristic.py with cwd=D:\Production\backend\src\analysis
2025-06-20 22:18:30,664 - main - INFO - [analyze] Analysis completed.
2025-06-20 22:18:30,739 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-20 22:18:30,759 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '172946'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '656f9e94-4df6-11f0-b7c9-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:31,345 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:32 GMT'
    'ETag': '"0x8DDB01A4A79FA49"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997226-501e-00aa-4f03-e2103b000000'
    'x-ms-client-request-id': '656f9e94-4df6-11f0-b7c9-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:32 GMT'
2025-06-20 22:18:31,348 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '65c97041-4df6-11f0-a9d9-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:31,556 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:32 GMT'
    'ETag': '"0x8DDB01A4A9A7D15"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a999723a-501e-00aa-5e03-e2103b000000'
    'x-ms-client-request-id': '65c97041-4df6-11f0-a9d9-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:32 GMT'
2025-06-20 22:18:31,559 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '65e9b422-4df6-11f0-8cc5-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:31,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:32 GMT'
    'ETag': '"0x8DDB01A4ACF8242"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a999723c-501e-00aa-6003-e2103b000000'
    'x-ms-client-request-id': '65e9b422-4df6-11f0-8cc5-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:32 GMT'
2025-06-20 22:18:31,908 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '661ef6af-4df6-11f0-b308-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:32,048 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:32 GMT'
    'ETag': '"0x8DDB01A4AE562A6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997247-501e-00aa-6803-e2103b000000'
    'x-ms-client-request-id': '661ef6af-4df6-11f0-b308-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:32 GMT'
2025-06-20 22:18:32,051 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6634b299-4df6-11f0-87f0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:32,326 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:33 GMT'
    'ETag': '"0x8DDB01A4B0F779C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997249-501e-00aa-6a03-e2103b000000'
    'x-ms-client-request-id': '6634b299-4df6-11f0-87f0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:33 GMT'
2025-06-20 22:18:32,329 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003910'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '665f3592-4df6-11f0-9d81-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:34,207 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:35 GMT'
    'ETag': '"0x8DDB01A4C2EBF9B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997251-501e-00aa-7103-e2103b000000'
    'x-ms-client-request-id': '665f3592-4df6-11f0-9d81-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:34 GMT'
2025-06-20 22:18:34,213 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '677eaaf3-4df6-11f0-96c2-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:37,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:38 GMT'
    'ETag': '"0x8DDB01A4E4B95AA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997287-501e-00aa-1903-e2103b000000'
    'x-ms-client-request-id': '677eaaf3-4df6-11f0-96c2-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:38 GMT'
2025-06-20 22:18:37,757 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '699b646e-4df6-11f0-9c7c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:38,663 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:39 GMT'
    'ETag': '"0x8DDB01A4ED6BE58"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972b1-501e-00aa-3b03-e2103b000000'
    'x-ms-client-request-id': '699b646e-4df6-11f0-9c7c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:38,666 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a2613ae-4df6-11f0-8875-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:38,741 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:39 GMT'
    'ETag': '"0x8DDB01A4EE27108"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972bf-501e-00aa-4703-e2103b000000'
    'x-ms-client-request-id': '6a2613ae-4df6-11f0-8875-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:38,744 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a321663-4df6-11f0-87d8-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:38,818 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:39 GMT'
    'ETag': '"0x8DDB01A4EEE7173"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972c2-501e-00aa-4a03-e2103b000000'
    'x-ms-client-request-id': '6a321663-4df6-11f0-87d8-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:38,820 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a3dacdb-4df6-11f0-a49b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:38,894 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:39 GMT'
    'ETag': '"0x8DDB01A4EFA241C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972c3-501e-00aa-4b03-e2103b000000'
    'x-ms-client-request-id': '6a3dacdb-4df6-11f0-a49b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:38,898 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a498024-4df6-11f0-82c5-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:38,973 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:39 GMT'
    'ETag': '"0x8DDB01A4F05FDA1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972d7-501e-00aa-4f03-e2103b000000'
    'x-ms-client-request-id': '6a498024-4df6-11f0-82c5-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:38,976 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a55835b-4df6-11f0-a45d-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:39,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:39 GMT'
    'ETag': '"0x8DDB01A4F1224FB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972da-501e-00aa-5103-e2103b000000'
    'x-ms-client-request-id': '6a55835b-4df6-11f0-a45d-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:39,063 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a62bf04-4df6-11f0-ad6a-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:39,139 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:39 GMT'
    'ETag': '"0x8DDB01A4F1F5C8B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972dd-501e-00aa-5403-e2103b000000'
    'x-ms-client-request-id': '6a62bf04-4df6-11f0-ad6a-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:39,141 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '51338'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a6e9261-4df6-11f0-a599-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:39,215 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:40 GMT'
    'ETag': '"0x8DDB01A4F2B0F31"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972df-501e-00aa-5603-e2103b000000'
    'x-ms-client-request-id': '6a6e9261-4df6-11f0-a599-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:39 GMT'
2025-06-20 22:18:39,219 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1504207'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a7a8298-4df6-11f0-a7bf-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:39,856 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:40 GMT'
    'ETag': '"0x8DDB01A4F8CBE7B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a99972e1-501e-00aa-5803-e2103b000000'
    'x-ms-client-request-id': '6a7a8298-4df6-11f0-a7bf-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:40 GMT'
2025-06-20 22:18:39,862 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6adcaca5-4df6-11f0-b869-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:41,721 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:42 GMT'
    'ETag': '"0x8DDB01A50A94A6E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997301-501e-00aa-7303-e2103b000000'
    'x-ms-client-request-id': '6adcaca5-4df6-11f0-b869-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:42 GMT'
2025-06-20 22:18:41,723 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6bf8a787-4df6-11f0-ae6f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:41,799 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:42 GMT'
    'ETag': '"0x8DDB01A50B523FA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997329-501e-00aa-1603-e2103b000000'
    'x-ms-client-request-id': '6bf8a787-4df6-11f0-ae6f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:42 GMT'
2025-06-20 22:18:41,802 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6c049d53-4df6-11f0-bff0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:41,880 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:42 GMT'
    'ETag': '"0x8DDB01A50C19919"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a999732b-501e-00aa-1803-e2103b000000'
    'x-ms-client-request-id': '6c049d53-4df6-11f0-bff0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:42 GMT'
2025-06-20 22:18:41,882 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6c10e847-4df6-11f0-a61b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:41,960 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:42 GMT'
    'ETag': '"0x8DDB01A50CD72A2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a999732d-501e-00aa-1903-e2103b000000'
    'x-ms-client-request-id': '6c10e847-4df6-11f0-a61b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:42 GMT'
2025-06-20 22:18:41,963 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6c1d35a7-4df6-11f0-8ec2-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:42,041 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:42 GMT'
    'ETag': '"0x8DDB01A50D9E7C3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a999732f-501e-00aa-1b03-e2103b000000'
    'x-ms-client-request-id': '6c1d35a7-4df6-11f0-8ec2-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:42 GMT'
2025-06-20 22:18:42,044 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6c298267-4df6-11f0-b902-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:42,118 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:42 GMT'
    'ETag': '"0x8DDB01A50E60F14"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997330-501e-00aa-1c03-e2103b000000'
    'x-ms-client-request-id': '6c298267-4df6-11f0-b902-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:42 GMT'
2025-06-20 22:18:42,121 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6c356365-4df6-11f0-99c1-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:18:42,198 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 16:48:43 GMT'
    'ETag': '"0x8DDB01A50F20F84"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9997332-501e-00aa-1e03-e2103b000000'
    'x-ms-client-request-id': '6c356365-4df6-11f0-99c1-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 16:48:42 GMT'
2025-06-20 22:36:15,260 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 22:36:15,262 - main - INFO - FastAPI application shutdown
2025-06-20 22:36:33,124 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:36:49,665 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:36:49,666 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:36:49,667 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:36:49,669 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:36:49,670 - main - INFO - FastAPI application started
2025-06-20 22:39:09,629 - d365 - INFO - Loading D365 data
2025-06-20 22:39:09,631 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:39:10,018 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ac59c461-3d05-4513-ac6d-775815002200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:09:10 GMT'
    'Content-Length': '1753'
2025-06-20 22:39:10,031 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:39:10,195 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9b560961-86c9-43b4-8281-607ac0d51500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:09:10 GMT'
    'Content-Length': '1653'
2025-06-20 22:39:10,196 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:39:10,197 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:39:10,197 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-22T17:09:10Z)
2025-06-20 22:39:14,069 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-20 22:39:17,000 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-20 22:39:20,353 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-20 22:39:23,292 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-20 22:39:26,120 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-20 22:39:29,060 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-20 22:39:30,892 - d365 - INFO - Progress: Fetched 32312 audit logs after 7 pages
2025-06-20 22:39:30,911 - d365 - INFO - Fetched 32312 D365 audit logs via Dataverse
2025-06-20 22:39:30,966 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-20 22:39:30,969 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:39:31,385 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '304e3a9e-634c-4d8e-82dc-6a3492951300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:09:31 GMT'
    'Content-Length': '1753'
2025-06-20 22:39:31,387 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:39:31,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'eb45bcfc-0052-487b-a7d7-6149c4681e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:09:32 GMT'
    'Content-Length': '1991'
2025-06-20 22:39:31,653 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:39:31,653 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:39:31,654 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-22T17:09:31Z)
2025-06-20 22:39:31,654 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-20 22:39:40,746 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 6.6 req/min | Time: 0:00:09
2025-06-20 22:39:47,977 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 7.4 req/min | Time: 0:00:16
2025-06-20 22:39:55,811 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 7.5 req/min | Time: 0:00:24
2025-06-20 22:40:15,382 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.5 req/min | Time: 0:00:43
2025-06-20 22:40:34,381 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 4.8 req/min | Time: 0:01:02
2025-06-20 22:40:38,497 - d365 - INFO - Progress: 5,429 records | Pages: 6 | Requests: 6 | Rate: 5.4 req/min | Time: 0:01:06
2025-06-20 22:40:38,998 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-21T17:09:39Z to 2025-06-20T16:18:20Z
2025-06-20 22:40:39,061 - d365 - INFO - Fetch completed: 5,429 records in 0:01:07
2025-06-20 22:40:39,061 - d365 - INFO - Total requests made: 6
2025-06-20 22:40:39,066 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:40:39,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1d2c4997-248b-464a-965f-96b2b8611300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:10:39 GMT'
    'Content-Length': '1753'
2025-06-20 22:40:39,500 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:40:39,784 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1d2c4997-248b-464a-965f-96b2bc611300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:10:39 GMT'
    'Content-Length': '1647'
2025-06-20 22:40:39,785 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:40:39,786 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:40:39,787 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:40:40,158 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e0d684ed-8fc7-4cf7-a3fa-8c5686481700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:10:40 GMT'
    'Content-Length': '1753'
2025-06-20 22:40:40,159 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:40:40,342 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5e0b5be4-c691-440e-b0f4-2f8278f71700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:10:40 GMT'
    'Content-Length': '1996'
2025-06-20 22:40:40,343 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:40:40,344 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:40:40,345 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:40:43,783 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'deda7737-be6d-401b-90e7-0e69399a1400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:10:44 GMT'
    'Content-Length': '1753'
2025-06-20 22:40:43,784 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:40:44,072 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '51ba71e1-3f2b-4c0d-97a7-4a1c0e001e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:10:44 GMT'
    'Content-Length': '1992'
2025-06-20 22:40:44,073 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:40:44,073 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:40:47,894 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-20 22:40:47,895 - d365 - INFO - Found 981 users in Entra ID
2025-06-20 22:40:49,167 - d365 - INFO - Fetched 936 user records from D365
2025-06-20 22:42:22,298 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-20 22:42:22,299 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-20 22:42:59,281 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-20 22:42:59,282 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-20 22:43:01,256 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-20 22:43:01,258 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-20 22:43:05,427 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-20 22:43:05,428 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-20 22:43:46,973 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-20 22:43:46,975 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-20 22:44:11,448 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-20 22:44:11,449 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-20 22:44:25,872 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-20 22:44:25,873 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-20 22:45:02,083 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-20 22:45:02,084 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-20 22:45:02,084 - d365 - INFO - Final user count after filtering: 205
2025-06-20 22:45:02,086 - d365 - INFO - Fetched 205 user details after filtering
2025-06-20 22:45:02,089 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-20 22:45:02,093 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-20 22:45:02,097 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-20 22:45:02,102 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:45:02,513 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3a66b594-43d9-41d0-bb1c-5937a00d1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:02 GMT'
    'Content-Length': '1753'
2025-06-20 22:45:02,514 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:45:02,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '074c2982-fc1a-4173-aa56-d61496501b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:02 GMT'
    'Content-Length': '1651'
2025-06-20 22:45:02,773 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:45:02,773 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:45:04,017 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-20 22:45:04,022 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-20 22:45:04,024 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:45:04,351 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9b73e5b7-b95f-46fe-bb66-4581ba931300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:05 GMT'
    'Content-Length': '1753'
2025-06-20 22:45:04,352 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:45:04,595 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a0e4c7d3-cd5e-4086-b7d7-eddacdb71800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:05 GMT'
    'Content-Length': '1647'
2025-06-20 22:45:04,597 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:45:04,597 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:45:06,980 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-20 22:45:06,984 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-20 22:45:06,985 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:45:07,351 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6a966c93-c8a9-4f8c-9eae-e9ffaffc1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:07 GMT'
    'Content-Length': '1753'
2025-06-20 22:45:07,352 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:45:07,625 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6a966c93-c8a9-4f8c-9eae-e9ffb3fc1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:07 GMT'
    'Content-Length': '1991'
2025-06-20 22:45:07,626 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:45:07,628 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 22:45:12,051 - d365 - INFO - Fetched 35 conditional access policies
2025-06-20 22:45:12,054 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-20 22:45:12,055 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 22:45:12,491 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c5cc19a0-8d73-4b21-b526-c548639b1700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:13 GMT'
    'Content-Length': '1753'
2025-06-20 22:45:12,493 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 22:45:12,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '30849673-7c5d-4104-98f9-19e4eaf11400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:15:13 GMT'
    'Content-Length': '1647'
2025-06-20 22:45:12,753 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 22:45:12,753 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 22:45:13,485 - d365 - INFO - Fetched 11 business units
2025-06-20 22:45:13,487 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-20 22:45:13,489 - d365 - INFO - D365 data loaded successfully
2025-06-20 22:45:13,501 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-20 22:45:13,502 - main - INFO - Loading data from CSV files
2025-06-20 22:45:13,557 - main - INFO - Loaded audit_logs with 32312 rows
2025-06-20 22:45:13,600 - main - INFO - Loaded signin_logs with 5429 rows
2025-06-20 22:45:13,628 - main - INFO - Loaded user_details with 205 rows
2025-06-20 22:45:13,632 - main - INFO - Loaded app_roles with 2112 rows
2025-06-20 22:45:13,662 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-20 22:45:13,794 - main - INFO - Created group_memberships with 3295 rows
2025-06-20 22:45:13,803 - main - INFO - Created role_matrix with 2112 rows
2025-06-20 22:45:13,809 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-20 22:45:13,810 - main - WARNING - Found 75 users in signin_logs not present in user_details: ['8c21304f-41d0-474f-bb19-d49eba150fb0', 'bc1af13e-0ffe-41a1-9e83-7166e35c3403', '3ac384df-adbd-464b-81e6-abcdbd1cebbc', '277f14c0-4325-4bcf-b311-599623c0ca37', 'f930eecf-94a2-492d-a317-ab8c86b0e56c']...
2025-06-20 22:45:13,812 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['3650733f-13aa-eb11-8236-0022489b4c66', 'aaf634cd-69b8-ed11-9886-0022489b4de1', '8a4e80c9-a6db-eb11-bacb-000d3aba42cf', '01f87407-2a28-ee11-9966-0022489ba102', '9f64f0c5-c8de-ec11-bb3d-000d3ab95dd7']...
2025-06-20 22:45:13,813 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-20 22:45:13,817 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-20 22:45:13,818 - src.core.embeddings - INFO - Starting embedding generation
2025-06-20 22:45:13,819 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-20 22:45:13,819 - src.core.embeddings - INFO - Using batch_size=64
2025-06-20 22:45:13,820 - src.core.embeddings - INFO - Using device: cpu
2025-06-20 22:45:57,925 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-20 22:46:02,167 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-20 22:46:02,167 - src.core.embeddings - INFO - Embedding initialization took 48.35 seconds
2025-06-20 22:46:02,168 - src.core.embeddings - INFO - Memory usage: RSS=515.38 MB, VMS=2702.27 MB
2025-06-20 22:46:02,168 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-20 22:46:02,169 - src.core.embeddings - INFO - Using all logs: audit_logs=32312 rows, signin_logs=5429 rows
2025-06-20 22:46:02,175 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-20 22:46:02,184 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-20 22:46:02,846 - src.core.embeddings - INFO - Text generation took 0.68 seconds
2025-06-20 22:46:02,846 - src.core.embeddings - INFO - Memory usage: RSS=539.30 MB, VMS=2726.80 MB
2025-06-20 22:46:02,847 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-20 22:46:04,752 - src.core.embeddings - INFO - Total documents to embed: 37741
2025-06-20 22:46:04,753 - src.core.embeddings - INFO - Document conversion took 1.91 seconds
2025-06-20 22:46:04,754 - src.core.embeddings - INFO - Memory usage: RSS=568.96 MB, VMS=2755.86 MB
2025-06-20 22:46:04,754 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-20 22:46:04,756 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-20 22:46:16,773 - src.core.embeddings - INFO - Memory usage: RSS=735.03 MB, VMS=2941.07 MB
2025-06-20 22:46:16,774 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-20 22:46:29,717 - src.core.embeddings - INFO - Memory usage: RSS=810.94 MB, VMS=3016.57 MB
2025-06-20 22:46:29,718 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-20 22:46:43,105 - src.core.embeddings - INFO - Memory usage: RSS=885.46 MB, VMS=3090.71 MB
2025-06-20 22:46:43,105 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-20 22:46:56,590 - src.core.embeddings - INFO - Memory usage: RSS=959.61 MB, VMS=3165.61 MB
2025-06-20 22:46:56,591 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-20 22:47:09,800 - src.core.embeddings - INFO - Memory usage: RSS=1033.72 MB, VMS=3239.26 MB
2025-06-20 22:47:09,801 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-20 22:47:23,045 - src.core.embeddings - INFO - Memory usage: RSS=1107.32 MB, VMS=3313.43 MB
2025-06-20 22:47:23,046 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-20 22:47:51,782 - src.core.embeddings - INFO - Memory usage: RSS=1364.34 MB, VMS=3568.70 MB
2025-06-20 22:47:51,783 - src.core.embeddings - INFO - Embedding chunk 8/8 (2741 documents)
2025-06-20 22:48:15,496 - src.core.embeddings - INFO - Memory usage: RSS=1392.67 MB, VMS=3608.46 MB
2025-06-20 22:48:15,812 - src.core.embeddings - INFO - Embedding generation took 131.06 seconds
2025-06-20 22:48:15,813 - src.core.embeddings - INFO - Memory usage: RSS=1392.67 MB, VMS=3608.46 MB
2025-06-20 22:48:15,813 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-20 22:48:16,633 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37741 vectors
2025-06-20 22:48:17,599 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-20 22:48:17,614 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-20 22:48:17,614 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-20 22:48:17,615 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.80 seconds
2025-06-20 22:48:17,615 - src.core.embeddings - INFO - Memory usage: RSS=1588.46 MB, VMS=3940.77 MB
2025-06-20 22:48:17,626 - src.core.embeddings - INFO - Total embedding generation took 183.81 seconds
2025-06-20 22:48:17,654 - main - INFO - [analyze] Embeddings generated.
2025-06-20 22:48:17,654 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-20 22:48:17,655 - src.utils.config - INFO - Loading environment variables
2025-06-20 22:48:17,657 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-20 22:48:17,657 - src.core.analysis - INFO - Validating input DataFrames
2025-06-20 22:48:17,740 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 22:48:17,741 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 22:48:17,742 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 22:48:17,743 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-20 22:48:17,745 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-20 22:48:17,753 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-20 22:48:17,754 - src.core.analysis - INFO - User IDs from signin_logs: 75
2025-06-20 22:48:17,754 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-20 22:48:17,755 - src.core.analysis - INFO - User IDs from app_role_assignments: 335
2025-06-20 22:48:17,755 - src.core.analysis - INFO - Total unique user IDs: 515
2025-06-20 22:48:19,332 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-20 22:48:19,360 - src.core.analysis - INFO - Starting analysis
2025-06-20 22:48:19,361 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-20 22:48:22,578 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-20 22:48:22,579 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-20 22:48:22,580 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-20 22:48:22,580 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-20 22:48:22,581 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-20 22:48:22,581 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 22:48:22,581 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5429, 12)
2025-06-20 22:48:22,582 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 22:48:22,587 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-20 22:48:22,602 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-20 22:48:22,618 - src.analysis.anomaly_detector - INFO - Successfully mapped 5427 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-20 22:48:22,622 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-20 22:48:22,622 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 75
2025-06-20 22:48:22,623 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-20 22:48:22,623 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-20 22:48:22,624 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-20 22:48:22,624 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-20 22:48:22,625 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-20 22:48:22,625 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-20 22:48:22,626 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-20 22:48:22,626 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-20 22:48:22,626 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-20 22:48:22,627 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-20 22:48:22,627 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-20 22:48:22,628 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-20 22:48:22,629 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-20 22:48:22,629 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-20 22:48:22,629 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-20 22:48:22,630 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-20 22:48:23,982 - src.analysis.anomaly_detector - INFO - Detected 44 anomalies
2025-06-20 22:48:23,983 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-20 22:48:23,983 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> User Vikneshkumar Palanisamy had 2007 sign-ins (avg: 72.4, threshold: 551.2) in the period.; User us...
2025-06-20 22:48:23,984 - src.analysis.anomaly_detector - INFO - Example 2: Nihal Rajeev -> User usually signs in from Bengaluru, IN (59.0%), but on 2025-06-18 signed in from Delhi, IN.; User ...
2025-06-20 22:48:23,984 - src.analysis.anomaly_detector - INFO - Example 3: Lubna Kawal -> User usually signs in from Abu Zaby, AE (77.8%), but on 2025-05-23 signed in from Bengaluru, IN.; Us...
2025-06-20 22:48:23,985 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-20 22:48:24,663 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-20 22:48:24,664 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-20 22:48:24,747 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-20 22:48:25,135 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-20 22:48:25,598 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-20 22:48:25,599 - src.core.analysis - INFO - Analyzing inactive users
2025-06-20 22:48:25,599 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-20 22:48:25,600 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 22:48:25,600 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 22:48:25,605 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-20 16:18:20+0000', tz='UTC'), Timestamp('2025-06-20 15:56:42+0000', tz='UTC'), Timestamp('2025-06-20 15:21:05+0000', tz='UTC'), Timestamp('2025-06-20 15:01:21+0000', tz='UTC'), Timestamp('2025-06-20 13:43:26+0000', tz='UTC')]
2025-06-20 22:48:25,606 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-20 22:48:25,615 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-22 19:47:30+0000', tz='UTC'), Timestamp('2025-03-22 22:23:41+0000', tz='UTC'), Timestamp('2025-03-22 22:30:24+0000', tz='UTC'), Timestamp('2025-03-22 22:30:40+0000', tz='UTC'), Timestamp('2025-03-22 22:30:53+0000', tz='UTC')]
2025-06-20 22:48:25,616 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-20 22:48:26,059 - src.analysis.inactive_users - INFO - Found 131 inactive users out of 205 total users.
2025-06-20 22:48:26,061 - src.core.analysis - INFO - Total unique user IDs after analysis: 598
2025-06-20 22:48:26,091 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-20 22:48:26,092 - src.core.analysis - INFO - Using chunk size: 200 for 598 users
2025-06-20 22:48:26,094 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-20 22:48:26,095 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-20 22:48:26,097 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 141190 bytes
2025-06-20 22:48:52,815 - src.core.analysis - INFO - Findings chunk 1 completed in 26.72s
2025-06-20 22:48:52,815 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-20 22:48:52,817 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 143774 bytes
2025-06-20 22:49:21,040 - src.core.analysis - INFO - Findings chunk 2 completed in 28.22s
2025-06-20 22:49:21,041 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-20 22:49:21,042 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 155474 bytes
2025-06-20 22:49:48,794 - src.core.analysis - INFO - Findings chunk 3 completed in 27.75s
2025-06-20 22:49:48,900 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-20 22:49:48,901 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-20 22:49:48,902 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-20 22:49:48,903 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-20 22:49:48,903 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-20 22:49:48,904 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-20 22:49:48,905 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-20 22:49:48,906 - src.core.analysis - INFO - Sequential processing completed in 82.81s
2025-06-20 22:49:48,906 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-20 22:49:48,907 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-20 22:49:48,907 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 598 users
2025-06-20 22:49:48,908 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-20 22:49:48,909 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-20 22:49:48,910 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-20 22:49:48,910 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 14972 bytes
2025-06-20 22:49:57,012 - src.core.analysis - INFO - Recommendations chunk 1 completed in 8.10s
2025-06-20 22:49:57,115 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-20 22:49:57,116 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-20 22:49:57,116 - src.core.analysis - INFO - Analysis completed successfully with 9 recommendations
2025-06-20 22:49:57,117 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:49:57,117 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\audit_logs_full_sample.csv', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\d365_roles.csv', 'D:\\Production\\backend\\data\\role_usage_heuristic_output.csv', 'D:\\Production\\backend\\data\\role_usage_per_user_summary.csv', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-20 22:49:57,118 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-20 22:49:57,119 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:49:57,131 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '172946'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c9cd2b99-4dfa-11f0-8e10-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:49:57,690 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:19:58 GMT'
    'ETag': '"0x8DDB01EAED4B09B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9ca2cff0-501e-0085-0c07-e21df0000000'
    'x-ms-client-request-id': 'c9cd2b99-4dfa-11f0-8e10-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:19:57 GMT'
2025-06-20 22:49:57,691 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-20 22:49:57,692 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-20 22:49:57,693 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:49:57,704 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ca249a41-4dfa-11f0-9cbb-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:49:58,377 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:19:59 GMT'
    'ETag': '"0x8DDB01EAF3AC7BA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '98090b84-401e-000f-5807-e24641000000'
    'x-ms-client-request-id': 'ca249a41-4dfa-11f0-9cbb-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:19:59 GMT'
2025-06-20 22:49:58,378 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-20 22:49:58,379 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-20 22:49:58,380 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:49:58,398 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ca8e7991-4dfa-11f0-955f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:49:58,984 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:19:59 GMT'
    'ETag': '"0x8DDB01EAF9A568D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c47a6c49-b01e-0056-7c07-e2c1c2000000'
    'x-ms-client-request-id': 'ca8e7991-4dfa-11f0-955f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:19:59 GMT'
2025-06-20 22:49:58,985 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-20 22:49:58,986 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-20 22:49:58,987 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:49:58,997 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cae9ec12-4dfa-11f0-b79e-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:49:59,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:00 GMT'
    'ETag': '"0x8DDB01EAFEE32BD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '205f4a7f-401e-0099-3707-e24f90000000'
    'x-ms-client-request-id': 'cae9ec12-4dfa-11f0-b79e-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:19:59 GMT'
2025-06-20 22:49:59,543 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-20 22:49:59,544 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-20 22:49:59,544 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:49:59,559 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cb3fa279-4dfa-11f0-b284-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:00,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:01 GMT'
    'ETag': '"0x8DDB01EB069B59D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '55a72470-201e-00a0-4c07-e2b48c000000'
    'x-ms-client-request-id': 'cb3fa279-4dfa-11f0-b284-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:00 GMT'
2025-06-20 22:50:00,359 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-20 22:50:00,360 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-20 22:50:00,361 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:00,373 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003414'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cbbbc843-4dfa-11f0-821d-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:01,583 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:02 GMT'
    'ETag': '"0x8DDB01EB123CFD0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8b489cad-701e-0092-3007-e2b4fb000000'
    'x-ms-client-request-id': 'cbbbc843-4dfa-11f0-821d-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:02 GMT'
2025-06-20 22:50:01,584 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-20 22:50:01,585 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-20 22:50:01,586 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:01,610 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cc78a629-4dfa-11f0-b5ab-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:03,538 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:04 GMT'
    'ETag': '"0x8DDB01EB251AD64"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '69d9a2d2-501e-0003-1907-e2d149000000'
    'x-ms-client-request-id': 'cc78a629-4dfa-11f0-b5ab-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:03 GMT'
2025-06-20 22:50:03,539 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-20 22:50:03,540 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs_full_sample.csv to blob as audit_logs_full_sample.csv
2025-06-20 22:50:03,541 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:03,557 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cda1b896-4dfa-11f0-8f9b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:04,822 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:05 GMT'
    'ETag': '"0x8DDB01EB313394F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28cf8fe1-801e-002f-5d07-e23de6000000'
    'x-ms-client-request-id': 'cda1b896-4dfa-11f0-8f9b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:05 GMT'
2025-06-20 22:50:04,823 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs_full_sample.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv
2025-06-20 22:50:04,824 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-20 22:50:04,825 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:04,835 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ce64bbc1-4dfa-11f0-a716-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:05,248 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:06 GMT'
    'ETag': '"0x8DDB01EB3513516"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e76f59dd-301e-003a-1607-e22a55000000'
    'x-ms-client-request-id': 'ce64bbc1-4dfa-11f0-a716-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:05 GMT'
2025-06-20 22:50:05,248 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-20 22:50:05,249 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-20 22:50:05,250 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:05,262 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cea5cb2f-4dfa-11f0-b531-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:05,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:06 GMT'
    'ETag': '"0x8DDB01EB3967BA9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bae6bf11-a01e-0065-3f07-e29e69000000'
    'x-ms-client-request-id': 'cea5cb2f-4dfa-11f0-b531-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:05 GMT'
2025-06-20 22:50:05,693 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-20 22:50:05,694 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-20 22:50:05,695 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:05,707 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cee9bdc5-4dfa-11f0-addd-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:06,159 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:06 GMT'
    'ETag': '"0x8DDB01EB3E1AEFF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54daaed4-401e-0042-0907-e289ad000000'
    'x-ms-client-request-id': 'cee9bdc5-4dfa-11f0-addd-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:06 GMT'
2025-06-20 22:50:06,160 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-20 22:50:06,160 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-20 22:50:06,161 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:06,176 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cf3146c9-4dfa-11f0-b818-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:06,591 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:07 GMT'
    'ETag': '"0x8DDB01EB423770D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8dcfe735-601e-009e-8007-e223f3000000'
    'x-ms-client-request-id': 'cf3146c9-4dfa-11f0-b818-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:06 GMT'
2025-06-20 22:50:06,592 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-20 22:50:06,592 - src.core.analysis - INFO - Uploading D:\Production\backend\data\d365_roles.csv to blob as d365_roles.csv
2025-06-20 22:50:06,593 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:06,607 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cf731e10-4dfa-11f0-9cb0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:07,352 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:08 GMT'
    'ETag': '"0x8DDB01EB4919B76"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '74eb667b-b01e-008d-0607-e207ff000000'
    'x-ms-client-request-id': 'cf731e10-4dfa-11f0-9cb0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:07 GMT'
2025-06-20 22:50:07,353 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\d365_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv
2025-06-20 22:50:07,354 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_heuristic_output.csv to blob as role_usage_heuristic_output.csv
2025-06-20 22:50:07,355 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:07,375 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cfe831e7-4dfa-11f0-bee6-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:07,898 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:08 GMT'
    'ETag': '"0x8DDB01EB4EAEFB8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1eddd5b2-701e-002b-7307-e2b0e1000000'
    'x-ms-client-request-id': 'cfe831e7-4dfa-11f0-bee6-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:08 GMT'
2025-06-20 22:50:07,899 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_heuristic_output.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv
2025-06-20 22:50:07,900 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_per_user_summary.csv to blob as role_usage_per_user_summary.csv
2025-06-20 22:50:07,901 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:07,916 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '51338'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd03ac3e8-4dfa-11f0-bfe5-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:08,374 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:09 GMT'
    'ETag': '"0x8DDB01EB5316D6C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3c28076a-a01e-00ae-7e07-e29d3c000000'
    'x-ms-client-request-id': 'd03ac3e8-4dfa-11f0-bfe5-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:09 GMT'
2025-06-20 22:50:08,375 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_per_user_summary.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv
2025-06-20 22:50:08,376 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-20 22:50:08,377 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:08,388 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1385539'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd082e5be-4dfa-11f0-a792-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:09,392 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:10 GMT'
    'ETag': '"0x8DDB01EB5C89687"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '892a6faa-901e-0051-6b07-e2ada1000000'
    'x-ms-client-request-id': 'd082e5be-4dfa-11f0-a792-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:09 GMT'
2025-06-20 22:50:09,393 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-20 22:50:09,393 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-20 22:50:09,394 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:09,416 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd11fadf8-4dfa-11f0-af6c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:11,481 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:12 GMT'
    'ETag': '"0x8DDB01EB7094ABB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8d60ac5e-b01e-00b2-7807-e2cf5c000000'
    'x-ms-client-request-id': 'd11fadf8-4dfa-11f0-af6c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:11 GMT'
2025-06-20 22:50:11,482 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-20 22:50:11,483 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-20 22:50:11,484 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:11,494 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd25ccb89-4dfa-11f0-9723-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:12,056 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:12 GMT'
    'ETag': '"0x8DDB01EB75E84EC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd2b03974-701e-003b-2e07-e27589000000'
    'x-ms-client-request-id': 'd25ccb89-4dfa-11f0-9723-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:12 GMT'
2025-06-20 22:50:12,057 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-20 22:50:12,058 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-20 22:50:12,059 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:12,069 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd2b4975e-4dfa-11f0-9d65-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:12,708 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:13 GMT'
    'ETag': '"0x8DDB01EB7C537A3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c47a6d25-b01e-0056-0f07-e2c1c2000000'
    'x-ms-client-request-id': 'd2b4975e-4dfa-11f0-9d65-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:12 GMT'
2025-06-20 22:50:12,709 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-20 22:50:12,710 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-20 22:50:12,711 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:12,721 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd317f168-4dfa-11f0-b642-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:13,179 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:14 GMT'
    'ETag': '"0x8DDB01EB810DFA6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '513e4322-901e-009a-1507-e2aef4000000'
    'x-ms-client-request-id': 'd317f168-4dfa-11f0-b642-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:13 GMT'
2025-06-20 22:50:13,180 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-20 22:50:13,181 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-20 22:50:13,182 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:13,199 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd360e16c-4dfa-11f0-85aa-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:13,777 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:14 GMT'
    'ETag': '"0x8DDB01EB869E61E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a331d7e3-d01e-006f-7407-e23ade000000'
    'x-ms-client-request-id': 'd360e16c-4dfa-11f0-85aa-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:14 GMT'
2025-06-20 22:50:13,778 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-20 22:50:13,779 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-20 22:50:13,780 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:13,793 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd3bba229-4dfa-11f0-b1a1-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:14,378 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:15 GMT'
    'ETag': '"0x8DDB01EB8C49868"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9bda6fe7-901e-006e-4f07-e26502000000'
    'x-ms-client-request-id': 'd3bba229-4dfa-11f0-b1a1-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:14 GMT'
2025-06-20 22:50:14,378 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-20 22:50:14,379 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-20 22:50:14,380 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 22:50:14,394 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd4174591-4dfa-11f0-992e-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:15,009 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:15 GMT'
    'ETag': '"0x8DDB01EB925F9EA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0dd7fb42-001e-000e-1407-e2199d000000'
    'x-ms-client-request-id': 'd4174591-4dfa-11f0-992e-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:15 GMT'
2025-06-20 22:50:15,010 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-20 22:50:25,903 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-20 22:50:25,914 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-20 22:50:25,928 - main - INFO - [analyze] Analysis completed.
2025-06-20 22:50:25,975 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-20 22:50:26,007 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '248655'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db034053-4dfa-11f0-9107-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:26,596 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:27 GMT'
    'ETag': '"0x8DDB01EC00FFFE2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54960-c01e-00a8-7307-e2ae83000000'
    'x-ms-client-request-id': 'db034053-4dfa-11f0-9107-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:26 GMT'
2025-06-20 22:50:26,598 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db5d6610-4dfa-11f0-8c53-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:26,677 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:27 GMT'
    'ETag': '"0x8DDB01EC01C4E1B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d5496f-c01e-00a8-7e07-e2ae83000000'
    'x-ms-client-request-id': 'db5d6610-4dfa-11f0-8c53-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:26 GMT'
2025-06-20 22:50:26,680 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db6a042b-4dfa-11f0-8aad-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:26,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:27 GMT'
    'ETag': '"0x8DDB01EC029FA57"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54971-c01e-00a8-8007-e2ae83000000'
    'x-ms-client-request-id': 'db6a042b-4dfa-11f0-8aad-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:26 GMT'
2025-06-20 22:50:26,770 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db77c399-4dfa-11f0-8901-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:26,848 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:27 GMT'
    'ETag': '"0x8DDB01EC03621AA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54972-c01e-00a8-0107-e2ae83000000'
    'x-ms-client-request-id': 'db77c399-4dfa-11f0-8901-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:26 GMT'
2025-06-20 22:50:26,851 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db8409bc-4dfa-11f0-966c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:26,933 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:27 GMT'
    'ETag': '"0x8DDB01EC043A703"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54974-c01e-00a8-0307-e2ae83000000'
    'x-ms-client-request-id': 'db8409bc-4dfa-11f0-966c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:26 GMT'
2025-06-20 22:50:26,936 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003414'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'db90fc77-4dfa-11f0-b316-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:27,526 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:28 GMT'
    'ETag': '"0x8DDB01EC09E0B80"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54975-c01e-00a8-0407-e2ae83000000'
    'x-ms-client-request-id': 'db90fc77-4dfa-11f0-b316-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:27 GMT'
2025-06-20 22:50:27,532 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dbebf61f-4dfa-11f0-a8da-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:29,085 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:29 GMT'
    'ETag': '"0x8DDB01EC18BCCDC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d5497d-c01e-00a8-0a07-e2ae83000000'
    'x-ms-client-request-id': 'dbebf61f-4dfa-11f0-a8da-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:28 GMT'
2025-06-20 22:50:29,089 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dcd99bb9-4dfa-11f0-902e-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:29,619 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:30 GMT'
    'ETag': '"0x8DDB01EC1DD61A6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54998-c01e-00a8-1e07-e2ae83000000'
    'x-ms-client-request-id': 'dcd99bb9-4dfa-11f0-902e-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:29 GMT'
2025-06-20 22:50:29,621 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd2abf09-4dfa-11f0-bab2-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:29,717 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:30 GMT'
    'ETag': '"0x8DDB01EC1E8ED69"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549ba-c01e-00a8-3107-e2ae83000000'
    'x-ms-client-request-id': 'dd2abf09-4dfa-11f0-bab2-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:29 GMT'
2025-06-20 22:50:29,719 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd39bfd6-4dfa-11f0-8ded-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:29,793 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:30 GMT'
    'ETag': '"0x8DDB01EC1F7F7B0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549c0-c01e-00a8-3407-e2ae83000000'
    'x-ms-client-request-id': 'dd39bfd6-4dfa-11f0-8ded-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:29 GMT'
2025-06-20 22:50:29,795 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd453b21-4dfa-11f0-804d-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:29,870 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:30 GMT'
    'ETag': '"0x8DDB01EC203AA57"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549c4-c01e-00a8-3807-e2ae83000000'
    'x-ms-client-request-id': 'dd453b21-4dfa-11f0-804d-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:29 GMT'
2025-06-20 22:50:29,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd511980-4dfa-11f0-9789-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:29,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:30 GMT'
    'ETag': '"0x8DDB01EC20F83DF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549c6-c01e-00a8-3a07-e2ae83000000'
    'x-ms-client-request-id': 'dd511980-4dfa-11f0-9789-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:29 GMT'
2025-06-20 22:50:29,950 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd5cfd2b-4dfa-11f0-8885-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:30,028 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:30 GMT'
    'ETag': '"0x8DDB01EC21BD217"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549c8-c01e-00a8-3c07-e2ae83000000'
    'x-ms-client-request-id': 'dd5cfd2b-4dfa-11f0-8885-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:29 GMT'
2025-06-20 22:50:30,031 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd6949e9-4dfa-11f0-9696-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:30,106 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:30 GMT'
    'ETag': '"0x8DDB01EC227D287"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549ca-c01e-00a8-3d07-e2ae83000000'
    'x-ms-client-request-id': 'dd6949e9-4dfa-11f0-9696-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:30 GMT'
2025-06-20 22:50:30,108 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '51338'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd7519e7-4dfa-11f0-9488-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:30,182 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:31 GMT'
    'ETag': '"0x8DDB01EC2335E4A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549ce-c01e-00a8-4007-e2ae83000000'
    'x-ms-client-request-id': 'dd7519e7-4dfa-11f0-9488-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:30 GMT'
2025-06-20 22:50:30,184 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1385539'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd80b826-4dfa-11f0-94b8-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:30,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:31 GMT'
    'ETag': '"0x8DDB01EC26A3626"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549d0-c01e-00a8-4107-e2ae83000000'
    'x-ms-client-request-id': 'dd80b826-4dfa-11f0-94b8-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:30 GMT'
2025-06-20 22:50:30,548 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ddb826dc-4dfa-11f0-b5c3-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:31,868 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:32 GMT'
    'ETag': '"0x8DDB01EC3346ADE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d549d8-c01e-00a8-4907-e2ae83000000'
    'x-ms-client-request-id': 'ddb826dc-4dfa-11f0-b5c3-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:31 GMT'
2025-06-20 22:50:31,870 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'de81e3b9-4dfa-11f0-8773-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:31,944 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:32 GMT'
    'ETag': '"0x8DDB01EC3401D7D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54a06-c01e-00a8-7007-e2ae83000000'
    'x-ms-client-request-id': 'de81e3b9-4dfa-11f0-8773-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:31 GMT'
2025-06-20 22:50:31,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'de8da36a-4dfa-11f0-8c56-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:32,021 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:32 GMT'
    'ETag': '"0x8DDB01EC34BF70F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54a07-c01e-00a8-7107-e2ae83000000'
    'x-ms-client-request-id': 'de8da36a-4dfa-11f0-8c56-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:31 GMT'
2025-06-20 22:50:32,023 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'de993a68-4dfa-11f0-af03-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:32,097 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:32 GMT'
    'ETag': '"0x8DDB01EC35782D3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54a0c-c01e-00a8-7507-e2ae83000000'
    'x-ms-client-request-id': 'de993a68-4dfa-11f0-af03-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:32 GMT'
2025-06-20 22:50:32,099 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dea4eaef-4dfa-11f0-b916-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:32,175 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:33 GMT'
    'ETag': '"0x8DDB01EC3638342"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54a0e-c01e-00a8-7707-e2ae83000000'
    'x-ms-client-request-id': 'dea4eaef-4dfa-11f0-b916-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:32 GMT'
2025-06-20 22:50:32,177 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'deb0c927-4dfa-11f0-8d6f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:32,252 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:33 GMT'
    'ETag': '"0x8DDB01EC36F0F07"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54a12-c01e-00a8-7a07-e2ae83000000'
    'x-ms-client-request-id': 'deb0c927-4dfa-11f0-8d6f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:32 GMT'
2025-06-20 22:50:32,255 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'debc949c-4dfa-11f0-a5d8-c5823ebe3fa0'
A body is sent with the request
2025-06-20 22:50:32,332 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:20:33 GMT'
    'ETag': '"0x8DDB01EC37B0F73"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19d54a14-c01e-00a8-7c07-e2ae83000000'
    'x-ms-client-request-id': 'debc949c-4dfa-11f0-a5d8-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:20:32 GMT'
2025-06-20 22:53:13,001 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 22:53:13,003 - main - INFO - FastAPI application shutdown
2025-06-20 22:53:31,355 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:53:52,295 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:53:52,295 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:53:52,296 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:53:52,297 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:53:52,297 - main - INFO - FastAPI application started
2025-06-20 22:55:13,168 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 22:55:13,171 - main - INFO - FastAPI application shutdown
2025-06-20 22:55:19,120 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:55:23,270 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:55:23,271 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:55:23,271 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:55:23,272 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:55:23,272 - main - INFO - FastAPI application started
2025-06-20 22:55:35,386 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-20 22:55:35,386 - main - INFO - FastAPI application shutdown
2025-06-20 22:55:40,788 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-20 22:55:44,569 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-20 22:55:44,569 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-20 22:55:44,570 - apscheduler.scheduler - INFO - Scheduler started
2025-06-20 22:55:44,571 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-20 22:55:44,572 - main - INFO - FastAPI application started
2025-06-20 23:00:33,983 - d365 - INFO - Loading D365 data
2025-06-20 23:00:33,984 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:00:34,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9b73e5b7-b95f-46fe-bb66-458134be1300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:30:34 GMT'
    'Content-Length': '1753'
2025-06-20 23:00:34,273 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:00:34,441 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'feeb9ca7-e099-40df-9505-a36e630a1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:30:35 GMT'
    'Content-Length': '1648'
2025-06-20 23:00:34,442 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:00:34,443 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:00:34,443 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-22T17:30:34Z)
2025-06-20 23:00:38,213 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-20 23:00:40,993 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-20 23:00:44,689 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-20 23:00:47,445 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-20 23:00:50,261 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-20 23:00:53,155 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-20 23:00:54,565 - d365 - INFO - Progress: Fetched 32311 audit logs after 7 pages
2025-06-20 23:00:54,582 - d365 - INFO - Fetched 32311 D365 audit logs via Dataverse
2025-06-20 23:00:54,634 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-20 23:00:54,637 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:00:54,835 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '57688525-244f-4133-a053-5990a4b21700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:30:54 GMT'
    'Content-Length': '1753'
2025-06-20 23:00:54,836 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:00:54,966 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'eaef825e-b447-4712-bc5a-e3b2c50a1700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:30:55 GMT'
    'Content-Length': '1997'
2025-06-20 23:00:54,967 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:00:54,968 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:00:54,968 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-22T17:30:54Z)
2025-06-20 23:00:54,969 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-20 23:01:00,991 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 10.0 req/min | Time: 0:00:06
2025-06-20 23:01:08,824 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 8.7 req/min | Time: 0:00:13
2025-06-20 23:01:19,271 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 7.4 req/min | Time: 0:00:24
2025-06-20 23:01:28,689 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 7.1 req/min | Time: 0:00:33
2025-06-20 23:01:46,806 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.8 req/min | Time: 0:00:51
2025-06-20 23:01:50,535 - d365 - INFO - Progress: 5,429 records | Pages: 6 | Requests: 6 | Rate: 6.5 req/min | Time: 0:00:55
2025-06-20 23:01:51,037 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-21T17:37:54Z to 2025-06-20T17:10:59Z
2025-06-20 23:01:51,082 - d365 - INFO - Fetch completed: 5,429 records in 0:00:56
2025-06-20 23:01:51,082 - d365 - INFO - Total requests made: 6
2025-06-20 23:01:51,087 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:01:51,299 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '64612752-5fa6-4b9d-967d-6963ff821800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:31:51 GMT'
    'Content-Length': '1753'
2025-06-20 23:01:51,300 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:01:51,457 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '11e41a48-4390-494b-9d64-5be9b43e2400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:31:52 GMT'
    'Content-Length': '1648'
2025-06-20 23:01:51,458 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:01:51,458 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:01:51,459 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:01:51,683 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f40fe0a1-a608-4ac6-b2b6-93e638561f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:31:51 GMT'
    'Content-Length': '1753'
2025-06-20 23:01:51,684 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:01:51,828 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e58d898b-1e95-4127-b984-93197d5d1700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:31:51 GMT'
    'Content-Length': '1997'
2025-06-20 23:01:51,829 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:01:51,829 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:01:51,830 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:01:52,043 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'feeb9ca7-e099-40df-9505-a36eca0f1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:31:51 GMT'
    'Content-Length': '1753'
2025-06-20 23:01:52,044 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:01:52,242 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'cc52b4e3-cd7e-4b99-8a01-c1e2467c1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:31:52 GMT'
    'Content-Length': '1996'
2025-06-20 23:01:52,243 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:01:52,243 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:01:54,587 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-20 23:01:54,588 - d365 - INFO - Found 981 users in Entra ID
2025-06-20 23:01:55,820 - d365 - INFO - Fetched 936 user records from D365
2025-06-20 23:02:55,118 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-20 23:02:55,119 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-20 23:03:29,741 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-20 23:03:29,742 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-20 23:03:31,786 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-20 23:03:31,787 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-20 23:03:35,995 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-20 23:03:35,996 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-20 23:04:19,112 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-20 23:04:19,113 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-20 23:04:43,433 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-20 23:04:43,435 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-20 23:04:58,174 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-20 23:04:58,175 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-20 23:05:34,924 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-20 23:05:34,925 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-20 23:05:34,926 - d365 - INFO - Final user count after filtering: 205
2025-06-20 23:05:34,927 - d365 - INFO - Fetched 205 user details after filtering
2025-06-20 23:05:34,930 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-20 23:05:34,934 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-20 23:05:34,939 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-20 23:05:34,941 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:05:35,171 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '92559661-6bee-4ccd-9c21-1c79178c1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:35 GMT'
    'Content-Length': '1753'
2025-06-20 23:05:35,173 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:05:35,385 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '53fff2a5-6086-488d-97c9-5de4f05c1600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:36 GMT'
    'Content-Length': '1647'
2025-06-20 23:05:35,385 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:05:35,386 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:05:36,510 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-20 23:05:36,515 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-20 23:05:36,516 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:05:36,674 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b351c73e-e8b5-49ee-9763-04eb9c681500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:36 GMT'
    'Content-Length': '1753'
2025-06-20 23:05:36,675 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:05:36,861 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '73f5639c-6a20-428f-9f3d-764888dc1900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:36 GMT'
    'Content-Length': '1651'
2025-06-20 23:05:36,862 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:05:36,863 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:05:39,143 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-20 23:05:39,147 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-20 23:05:39,149 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:05:39,376 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0779b493-942f-4514-8969-6e3fe3021600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:39 GMT'
    'Content-Length': '1753'
2025-06-20 23:05:39,378 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:05:39,598 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c3067561-e273-4f2b-a596-1e59a5d31400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:39 GMT'
    'Content-Length': '1989'
2025-06-20 23:05:39,599 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:05:39,600 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:05:41,902 - d365 - INFO - Fetched 35 conditional access policies
2025-06-20 23:05:41,904 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-20 23:05:41,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:05:42,048 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3df147f8-5800-4d0b-8758-b81c17ab1600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:42 GMT'
    'Content-Length': '1753'
2025-06-20 23:05:42,049 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:05:42,230 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'eb4656e5-50a8-4f26-b47d-4b3395991500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:35:43 GMT'
    'Content-Length': '1652'
2025-06-20 23:05:42,231 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:05:42,231 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:05:42,896 - d365 - INFO - Fetched 11 business units
2025-06-20 23:05:42,898 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-20 23:05:42,900 - d365 - INFO - D365 data loaded successfully
2025-06-20 23:05:42,911 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-20 23:05:42,912 - main - INFO - Loading data from CSV files
2025-06-20 23:05:42,962 - main - INFO - Loaded audit_logs with 32311 rows
2025-06-20 23:05:43,004 - main - INFO - Loaded signin_logs with 5429 rows
2025-06-20 23:05:43,034 - main - INFO - Loaded user_details with 205 rows
2025-06-20 23:05:43,039 - main - INFO - Loaded app_roles with 2112 rows
2025-06-20 23:05:43,069 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-20 23:05:43,188 - main - INFO - Created group_memberships with 3295 rows
2025-06-20 23:05:43,197 - main - INFO - Created role_matrix with 2112 rows
2025-06-20 23:05:43,202 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-20 23:05:43,203 - main - WARNING - Found 75 users in signin_logs not present in user_details: ['9405e3c4-34fa-4514-aa16-161cb1e01532', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', 'f956b637-d19e-48a5-bde4-01ab0f111c5b', 'b36d70a1-f635-4f11-9be8-c9cb51b84298', '8c21304f-41d0-474f-bb19-d49eba150fb0']...
2025-06-20 23:05:43,205 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['c4071676-e5be-eb11-bacc-000d3ade3348', 'e09b27dd-6d24-ee11-9cbc-000d3a669ba8', 'b7da05ff-8ac6-ed11-b597-0022489b4de1', '626fe506-9bf2-eb11-94ef-000d3aba6d30', '0c888ab9-76b4-eb11-8236-000d3ab5a61f']...
2025-06-20 23:05:43,206 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-20 23:05:43,209 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-20 23:05:43,209 - src.core.embeddings - INFO - Starting embedding generation
2025-06-20 23:05:43,210 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-20 23:05:43,210 - src.core.embeddings - INFO - Using batch_size=64
2025-06-20 23:05:43,211 - src.core.embeddings - INFO - Using device: cpu
2025-06-20 23:06:27,010 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-20 23:06:31,848 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-20 23:06:31,848 - src.core.embeddings - INFO - Embedding initialization took 48.64 seconds
2025-06-20 23:06:31,849 - src.core.embeddings - INFO - Memory usage: RSS=514.83 MB, VMS=2701.78 MB
2025-06-20 23:06:31,849 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-20 23:06:31,849 - src.core.embeddings - INFO - Using all logs: audit_logs=32311 rows, signin_logs=5429 rows
2025-06-20 23:06:31,854 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-20 23:06:31,863 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-20 23:06:32,549 - src.core.embeddings - INFO - Text generation took 0.70 seconds
2025-06-20 23:06:32,550 - src.core.embeddings - INFO - Memory usage: RSS=539.23 MB, VMS=2726.56 MB
2025-06-20 23:06:32,550 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-20 23:06:34,416 - src.core.embeddings - INFO - Total documents to embed: 37740
2025-06-20 23:06:34,417 - src.core.embeddings - INFO - Document conversion took 1.87 seconds
2025-06-20 23:06:34,417 - src.core.embeddings - INFO - Memory usage: RSS=568.90 MB, VMS=2755.62 MB
2025-06-20 23:06:34,418 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-20 23:06:34,419 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-20 23:06:46,672 - src.core.embeddings - INFO - Memory usage: RSS=734.68 MB, VMS=2940.96 MB
2025-06-20 23:06:46,672 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-20 23:06:58,924 - src.core.embeddings - INFO - Memory usage: RSS=809.82 MB, VMS=3015.51 MB
2025-06-20 23:06:58,925 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-20 23:07:11,330 - src.core.embeddings - INFO - Memory usage: RSS=884.41 MB, VMS=3089.73 MB
2025-06-20 23:07:11,330 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-20 23:07:24,275 - src.core.embeddings - INFO - Memory usage: RSS=948.26 MB, VMS=3164.52 MB
2025-06-20 23:07:24,275 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-20 23:07:37,861 - src.core.embeddings - INFO - Memory usage: RSS=1021.86 MB, VMS=3237.64 MB
2025-06-20 23:07:37,861 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-20 23:07:50,977 - src.core.embeddings - INFO - Memory usage: RSS=1095.62 MB, VMS=3311.93 MB
2025-06-20 23:07:50,977 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-20 23:08:19,009 - src.core.embeddings - INFO - Memory usage: RSS=1353.23 MB, VMS=3567.30 MB
2025-06-20 23:08:19,010 - src.core.embeddings - INFO - Embedding chunk 8/8 (2740 documents)
2025-06-20 23:08:41,720 - src.core.embeddings - INFO - Memory usage: RSS=1394.18 MB, VMS=3608.54 MB
2025-06-20 23:08:42,043 - src.core.embeddings - INFO - Embedding generation took 127.63 seconds
2025-06-20 23:08:42,044 - src.core.embeddings - INFO - Memory usage: RSS=1394.18 MB, VMS=3608.54 MB
2025-06-20 23:08:42,044 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-20 23:08:42,834 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37740 vectors
2025-06-20 23:08:43,831 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-20 23:08:43,855 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-20 23:08:43,856 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-20 23:08:43,858 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.81 seconds
2025-06-20 23:08:43,858 - src.core.embeddings - INFO - Memory usage: RSS=1590.32 MB, VMS=3943.20 MB
2025-06-20 23:08:43,872 - src.core.embeddings - INFO - Total embedding generation took 180.66 seconds
2025-06-20 23:08:43,931 - main - INFO - [analyze] Embeddings generated.
2025-06-20 23:08:43,932 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-20 23:08:43,932 - src.utils.config - INFO - Loading environment variables
2025-06-20 23:08:43,971 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-20 23:08:43,972 - src.core.analysis - INFO - Validating input DataFrames
2025-06-20 23:08:44,071 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 23:08:44,072 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 23:08:44,073 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 23:08:44,073 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-20 23:08:44,073 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-20 23:08:44,083 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-20 23:08:44,084 - src.core.analysis - INFO - User IDs from signin_logs: 75
2025-06-20 23:08:44,084 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-20 23:08:44,085 - src.core.analysis - INFO - User IDs from app_role_assignments: 335
2025-06-20 23:08:44,086 - src.core.analysis - INFO - Total unique user IDs: 515
2025-06-20 23:08:45,732 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-20 23:08:45,754 - src.core.analysis - INFO - Starting analysis
2025-06-20 23:08:45,754 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-20 23:08:48,959 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-20 23:08:48,960 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-20 23:08:48,961 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-20 23:08:48,961 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-20 23:08:48,962 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-20 23:08:48,962 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 23:08:48,963 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5429, 12)
2025-06-20 23:08:48,963 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 23:08:48,968 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-20 23:08:48,987 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-20 23:08:49,003 - src.analysis.anomaly_detector - INFO - Successfully mapped 5427 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-20 23:08:49,007 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-20 23:08:49,007 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 75
2025-06-20 23:08:49,008 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 1
2025-06-20 23:08:49,009 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 2
2025-06-20 23:08:49,009 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-20 23:08:49,010 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-20 23:08:49,010 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-20 23:08:49,011 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-20 23:08:49,011 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-20 23:08:49,012 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-20 23:08:49,012 - src.analysis.anomaly_detector - INFO - Generated names for 2 missing users
2025-06-20 23:08:49,013 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-20 23:08:49,013 - src.analysis.anomaly_detector - INFO -   Missing user: unknown -> User-unknown
2025-06-20 23:08:49,014 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-20 23:08:49,015 - src.analysis.anomaly_detector - INFO - Successfully mapped 207 users
2025-06-20 23:08:49,015 - src.analysis.anomaly_detector - INFO - Generated names for 2 users not found in user_details
2025-06-20 23:08:49,016 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-20 23:08:49,016 - src.analysis.anomaly_detector - INFO -   unknown -> User-unknown (from vectorstore)
2025-06-20 23:08:50,372 - src.analysis.anomaly_detector - INFO - Detected 44 anomalies
2025-06-20 23:08:50,372 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-20 23:08:50,373 - src.analysis.anomaly_detector - INFO - Example 1: Vikneshkumar Palanisamy -> User Vikneshkumar Palanisamy had 2007 sign-ins (avg: 72.4, threshold: 551.2) in the period.; User us...
2025-06-20 23:08:50,374 - src.analysis.anomaly_detector - INFO - Example 2: Nihal Rajeev -> User usually signs in from Bengaluru, IN (58.8%), but on 2025-06-20 signed in from Delhi, IN.; User ...
2025-06-20 23:08:50,374 - src.analysis.anomaly_detector - INFO - Example 3: Lubna Kawal -> User usually signs in from Abu Zaby, AE (77.8%), but on 2025-05-23 signed in from Bengaluru, IN.; Us...
2025-06-20 23:08:50,375 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-20 23:08:51,089 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-20 23:08:51,091 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-20 23:08:51,192 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-20 23:08:51,658 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-20 23:08:52,201 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-20 23:08:52,202 - src.core.analysis - INFO - Analyzing inactive users
2025-06-20 23:08:52,202 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-20 23:08:52,203 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 23:08:52,203 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 23:08:52,208 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-20 17:10:59+0000', tz='UTC'), Timestamp('2025-06-20 16:18:20+0000', tz='UTC'), Timestamp('2025-06-20 15:56:42+0000', tz='UTC'), Timestamp('2025-06-20 15:21:05+0000', tz='UTC'), Timestamp('2025-06-20 15:01:21+0000', tz='UTC')]
2025-06-20 23:08:52,209 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-20 23:08:52,218 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-22 19:47:30+0000', tz='UTC'), Timestamp('2025-03-22 22:23:41+0000', tz='UTC'), Timestamp('2025-03-22 22:30:24+0000', tz='UTC'), Timestamp('2025-03-22 22:30:40+0000', tz='UTC'), Timestamp('2025-03-22 22:30:53+0000', tz='UTC')]
2025-06-20 23:08:52,219 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-20 23:08:52,706 - src.analysis.inactive_users - INFO - Found 131 inactive users out of 205 total users.
2025-06-20 23:08:52,708 - src.core.analysis - INFO - Total unique user IDs after analysis: 598
2025-06-20 23:08:52,738 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-20 23:08:52,739 - src.core.analysis - INFO - Using chunk size: 200 for 598 users
2025-06-20 23:08:52,741 - src.core.analysis - INFO - Processing 3 chunks sequentially
2025-06-20 23:08:52,743 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-20 23:08:52,744 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 144518 bytes
2025-06-20 23:09:37,994 - src.core.analysis - INFO - Findings chunk 1 completed in 45.25s
2025-06-20 23:09:37,994 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-20 23:09:37,996 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 144584 bytes
2025-06-20 23:10:07,298 - src.core.analysis - INFO - Findings chunk 2 completed in 29.30s
2025-06-20 23:10:07,298 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-20 23:10:07,300 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 151336 bytes
2025-06-20 23:10:26,156 - src.core.analysis - INFO - Findings chunk 3 completed in 18.86s
2025-06-20 23:10:26,269 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-20 23:10:26,270 - src.core.analysis - INFO - Processed 1/3 chunks (33%)
2025-06-20 23:10:26,270 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-20 23:10:26,271 - src.core.analysis - INFO - Processed 2/3 chunks (66%)
2025-06-20 23:10:26,272 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-20 23:10:26,272 - src.core.analysis - INFO - Processed 3/3 chunks (95%)
2025-06-20 23:10:26,273 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-20 23:10:26,273 - src.core.analysis - INFO - Sequential processing completed in 93.53s
2025-06-20 23:10:26,274 - src.core.analysis - INFO - Successfully processed 3/3 chunks
2025-06-20 23:10:26,274 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-20 23:10:26,275 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 598 users
2025-06-20 23:10:26,276 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-20 23:10:26,277 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-20 23:10:26,278 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-20 23:10:26,278 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 28519 bytes
2025-06-20 23:10:36,841 - src.core.analysis - INFO - Recommendations chunk 1 completed in 10.56s
2025-06-20 23:10:36,950 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-20 23:10:36,951 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-20 23:10:36,951 - src.core.analysis - INFO - Analysis completed successfully with 13 recommendations
2025-06-20 23:10:36,952 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:36,952 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\audit_logs_full_sample.csv', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\d365_roles.csv', 'D:\\Production\\backend\\data\\role_usage_heuristic_output.csv', 'D:\\Production\\backend\\data\\role_usage_per_user_summary.csv', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-20 23:10:36,953 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-20 23:10:36,954 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:36,972 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '248655'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'accdde3b-4dfd-11f0-941f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:37,728 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:38 GMT'
    'ETag': '"0x8DDB02191F1DBA0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e0aba1b7-401e-007d-1c0a-e2410e000000'
    'x-ms-client-request-id': 'accdde3b-4dfd-11f0-941f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:37 GMT'
2025-06-20 23:10:37,729 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-20 23:10:37,730 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-20 23:10:37,731 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:37,732 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ad41e073-4dfd-11f0-9e07-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:38,332 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:39 GMT'
    'ETag': '"0x8DDB021924FE581"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c47b0f7f-b01e-0056-2f0a-e2c1c2000000'
    'x-ms-client-request-id': 'ad41e073-4dfd-11f0-9e07-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:38 GMT'
2025-06-20 23:10:38,333 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-20 23:10:38,334 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-20 23:10:38,335 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:38,353 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ada08dc1-4dfd-11f0-8726-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:38,914 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:39 GMT'
    'ETag': '"0x8DDB02192AAE597"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '66509da1-701e-0066-0b0a-e27f0d000000'
    'x-ms-client-request-id': 'ada08dc1-4dfd-11f0-8726-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:39 GMT'
2025-06-20 23:10:38,915 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-20 23:10:38,916 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-20 23:10:38,917 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:38,919 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'adf6e8e7-4dfd-11f0-b062-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:39,496 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:40 GMT'
    'ETag': '"0x8DDB02193017DCF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5c487b07-201e-0019-530a-e2b096000000'
    'x-ms-client-request-id': 'adf6e8e7-4dfd-11f0-b062-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:39 GMT'
2025-06-20 23:10:39,497 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-20 23:10:39,498 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-20 23:10:39,499 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:39,514 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ae51b350-4dfd-11f0-82c7-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:40,093 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:40 GMT'
    'ETag': '"0x8DDB021935EC539"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1d79c417-e01e-0039-2f0a-e2cb31000000'
    'x-ms-client-request-id': 'ae51b350-4dfd-11f0-82c7-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:40 GMT'
2025-06-20 23:10:40,094 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-20 23:10:40,095 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-20 23:10:40,096 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:40,099 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003352'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'aeaafada-4dfd-11f0-b812-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:41,118 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:41 GMT'
    'ETag': '"0x8DDB02193F91F17"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '207c4ceb-101e-0002-680a-e28e95000000'
    'x-ms-client-request-id': 'aeaafada-4dfd-11f0-b812-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:41 GMT'
2025-06-20 23:10:41,120 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-20 23:10:41,121 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-20 23:10:41,122 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:41,143 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'af4a57a9-4dfd-11f0-b13b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:43,413 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:44 GMT'
    'ETag': '"0x8DDB0219556D786"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '87f5e828-701e-0049-320a-e272c6000000'
    'x-ms-client-request-id': 'af4a57a9-4dfd-11f0-b13b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:43 GMT'
2025-06-20 23:10:43,414 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-20 23:10:43,415 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs_full_sample.csv to blob as audit_logs_full_sample.csv
2025-06-20 23:10:43,416 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:43,431 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b0a774eb-4dfd-11f0-8d06-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:44,559 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:45 GMT'
    'ETag': '"0x8DDB0219605DAA1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '107a75ff-a01e-0038-6e0a-e294ed000000'
    'x-ms-client-request-id': 'b0a774eb-4dfd-11f0-8d06-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:45 GMT'
2025-06-20 23:10:44,560 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs_full_sample.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv
2025-06-20 23:10:44,561 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-20 23:10:44,563 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:44,564 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b1545516-4dfd-11f0-8b80-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:44,931 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:45 GMT'
    'ETag': '"0x8DDB021963EAC15"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e3a6f918-b01e-0079-5d0a-e2cc09000000'
    'x-ms-client-request-id': 'b1545516-4dfd-11f0-8b80-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:45 GMT'
2025-06-20 23:10:44,932 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-20 23:10:44,933 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-20 23:10:44,934 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:44,951 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b18f670a-4dfd-11f0-abc0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:45,275 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:46 GMT'
    'ETag': '"0x8DDB0219675AAD7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3b215836-f01e-000a-410a-e2949a000000'
    'x-ms-client-request-id': 'b18f670a-4dfd-11f0-abc0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:45 GMT'
2025-06-20 23:10:45,276 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-20 23:10:45,277 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-20 23:10:45,278 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:45,279 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b1c178cb-4dfd-11f0-9dac-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:45,691 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:46 GMT'
    'ETag': '"0x8DDB02196B4B6D9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0871b537-f01e-0057-520a-e29e1e000000'
    'x-ms-client-request-id': 'b1c178cb-4dfd-11f0-9dac-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:46 GMT'
2025-06-20 23:10:45,692 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-20 23:10:45,693 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-20 23:10:45,694 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:45,711 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b2035481-4dfd-11f0-8bce-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:46,133 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:46 GMT'
    'ETag': '"0x8DDB02196F82ABB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8e0dbfc7-001e-0021-410a-e21456000000'
    'x-ms-client-request-id': 'b2035481-4dfd-11f0-8bce-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:46 GMT'
2025-06-20 23:10:46,134 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-20 23:10:46,135 - src.core.analysis - INFO - Uploading D:\Production\backend\data\d365_roles.csv to blob as d365_roles.csv
2025-06-20 23:10:46,137 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:46,153 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b246cf34-4dfd-11f0-9a55-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:46,661 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:47 GMT'
    'ETag': '"0x8DDB021974923EF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '15f021b0-601e-0008-030a-e22a22000000'
    'x-ms-client-request-id': 'b246cf34-4dfd-11f0-9a55-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:47 GMT'
2025-06-20 23:10:46,662 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\d365_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv
2025-06-20 23:10:46,663 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_heuristic_output.csv to blob as role_usage_heuristic_output.csv
2025-06-20 23:10:46,664 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:46,679 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b2971553-4dfd-11f0-ae58-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:47,132 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:47 GMT'
    'ETag': '"0x8DDB0219790D8C4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ca2763a6-801e-0000-370a-e2302d000000'
    'x-ms-client-request-id': 'b2971553-4dfd-11f0-ae58-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:47 GMT'
2025-06-20 23:10:47,133 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_heuristic_output.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv
2025-06-20 23:10:47,134 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_per_user_summary.csv to blob as role_usage_per_user_summary.csv
2025-06-20 23:10:47,135 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:47,147 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '58073'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b2de66ba-4dfd-11f0-8b05-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:47,570 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:48 GMT'
    'ETag': '"0x8DDB02197D3D7F7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'de7e165b-201e-007b-130a-e272b1000000'
    'x-ms-client-request-id': 'b2de66ba-4dfd-11f0-8b05-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:47 GMT'
2025-06-20 23:10:47,571 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_per_user_summary.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv
2025-06-20 23:10:47,572 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-20 23:10:47,573 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:47,575 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1385537'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b31fc7b3-4dfd-11f0-9f78-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:48,481 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:49 GMT'
    'ETag': '"0x8DDB021985EB2E0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f57fea2c-801e-0086-600a-e2fc94000000'
    'x-ms-client-request-id': 'b31fc7b3-4dfd-11f0-9f78-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:48 GMT'
2025-06-20 23:10:48,482 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-20 23:10:48,483 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-20 23:10:48,484 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:48,504 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b3ad7923-4dfd-11f0-9731-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:50,360 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:51 GMT'
    'ETag': '"0x8DDB021997D5F4D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e925350c-101e-002d-0f0a-e2835e000000'
    'x-ms-client-request-id': 'b3ad7923-4dfd-11f0-9731-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:50 GMT'
2025-06-20 23:10:50,361 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-20 23:10:50,362 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-20 23:10:50,364 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:50,365 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b4c98301-4dfd-11f0-8922-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:50,741 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:51 GMT'
    'ETag': '"0x8DDB02199B7B5AD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3c6bd432-301e-0077-480a-e2e5b9000000'
    'x-ms-client-request-id': 'b4c98301-4dfd-11f0-8922-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:51 GMT'
2025-06-20 23:10:50,743 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-20 23:10:50,744 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-20 23:10:50,745 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:50,759 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b5059fd0-4dfd-11f0-9117-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:51,221 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:52 GMT'
    'ETag': '"0x8DDB0219A00EF6C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e26932b8-e01e-0074-590a-e204dd000000'
    'x-ms-client-request-id': 'b5059fd0-4dfd-11f0-9117-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:51 GMT'
2025-06-20 23:10:51,222 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-20 23:10:51,223 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-20 23:10:51,224 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:51,226 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b54cdd62-4dfd-11f0-b601-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:51,757 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:52 GMT'
    'ETag': '"0x8DDB0219A503CD4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e33a7cca-201e-0026-020a-e27835000000'
    'x-ms-client-request-id': 'b54cdd62-4dfd-11f0-b601-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:52 GMT'
2025-06-20 23:10:51,758 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-20 23:10:51,759 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-20 23:10:51,760 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:51,778 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b5a11efa-4dfd-11f0-a3ec-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:52,274 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:53 GMT'
    'ETag': '"0x8DDB0219AA15CEF"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2839d544-c01e-0063-440a-e2add6000000'
    'x-ms-client-request-id': 'b5a11efa-4dfd-11f0-a3ec-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:53 GMT'
2025-06-20 23:10:52,275 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-20 23:10:52,276 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-20 23:10:52,277 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:52,278 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b5ed5e66-4dfd-11f0-8af7-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:52,893 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:53 GMT'
    'ETag': '"0x8DDB0219AFDBB0A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6edb5942-c01e-005c-2e0a-e26575000000'
    'x-ms-client-request-id': 'b5ed5e66-4dfd-11f0-8af7-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:53 GMT'
2025-06-20 23:10:52,894 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-20 23:10:52,895 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-20 23:10:52,896 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:10:52,913 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b64e4e15-4dfd-11f0-9d47-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:10:53,562 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:40:54 GMT'
    'ETag': '"0x8DDB0219B63AB4A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '02c2514a-801e-003f-560a-e2f88e000000'
    'x-ms-client-request-id': 'b64e4e15-4dfd-11f0-9d47-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:40:53 GMT'
2025-06-20 23:10:53,563 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-20 23:11:05,894 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-20 23:11:05,908 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-20 23:11:05,930 - main - INFO - [analyze] Analysis completed.
2025-06-20 23:11:05,989 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-20 23:11:06,018 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '212913'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be1dfa4c-4dfd-11f0-ab3f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:06,551 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:07 GMT'
    'ETag': '"0x8DDB021A3223A86"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc759f-301e-0093-340a-e2eb27000000'
    'x-ms-client-request-id': 'be1dfa4c-4dfd-11f0-ab3f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:06 GMT'
2025-06-20 23:11:06,553 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be6f918f-4dfd-11f0-9708-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:06,627 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:07 GMT'
    'ETag': '"0x8DDB021A32F98FC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75ac-301e-0093-3c0a-e2eb27000000'
    'x-ms-client-request-id': 'be6f918f-4dfd-11f0-9708-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:06 GMT'
2025-06-20 23:11:06,630 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be7b5d5c-4dfd-11f0-8f3b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:06,710 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:07 GMT'
    'ETag': '"0x8DDB021A33C34F3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75b2-301e-0093-420a-e2eb27000000'
    'x-ms-client-request-id': 'be7b5d5c-4dfd-11f0-8f3b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:06 GMT'
2025-06-20 23:11:06,712 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be87e62d-4dfd-11f0-a3d4-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:06,785 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:07 GMT'
    'ETag': '"0x8DDB021A347C0C2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75b3-301e-0093-430a-e2eb27000000'
    'x-ms-client-request-id': 'be87e62d-4dfd-11f0-a3d4-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:06 GMT'
2025-06-20 23:11:06,789 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be938b1f-4dfd-11f0-8d4c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:06,866 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:07 GMT'
    'ETag': '"0x8DDB021A3540EFB"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75b4-301e-0093-440a-e2eb27000000'
    'x-ms-client-request-id': 'be938b1f-4dfd-11f0-8d4c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:06 GMT'
2025-06-20 23:11:06,870 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003352'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be9fe883-4dfd-11f0-84cd-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:07,377 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:08 GMT'
    'ETag': '"0x8DDB021A3A2253A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75b6-301e-0093-460a-e2eb27000000'
    'x-ms-client-request-id': 'be9fe883-4dfd-11f0-84cd-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:07 GMT'
2025-06-20 23:11:07,383 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'beee319d-4dfd-11f0-bbe6-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:08,826 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:09 GMT'
    'ETag': '"0x8DDB021A47F3084"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75bd-301e-0093-4d0a-e2eb27000000'
    'x-ms-client-request-id': 'beee319d-4dfd-11f0-bbe6-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:08 GMT'
2025-06-20 23:11:08,832 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bfcb4b47-4dfd-11f0-9c59-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,364 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A4D139FA"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75e9-301e-0093-5d0a-e2eb27000000'
    'x-ms-client-request-id': 'bfcb4b47-4dfd-11f0-9c59-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,367 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c01cf5db-4dfd-11f0-8aa0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,439 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A4DCC5BD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75eb-301e-0093-5f0a-e2eb27000000'
    'x-ms-client-request-id': 'c01cf5db-4dfd-11f0-8aa0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,442 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0285f1c-4dfd-11f0-a962-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,514 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A4E82A9D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75f0-301e-0093-630a-e2eb27000000'
    'x-ms-client-request-id': 'c0285f1c-4dfd-11f0-a962-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,517 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c033caad-4dfd-11f0-b99a-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,590 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A4F3B65C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75f1-301e-0093-640a-e2eb27000000'
    'x-ms-client-request-id': 'c033caad-4dfd-11f0-b99a-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,594 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c03f7d70-4dfd-11f0-8da6-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,676 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A4FF8FE7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75f3-301e-0093-660a-e2eb27000000'
    'x-ms-client-request-id': 'c03f7d70-4dfd-11f0-8da6-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,681 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c04ce937-4dfd-11f0-8582-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,765 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A50DD7B8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75f4-301e-0093-670a-e2eb27000000'
    'x-ms-client-request-id': 'c04ce937-4dfd-11f0-8582-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c05a3d18-4dfd-11f0-a4b0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,847 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A51AE864"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75f6-301e-0093-690a-e2eb27000000'
    'x-ms-client-request-id': 'c05a3d18-4dfd-11f0-a4b0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,849 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '58073'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0667775-4dfd-11f0-bc16-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:09,923 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:10 GMT'
    'ETag': '"0x8DDB021A5264D41"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75f8-301e-0093-6b0a-e2eb27000000'
    'x-ms-client-request-id': 'c0667775-4dfd-11f0-bc16-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:09 GMT'
2025-06-20 23:11:09,926 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1385537'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c072404b-4dfd-11f0-8d19-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:10,328 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:11 GMT'
    'ETag': '"0x8DDB021A564490A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75fa-301e-0093-6d0a-e2eb27000000'
    'x-ms-client-request-id': 'c072404b-4dfd-11f0-8d19-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:10 GMT'
2025-06-20 23:11:10,335 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0b098a0-4dfd-11f0-9680-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:11,666 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:12 GMT'
    'ETag': '"0x8DDB021A6307752"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc75fe-301e-0093-710a-e2eb27000000'
    'x-ms-client-request-id': 'c0b098a0-4dfd-11f0-9680-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:11 GMT'
2025-06-20 23:11:11,669 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c17c3136-4dfd-11f0-ba06-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:11,743 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:12 GMT'
    'ETag': '"0x8DDB021A63C29FC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc760c-301e-0093-7d0a-e2eb27000000'
    'x-ms-client-request-id': 'c17c3136-4dfd-11f0-ba06-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:11 GMT'
2025-06-20 23:11:11,750 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1888a30-4dfd-11f0-98af-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:11,827 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:12 GMT'
    'ETag': '"0x8DDB021A6489F16"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc760d-301e-0093-7e0a-e2eb27000000'
    'x-ms-client-request-id': 'c1888a30-4dfd-11f0-98af-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:11 GMT'
2025-06-20 23:11:11,829 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c194a835-4dfd-11f0-95cc-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:11,903 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:12 GMT'
    'ETag': '"0x8DDB021A654C66A"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc760e-301e-0093-7f0a-e2eb27000000'
    'x-ms-client-request-id': 'c194a835-4dfd-11f0-95cc-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:11 GMT'
2025-06-20 23:11:11,907 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1a08f56-4dfd-11f0-9638-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:11,983 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:12 GMT'
    'ETag': '"0x8DDB021A660EDBE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc7610-301e-0093-010a-e2eb27000000'
    'x-ms-client-request-id': 'c1a08f56-4dfd-11f0-9638-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:11 GMT'
2025-06-20 23:11:11,987 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1aca5aa-4dfd-11f0-94ac-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:12,063 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:12 GMT'
    'ETag': '"0x8DDB021A66CEE2D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc7611-301e-0093-020a-e2eb27000000'
    'x-ms-client-request-id': 'c1aca5aa-4dfd-11f0-94ac-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:11 GMT'
2025-06-20 23:11:12,067 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1b8e10a-4dfd-11f0-b00d-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:11:12,142 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 17:41:12 GMT'
    'ETag': '"0x8DDB021A6791582"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fc7614-301e-0093-050a-e2eb27000000'
    'x-ms-client-request-id': 'c1b8e10a-4dfd-11f0-b00d-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:41:12 GMT'
2025-06-20 23:23:16,052 - d365 - INFO - Loading D365 data
2025-06-20 23:23:16,053 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:23:16,265 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'aeeb3b97-810f-4cf3-ac35-435a1bd51900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:53:16 GMT'
    'Content-Length': '1753'
2025-06-20 23:23:16,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:23:16,484 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '515a1033-9a7c-4805-976b-f95245fe1600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:53:16 GMT'
    'Content-Length': '1645'
2025-06-20 23:23:16,486 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:23:16,486 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:23:16,487 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-22T17:53:16Z)
2025-06-20 23:23:20,273 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-20 23:23:23,228 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-20 23:23:26,066 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-20 23:23:28,937 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-20 23:23:31,718 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-20 23:23:34,519 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-20 23:23:35,906 - d365 - INFO - Progress: Fetched 32309 audit logs after 7 pages
2025-06-20 23:23:35,926 - d365 - INFO - Fetched 32309 D365 audit logs via Dataverse
2025-06-20 23:23:35,991 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-20 23:23:35,994 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:23:36,181 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2717db01-e488-46a5-9a29-14084c6d1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:53:37 GMT'
    'Content-Length': '1753'
2025-06-20 23:23:36,183 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:23:36,346 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ff49ee8e-aeec-47f7-abbd-3bb3392b1800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:53:37 GMT'
    'Content-Length': '1992'
2025-06-20 23:23:36,347 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:23:36,348 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:23:36,348 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-22T17:53:36Z)
2025-06-20 23:23:36,348 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-20 23:23:46,331 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 6.0 req/min | Time: 0:00:09
2025-06-20 23:23:57,123 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 5.8 req/min | Time: 0:00:20
2025-06-20 23:24:06,819 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.9 req/min | Time: 0:00:30
2025-06-20 23:24:19,556 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.6 req/min | Time: 0:00:43
2025-06-20 23:24:29,778 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.6 req/min | Time: 0:00:53
2025-06-20 23:24:33,561 - d365 - INFO - Progress: 5,429 records | Pages: 6 | Requests: 6 | Rate: 6.3 req/min | Time: 0:00:57
2025-06-20 23:24:34,063 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-21T18:09:36Z to 2025-06-20T17:40:29Z
2025-06-20 23:24:34,119 - d365 - INFO - Fetch completed: 5,429 records in 0:00:57
2025-06-20 23:24:34,120 - d365 - INFO - Total requests made: 6
2025-06-20 23:24:34,125 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:24:34,335 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c5c1b0b1-3102-44e0-a43e-166957ff2000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:54:35 GMT'
    'Content-Length': '1753'
2025-06-20 23:24:34,336 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:24:34,549 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7ec3b1fd-8f20-4e65-a2bc-12fd91e90700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:54:35 GMT'
    'Content-Length': '1647'
2025-06-20 23:24:34,550 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:24:34,550 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:24:34,551 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:24:34,904 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7821745a-da35-483d-af26-85bae6821600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:54:34 GMT'
    'Content-Length': '1753'
2025-06-20 23:24:34,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:24:35,032 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '925119a8-33e3-4d19-ab42-f049e8d31900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:54:35 GMT'
    'Content-Length': '1997'
2025-06-20 23:24:35,033 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:24:35,033 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:24:35,034 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:24:35,216 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7e175be1-6c9f-4a1d-883c-a8306db81400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:54:35 GMT'
    'Content-Length': '1753'
2025-06-20 23:24:35,217 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:24:35,420 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '709cc9eb-aefc-4fbd-9bc3-f235c4b91600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:54:35 GMT'
    'Content-Length': '1991'
2025-06-20 23:24:35,421 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:24:35,422 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:24:37,699 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-20 23:24:37,700 - d365 - INFO - Found 981 users in Entra ID
2025-06-20 23:24:39,066 - d365 - INFO - Fetched 936 user records from D365
2025-06-20 23:25:38,072 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-20 23:25:38,073 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-20 23:26:12,006 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-20 23:26:12,007 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-20 23:26:14,231 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-20 23:26:14,232 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-20 23:26:18,518 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-20 23:26:18,519 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-20 23:27:02,218 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-20 23:27:02,219 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-20 23:27:26,857 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-20 23:27:26,858 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-20 23:27:40,588 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-20 23:27:40,589 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-20 23:28:16,817 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-20 23:28:16,818 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-20 23:28:16,819 - d365 - INFO - Final user count after filtering: 205
2025-06-20 23:28:16,820 - d365 - INFO - Fetched 205 user details after filtering
2025-06-20 23:28:16,823 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-20 23:28:16,826 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-20 23:28:16,829 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-20 23:28:16,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:28:17,162 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd1155f49-16eb-44db-b854-f35a60fd1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:17 GMT'
    'Content-Length': '1753'
2025-06-20 23:28:17,164 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:28:17,382 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2154035c-159e-447c-b406-a31fc9fc1f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:17 GMT'
    'Content-Length': '1648'
2025-06-20 23:28:17,383 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:28:17,383 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:28:18,545 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-20 23:28:18,549 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-20 23:28:18,551 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:28:18,886 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e4cd9d19-7129-4057-9103-449a74471500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:19 GMT'
    'Content-Length': '1753'
2025-06-20 23:28:18,888 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:28:19,317 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '222efe2f-c031-47d7-b102-fe14a3511b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:19 GMT'
    'Content-Length': '1647'
2025-06-20 23:28:19,317 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:28:19,318 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:28:21,489 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-20 23:28:21,492 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-20 23:28:21,494 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:28:21,777 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '52fffb9f-13db-4651-a4ec-494a4b4c1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:21 GMT'
    'Content-Length': '1753'
2025-06-20 23:28:21,778 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:28:22,038 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '460a7a5a-8c25-4e01-8928-85badb380c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:22 GMT'
    'Content-Length': '1995'
2025-06-20 23:28:22,039 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:28:22,040 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-20 23:28:26,405 - d365 - INFO - Fetched 35 conditional access policies
2025-06-20 23:28:26,407 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-20 23:28:26,408 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-20 23:28:26,732 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ff7ed40f-3fb2-4cd3-90b3-fbc05cab1700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:27 GMT'
    'Content-Length': '1753'
2025-06-20 23:28:26,733 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-20 23:28:26,944 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '51ba71e1-3f2b-4c0d-97a7-4a1cb58f1e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 17:58:27 GMT'
    'Content-Length': '1648'
2025-06-20 23:28:26,945 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-20 23:28:26,945 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-20 23:28:27,665 - d365 - INFO - Fetched 11 business units
2025-06-20 23:28:27,666 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-20 23:28:27,668 - d365 - INFO - D365 data loaded successfully
2025-06-20 23:28:27,678 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-20 23:28:27,680 - main - INFO - Loading data from CSV files
2025-06-20 23:28:27,727 - main - INFO - Loaded audit_logs with 32309 rows
2025-06-20 23:28:27,768 - main - INFO - Loaded signin_logs with 5429 rows
2025-06-20 23:28:27,793 - main - INFO - Loaded user_details with 205 rows
2025-06-20 23:28:27,798 - main - INFO - Loaded app_roles with 2112 rows
2025-06-20 23:28:27,826 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-20 23:28:27,937 - main - INFO - Created group_memberships with 3295 rows
2025-06-20 23:28:27,944 - main - INFO - Created role_matrix with 2112 rows
2025-06-20 23:28:27,949 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-20 23:28:27,950 - main - WARNING - Found 75 users in signin_logs not present in user_details: ['9405e3c4-34fa-4514-aa16-161cb1e01532', '249ff76c-c4eb-4fb3-91a4-aa0fd0e8a268', 'f956b637-d19e-48a5-bde4-01ab0f111c5b', 'b36d70a1-f635-4f11-9be8-c9cb51b84298', '8c21304f-41d0-474f-bb19-d49eba150fb0']...
2025-06-20 23:28:27,951 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['c4071676-e5be-eb11-bacc-000d3ade3348', 'e09b27dd-6d24-ee11-9cbc-000d3a669ba8', 'b7da05ff-8ac6-ed11-b597-0022489b4de1', '626fe506-9bf2-eb11-94ef-000d3aba6d30', '0c888ab9-76b4-eb11-8236-000d3ab5a61f']...
2025-06-20 23:28:27,952 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-20 23:28:27,954 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-20 23:28:27,955 - src.core.embeddings - INFO - Starting embedding generation
2025-06-20 23:28:27,955 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-20 23:28:27,955 - src.core.embeddings - INFO - Using batch_size=64
2025-06-20 23:28:27,956 - src.core.embeddings - INFO - Using device: cpu
2025-06-20 23:28:27,957 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-20 23:28:30,816 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-20 23:28:30,816 - src.core.embeddings - INFO - Embedding initialization took 2.86 seconds
2025-06-20 23:28:30,817 - src.core.embeddings - INFO - Memory usage: RSS=554.30 MB, VMS=3030.18 MB
2025-06-20 23:28:30,817 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-20 23:28:30,818 - src.core.embeddings - INFO - Using all logs: audit_logs=32309 rows, signin_logs=5429 rows
2025-06-20 23:28:30,822 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-20 23:28:30,829 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-20 23:28:31,312 - src.core.embeddings - INFO - Text generation took 0.49 seconds
2025-06-20 23:28:31,313 - src.core.embeddings - INFO - Memory usage: RSS=554.94 MB, VMS=3030.83 MB
2025-06-20 23:28:31,313 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-20 23:28:32,696 - src.core.embeddings - INFO - Total documents to embed: 37738
2025-06-20 23:28:32,696 - src.core.embeddings - INFO - Document conversion took 1.38 seconds
2025-06-20 23:28:32,697 - src.core.embeddings - INFO - Memory usage: RSS=566.42 MB, VMS=3042.84 MB
2025-06-20 23:28:32,697 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-20 23:28:32,699 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-20 23:28:45,477 - src.core.embeddings - INFO - Memory usage: RSS=708.97 MB, VMS=3108.23 MB
2025-06-20 23:28:45,478 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-20 23:28:57,010 - src.core.embeddings - INFO - Memory usage: RSS=784.31 MB, VMS=3181.81 MB
2025-06-20 23:28:57,011 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-20 23:29:08,466 - src.core.embeddings - INFO - Memory usage: RSS=858.39 MB, VMS=3255.58 MB
2025-06-20 23:29:08,467 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-20 23:29:20,035 - src.core.embeddings - INFO - Memory usage: RSS=932.18 MB, VMS=3329.78 MB
2025-06-20 23:29:20,035 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-20 23:29:32,026 - src.core.embeddings - INFO - Memory usage: RSS=1006.10 MB, VMS=3404.23 MB
2025-06-20 23:29:32,026 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-20 23:29:44,424 - src.core.embeddings - INFO - Memory usage: RSS=1080.43 MB, VMS=3479.11 MB
2025-06-20 23:29:44,424 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-20 23:30:10,078 - src.core.embeddings - INFO - Memory usage: RSS=1321.06 MB, VMS=3725.84 MB
2025-06-20 23:30:10,079 - src.core.embeddings - INFO - Embedding chunk 8/8 (2738 documents)
2025-06-20 23:30:30,746 - src.core.embeddings - INFO - Memory usage: RSS=1361.40 MB, VMS=3766.02 MB
2025-06-20 23:30:31,053 - src.core.embeddings - INFO - Embedding generation took 118.36 seconds
2025-06-20 23:30:31,054 - src.core.embeddings - INFO - Memory usage: RSS=1361.40 MB, VMS=3766.02 MB
2025-06-20 23:30:31,054 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-20 23:30:31,681 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37738 vectors
2025-06-20 23:30:32,552 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-20 23:30:32,570 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-20 23:30:32,571 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-20 23:30:32,572 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.52 seconds
2025-06-20 23:30:32,572 - src.core.embeddings - INFO - Memory usage: RSS=1550.48 MB, VMS=3970.33 MB
2025-06-20 23:30:32,584 - src.core.embeddings - INFO - Total embedding generation took 124.63 seconds
2025-06-20 23:30:32,616 - main - INFO - [analyze] Embeddings generated.
2025-06-20 23:30:32,617 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-20 23:30:32,617 - src.utils.config - INFO - Loading environment variables
2025-06-20 23:30:32,645 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-20 23:30:32,646 - src.core.analysis - INFO - Validating input DataFrames
2025-06-20 23:30:32,694 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 23:30:32,695 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 23:30:32,695 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 23:30:32,696 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-20 23:30:32,696 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-20 23:30:32,703 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-20 23:30:32,703 - src.core.analysis - INFO - User IDs from signin_logs: 75
2025-06-20 23:30:32,704 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-20 23:30:32,704 - src.core.analysis - INFO - User IDs from app_role_assignments: 335
2025-06-20 23:30:32,705 - src.core.analysis - INFO - Total unique user IDs: 515
2025-06-20 23:30:33,406 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-20 23:30:33,419 - src.core.analysis - INFO - Starting analysis
2025-06-20 23:30:33,420 - src.analysis.access_pattern - INFO - Analyzing access patterns
2025-06-20 23:30:35,911 - src.analysis.access_pattern - INFO - Access pattern analysis completed
2025-06-20 23:30:35,912 - src.core.analysis - INFO - No display name column found, using User ID as name.
2025-06-20 23:30:35,913 - src.analysis.anomaly_detector - INFO - Detecting anomalies
2025-06-20 23:30:35,913 - src.analysis.anomaly_detector - INFO - === USER DATA VALIDATION ===
2025-06-20 23:30:35,913 - src.analysis.anomaly_detector - INFO - User details shape: (205, 10)
2025-06-20 23:30:35,914 - src.analysis.anomaly_detector - INFO - User details columns: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 23:30:35,914 - src.analysis.anomaly_detector - INFO - Signin logs shape: (5429, 12)
2025-06-20 23:30:35,914 - src.analysis.anomaly_detector - INFO - Signin logs columns: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-20 23:30:35,919 - src.analysis.anomaly_detector - INFO - Invalid signInDateTime entries: 0
2025-06-20 23:30:35,933 - src.analysis.anomaly_detector - INFO - Using 'User ID' as primary user ID column
2025-06-20 23:30:35,947 - src.analysis.anomaly_detector - INFO - Successfully mapped 5427 signin_logs userIds to user_details userIds via azureAdObjectId
2025-06-20 23:30:35,950 - src.analysis.anomaly_detector - INFO - Total mapped users: 205
2025-06-20 23:30:35,951 - src.analysis.anomaly_detector - INFO - Total users in signin logs: 75
2025-06-20 23:30:35,951 - src.analysis.anomaly_detector - INFO - Total users in vectorstore: 22
2025-06-20 23:30:35,951 - src.analysis.anomaly_detector - INFO - Missing users (not in user_details): 1
2025-06-20 23:30:35,952 - src.analysis.anomaly_detector - INFO - Sample user mappings:
2025-06-20 23:30:35,952 - src.analysis.anomaly_detector - INFO -   418cf370-1c30-ed11-9db1-000d3a65164f -> Varadharajan Shanmugam (dept: PCS Employees - UAE)
2025-06-20 23:30:35,952 - src.analysis.anomaly_detector - INFO -   3b644a99-742f-ed11-9db1-000d3a651fbe -> Nitin Tumbade (dept: PCS Employees - UAE)
2025-06-20 23:30:35,953 - src.analysis.anomaly_detector - INFO -   0f8e48c4-f4c9-ec11-a7b5-000d3a653893 -> Rugma Satheesh (dept: AdminAgents)
2025-06-20 23:30:35,953 - src.analysis.anomaly_detector - INFO -   8353ba00-5fa3-ec11-983f-000d3a65be92 -> Bharat Devashi Luva (dept: PCS Employees - UAE)
2025-06-20 23:30:35,954 - src.analysis.anomaly_detector - INFO -   4d28cf51-83b9-ec11-983f-000d3a65c37c -> Prem Anand Rajendran (dept: Air Arabia NOC)
2025-06-20 23:30:35,954 - src.analysis.anomaly_detector - INFO - Generated names for 1 missing users
2025-06-20 23:30:35,954 - src.analysis.anomaly_detector - INFO -   Missing user: 1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e
2025-06-20 23:30:35,954 - src.analysis.anomaly_detector - INFO - === USER MAPPING STATISTICS ===
2025-06-20 23:30:35,955 - src.analysis.anomaly_detector - INFO - Successfully mapped 206 users
2025-06-20 23:30:35,955 - src.analysis.anomaly_detector - INFO - Generated names for 1 users not found in user_details
2025-06-20 23:30:35,955 - src.analysis.anomaly_detector - INFO -   1162c37e-dab5-4017-9d23-d606dbd2c6eb -> Unknown-1162c37e (from signin_logs)
2025-06-20 23:30:36,958 - src.analysis.anomaly_detector - INFO - Detected 52 anomalies
2025-06-20 23:30:36,959 - src.analysis.anomaly_detector - INFO - === ANOMALY MAPPING EXAMPLES ===
2025-06-20 23:30:36,959 - src.analysis.anomaly_detector - INFO - Example 1: Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e -> User Unknown-User-22f074a3-f331-4ba5-a5c3-aa0e8af9b61e has an unusual activity pattern (Roles: Unkno...
2025-06-20 23:30:36,960 - src.analysis.anomaly_detector - INFO - Example 2: Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 -> User Unknown-User-277f14c0-4325-4bcf-b311-599623c0ca37 has an unusual activity pattern (Roles: Unkno...
2025-06-20 23:30:36,960 - src.analysis.anomaly_detector - INFO - Example 3: Unknown-User-d373c19a-2bb2-4488-94a2-db96409ca507 -> User Unknown-User-d373c19a-2bb2-4488-94a2-db96409ca507 has an unusual activity pattern (Roles: Unkno...
2025-06-20 23:30:36,961 - src.analysis.permission_mismatch - INFO - Analyzing permission mismatches and SoD violations
2025-06-20 23:30:37,527 - src.analysis.permission_mismatch - INFO - Permission mismatch and SoD analysis completed
2025-06-20 23:30:37,528 - src.analysis.permission_trends - INFO - Analyzing permission usage trends
2025-06-20 23:30:37,603 - src.analysis.permission_trends - INFO - Invalid activityDateTime entries: 0
2025-06-20 23:30:37,947 - src.analysis.permission_trends - INFO - Invalid signInDateTime entries: 0
2025-06-20 23:30:38,335 - src.analysis.permission_trends - INFO - Permission usage trends analysis completed
2025-06-20 23:30:38,336 - src.core.analysis - INFO - Analyzing inactive users
2025-06-20 23:30:38,337 - src.analysis.inactive_users - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage', 'original_userId', 'mapped_userId']
2025-06-20 23:30:38,337 - src.analysis.inactive_users - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-20 23:30:38,337 - src.analysis.inactive_users - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-20 23:30:38,341 - src.analysis.inactive_users - INFO - Sample signInDateTime values: [Timestamp('2025-06-20 17:40:29+0000', tz='UTC'), Timestamp('2025-06-20 17:34:37+0000', tz='UTC'), Timestamp('2025-06-20 17:10:59+0000', tz='UTC'), Timestamp('2025-06-20 16:18:20+0000', tz='UTC'), Timestamp('2025-06-20 15:56:42+0000', tz='UTC')]
2025-06-20 23:30:38,342 - src.analysis.inactive_users - INFO - Invalid signInDateTime entries: 0
2025-06-20 23:30:38,350 - src.analysis.inactive_users - INFO - Sample activityDateTime values: [Timestamp('2025-03-22 19:47:30+0000', tz='UTC'), Timestamp('2025-03-22 22:23:41+0000', tz='UTC'), Timestamp('2025-03-22 22:30:24+0000', tz='UTC'), Timestamp('2025-03-22 22:30:40+0000', tz='UTC'), Timestamp('2025-03-22 22:30:53+0000', tz='UTC')]
2025-06-20 23:30:38,351 - src.analysis.inactive_users - INFO - Invalid activityDateTime entries: 0
2025-06-20 23:30:38,726 - src.analysis.inactive_users - INFO - Found 131 inactive users out of 205 total users.
2025-06-20 23:30:38,728 - src.core.analysis - INFO - Total unique user IDs after analysis: 606
2025-06-20 23:30:38,752 - src.core.analysis - INFO - Starting sequential processing of findings
2025-06-20 23:30:38,752 - src.core.analysis - INFO - Using chunk size: 200 for 606 users
2025-06-20 23:30:38,754 - src.core.analysis - INFO - Processing 4 chunks sequentially
2025-06-20 23:30:38,754 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 1
2025-06-20 23:30:38,756 - src.core.analysis - INFO - Processing findings chunk 1 with data size: 143763 bytes
2025-06-20 23:31:13,163 - src.core.analysis - INFO - Findings chunk 1 completed in 34.41s
2025-06-20 23:31:13,164 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 2
2025-06-20 23:31:13,166 - src.core.analysis - INFO - Processing findings chunk 2 with data size: 143694 bytes
2025-06-20 23:31:40,243 - src.core.analysis - INFO - Findings chunk 2 completed in 27.08s
2025-06-20 23:31:40,243 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 3
2025-06-20 23:31:40,245 - src.core.analysis - INFO - Processing findings chunk 3 with data size: 152908 bytes
2025-06-20 23:31:59,774 - src.core.analysis - INFO - Findings chunk 3 completed in 19.53s
2025-06-20 23:31:59,775 - src.core.analysis - INFO - Attempt 1/4 for findings chunk 4
2025-06-20 23:31:59,776 - src.core.analysis - INFO - Processing findings chunk 4 with data size: 10487 bytes
2025-06-20 23:32:28,922 - src.core.analysis - INFO - Findings chunk 4 completed in 29.15s
2025-06-20 23:32:29,028 - src.core.analysis - INFO - LLM response parsed successfully for chunk 1
2025-06-20 23:32:29,029 - src.core.analysis - INFO - Processed 1/4 chunks (25%)
2025-06-20 23:32:29,029 - src.core.analysis - INFO - LLM response parsed successfully for chunk 2
2025-06-20 23:32:29,030 - src.core.analysis - INFO - Processed 2/4 chunks (50%)
2025-06-20 23:32:29,030 - src.core.analysis - INFO - LLM response parsed successfully for chunk 3
2025-06-20 23:32:29,031 - src.core.analysis - INFO - Processed 3/4 chunks (75%)
2025-06-20 23:32:29,031 - src.core.analysis - INFO - LLM response parsed successfully for chunk 4
2025-06-20 23:32:29,032 - src.core.analysis - INFO - Processed 4/4 chunks (95%)
2025-06-20 23:32:29,032 - src.core.analysis - INFO - Sequential Processing completed!
2025-06-20 23:32:29,032 - src.core.analysis - INFO - Sequential processing completed in 110.28s
2025-06-20 23:32:29,033 - src.core.analysis - INFO - Successfully processed 4/4 chunks
2025-06-20 23:32:29,033 - src.core.analysis - INFO - Starting sequential processing of recommendations
2025-06-20 23:32:29,034 - src.core.analysis - INFO - Using recommendation chunk size: 30 for 606 users
2025-06-20 23:32:29,035 - src.core.analysis - INFO - Validating recommendation chunks data
2025-06-20 23:32:29,036 - src.core.analysis - INFO - Running sequential recommendations processing
2025-06-20 23:32:29,036 - src.core.analysis - INFO - Attempt 1/4 for recommendations chunk 1
2025-06-20 23:32:29,037 - src.core.analysis - INFO - Processing recommendations chunk 1 with data size: 34016 bytes
2025-06-20 23:32:40,144 - src.core.analysis - INFO - Recommendations chunk 1 completed in 11.11s
2025-06-20 23:32:40,249 - src.core.analysis - INFO - Processed 1/1 recommendation chunks (95%)
2025-06-20 23:32:40,250 - src.core.analysis - INFO - Recommendations processing completed!
2025-06-20 23:32:40,251 - src.core.analysis - INFO - Analysis completed successfully with 11 recommendations
2025-06-20 23:32:40,251 - src.core.analysis - INFO - [BLOB DEBUG] sas_url: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:40,252 - src.core.analysis - INFO - [BLOB DEBUG] files_to_upload: ['D:\\Production\\backend\\data\\analyze.json', 'D:\\Production\\backend\\data\\app_roles.csv', 'D:\\Production\\backend\\data\\app_roles.json', 'D:\\Production\\backend\\data\\app_role_assignments.csv', 'D:\\Production\\backend\\data\\app_role_assignments.json', 'D:\\Production\\backend\\data\\audit_logs.csv', 'D:\\Production\\backend\\data\\audit_logs.json', 'D:\\Production\\backend\\data\\audit_logs_full_sample.csv', 'D:\\Production\\backend\\data\\business_units.csv', 'D:\\Production\\backend\\data\\business_units.json', 'D:\\Production\\backend\\data\\conditional_access_policies.csv', 'D:\\Production\\backend\\data\\conditional_access_policies.json', 'D:\\Production\\backend\\data\\d365_roles.csv', 'D:\\Production\\backend\\data\\role_usage_heuristic_output.csv', 'D:\\Production\\backend\\data\\role_usage_per_user_summary.csv', 'D:\\Production\\backend\\data\\signin_logs.csv', 'D:\\Production\\backend\\data\\signin_logs.json', 'D:\\Production\\backend\\data\\users_without_d365_license.csv', 'D:\\Production\\backend\\data\\users_without_d365_license.json', 'D:\\Production\\backend\\data\\users_without_entra_id.csv', 'D:\\Production\\backend\\data\\users_without_entra_id.json', 'D:\\Production\\backend\\data\\user_details.csv', 'D:\\Production\\backend\\data\\user_details.json']
2025-06-20 23:32:40,252 - src.core.analysis - INFO - Uploading D:\Production\backend\data\analyze.json to blob as analyze.json
2025-06-20 23:32:40,253 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:40,265 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '212913'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c18c5bdc-4e00-11f0-b022-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:40,808 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:41 GMT'
    'ETag': '"0x8DDB024A6957E02"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8635a4f4-f01e-00a3-170d-e255e8000000'
    'x-ms-client-request-id': 'c18c5bdc-4e00-11f0-b022-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:40 GMT'
2025-06-20 23:32:40,809 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\analyze.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/analyze.json
2025-06-20 23:32:40,810 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.csv to blob as app_roles.csv
2025-06-20 23:32:40,811 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:40,812 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1dfd904-4e00-11f0-bac8-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:41,292 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:42 GMT'
    'ETag': '"0x8DDB024A6DF5352"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f776c019-301e-0067-7e0d-e220d1000000'
    'x-ms-client-request-id': 'c1dfd904-4e00-11f0-bac8-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:41 GMT'
2025-06-20 23:32:41,293 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.csv
2025-06-20 23:32:41,294 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_roles.json to blob as app_roles.json
2025-06-20 23:32:41,295 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:41,306 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c22b41cb-4e00-11f0-b08c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:42,018 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:42 GMT'
    'ETag': '"0x8DDB024A74BA500"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a73064da-601e-0027-550d-e227e9000000'
    'x-ms-client-request-id': 'c22b41cb-4e00-11f0-b08c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:42 GMT'
2025-06-20 23:32:42,019 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_roles.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_roles.json
2025-06-20 23:32:42,020 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.csv to blob as app_role_assignments.csv
2025-06-20 23:32:42,020 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:42,021 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c2985d8f-4e00-11f0-934f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:42,495 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:43 GMT'
    'ETag': '"0x8DDB024A796FF43"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3b24a2c2-f01e-000a-130d-e2949a000000'
    'x-ms-client-request-id': 'c2985d8f-4e00-11f0-934f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:42 GMT'
2025-06-20 23:32:42,496 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.csv
2025-06-20 23:32:42,497 - src.core.analysis - INFO - Uploading D:\Production\backend\data\app_role_assignments.json to blob as app_role_assignments.json
2025-06-20 23:32:42,498 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:42,510 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c2e2e778-4e00-11f0-9de0-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:43,116 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:43 GMT'
    'ETag': '"0x8DDB024A7F5CB9F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd2b072e8-d01e-0050-540d-e2f27d000000'
    'x-ms-client-request-id': 'c2e2e778-4e00-11f0-9de0-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:43 GMT'
2025-06-20 23:32:43,117 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\app_role_assignments.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/app_role_assignments.json
2025-06-20 23:32:43,118 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.csv to blob as audit_logs.csv
2025-06-20 23:32:43,119 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:43,120 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003228'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c3401472-4e00-11f0-bdfa-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:44,078 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:44 GMT'
    'ETag': '"0x8DDB024A888B3C9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd02347fe-401e-0030-630d-e28ee2000000'
    'x-ms-client-request-id': 'c3401472-4e00-11f0-bdfa-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:44 GMT'
2025-06-20 23:32:44,079 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.csv
2025-06-20 23:32:44,079 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs.json to blob as audit_logs.json
2025-06-20 23:32:44,080 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:44,096 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c3d4f6ef-4e00-11f0-8c40-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:46,013 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:46 GMT'
    'ETag': '"0x8DDB024A9AF945F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8b4d849a-701e-0092-060d-e2b4fb000000'
    'x-ms-client-request-id': 'c3d4f6ef-4e00-11f0-8c40-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:46 GMT'
2025-06-20 23:32:46,014 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs.json
2025-06-20 23:32:46,015 - src.core.analysis - INFO - Uploading D:\Production\backend\data\audit_logs_full_sample.csv to blob as audit_logs_full_sample.csv
2025-06-20 23:32:46,016 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:46,032 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c4fc449f-4e00-11f0-8ee8-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:46,924 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:47 GMT'
    'ETag': '"0x8DDB024AA3B0ADD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7f345558-401e-000f-4f0d-e24641000000'
    'x-ms-client-request-id': 'c4fc449f-4e00-11f0-8ee8-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:47 GMT'
2025-06-20 23:32:46,926 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\audit_logs_full_sample.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/audit_logs_full_sample.csv
2025-06-20 23:32:46,927 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.csv to blob as business_units.csv
2025-06-20 23:32:46,927 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:46,929 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c5852b56-4e00-11f0-a5b5-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:47,231 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:48 GMT'
    'ETag': '"0x8DDB024AA69AE8C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e269e3e4-e01e-0074-800d-e204dd000000'
    'x-ms-client-request-id': 'c5852b56-4e00-11f0-a5b5-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:47 GMT'
2025-06-20 23:32:47,232 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.csv
2025-06-20 23:32:47,233 - src.core.analysis - INFO - Uploading D:\Production\backend\data\business_units.json to blob as business_units.json
2025-06-20 23:32:47,233 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:47,244 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c5b54169-4e00-11f0-ad5a-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:47,599 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:48 GMT'
    'ETag': '"0x8DDB024AA9E1831"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '827b3405-b01e-0034-570d-e203e5000000'
    'x-ms-client-request-id': 'c5b54169-4e00-11f0-ad5a-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:47 GMT'
2025-06-20 23:32:47,600 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\business_units.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/business_units.json
2025-06-20 23:32:47,601 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.csv to blob as conditional_access_policies.csv
2025-06-20 23:32:47,601 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:47,603 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c5ebfd16-4e00-11f0-8eed-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:48,028 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:48 GMT'
    'ETag': '"0x8DDB024AAE337D8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e770b5f7-301e-003a-380d-e22a55000000'
    'x-ms-client-request-id': 'c5ebfd16-4e00-11f0-8eed-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:48 GMT'
2025-06-20 23:32:48,029 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.csv
2025-06-20 23:32:48,030 - src.core.analysis - INFO - Uploading D:\Production\backend\data\conditional_access_policies.json to blob as conditional_access_policies.json
2025-06-20 23:32:48,030 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:48,046 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c62fb235-4e00-11f0-b1fb-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:48,485 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:49 GMT'
    'ETag': '"0x8DDB024AB28CC33"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e925dd1c-101e-002d-790d-e2835e000000'
    'x-ms-client-request-id': 'c62fb235-4e00-11f0-b1fb-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:48 GMT'
2025-06-20 23:32:48,486 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\conditional_access_policies.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/conditional_access_policies.json
2025-06-20 23:32:48,486 - src.core.analysis - INFO - Uploading D:\Production\backend\data\d365_roles.csv to blob as d365_roles.csv
2025-06-20 23:32:48,487 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:48,498 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c674b259-4e00-11f0-ad71-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:49,004 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:49 GMT'
    'ETag': '"0x8DDB024AB784080"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6b2aac7a-e01e-0029-310d-e20e59000000'
    'x-ms-client-request-id': 'c674b259-4e00-11f0-ad71-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:49 GMT'
2025-06-20 23:32:49,005 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\d365_roles.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/d365_roles.csv
2025-06-20 23:32:49,006 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_heuristic_output.csv to blob as role_usage_heuristic_output.csv
2025-06-20 23:32:49,007 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:49,019 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c6c41ae3-4e00-11f0-a840-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:49,463 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:50 GMT'
    'ETag': '"0x8DDB024ABBE4988"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fa0719bb-a01e-0007-740d-e25c4e000000'
    'x-ms-client-request-id': 'c6c41ae3-4e00-11f0-a840-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:50 GMT'
2025-06-20 23:32:49,464 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_heuristic_output.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_heuristic_output.csv
2025-06-20 23:32:49,465 - src.core.analysis - INFO - Uploading D:\Production\backend\data\role_usage_per_user_summary.csv to blob as role_usage_per_user_summary.csv
2025-06-20 23:32:49,466 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:49,477 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '58073'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c709f82c-4e00-11f0-a70a-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:49,877 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:50 GMT'
    'ETag': '"0x8DDB024ABFD5589"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6d3d0591-d01e-007f-1e0d-e2ffb6000000'
    'x-ms-client-request-id': 'c709f82c-4e00-11f0-a70a-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:50 GMT'
2025-06-20 23:32:49,878 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\role_usage_per_user_summary.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/role_usage_per_user_summary.csv
2025-06-20 23:32:49,879 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.csv to blob as signin_logs.csv
2025-06-20 23:32:49,880 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:49,881 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1385556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c747ba5b-4e00-11f0-a994-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:50,805 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:51 GMT'
    'ETag': '"0x8DDB024AC8A9EB9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a4fb3fbf-a01e-004a-650d-e293a2000000'
    'x-ms-client-request-id': 'c747ba5b-4e00-11f0-a994-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:51 GMT'
2025-06-20 23:32:50,806 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.csv
2025-06-20 23:32:50,807 - src.core.analysis - INFO - Uploading D:\Production\backend\data\signin_logs.json to blob as signin_logs.json
2025-06-20 23:32:50,808 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:50,823 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c7d75e4d-4e00-11f0-9a64-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:52,674 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:53 GMT'
    'ETag': '"0x8DDB024ADA81405"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7d93ffa2-501e-0013-610d-e21421000000'
    'x-ms-client-request-id': 'c7d75e4d-4e00-11f0-9a64-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:53 GMT'
2025-06-20 23:32:52,675 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\signin_logs.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/signin_logs.json
2025-06-20 23:32:52,676 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.csv to blob as users_without_d365_license.csv
2025-06-20 23:32:52,677 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:52,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c8f273a3-4e00-11f0-808a-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:53,130 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:53 GMT'
    'ETag': '"0x8DDB024ADEB1337"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0ec9329b-d01e-00a4-7d0d-e2398b000000'
    'x-ms-client-request-id': 'c8f273a3-4e00-11f0-808a-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:53 GMT'
2025-06-20 23:32:53,131 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.csv
2025-06-20 23:32:53,132 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_d365_license.json to blob as users_without_d365_license.json
2025-06-20 23:32:53,133 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:53,149 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c93a5d98-4e00-11f0-8cfd-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:53,594 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:54 GMT'
    'ETag': '"0x8DDB024AE349AC0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3c297516-a01e-00ae-1a0d-e29d3c000000'
    'x-ms-client-request-id': 'c93a5d98-4e00-11f0-8cfd-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:54 GMT'
2025-06-20 23:32:53,594 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_d365_license.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_d365_license.json
2025-06-20 23:32:53,595 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.csv to blob as users_without_entra_id.csv
2025-06-20 23:32:53,596 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:53,597 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c97eaab2-4e00-11f0-9a08-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:54,029 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:54 GMT'
    'ETag': '"0x8DDB024AE76FE62"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '14368aa8-f01e-00b3-2c0d-e29080000000'
    'x-ms-client-request-id': 'c97eaab2-4e00-11f0-9a08-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:54 GMT'
2025-06-20 23:32:54,030 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.csv
2025-06-20 23:32:54,030 - src.core.analysis - INFO - Uploading D:\Production\backend\data\users_without_entra_id.json to blob as users_without_entra_id.json
2025-06-20 23:32:54,031 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:54,042 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c9c29d1e-4e00-11f0-a8ba-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:54,559 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:55 GMT'
    'ETag': '"0x8DDB024AEC782EC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '28fcfc9e-301e-0093-6d0d-e2eb27000000'
    'x-ms-client-request-id': 'c9c29d1e-4e00-11f0-a8ba-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:55 GMT'
2025-06-20 23:32:54,560 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\users_without_entra_id.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/users_without_entra_id.json
2025-06-20 23:32:54,561 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.csv to blob as user_details.csv
2025-06-20 23:32:54,561 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:54,563 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ca120943-4e00-11f0-9c4b-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:55,045 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:55 GMT'
    'ETag': '"0x8DDB024AF11F3CC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a6292c0f-501e-0095-4a0d-e2d898000000'
    'x-ms-client-request-id': 'ca120943-4e00-11f0-9c4b-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:55 GMT'
2025-06-20 23:32:55,046 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.csv to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.csv
2025-06-20 23:32:55,047 - src.core.analysis - INFO - Uploading D:\Production\backend\data\user_details.json to blob as user_details.json
2025-06-20 23:32:55,048 - src.utils.azure_blob - INFO - Constructed blob URL: https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D
2025-06-20 23:32:55,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ca5dcfb3-4e00-11f0-9417-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:32:55,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:02:56 GMT'
    'ETag': '"0x8DDB024AF70249D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3c6ca0a0-301e-0077-460d-e2e5b9000000'
    'x-ms-client-request-id': 'ca5dcfb3-4e00-11f0-9417-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:02:55 GMT'
2025-06-20 23:32:55,679 - src.utils.azure_blob - INFO - Uploaded D:\Production\backend\data\user_details.json to https://d365accessreview.blob.core.windows.net/accessreview?sp=racwdli&st=2025-06-10T13:17:26Z&se=2025-12-30T21:17:26Z&sv=2024-11-04&sr=c&sig=L6pX027xEBNp7Ne3Bhl%2FNiqIeqMBoCaxn59Jr6puODE%3D/user_details.json
2025-06-20 23:33:13,053 - httpx - INFO - HTTP Request: POST https://bankdemo.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-06-20 23:33:13,058 - src.core.analysis - ERROR - Error running LLM SoD analysis: 'AIMessage' object is not subscriptable
2025-06-20 23:33:13,075 - main - INFO - [analyze] Analysis completed.
2025-06-20 23:33:13,126 - main - INFO - [analyze] Analysis results saved to D:\Production\backend\data\analyze.json
2025-06-20 23:33:13,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/analyze.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '227752'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd5268ead-4e00-11f0-9d50-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:13,755 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:14 GMT'
    'ETag': '"0x8DDB024BA38142F"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f647d-f01e-0078-100d-e293d5000000'
    'x-ms-client-request-id': 'd5268ead-4e00-11f0-9d50-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:14 GMT'
2025-06-20 23:33:13,757 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '138071'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd582d8cf-4e00-11f0-8636-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:13,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:14 GMT'
    'ETag': '"0x8DDB024BA44B02E"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f648b-f01e-0078-1b0d-e293d5000000'
    'x-ms-client-request-id': 'd582d8cf-4e00-11f0-8636-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:14 GMT'
2025-06-20 23:33:13,836 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_roles.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '269821'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd58ed6e0-4e00-11f0-bb75-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:13,917 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:14 GMT'
    'ETag': '"0x8DDB024BA5199F6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f648f-f01e-0078-1f0d-e293d5000000'
    'x-ms-client-request-id': 'd58ed6e0-4e00-11f0-bb75-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:14 GMT'
2025-06-20 23:33:13,920 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '121433'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd59ba51e-4e00-11f0-a48c-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:13,994 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:14 GMT'
    'ETag': '"0x8DDB024BA5D4C9D"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6490-f01e-0078-200d-e293d5000000'
    'x-ms-client-request-id': 'd59ba51e-4e00-11f0-a48c-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:14 GMT'
2025-06-20 23:33:13,997 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/app_role_assignments.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '218751'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd5a76fc0-4e00-11f0-82e3-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:14,074 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:14 GMT'
    'ETag': '"0x8DDB024BA6973F0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6492-f01e-0078-220d-e293d5000000'
    'x-ms-client-request-id': 'd5a76fc0-4e00-11f0-82e3-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:14 GMT'
2025-06-20 23:33:14,077 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '2003228'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd5b39b9e-4e00-11f0-b20f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:14,593 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:15 GMT'
    'ETag': '"0x8DDB024BAB89A77"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6494-f01e-0078-240d-e293d5000000'
    'x-ms-client-request-id': 'd5b39b9e-4e00-11f0-b20f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:15 GMT'
2025-06-20 23:33:14,599 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5954447'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd6034555-4e00-11f0-9428-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:16,050 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:16 GMT'
    'ETag': '"0x8DDB024BB9703C2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f64c7-f01e-0078-3d0d-e293d5000000'
    'x-ms-client-request-id': 'd6034555-4e00-11f0-9428-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:16 GMT'
2025-06-20 23:33:16,054 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/audit_logs_full_sample.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1826881'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd6e14dc3-4e00-11f0-acf2-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:16,602 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BBEB2DB2"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f64e5-f01e-0078-580d-e293d5000000'
    'x-ms-client-request-id': 'd6e14dc3-4e00-11f0-acf2-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:16,604 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '621'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd7352f9c-4e00-11f0-aaa3-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:16,676 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BBF6B97C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f64f7-f01e-0078-660d-e293d5000000'
    'x-ms-client-request-id': 'd7352f9c-4e00-11f0-aaa3-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:16,679 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/business_units.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1739'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd740bda2-4e00-11f0-97f7-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:16,754 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BC029302"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f64fa-f01e-0078-690d-e293d5000000'
    'x-ms-client-request-id': 'd740bda2-4e00-11f0-97f7-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:16,756 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '61951'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd74c664a-4e00-11f0-accf-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:16,829 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BC0DF7E4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f64fd-f01e-0078-6c0d-e293d5000000'
    'x-ms-client-request-id': 'd74c664a-4e00-11f0-accf-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:16,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/conditional_access_policies.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '67231'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd7582375-4e00-11f0-88ca-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:16,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BC19D16B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f64ff-f01e-0078-6e0d-e293d5000000'
    'x-ms-client-request-id': 'd7582375-4e00-11f0-88ca-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:16,910 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/d365_roles.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '137598'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd763e46f-4e00-11f0-9226-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:16,986 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BC25F8C0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6501-f01e-0078-700d-e293d5000000'
    'x-ms-client-request-id': 'd763e46f-4e00-11f0-9226-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:16,989 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_heuristic_output.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '101010'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd7700531-4e00-11f0-98b6-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:17,063 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BC31AB66"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6505-f01e-0078-740d-e293d5000000'
    'x-ms-client-request-id': 'd7700531-4e00-11f0-98b6-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:17,065 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/role_usage_per_user_summary.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '58073'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd77ba45c-4e00-11f0-9d2f-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:17,139 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:17 GMT'
    'ETag': '"0x8DDB024BC3D372B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6508-f01e-0078-770d-e293d5000000'
    'x-ms-client-request-id': 'd77ba45c-4e00-11f0-9d2f-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:17 GMT'
2025-06-20 23:33:17,141 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '1385556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd787450e-4e00-11f0-846e-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:17,555 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:18 GMT'
    'ETag': '"0x8DDB024BC7C90F3"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6509-f01e-0078-780d-e293d5000000'
    'x-ms-client-request-id': 'd787450e-4e00-11f0-846e-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:18 GMT'
2025-06-20 23:33:17,559 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/signin_logs.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '5571343'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd7c6ffd2-4e00-11f0-b687-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:18,980 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:19 GMT'
    'ETag': '"0x8DDB024BD561DB9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6524-f01e-0078-110d-e293d5000000'
    'x-ms-client-request-id': 'd7c6ffd2-4e00-11f0-b687-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:19 GMT'
2025-06-20 23:33:18,982 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '40601'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8a02af4-4e00-11f0-8e8d-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:19,056 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:19 GMT'
    'ETag': '"0x8DDB024BD61D056"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f656e-f01e-0078-560d-e293d5000000'
    'x-ms-client-request-id': 'd8a02af4-4e00-11f0-8e8d-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:19 GMT'
2025-06-20 23:33:19,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_d365_license.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '88911'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8abda87-4e00-11f0-8a69-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:19,134 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:19 GMT'
    'ETag': '"0x8DDB024BD6D8305"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6570-f01e-0078-580d-e293d5000000'
    'x-ms-client-request-id': 'd8abda87-4e00-11f0-8a69-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:19 GMT'
2025-06-20 23:33:19,136 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '50556'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8b7976c-4e00-11f0-b712-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:19,210 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:20 GMT'
    'ETag': '"0x8DDB024BD7935A6"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6573-f01e-0078-5b0d-e293d5000000'
    'x-ms-client-request-id': 'd8b7976c-4e00-11f0-b712-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:19 GMT'
2025-06-20 23:33:19,212 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/users_without_entra_id.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '114905'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8c342bb-4e00-11f0-bf13-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:19,288 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:20 GMT'
    'ETag': '"0x8DDB024BD84E856"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6579-f01e-0078-600d-e293d5000000'
    'x-ms-client-request-id': 'd8c342bb-4e00-11f0-bf13-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:20 GMT'
2025-06-20 23:33:19,289 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.csv?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '107794'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8cf06d9-4e00-11f0-8425-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:19,363 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:20 GMT'
    'ETag': '"0x8DDB024BD90C1DE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f657f-f01e-0078-660d-e293d5000000'
    'x-ms-client-request-id': 'd8cf06d9-4e00-11f0-8425-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:20 GMT'
2025-06-20 23:33:19,367 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://d365accessreview.blob.core.windows.net/accessreview/accessreview/data/user_details.json?sp=REDACTED&st=REDACTED&se=REDACTED&sv=REDACTED&sr=REDACTED&sig=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Length': '140517'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.25.1 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8dae0f7-4e00-11f0-90e4-c5823ebe3fa0'
A body is sent with the request
2025-06-20 23:33:19,442 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Fri, 20 Jun 2025 18:03:20 GMT'
    'ETag': '"0x8DDB024BD9CC25B"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c54f6584-f01e-0078-690d-e293d5000000'
    'x-ms-client-request-id': 'd8dae0f7-4e00-11f0-90e4-c5823ebe3fa0'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 18:03:20 GMT'
2025-06-21 00:23:25,320 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 00:23:25,354 - main - INFO - FastAPI application shutdown
2025-06-21 00:23:54,676 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 00:24:12,537 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 00:24:12,538 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 00:24:12,539 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 00:24:12,540 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 00:24:12,541 - main - INFO - FastAPI application started
2025-06-21 00:44:35,502 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 00:44:35,504 - main - INFO - FastAPI application shutdown
2025-06-21 00:45:37,535 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 00:45:50,686 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 00:45:50,686 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 00:45:50,688 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 00:45:50,690 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 00:45:50,690 - main - INFO - FastAPI application started
2025-06-21 00:50:21,942 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 00:50:21,943 - main - INFO - FastAPI application shutdown
2025-06-21 00:51:36,334 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 00:51:49,368 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 00:51:49,368 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 00:51:49,368 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 00:51:49,369 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 00:51:49,370 - main - INFO - FastAPI application started
2025-06-21 00:56:38,123 - d365 - INFO - Loading D365 data
2025-06-21 00:56:38,125 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 00:56:38,464 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '538e44f9-df5d-4f66-9f61-2c4c3cd81900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:26:38 GMT'
    'Content-Length': '1753'
2025-06-21 00:56:38,476 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 00:56:38,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a8bdd2b4-fc9f-4e4d-8688-938c66981a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:26:38 GMT'
    'Content-Length': '1651'
2025-06-21 00:56:38,693 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 00:56:38,694 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 00:56:38,694 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-22T19:26:38Z)
2025-06-21 00:56:43,304 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-21 00:56:46,357 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-21 00:56:49,765 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-21 00:56:53,094 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-21 00:56:56,061 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-21 00:56:58,802 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-21 00:57:00,500 - d365 - INFO - Progress: Fetched 32321 audit logs after 7 pages
2025-06-21 00:57:00,526 - d365 - INFO - Fetched 32321 D365 audit logs via Dataverse
2025-06-21 00:57:00,586 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-21 00:57:00,589 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 00:57:00,918 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a8fc589a-5773-4e6d-a182-a1afae241900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:01 GMT'
    'Content-Length': '1753'
2025-06-21 00:57:00,919 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 00:57:01,149 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0523adf6-ab20-451f-afcc-72b543072100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:01 GMT'
    'Content-Length': '1992'
2025-06-21 00:57:01,150 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 00:57:01,153 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 00:57:01,155 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-22T19:27:01Z)
2025-06-21 00:57:01,155 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-21 00:57:09,585 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 7.1 req/min | Time: 0:00:08
2025-06-21 00:57:18,635 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 6.9 req/min | Time: 0:00:17
2025-06-21 00:57:26,953 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 7.0 req/min | Time: 0:00:25
2025-06-21 00:57:36,491 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 6.8 req/min | Time: 0:00:35
2025-06-21 00:57:44,668 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 6.9 req/min | Time: 0:00:43
2025-06-21 00:57:48,731 - d365 - INFO - Progress: 5,448 records | Pages: 6 | Requests: 6 | Rate: 7.6 req/min | Time: 0:00:47
2025-06-21 00:57:49,233 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-21T21:28:21Z to 2025-06-20T19:23:58Z
2025-06-21 00:57:49,349 - d365 - INFO - Fetch completed: 5,448 records in 0:00:48
2025-06-21 00:57:49,350 - d365 - INFO - Total requests made: 6
2025-06-21 00:57:49,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 00:57:49,667 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '324d5483-5680-401b-851e-02319bc92200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:50 GMT'
    'Content-Length': '1753'
2025-06-21 00:57:49,669 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 00:57:49,874 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2cfd08b1-4728-453e-9929-3a31c6b41600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:50 GMT'
    'Content-Length': '1648'
2025-06-21 00:57:49,875 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 00:57:49,876 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 00:57:49,877 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 00:57:50,129 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5773b71e-5f69-4422-a8d3-e92d5fce1900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:50 GMT'
    'Content-Length': '1753'
2025-06-21 00:57:50,131 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 00:57:50,417 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8929d47e-1179-4a49-b086-a66cc3f71b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:51 GMT'
    'Content-Length': '1996'
2025-06-21 00:57:50,418 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 00:57:50,419 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 00:57:50,420 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 00:57:50,683 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0bd59e49-87ca-42ee-8cfe-4d07d8cf1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:51 GMT'
    'Content-Length': '1753'
2025-06-21 00:57:50,685 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 00:57:50,909 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0bd59e49-87ca-42ee-8cfe-4d07dbcf1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 20 Jun 2025 19:27:51 GMT'
    'Content-Length': '1996'
2025-06-21 00:57:50,910 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 00:57:50,911 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 00:57:52,994 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-21 00:57:52,994 - d365 - INFO - Found 981 users in Entra ID
2025-06-21 00:57:54,963 - d365 - INFO - Fetched 936 user records from D365
2025-06-21 03:34:00,121 - d365 - ERROR - Failed to check D365 license for user 4f052881-ff22-4a63-8cfa-cc0376e3f609: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4f052881-ff22-4a63-8cfa-cc0376e3f609/licenseDetails
2025-06-21 03:34:00,359 - d365 - ERROR - Failed to check D365 license for user ae1aeebf-7371-48e3-9c48-f91da1474575: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ae1aeebf-7371-48e3-9c48-f91da1474575/licenseDetails
2025-06-21 03:34:00,612 - d365 - ERROR - Failed to check D365 license for user 68bca0fd-8e10-4aed-872f-8ccbd0c7781b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/68bca0fd-8e10-4aed-872f-8ccbd0c7781b/licenseDetails
2025-06-21 03:34:00,861 - d365 - ERROR - Failed to check D365 license for user d430f7a4-688c-4422-ab7c-006454c98388: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d430f7a4-688c-4422-ab7c-006454c98388/licenseDetails
2025-06-21 03:34:01,038 - d365 - ERROR - Failed to check D365 license for user c3607dbd-25a6-49cb-8d2c-4355753ce943: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c3607dbd-25a6-49cb-8d2c-4355753ce943/licenseDetails
2025-06-21 03:34:01,301 - d365 - ERROR - Failed to check D365 license for user 69589b10-0fb2-4c52-b145-a8b43e76a14d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/69589b10-0fb2-4c52-b145-a8b43e76a14d/licenseDetails
2025-06-21 03:34:01,548 - d365 - ERROR - Failed to check D365 license for user 8c6b6783-4bd4-4f25-8e56-6664a242d765: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8c6b6783-4bd4-4f25-8e56-6664a242d765/licenseDetails
2025-06-21 03:34:01,770 - d365 - ERROR - Failed to check D365 license for user 2b153137-706e-4b10-89a9-ae022f3573ae: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2b153137-706e-4b10-89a9-ae022f3573ae/licenseDetails
2025-06-21 03:34:02,000 - d365 - ERROR - Failed to check D365 license for user f930eecf-94a2-492d-a317-ab8c86b0e56c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f930eecf-94a2-492d-a317-ab8c86b0e56c/licenseDetails
2025-06-21 03:34:02,201 - d365 - ERROR - Failed to check D365 license for user e47c13ca-4bb9-4854-81e3-56f742ef322f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e47c13ca-4bb9-4854-81e3-56f742ef322f/licenseDetails
2025-06-21 03:34:02,429 - d365 - ERROR - Failed to check D365 license for user 80e33102-c75b-4785-9c26-fb7b8983f94b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/80e33102-c75b-4785-9c26-fb7b8983f94b/licenseDetails
2025-06-21 03:34:02,717 - d365 - ERROR - Failed to check D365 license for user 183830e5-7716-4f65-820e-79f9be388c9f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/183830e5-7716-4f65-820e-79f9be388c9f/licenseDetails
2025-06-21 03:34:03,169 - d365 - ERROR - Failed to check D365 license for user 9b0b32a4-d4b3-40e0-b421-92a116ccd016: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9b0b32a4-d4b3-40e0-b421-92a116ccd016/licenseDetails
2025-06-21 03:34:03,340 - d365 - ERROR - Failed to check D365 license for user fc9cbf79-2c0b-4e24-97cd-2e8a801f8244: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/fc9cbf79-2c0b-4e24-97cd-2e8a801f8244/licenseDetails
2025-06-21 03:34:03,611 - d365 - ERROR - Failed to check D365 license for user ad6f7cda-8219-46e8-800f-51cb38a651b7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ad6f7cda-8219-46e8-800f-51cb38a651b7/licenseDetails
2025-06-21 03:34:03,793 - d365 - ERROR - Failed to check D365 license for user cbe56aa6-44ea-4692-bae6-98a24819ef79: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cbe56aa6-44ea-4692-bae6-98a24819ef79/licenseDetails
2025-06-21 03:34:03,996 - d365 - ERROR - Failed to check D365 license for user 561114f3-72a6-4953-94dc-eabec08dfe10: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/561114f3-72a6-4953-94dc-eabec08dfe10/licenseDetails
2025-06-21 03:34:04,200 - d365 - ERROR - Failed to check D365 license for user 1f8597b5-95c1-4f4c-88f7-13a40596941f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1f8597b5-95c1-4f4c-88f7-13a40596941f/licenseDetails
2025-06-21 03:34:04,401 - d365 - ERROR - Failed to check D365 license for user 61f8a4aa-5fab-46c9-964e-fcce3914ced1: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/61f8a4aa-5fab-46c9-964e-fcce3914ced1/licenseDetails
2025-06-21 03:34:04,621 - d365 - ERROR - Failed to check D365 license for user b721304b-6846-4396-9bbe-32be36d4fa8e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b721304b-6846-4396-9bbe-32be36d4fa8e/licenseDetails
2025-06-21 03:34:04,802 - d365 - ERROR - Failed to check D365 license for user c971fd75-9802-4e1b-96cc-8f463d237a74: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c971fd75-9802-4e1b-96cc-8f463d237a74/licenseDetails
2025-06-21 03:34:05,013 - d365 - ERROR - Failed to check D365 license for user e5efa8b5-845f-4859-b036-5e2899d86aee: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e5efa8b5-845f-4859-b036-5e2899d86aee/licenseDetails
2025-06-21 03:34:05,257 - d365 - ERROR - Failed to check D365 license for user 30b71096-97c9-49ba-9e66-ca5998fbb7ae: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/30b71096-97c9-49ba-9e66-ca5998fbb7ae/licenseDetails
2025-06-21 03:34:05,482 - d365 - ERROR - Failed to check D365 license for user 1a34694a-a428-4ae1-8974-2484669cf263: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1a34694a-a428-4ae1-8974-2484669cf263/licenseDetails
2025-06-21 03:34:05,750 - d365 - ERROR - Failed to check D365 license for user 0c2b6849-d777-45b9-93d7-6db75b0b3d08: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0c2b6849-d777-45b9-93d7-6db75b0b3d08/licenseDetails
2025-06-21 03:34:05,992 - d365 - ERROR - Failed to check D365 license for user 1600a78c-b2d2-41a2-8f98-515cdffa8396: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1600a78c-b2d2-41a2-8f98-515cdffa8396/licenseDetails
2025-06-21 03:34:06,202 - d365 - ERROR - Failed to check D365 license for user 1f2b9261-b13b-4cee-be32-8721d0a0a8ac: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1f2b9261-b13b-4cee-be32-8721d0a0a8ac/licenseDetails
2025-06-21 03:34:06,503 - d365 - ERROR - Failed to check D365 license for user 57c3fb5c-b597-44f9-8aff-fa903bd8edd4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/57c3fb5c-b597-44f9-8aff-fa903bd8edd4/licenseDetails
2025-06-21 03:34:06,777 - d365 - ERROR - Failed to check D365 license for user f342a152-c8aa-461e-8564-68d07d4c2604: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f342a152-c8aa-461e-8564-68d07d4c2604/licenseDetails
2025-06-21 03:34:07,051 - d365 - ERROR - Failed to check D365 license for user eb6ce3a0-9e45-4896-9bf6-c1f4852ef05f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/eb6ce3a0-9e45-4896-9bf6-c1f4852ef05f/licenseDetails
2025-06-21 03:34:07,325 - d365 - ERROR - Failed to check D365 license for user 0418de2e-abb3-4804-9594-970b3da85fff: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0418de2e-abb3-4804-9594-970b3da85fff/licenseDetails
2025-06-21 03:34:07,619 - d365 - ERROR - Failed to check D365 license for user f32d9a44-89bb-45ca-b131-f8234d14ac2a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f32d9a44-89bb-45ca-b131-f8234d14ac2a/licenseDetails
2025-06-21 03:34:07,874 - d365 - ERROR - Failed to check D365 license for user 63e6b948-af0b-4e1c-9bd2-3f99079578e3: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/63e6b948-af0b-4e1c-9bd2-3f99079578e3/licenseDetails
2025-06-21 03:34:08,148 - d365 - ERROR - Failed to check D365 license for user 979f6abe-f014-4132-91c6-0817fb665928: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/979f6abe-f014-4132-91c6-0817fb665928/licenseDetails
2025-06-21 03:34:08,347 - d365 - ERROR - Failed to check D365 license for user 462e6c8c-362b-4f1e-b864-d218e7450a77: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/462e6c8c-362b-4f1e-b864-d218e7450a77/licenseDetails
2025-06-21 03:34:08,621 - d365 - ERROR - Failed to check D365 license for user c0a685a7-527f-4b63-9b42-c72f59ff9f8a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c0a685a7-527f-4b63-9b42-c72f59ff9f8a/licenseDetails
2025-06-21 03:34:08,895 - d365 - ERROR - Failed to check D365 license for user 9218a247-b6c8-4f15-8326-de95592dd612: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9218a247-b6c8-4f15-8326-de95592dd612/licenseDetails
2025-06-21 03:34:09,171 - d365 - ERROR - Failed to check D365 license for user 75382e8a-4866-4499-8509-107979a28a71: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/75382e8a-4866-4499-8509-107979a28a71/licenseDetails
2025-06-21 09:51:49,366 - d365 - ERROR - Failed to check D365 license for user bddf5689-fd64-449f-a91f-8549e8309e07: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/bddf5689-fd64-449f-a91f-8549e8309e07/licenseDetails
2025-06-21 09:51:49,621 - d365 - ERROR - Failed to check D365 license for user b68e71f5-8519-447c-8a4f-a79bb2a94b47: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b68e71f5-8519-447c-8a4f-a79bb2a94b47/licenseDetails
2025-06-21 09:51:49,902 - d365 - ERROR - Failed to check D365 license for user 9dcbea24-df7f-42cc-b832-4eee60f20d40: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9dcbea24-df7f-42cc-b832-4eee60f20d40/licenseDetails
2025-06-21 09:51:50,094 - d365 - ERROR - Failed to check D365 license for user bb0f04d2-d842-40e8-8f6c-54277766d0a4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/bb0f04d2-d842-40e8-8f6c-54277766d0a4/licenseDetails
2025-06-21 09:51:50,257 - d365 - ERROR - Failed to check D365 license for user d92739d6-194d-4eb2-90b1-5c6e3ed4f053: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d92739d6-194d-4eb2-90b1-5c6e3ed4f053/licenseDetails
2025-06-21 09:51:50,550 - d365 - ERROR - Failed to check D365 license for user 33c7877a-db7e-4c18-adaf-89906e2f3afd: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/33c7877a-db7e-4c18-adaf-89906e2f3afd/licenseDetails
2025-06-21 09:51:50,768 - d365 - ERROR - Failed to check D365 license for user 445becac-86b8-4971-8fd7-9a77bafbafd7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/445becac-86b8-4971-8fd7-9a77bafbafd7/licenseDetails
2025-06-21 09:51:50,988 - d365 - ERROR - Failed to check D365 license for user f1aae284-5ea2-4c07-b58f-dc5fb5d03e27: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f1aae284-5ea2-4c07-b58f-dc5fb5d03e27/licenseDetails
2025-06-21 09:51:51,267 - d365 - ERROR - Failed to check D365 license for user 54d0ec47-1891-498f-a621-042e7a222bff: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/54d0ec47-1891-498f-a621-042e7a222bff/licenseDetails
2025-06-21 09:51:51,488 - d365 - ERROR - Failed to check D365 license for user 73dd5425-92a6-43c5-9483-47a424e8505b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/73dd5425-92a6-43c5-9483-47a424e8505b/licenseDetails
2025-06-21 09:51:51,938 - d365 - ERROR - Failed to check D365 license for user 7b85c397-1fec-4e18-ac45-f5dbf5dd7d7f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/7b85c397-1fec-4e18-ac45-f5dbf5dd7d7f/licenseDetails
2025-06-21 09:51:52,192 - d365 - ERROR - Failed to check D365 license for user bc88c07a-12c0-4976-b6ea-dfed9f074506: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/bc88c07a-12c0-4976-b6ea-dfed9f074506/licenseDetails
2025-06-21 09:51:52,378 - d365 - ERROR - Failed to check D365 license for user e5617b09-418d-4780-a43e-bd8b71a7e994: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e5617b09-418d-4780-a43e-bd8b71a7e994/licenseDetails
2025-06-21 09:51:52,556 - d365 - ERROR - Failed to check D365 license for user 9281383f-78d9-4258-91bf-d4db88d21e7a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9281383f-78d9-4258-91bf-d4db88d21e7a/licenseDetails
2025-06-21 09:51:52,823 - d365 - ERROR - Failed to check D365 license for user 046fa3ca-a6fc-497e-b819-a4cfd0afac68: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/046fa3ca-a6fc-497e-b819-a4cfd0afac68/licenseDetails
2025-06-21 09:51:52,985 - d365 - ERROR - Failed to check D365 license for user 47d4e4fe-7cce-469e-b5ce-5cf923b83d8e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/47d4e4fe-7cce-469e-b5ce-5cf923b83d8e/licenseDetails
2025-06-21 09:51:53,235 - d365 - ERROR - Failed to check D365 license for user f956b637-d19e-48a5-bde4-01ab0f111c5b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f956b637-d19e-48a5-bde4-01ab0f111c5b/licenseDetails
2025-06-21 09:51:53,509 - d365 - ERROR - Failed to check D365 license for user 2f4f9c97-520d-456c-9bb7-512d3d4c325f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2f4f9c97-520d-456c-9bb7-512d3d4c325f/licenseDetails
2025-06-21 09:51:53,785 - d365 - ERROR - Failed to check D365 license for user 29da6c48-ee7f-456f-825b-f20db0db79fd: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/29da6c48-ee7f-456f-825b-f20db0db79fd/licenseDetails
2025-06-21 09:51:53,948 - d365 - ERROR - Failed to check D365 license for user c1dac210-cb2b-4a68-8b6d-a78d0eab8001: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c1dac210-cb2b-4a68-8b6d-a78d0eab8001/licenseDetails
2025-06-21 09:51:54,195 - d365 - ERROR - Failed to check D365 license for user fc6fd2a8-593f-48a1-b2df-81d689137150: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/fc6fd2a8-593f-48a1-b2df-81d689137150/licenseDetails
2025-06-21 09:51:54,368 - d365 - ERROR - Failed to check D365 license for user 9e2352c8-dcb0-41ee-9205-ae8fb1722bd9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9e2352c8-dcb0-41ee-9205-ae8fb1722bd9/licenseDetails
2025-06-21 09:51:54,532 - d365 - ERROR - Failed to check D365 license for user 44094c13-c3d9-44f0-b913-283675c6f1e7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/44094c13-c3d9-44f0-b913-283675c6f1e7/licenseDetails
2025-06-21 09:51:54,702 - d365 - ERROR - Failed to check D365 license for user 52614237-42ce-44ca-a731-4567d6dcace2: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/52614237-42ce-44ca-a731-4567d6dcace2/licenseDetails
2025-06-21 09:51:54,818 - d365 - ERROR - Failed to check D365 license for user a948dd32-f18f-416d-bcc6-b16f38c6193e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a948dd32-f18f-416d-bcc6-b16f38c6193e/licenseDetails
2025-06-21 09:51:54,970 - d365 - ERROR - Failed to check D365 license for user 5578308b-7d09-4307-839a-a47a7df4a40b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5578308b-7d09-4307-839a-a47a7df4a40b/licenseDetails
2025-06-21 09:51:55,094 - d365 - ERROR - Failed to check D365 license for user 005a3324-6c26-484a-be06-07d829df9a76: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/005a3324-6c26-484a-be06-07d829df9a76/licenseDetails
2025-06-21 09:51:55,264 - d365 - ERROR - Failed to check D365 license for user 04bba67e-a0fc-4a92-917d-baef3128da09: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/04bba67e-a0fc-4a92-917d-baef3128da09/licenseDetails
2025-06-21 09:51:55,379 - d365 - ERROR - Failed to check D365 license for user c1b9bb70-296e-48c1-bdfd-b9d34a643871: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c1b9bb70-296e-48c1-bdfd-b9d34a643871/licenseDetails
2025-06-21 09:51:55,522 - d365 - ERROR - Failed to check D365 license for user a30e2a49-4247-4100-bbf8-a0fe0be1d09d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a30e2a49-4247-4100-bbf8-a0fe0be1d09d/licenseDetails
2025-06-21 09:51:55,661 - d365 - ERROR - Failed to check D365 license for user 076f450d-f61e-4a4e-86cb-23cf0abe16ec: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/076f450d-f61e-4a4e-86cb-23cf0abe16ec/licenseDetails
2025-06-21 09:51:55,754 - d365 - ERROR - Failed to check D365 license for user 074bd9bb-ef4f-4ba4-83cd-e5a00f9a9204: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/074bd9bb-ef4f-4ba4-83cd-e5a00f9a9204/licenseDetails
2025-06-21 09:51:55,863 - d365 - ERROR - Failed to check D365 license for user f38c3df6-05cb-4991-a48a-32864dd49691: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f38c3df6-05cb-4991-a48a-32864dd49691/licenseDetails
2025-06-21 09:51:56,000 - d365 - ERROR - Failed to check D365 license for user 04e8b85d-445d-4184-9829-2a33b5a5dec5: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/04e8b85d-445d-4184-9829-2a33b5a5dec5/licenseDetails
2025-06-21 09:51:56,103 - d365 - ERROR - Failed to check D365 license for user 17aa2fa5-1798-416e-a748-aab16991e159: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/17aa2fa5-1798-416e-a748-aab16991e159/licenseDetails
2025-06-21 09:51:56,225 - d365 - ERROR - Failed to check D365 license for user 29deb7c2-5be1-42a7-9145-afc74746d8ea: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/29deb7c2-5be1-42a7-9145-afc74746d8ea/licenseDetails
2025-06-21 09:51:56,328 - d365 - ERROR - Failed to check D365 license for user 627a6274-2144-43ae-a541-428069f4ff8a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/627a6274-2144-43ae-a541-428069f4ff8a/licenseDetails
2025-06-21 09:51:56,414 - d365 - ERROR - Failed to check D365 license for user bfa5d2b9-f1ec-454e-82e1-9dad0275f657: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/bfa5d2b9-f1ec-454e-82e1-9dad0275f657/licenseDetails
2025-06-21 09:51:56,503 - d365 - ERROR - Failed to check D365 license for user 278f6414-e346-4b85-9c3e-549cdc4a7f79: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/278f6414-e346-4b85-9c3e-549cdc4a7f79/licenseDetails
2025-06-21 09:51:56,614 - d365 - ERROR - Failed to check D365 license for user 7b5104d0-f059-41e7-a1d4-f1e4cd4cebc5: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/7b5104d0-f059-41e7-a1d4-f1e4cd4cebc5/licenseDetails
2025-06-21 09:51:56,697 - d365 - ERROR - Failed to check D365 license for user cfdc5c44-e69c-45a6-ac0a-92d7fe88a6c9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cfdc5c44-e69c-45a6-ac0a-92d7fe88a6c9/licenseDetails
2025-06-21 09:51:56,783 - d365 - ERROR - Failed to check D365 license for user f6a623a6-c3e5-4e63-923b-970c3cddc789: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f6a623a6-c3e5-4e63-923b-970c3cddc789/licenseDetails
2025-06-21 09:51:56,890 - d365 - ERROR - Failed to check D365 license for user 96b02617-0dcb-4cc2-a8ec-3aad9bead04a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/96b02617-0dcb-4cc2-a8ec-3aad9bead04a/licenseDetails
2025-06-21 09:51:56,967 - d365 - ERROR - Failed to check D365 license for user 3c15539e-a623-4cf3-bc74-7417889cb863: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3c15539e-a623-4cf3-bc74-7417889cb863/licenseDetails
2025-06-21 09:51:57,091 - d365 - ERROR - Failed to check D365 license for user aceb170f-a792-452f-87fc-4d58adf6f812: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/aceb170f-a792-452f-87fc-4d58adf6f812/licenseDetails
2025-06-21 09:51:57,181 - d365 - ERROR - Failed to check D365 license for user f3868fcb-a248-4174-8a23-fead9d625331: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f3868fcb-a248-4174-8a23-fead9d625331/licenseDetails
2025-06-21 09:51:57,253 - d365 - ERROR - Failed to check D365 license for user f2a745e4-bba3-46a1-a876-33013d18f211: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f2a745e4-bba3-46a1-a876-33013d18f211/licenseDetails
2025-06-21 09:51:57,353 - d365 - ERROR - Failed to check D365 license for user 8f814f88-9e1a-43b4-a1dc-70314034112d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8f814f88-9e1a-43b4-a1dc-70314034112d/licenseDetails
2025-06-21 09:51:57,446 - d365 - ERROR - Failed to check D365 license for user 3ec188a7-aae0-4bdc-a10c-eca61dce47a0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3ec188a7-aae0-4bdc-a10c-eca61dce47a0/licenseDetails
2025-06-21 09:51:57,553 - d365 - ERROR - Failed to check D365 license for user 31194cec-54b5-4e38-8ac7-1af6b7fe12a2: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/31194cec-54b5-4e38-8ac7-1af6b7fe12a2/licenseDetails
2025-06-21 09:51:57,671 - d365 - ERROR - Failed to check D365 license for user 5615fd17-014c-4697-b674-5eb1927366ac: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5615fd17-014c-4697-b674-5eb1927366ac/licenseDetails
2025-06-21 09:51:57,753 - d365 - ERROR - Failed to check D365 license for user 9d500883-7740-4a6f-ae6b-8db4bd3dd450: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9d500883-7740-4a6f-ae6b-8db4bd3dd450/licenseDetails
2025-06-21 09:51:57,884 - d365 - ERROR - Failed to check D365 license for user 1038812d-f12c-40d9-9b2f-7cc0e7d9f4f4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1038812d-f12c-40d9-9b2f-7cc0e7d9f4f4/licenseDetails
2025-06-21 09:51:57,978 - d365 - ERROR - Failed to check D365 license for user 8cdbd43f-06d4-46c9-a9ec-2b3231fc0f98: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8cdbd43f-06d4-46c9-a9ec-2b3231fc0f98/licenseDetails
2025-06-21 09:51:58,102 - d365 - ERROR - Failed to check D365 license for user 9dafa9a5-0993-481f-a6cc-43773fb7d9ae: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9dafa9a5-0993-481f-a6cc-43773fb7d9ae/licenseDetails
2025-06-21 09:51:58,222 - d365 - ERROR - Failed to check D365 license for user 17bcaa25-7d6a-425c-975d-3044cadf25de: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/17bcaa25-7d6a-425c-975d-3044cadf25de/licenseDetails
2025-06-21 09:51:58,309 - d365 - ERROR - Failed to check D365 license for user d373c19a-2bb2-4488-94a2-db96409ca507: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d373c19a-2bb2-4488-94a2-db96409ca507/licenseDetails
2025-06-21 09:51:58,419 - d365 - ERROR - Failed to check D365 license for user e015e353-dda8-419f-bf83-ce67be175e6d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e015e353-dda8-419f-bf83-ce67be175e6d/licenseDetails
2025-06-21 09:51:58,517 - d365 - ERROR - Failed to check D365 license for user 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d/licenseDetails
2025-06-21 09:51:58,617 - d365 - ERROR - Failed to check D365 license for user edf73c60-77ee-441e-94e3-eadd2c993307: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/edf73c60-77ee-441e-94e3-eadd2c993307/licenseDetails
2025-06-21 09:51:58,719 - d365 - ERROR - Failed to check D365 license for user b52ba911-6088-493d-9540-6afd622c81a7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b52ba911-6088-493d-9540-6afd622c81a7/licenseDetails
2025-06-21 09:51:58,860 - d365 - ERROR - Failed to check D365 license for user 02ebdf4b-fe53-48e0-a309-c3cd46061053: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/02ebdf4b-fe53-48e0-a309-c3cd46061053/licenseDetails
2025-06-21 09:51:58,962 - d365 - ERROR - Failed to check D365 license for user 1ac12a42-5318-4c55-90c8-c34ea2855904: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1ac12a42-5318-4c55-90c8-c34ea2855904/licenseDetails
2025-06-21 09:51:59,072 - d365 - ERROR - Failed to check D365 license for user d047be34-feb4-499e-90c4-3776d99d442b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d047be34-feb4-499e-90c4-3776d99d442b/licenseDetails
2025-06-21 09:51:59,366 - d365 - ERROR - Failed to check D365 license for user 42fe46b4-baaa-4ea2-89d2-d1fd4497ebfd: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/42fe46b4-baaa-4ea2-89d2-d1fd4497ebfd/licenseDetails
2025-06-21 09:51:59,477 - d365 - ERROR - Failed to check D365 license for user a9cbe0b9-6500-49db-b451-3b47f00f310e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a9cbe0b9-6500-49db-b451-3b47f00f310e/licenseDetails
2025-06-21 09:51:59,588 - d365 - ERROR - Failed to check D365 license for user c38b43de-685a-426a-a290-fa182ab55cc1: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c38b43de-685a-426a-a290-fa182ab55cc1/licenseDetails
2025-06-21 09:51:59,654 - d365 - ERROR - Failed to check D365 license for user 2ed4592e-5be7-4805-8074-73d98f577c36: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2ed4592e-5be7-4805-8074-73d98f577c36/licenseDetails
2025-06-21 09:51:59,742 - d365 - ERROR - Failed to check D365 license for user f777b683-9def-4137-98a3-06e33f07fcc7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f777b683-9def-4137-98a3-06e33f07fcc7/licenseDetails
2025-06-21 09:51:59,855 - d365 - ERROR - Failed to check D365 license for user d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188/licenseDetails
2025-06-21 09:51:59,964 - d365 - ERROR - Failed to check D365 license for user 6dfb9d71-0f51-43b6-bedc-aaee6f02f489: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6dfb9d71-0f51-43b6-bedc-aaee6f02f489/licenseDetails
2025-06-21 09:52:00,062 - d365 - ERROR - Failed to check D365 license for user b87b1d26-7e0f-4049-b16b-b40b1f04f0ca: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b87b1d26-7e0f-4049-b16b-b40b1f04f0ca/licenseDetails
2025-06-21 09:52:00,171 - d365 - ERROR - Failed to check D365 license for user 4cef4c68-dbd4-4417-964b-b61e384da0c1: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4cef4c68-dbd4-4417-964b-b61e384da0c1/licenseDetails
2025-06-21 09:52:00,271 - d365 - ERROR - Failed to check D365 license for user 4ddff338-8e4d-4038-8519-0bdb8caa274d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4ddff338-8e4d-4038-8519-0bdb8caa274d/licenseDetails
2025-06-21 09:52:00,366 - d365 - ERROR - Failed to check D365 license for user 277f14c0-4325-4bcf-b311-599623c0ca37: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/277f14c0-4325-4bcf-b311-599623c0ca37/licenseDetails
2025-06-21 09:52:00,482 - d365 - ERROR - Failed to check D365 license for user 4fe4a56b-3623-455e-9b4d-7df121b36699: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4fe4a56b-3623-455e-9b4d-7df121b36699/licenseDetails
2025-06-21 09:52:00,600 - d365 - ERROR - Failed to check D365 license for user 2e62e0a2-cc27-4c32-9ac2-e741390c3cdd: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2e62e0a2-cc27-4c32-9ac2-e741390c3cdd/licenseDetails
2025-06-21 09:52:00,715 - d365 - ERROR - Failed to check D365 license for user e2890086-8ec1-47f5-8028-39e0b429f3c0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e2890086-8ec1-47f5-8028-39e0b429f3c0/licenseDetails
2025-06-21 09:52:00,816 - d365 - ERROR - Failed to check D365 license for user c70a95bf-cbc0-4584-ae07-a883d3aaced5: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c70a95bf-cbc0-4584-ae07-a883d3aaced5/licenseDetails
2025-06-21 09:52:00,938 - d365 - ERROR - Failed to check D365 license for user 738fe358-4e9c-40af-b64f-d405fb320ef2: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/738fe358-4e9c-40af-b64f-d405fb320ef2/licenseDetails
2025-06-21 09:52:01,061 - d365 - ERROR - Failed to check D365 license for user 1c3f4eca-3cd0-4b4d-8766-7ff220c48916: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1c3f4eca-3cd0-4b4d-8766-7ff220c48916/licenseDetails
2025-06-21 09:52:01,165 - d365 - ERROR - Failed to check D365 license for user 040211e8-ced1-4e93-8620-615c0b566731: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/040211e8-ced1-4e93-8620-615c0b566731/licenseDetails
2025-06-21 09:52:01,266 - d365 - ERROR - Failed to check D365 license for user 043c419f-8f94-4486-bece-269d0e778d0b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/043c419f-8f94-4486-bece-269d0e778d0b/licenseDetails
2025-06-21 09:52:01,382 - d365 - ERROR - Failed to check D365 license for user 36dc8132-3501-40f4-96af-8492922253f8: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/36dc8132-3501-40f4-96af-8492922253f8/licenseDetails
2025-06-21 09:52:01,486 - d365 - ERROR - Failed to check D365 license for user 19ff3b40-22bf-40e8-923f-6be7224bbb04: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/19ff3b40-22bf-40e8-923f-6be7224bbb04/licenseDetails
2025-06-21 09:52:01,592 - d365 - ERROR - Failed to check D365 license for user 2098907d-9aef-4fc0-8449-3d1dd4f3a892: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2098907d-9aef-4fc0-8449-3d1dd4f3a892/licenseDetails
2025-06-21 09:52:01,692 - d365 - ERROR - Failed to check D365 license for user b1cab65f-06bd-4451-8a11-550c89248c77: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b1cab65f-06bd-4451-8a11-550c89248c77/licenseDetails
2025-06-21 09:52:01,796 - d365 - ERROR - Failed to check D365 license for user 02dc31a5-4663-4716-9cea-5c32706d3d25: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/02dc31a5-4663-4716-9cea-5c32706d3d25/licenseDetails
2025-06-21 09:52:01,921 - d365 - ERROR - Failed to check D365 license for user 3123d7d4-ba40-4538-a568-2eaf0afaec0a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3123d7d4-ba40-4538-a568-2eaf0afaec0a/licenseDetails
2025-06-21 09:52:02,038 - d365 - ERROR - Failed to check D365 license for user 887262de-45b2-4773-acc5-7882c7ca1732: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/887262de-45b2-4773-acc5-7882c7ca1732/licenseDetails
2025-06-21 09:52:02,097 - d365 - ERROR - Failed to check D365 license for user be31f481-22b3-4975-a0f8-80ff16d4b157: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/be31f481-22b3-4975-a0f8-80ff16d4b157/licenseDetails
2025-06-21 09:52:02,194 - d365 - ERROR - Failed to check D365 license for user 8c91f185-d4cc-45ea-9e58-9274d1b0d283: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8c91f185-d4cc-45ea-9e58-9274d1b0d283/licenseDetails
2025-06-21 09:52:02,303 - d365 - ERROR - Failed to check D365 license for user 3cac4936-d302-442e-be13-d025ceb75f3a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3cac4936-d302-442e-be13-d025ceb75f3a/licenseDetails
2025-06-21 09:52:02,415 - d365 - ERROR - Failed to check D365 license for user 847768ad-7dcf-44cf-9876-107c06171a64: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/847768ad-7dcf-44cf-9876-107c06171a64/licenseDetails
2025-06-21 09:52:02,487 - d365 - ERROR - Failed to check D365 license for user 44ad29d6-0fff-40c0-b77b-1104bf9c391f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/44ad29d6-0fff-40c0-b77b-1104bf9c391f/licenseDetails
2025-06-21 09:52:02,594 - d365 - ERROR - Failed to check D365 license for user 3726dc71-9dff-4049-823f-2a69fd16dcdf: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3726dc71-9dff-4049-823f-2a69fd16dcdf/licenseDetails
2025-06-21 09:52:02,688 - d365 - ERROR - Failed to check D365 license for user f3d3b3bb-c26a-4b33-81c1-b40dd0593a37: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f3d3b3bb-c26a-4b33-81c1-b40dd0593a37/licenseDetails
2025-06-21 09:52:02,797 - d365 - ERROR - Failed to check D365 license for user f6226291-cb08-4714-ba8b-1d6b83cdb8ec: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f6226291-cb08-4714-ba8b-1d6b83cdb8ec/licenseDetails
2025-06-21 09:52:02,917 - d365 - ERROR - Failed to check D365 license for user ccf6d52a-a45b-4d3a-810a-69bda63bec78: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ccf6d52a-a45b-4d3a-810a-69bda63bec78/licenseDetails
2025-06-21 09:52:03,003 - d365 - ERROR - Failed to check D365 license for user 9b85df3d-48bb-41e7-98a5-849005b424ff: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9b85df3d-48bb-41e7-98a5-849005b424ff/licenseDetails
2025-06-21 09:52:03,100 - d365 - ERROR - Failed to check D365 license for user 05e5fef5-536e-401c-b3b7-32d22a92d3a7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/05e5fef5-536e-401c-b3b7-32d22a92d3a7/licenseDetails
2025-06-21 09:52:03,211 - d365 - ERROR - Failed to check D365 license for user 57dfbd62-58c9-4f89-a8cc-8c2ce5383c29: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/57dfbd62-58c9-4f89-a8cc-8c2ce5383c29/licenseDetails
2025-06-21 09:52:03,321 - d365 - ERROR - Failed to check D365 license for user 632a686e-0e79-4bf2-a108-4382fb71a3f7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/632a686e-0e79-4bf2-a108-4382fb71a3f7/licenseDetails
2025-06-21 09:52:03,431 - d365 - ERROR - Failed to check D365 license for user 236a938b-9c25-43ba-9a64-0549d5b3de1c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/236a938b-9c25-43ba-9a64-0549d5b3de1c/licenseDetails
2025-06-21 09:52:03,528 - d365 - ERROR - Failed to check D365 license for user b73b71d2-2af4-4b31-bfb3-d7e7d2f19ee9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b73b71d2-2af4-4b31-bfb3-d7e7d2f19ee9/licenseDetails
2025-06-21 09:52:03,633 - d365 - ERROR - Failed to check D365 license for user 1caaa937-8018-47c2-b201-0bc7138e1d8a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1caaa937-8018-47c2-b201-0bc7138e1d8a/licenseDetails
2025-06-21 09:52:03,744 - d365 - ERROR - Failed to check D365 license for user 65e958c8-6dc1-42c7-83fd-682c105dcf67: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/65e958c8-6dc1-42c7-83fd-682c105dcf67/licenseDetails
2025-06-21 09:52:03,824 - d365 - ERROR - Failed to check D365 license for user 2fddf3a8-ddb5-4113-be56-f98c1f93deec: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2fddf3a8-ddb5-4113-be56-f98c1f93deec/licenseDetails
2025-06-21 09:52:03,902 - d365 - ERROR - Failed to check D365 license for user ede83771-9387-4f5b-9cd8-62b0412c2d88: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ede83771-9387-4f5b-9cd8-62b0412c2d88/licenseDetails
2025-06-21 09:52:04,014 - d365 - ERROR - Failed to check D365 license for user 873eb7f1-486f-423f-82ff-433111a53924: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/873eb7f1-486f-423f-82ff-433111a53924/licenseDetails
2025-06-21 09:52:04,113 - d365 - ERROR - Failed to check D365 license for user d9721234-977e-494f-843a-7fe07449f80b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d9721234-977e-494f-843a-7fe07449f80b/licenseDetails
2025-06-21 09:52:04,203 - d365 - ERROR - Failed to check D365 license for user 362e27bd-0cb2-4eb1-8262-97e55787fc40: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/362e27bd-0cb2-4eb1-8262-97e55787fc40/licenseDetails
2025-06-21 09:52:04,311 - d365 - ERROR - Failed to check D365 license for user 6c590439-7176-47f8-b748-36a0b77a8b1c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6c590439-7176-47f8-b748-36a0b77a8b1c/licenseDetails
2025-06-21 09:52:04,387 - d365 - ERROR - Failed to check D365 license for user 00e5df59-0081-4e43-9ae0-7c9969f698dc: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/00e5df59-0081-4e43-9ae0-7c9969f698dc/licenseDetails
2025-06-21 09:52:04,504 - d365 - ERROR - Failed to check D365 license for user 878b0840-ca6a-4aab-b181-aaef21598e95: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/878b0840-ca6a-4aab-b181-aaef21598e95/licenseDetails
2025-06-21 09:52:04,616 - d365 - ERROR - Failed to check D365 license for user 4f128540-407f-4017-b8cc-a6441209152c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4f128540-407f-4017-b8cc-a6441209152c/licenseDetails
2025-06-21 09:52:04,727 - d365 - ERROR - Failed to check D365 license for user dc6ba31e-0d1a-4f0a-b69e-9a3c796cc39b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/dc6ba31e-0d1a-4f0a-b69e-9a3c796cc39b/licenseDetails
2025-06-21 09:52:04,807 - d365 - ERROR - Failed to check D365 license for user 64ddd89d-188b-4d74-8afc-0629695ba553: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/64ddd89d-188b-4d74-8afc-0629695ba553/licenseDetails
2025-06-21 09:52:04,914 - d365 - ERROR - Failed to check D365 license for user e3fc650d-860f-4e24-8161-9785eaf99d82: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e3fc650d-860f-4e24-8161-9785eaf99d82/licenseDetails
2025-06-21 09:52:04,989 - d365 - ERROR - Failed to check D365 license for user 8c21304f-41d0-474f-bb19-d49eba150fb0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8c21304f-41d0-474f-bb19-d49eba150fb0/licenseDetails
2025-06-21 09:52:05,067 - d365 - ERROR - Failed to check D365 license for user c3fa9858-e624-4886-96f7-01fccc3b5f51: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c3fa9858-e624-4886-96f7-01fccc3b5f51/licenseDetails
2025-06-21 09:52:05,170 - d365 - ERROR - Failed to check D365 license for user ba7cf3f4-3993-48ad-9f7b-0717485b79db: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ba7cf3f4-3993-48ad-9f7b-0717485b79db/licenseDetails
2025-06-21 09:52:05,292 - d365 - ERROR - Failed to check D365 license for user cc80b9a0-19bf-4924-98bb-106f4482424b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cc80b9a0-19bf-4924-98bb-106f4482424b/licenseDetails
2025-06-21 09:52:05,408 - d365 - ERROR - Failed to check D365 license for user c9ca7354-6d59-4111-aa79-6a62555c7f3e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c9ca7354-6d59-4111-aa79-6a62555c7f3e/licenseDetails
2025-06-21 09:52:05,514 - d365 - ERROR - Failed to check D365 license for user 0f044ac3-384d-4e55-abe8-72911cbe6b76: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0f044ac3-384d-4e55-abe8-72911cbe6b76/licenseDetails
2025-06-21 09:52:05,584 - d365 - ERROR - Failed to check D365 license for user 009cd7c5-7047-42e5-9a2a-62168e8fee64: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/009cd7c5-7047-42e5-9a2a-62168e8fee64/licenseDetails
2025-06-21 09:52:05,698 - d365 - ERROR - Failed to check D365 license for user e36243ec-2ba1-45e4-bba0-d3691d1ec231: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e36243ec-2ba1-45e4-bba0-d3691d1ec231/licenseDetails
2025-06-21 09:52:05,805 - d365 - ERROR - Failed to check D365 license for user e55b9413-7455-4beb-b312-1ae556184838: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e55b9413-7455-4beb-b312-1ae556184838/licenseDetails
2025-06-21 09:52:05,916 - d365 - ERROR - Failed to check D365 license for user cf03d7b2-2583-47c5-b3c1-3f54bac34324: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cf03d7b2-2583-47c5-b3c1-3f54bac34324/licenseDetails
2025-06-21 09:52:05,997 - d365 - ERROR - Failed to check D365 license for user 3c36d97e-3ab6-4843-906a-4046a5a6e056: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3c36d97e-3ab6-4843-906a-4046a5a6e056/licenseDetails
2025-06-21 09:52:06,114 - d365 - ERROR - Failed to check D365 license for user 965deb23-866e-4c9d-b9c7-1e6ba36a4e83: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/965deb23-866e-4c9d-b9c7-1e6ba36a4e83/licenseDetails
2025-06-21 09:52:06,228 - d365 - ERROR - Failed to check D365 license for user add0b53f-8470-48e7-b3f6-169b51afd5fe: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/add0b53f-8470-48e7-b3f6-169b51afd5fe/licenseDetails
2025-06-21 09:52:06,327 - d365 - ERROR - Failed to check D365 license for user dd4c4c53-0a57-4462-8ca6-2f596a25258e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/dd4c4c53-0a57-4462-8ca6-2f596a25258e/licenseDetails
2025-06-21 09:52:06,443 - d365 - ERROR - Failed to check D365 license for user 7da41f58-e26e-43b1-ae3a-d10adb6f8717: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/7da41f58-e26e-43b1-ae3a-d10adb6f8717/licenseDetails
2025-06-21 09:52:06,521 - d365 - ERROR - Failed to check D365 license for user 26c82188-c75a-4603-8f5f-c92069eaa698: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/26c82188-c75a-4603-8f5f-c92069eaa698/licenseDetails
2025-06-21 09:52:06,618 - d365 - ERROR - Failed to check D365 license for user cda781a0-edfc-4375-b358-3485b409b5f3: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cda781a0-edfc-4375-b358-3485b409b5f3/licenseDetails
2025-06-21 09:52:06,720 - d365 - ERROR - Failed to check D365 license for user 43ff30d6-c2c8-4a1c-92ac-3253c386df5d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/43ff30d6-c2c8-4a1c-92ac-3253c386df5d/licenseDetails
2025-06-21 09:52:06,840 - d365 - ERROR - Failed to check D365 license for user 78867dac-ef34-42e1-937e-8e2a384d129c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/78867dac-ef34-42e1-937e-8e2a384d129c/licenseDetails
2025-06-21 09:52:06,921 - d365 - ERROR - Failed to check D365 license for user 49014f3e-96f5-4402-8c08-5c3969d194c6: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/49014f3e-96f5-4402-8c08-5c3969d194c6/licenseDetails
2025-06-21 09:52:07,022 - d365 - ERROR - Failed to check D365 license for user dbde5154-4161-4234-b252-81e89e5512d1: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/dbde5154-4161-4234-b252-81e89e5512d1/licenseDetails
2025-06-21 09:52:07,137 - d365 - ERROR - Failed to check D365 license for user aeab6906-4da5-461f-b3d0-108301505327: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/aeab6906-4da5-461f-b3d0-108301505327/licenseDetails
2025-06-21 09:52:07,247 - d365 - ERROR - Failed to check D365 license for user a2f1b7f1-5c62-4180-a976-834c95e9980b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a2f1b7f1-5c62-4180-a976-834c95e9980b/licenseDetails
2025-06-21 09:52:07,364 - d365 - ERROR - Failed to check D365 license for user 6b7657e9-4023-4e52-aa16-559450b317be: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6b7657e9-4023-4e52-aa16-559450b317be/licenseDetails
2025-06-21 09:52:07,463 - d365 - ERROR - Failed to check D365 license for user 4bc1b010-2c6e-44f3-b5bc-7aeb6903b4b6: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4bc1b010-2c6e-44f3-b5bc-7aeb6903b4b6/licenseDetails
2025-06-21 09:52:07,541 - d365 - ERROR - Failed to check D365 license for user 5dc4ef2c-44b1-46cb-9674-44eb082e0478: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5dc4ef2c-44b1-46cb-9674-44eb082e0478/licenseDetails
2025-06-21 09:52:07,673 - d365 - ERROR - Failed to check D365 license for user b5d4a7f0-ca53-4436-93f5-e7cd8b6b7129: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b5d4a7f0-ca53-4436-93f5-e7cd8b6b7129/licenseDetails
2025-06-21 09:52:07,770 - d365 - ERROR - Failed to check D365 license for user 9fe974e3-250a-4a4f-8664-075bfb9acd44: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9fe974e3-250a-4a4f-8664-075bfb9acd44/licenseDetails
2025-06-21 09:52:07,869 - d365 - ERROR - Failed to check D365 license for user 9169ee2f-56a9-48db-8cb7-77f197a51bf0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9169ee2f-56a9-48db-8cb7-77f197a51bf0/licenseDetails
2025-06-21 09:52:08,000 - d365 - ERROR - Failed to check D365 license for user 8cfcc408-57f2-4985-84af-5e4e722ed432: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8cfcc408-57f2-4985-84af-5e4e722ed432/licenseDetails
2025-06-21 09:52:08,092 - d365 - ERROR - Failed to check D365 license for user d9a6e6e4-11bc-4838-a89d-1e12dc0e4175: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d9a6e6e4-11bc-4838-a89d-1e12dc0e4175/licenseDetails
2025-06-21 09:52:08,197 - d365 - ERROR - Failed to check D365 license for user 3fea2cb5-3aa4-4605-914c-c65359cbfa10: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3fea2cb5-3aa4-4605-914c-c65359cbfa10/licenseDetails
2025-06-21 09:52:08,311 - d365 - ERROR - Failed to check D365 license for user 98a08685-1887-4994-a536-7b72fe7efae4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/98a08685-1887-4994-a536-7b72fe7efae4/licenseDetails
2025-06-21 09:52:08,413 - d365 - ERROR - Failed to check D365 license for user 9587430d-f7b3-439a-9b24-d79a62b160dc: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9587430d-f7b3-439a-9b24-d79a62b160dc/licenseDetails
2025-06-21 09:52:08,511 - d365 - ERROR - Failed to check D365 license for user 21c89e8c-746d-4de9-ac50-c0de034c6609: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/21c89e8c-746d-4de9-ac50-c0de034c6609/licenseDetails
2025-06-21 09:52:08,653 - d365 - ERROR - Failed to check D365 license for user 07ea9fdf-59ef-45a2-9b65-53a2ecd3ecc9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/07ea9fdf-59ef-45a2-9b65-53a2ecd3ecc9/licenseDetails
2025-06-21 09:52:08,762 - d365 - ERROR - Failed to check D365 license for user fbbb89f9-66a1-48e1-b07b-6617c5d8106e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/fbbb89f9-66a1-48e1-b07b-6617c5d8106e/licenseDetails
2025-06-21 09:52:08,856 - d365 - ERROR - Failed to check D365 license for user b858498a-065a-4a3b-9757-daacbb3b8a46: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b858498a-065a-4a3b-9757-daacbb3b8a46/licenseDetails
2025-06-21 09:52:08,936 - d365 - ERROR - Failed to check D365 license for user 237f4d62-6379-4340-bb6f-0c5739192897: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/237f4d62-6379-4340-bb6f-0c5739192897/licenseDetails
2025-06-21 09:52:09,010 - d365 - ERROR - Failed to check D365 license for user 2e186776-244e-4c01-a4d4-97102c86ff32: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2e186776-244e-4c01-a4d4-97102c86ff32/licenseDetails
2025-06-21 09:52:09,087 - d365 - ERROR - Failed to check D365 license for user 5fbb42cb-c4a0-46af-8e6c-1e763c0685a4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5fbb42cb-c4a0-46af-8e6c-1e763c0685a4/licenseDetails
2025-06-21 09:52:09,201 - d365 - ERROR - Failed to check D365 license for user 81365177-0a9c-4815-b04f-1ba6c71dfb11: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/81365177-0a9c-4815-b04f-1ba6c71dfb11/licenseDetails
2025-06-21 09:52:09,316 - d365 - ERROR - Failed to check D365 license for user 82701f31-72e4-4d14-9d41-b90ae787fdba: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/82701f31-72e4-4d14-9d41-b90ae787fdba/licenseDetails
2025-06-21 09:52:09,435 - d365 - ERROR - Failed to check D365 license for user e9843462-412e-4ef4-943d-b2a68c33f260: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e9843462-412e-4ef4-943d-b2a68c33f260/licenseDetails
2025-06-21 09:52:09,535 - d365 - ERROR - Failed to check D365 license for user 86f3d306-d530-4b21-a56e-b06f962d187b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/86f3d306-d530-4b21-a56e-b06f962d187b/licenseDetails
2025-06-21 09:52:09,634 - d365 - ERROR - Failed to check D365 license for user cace23a1-275e-4ee6-97ad-ca731532524c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cace23a1-275e-4ee6-97ad-ca731532524c/licenseDetails
2025-06-21 09:52:09,739 - d365 - ERROR - Failed to check D365 license for user f5155590-6d3e-4496-ac6d-f397857cd82f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f5155590-6d3e-4496-ac6d-f397857cd82f/licenseDetails
2025-06-21 09:52:09,829 - d365 - ERROR - Failed to check D365 license for user 8538c0d9-d971-4a6d-a5e1-5d294123bf97: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8538c0d9-d971-4a6d-a5e1-5d294123bf97/licenseDetails
2025-06-21 09:52:09,907 - d365 - ERROR - Failed to check D365 license for user e6024c81-c0c2-42f7-b213-eaed3ce702e8: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e6024c81-c0c2-42f7-b213-eaed3ce702e8/licenseDetails
2025-06-21 09:52:10,022 - d365 - ERROR - Failed to check D365 license for user 612f7a3c-e1eb-432a-aad0-42019d2ddc97: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/612f7a3c-e1eb-432a-aad0-42019d2ddc97/licenseDetails
2025-06-21 09:52:10,142 - d365 - ERROR - Failed to check D365 license for user 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d/licenseDetails
2025-06-21 09:52:10,237 - d365 - ERROR - Failed to check D365 license for user ea6ef0d5-2558-43e4-9bfe-a623e461bced: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ea6ef0d5-2558-43e4-9bfe-a623e461bced/licenseDetails
2025-06-21 09:52:10,385 - d365 - ERROR - Failed to check D365 license for user 0e629332-839c-44df-9d37-959bb4f21b1d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0e629332-839c-44df-9d37-959bb4f21b1d/licenseDetails
2025-06-21 09:52:10,474 - d365 - ERROR - Failed to check D365 license for user d4e4c6d1-8522-46b3-b75b-cf072dd73002: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d4e4c6d1-8522-46b3-b75b-cf072dd73002/licenseDetails
2025-06-21 09:52:10,583 - d365 - ERROR - Failed to check D365 license for user 72a07a32-8a95-4baf-8de6-8c0de160d421: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/72a07a32-8a95-4baf-8de6-8c0de160d421/licenseDetails
2025-06-21 09:52:10,665 - d365 - ERROR - Failed to check D365 license for user d6723e3c-4b88-4df4-a66c-4211048b997c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d6723e3c-4b88-4df4-a66c-4211048b997c/licenseDetails
2025-06-21 09:52:10,768 - d365 - ERROR - Failed to check D365 license for user c92b889e-7357-4860-bd4b-8512ce064239: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c92b889e-7357-4860-bd4b-8512ce064239/licenseDetails
2025-06-21 09:52:10,879 - d365 - ERROR - Failed to check D365 license for user 2d7c10ca-9edd-41ed-a5c5-81d7e0e999d7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2d7c10ca-9edd-41ed-a5c5-81d7e0e999d7/licenseDetails
2025-06-21 09:52:10,954 - d365 - ERROR - Failed to check D365 license for user cda78e30-5aba-457d-908b-7d26fff7133f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cda78e30-5aba-457d-908b-7d26fff7133f/licenseDetails
2025-06-21 09:52:11,083 - d365 - ERROR - Failed to check D365 license for user ae64b652-4b81-437f-88ff-9de316d755ee: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ae64b652-4b81-437f-88ff-9de316d755ee/licenseDetails
2025-06-21 09:52:11,220 - d365 - ERROR - Failed to check D365 license for user 6cad86e1-f456-4839-9707-7a86805691fe: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6cad86e1-f456-4839-9707-7a86805691fe/licenseDetails
2025-06-21 09:52:11,339 - d365 - ERROR - Failed to check D365 license for user b2680433-ddf9-412b-b1db-39a0c2292f1c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b2680433-ddf9-412b-b1db-39a0c2292f1c/licenseDetails
2025-06-21 09:52:11,474 - d365 - ERROR - Failed to check D365 license for user 95facc43-531d-496a-91b3-b3a68338a9ff: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/95facc43-531d-496a-91b3-b3a68338a9ff/licenseDetails
2025-06-21 09:52:11,559 - d365 - ERROR - Failed to check D365 license for user aae0e1e7-8122-46c3-b8fd-367a36e54104: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/aae0e1e7-8122-46c3-b8fd-367a36e54104/licenseDetails
2025-06-21 09:52:11,699 - d365 - ERROR - Failed to check D365 license for user 6d0345b0-38c0-4891-9b8c-be8bff8f136a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6d0345b0-38c0-4891-9b8c-be8bff8f136a/licenseDetails
2025-06-21 09:52:11,793 - d365 - ERROR - Failed to check D365 license for user 670139c3-2c13-403b-886a-940374f49e55: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/670139c3-2c13-403b-886a-940374f49e55/licenseDetails
2025-06-21 09:52:11,916 - d365 - ERROR - Failed to check D365 license for user 36bbb5f5-e9ab-49d8-a9dd-83496285d800: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/36bbb5f5-e9ab-49d8-a9dd-83496285d800/licenseDetails
2025-06-21 09:52:12,038 - d365 - ERROR - Failed to check D365 license for user 851f236a-dc3f-4cf1-90ed-53819fc8b41e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/851f236a-dc3f-4cf1-90ed-53819fc8b41e/licenseDetails
2025-06-21 09:52:12,137 - d365 - ERROR - Failed to check D365 license for user c227799b-0be3-4cc3-a57a-1474541d1ea0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c227799b-0be3-4cc3-a57a-1474541d1ea0/licenseDetails
2025-06-21 09:52:12,244 - d365 - ERROR - Failed to check D365 license for user 6a8f9c80-2ebf-40f5-9d26-9036db205a49: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6a8f9c80-2ebf-40f5-9d26-9036db205a49/licenseDetails
2025-06-21 09:52:12,363 - d365 - ERROR - Failed to check D365 license for user 42e0f34d-f052-4337-91ee-b1c508c4eab3: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/42e0f34d-f052-4337-91ee-b1c508c4eab3/licenseDetails
2025-06-21 09:52:12,452 - d365 - ERROR - Failed to check D365 license for user 861ba71b-30c8-4021-8c8c-971bfce97337: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/861ba71b-30c8-4021-8c8c-971bfce97337/licenseDetails
2025-06-21 09:52:12,694 - d365 - ERROR - Failed to check D365 license for user c316f5bf-434d-48c0-9fef-ba026d1a9ef4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c316f5bf-434d-48c0-9fef-ba026d1a9ef4/licenseDetails
2025-06-21 09:52:12,843 - d365 - ERROR - Failed to check D365 license for user 877b8f27-605f-499e-8d4c-63f420488da3: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/877b8f27-605f-499e-8d4c-63f420488da3/licenseDetails
2025-06-21 09:52:12,971 - d365 - ERROR - Failed to check D365 license for user 663e9b30-30d7-4707-becc-91a966b8632b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/663e9b30-30d7-4707-becc-91a966b8632b/licenseDetails
2025-06-21 09:52:13,084 - d365 - ERROR - Failed to check D365 license for user c9a68d4d-342a-416c-b54c-ec2cdabc0c3f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c9a68d4d-342a-416c-b54c-ec2cdabc0c3f/licenseDetails
2025-06-21 09:52:13,171 - d365 - ERROR - Failed to check D365 license for user 77f756f3-1c5b-4d29-8d5b-b80c82157899: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/77f756f3-1c5b-4d29-8d5b-b80c82157899/licenseDetails
2025-06-21 09:52:13,282 - d365 - ERROR - Failed to check D365 license for user 8ec89a5a-4ee8-4487-9637-1dbfb9062121: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8ec89a5a-4ee8-4487-9637-1dbfb9062121/licenseDetails
2025-06-21 09:52:13,402 - d365 - ERROR - Failed to check D365 license for user a04bb954-ce22-4ac6-8dda-170d68cd3dff: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a04bb954-ce22-4ac6-8dda-170d68cd3dff/licenseDetails
2025-06-21 09:52:13,504 - d365 - ERROR - Failed to check D365 license for user 26b5f6c9-effc-4f9f-87e7-88da8d697d62: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/26b5f6c9-effc-4f9f-87e7-88da8d697d62/licenseDetails
2025-06-21 09:52:13,630 - d365 - ERROR - Failed to check D365 license for user 734e3483-dff7-4b30-9a39-afe0c0508894: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/734e3483-dff7-4b30-9a39-afe0c0508894/licenseDetails
2025-06-21 09:52:13,746 - d365 - ERROR - Failed to check D365 license for user b36d70a1-f635-4f11-9be8-c9cb51b84298: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b36d70a1-f635-4f11-9be8-c9cb51b84298/licenseDetails
2025-06-21 09:52:13,860 - d365 - ERROR - Failed to check D365 license for user 6a05f3a7-f0fa-42a2-a413-59bf6199df96: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6a05f3a7-f0fa-42a2-a413-59bf6199df96/licenseDetails
2025-06-21 09:52:13,947 - d365 - ERROR - Failed to check D365 license for user 6e1c0688-ce49-4f95-b5f5-b3ce425b3513: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6e1c0688-ce49-4f95-b5f5-b3ce425b3513/licenseDetails
2025-06-21 09:52:14,021 - d365 - ERROR - Failed to check D365 license for user 54624cc5-cf5e-4060-95e6-a57c2a18f10f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/54624cc5-cf5e-4060-95e6-a57c2a18f10f/licenseDetails
2025-06-21 09:52:14,108 - d365 - ERROR - Failed to check D365 license for user ce1ef25e-9f6a-4b20-8030-d30c630e5b1d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ce1ef25e-9f6a-4b20-8030-d30c630e5b1d/licenseDetails
2025-06-21 09:52:14,188 - d365 - ERROR - Failed to check D365 license for user 53db3aab-686c-44e9-9723-33fe1e28781b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/53db3aab-686c-44e9-9723-33fe1e28781b/licenseDetails
2025-06-21 09:52:14,281 - d365 - ERROR - Failed to check D365 license for user 6571267a-415a-4ecb-abb8-1a3da715a2cb: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6571267a-415a-4ecb-abb8-1a3da715a2cb/licenseDetails
2025-06-21 09:52:14,386 - d365 - ERROR - Failed to check D365 license for user 42d1b83b-00fd-45b3-95a7-ed9c051441b7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/42d1b83b-00fd-45b3-95a7-ed9c051441b7/licenseDetails
2025-06-21 09:52:14,476 - d365 - ERROR - Failed to check D365 license for user 51d9785e-b776-4176-8178-f3d374a1ef45: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/51d9785e-b776-4176-8178-f3d374a1ef45/licenseDetails
2025-06-21 09:52:14,572 - d365 - ERROR - Failed to check D365 license for user 7b9b56d0-b3d2-42d6-a0d1-17f8e7e88a19: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/7b9b56d0-b3d2-42d6-a0d1-17f8e7e88a19/licenseDetails
2025-06-21 09:52:14,662 - d365 - ERROR - Failed to check D365 license for user 6888b3a3-019c-4da1-9d91-312c2e47bc7a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6888b3a3-019c-4da1-9d91-312c2e47bc7a/licenseDetails
2025-06-21 09:52:14,727 - d365 - ERROR - Failed to check D365 license for user 78411886-3044-4f13-90a5-cfe9ce9ed8c7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/78411886-3044-4f13-90a5-cfe9ce9ed8c7/licenseDetails
2025-06-21 09:52:14,839 - d365 - ERROR - Failed to check D365 license for user cecada78-070f-47e7-8f39-f06c08e707b9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cecada78-070f-47e7-8f39-f06c08e707b9/licenseDetails
2025-06-21 09:52:14,966 - d365 - ERROR - Failed to check D365 license for user 5adad402-ba88-41d1-8186-985465b7e910: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5adad402-ba88-41d1-8186-985465b7e910/licenseDetails
2025-06-21 09:52:15,075 - d365 - ERROR - Failed to check D365 license for user 4ec8fcae-b32a-46d2-b300-f2439bbbde40: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4ec8fcae-b32a-46d2-b300-f2439bbbde40/licenseDetails
2025-06-21 09:52:15,178 - d365 - ERROR - Failed to check D365 license for user 25bb7a53-8ce8-45b9-87e1-7ee1a2238b35: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/25bb7a53-8ce8-45b9-87e1-7ee1a2238b35/licenseDetails
2025-06-21 09:52:15,289 - d365 - ERROR - Failed to check D365 license for user f0fa3075-1b62-4d30-b6ba-133955543d8a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f0fa3075-1b62-4d30-b6ba-133955543d8a/licenseDetails
2025-06-21 09:52:15,409 - d365 - ERROR - Failed to check D365 license for user 05a4b01d-10ad-4e3c-b88f-7af71e0d903c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/05a4b01d-10ad-4e3c-b88f-7af71e0d903c/licenseDetails
2025-06-21 09:52:15,509 - d365 - ERROR - Failed to check D365 license for user 07eba47e-0412-4614-8b51-9fbed1756df7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/07eba47e-0412-4614-8b51-9fbed1756df7/licenseDetails
2025-06-21 09:52:15,632 - d365 - ERROR - Failed to check D365 license for user 9eceefb5-45d4-432b-8b29-46cc9cee7309: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/9eceefb5-45d4-432b-8b29-46cc9cee7309/licenseDetails
2025-06-21 09:52:15,732 - d365 - ERROR - Failed to check D365 license for user 25e4481b-88cd-43c3-8875-93a1ab52df0a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/25e4481b-88cd-43c3-8875-93a1ab52df0a/licenseDetails
2025-06-21 09:52:15,840 - d365 - ERROR - Failed to check D365 license for user 28635e0a-3ab6-4421-940d-e6b732a15b14: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/28635e0a-3ab6-4421-940d-e6b732a15b14/licenseDetails
2025-06-21 09:52:15,939 - d365 - ERROR - Failed to check D365 license for user b749241c-6560-4480-a164-03fb42189d40: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b749241c-6560-4480-a164-03fb42189d40/licenseDetails
2025-06-21 09:52:16,017 - d365 - ERROR - Failed to check D365 license for user e627630e-68d2-4076-a881-ec4e8ef1dba2: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e627630e-68d2-4076-a881-ec4e8ef1dba2/licenseDetails
2025-06-21 09:52:16,096 - d365 - ERROR - Failed to check D365 license for user 09b2f1ea-dc3c-4ec4-b8ce-212d0cb1d4ba: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/09b2f1ea-dc3c-4ec4-b8ce-212d0cb1d4ba/licenseDetails
2025-06-21 09:52:16,204 - d365 - ERROR - Failed to check D365 license for user b5778ac7-6d44-4382-a83f-3c2f810f1e1b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b5778ac7-6d44-4382-a83f-3c2f810f1e1b/licenseDetails
2025-06-21 09:52:16,295 - d365 - ERROR - Failed to check D365 license for user 554435ac-dc28-4775-a148-5229ae0979f4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/554435ac-dc28-4775-a148-5229ae0979f4/licenseDetails
2025-06-21 09:52:16,417 - d365 - ERROR - Failed to check D365 license for user bc1af13e-0ffe-41a1-9e83-7166e35c3403: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/bc1af13e-0ffe-41a1-9e83-7166e35c3403/licenseDetails
2025-06-21 09:52:16,545 - d365 - ERROR - Failed to check D365 license for user 2b68b50c-b7e1-4155-9966-4ddca2ec8afc: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2b68b50c-b7e1-4155-9966-4ddca2ec8afc/licenseDetails
2025-06-21 09:52:16,623 - d365 - ERROR - Failed to check D365 license for user 972af6ae-90d2-441e-8436-2860f812896f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/972af6ae-90d2-441e-8436-2860f812896f/licenseDetails
2025-06-21 09:52:16,707 - d365 - ERROR - Failed to check D365 license for user 6b118526-2e12-40ee-b662-6afe7d588561: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6b118526-2e12-40ee-b662-6afe7d588561/licenseDetails
2025-06-21 09:52:16,830 - d365 - ERROR - Failed to check D365 license for user fa67fb83-388e-4dca-b6d5-86b9a7e9efb6: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/fa67fb83-388e-4dca-b6d5-86b9a7e9efb6/licenseDetails
2025-06-21 09:52:16,942 - d365 - ERROR - Failed to check D365 license for user 0e5074f9-539c-4294-af33-17d49be5882f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0e5074f9-539c-4294-af33-17d49be5882f/licenseDetails
2025-06-21 09:52:17,063 - d365 - ERROR - Failed to check D365 license for user 8f15fa2b-dec4-4f11-a274-b6b11d1b01d8: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8f15fa2b-dec4-4f11-a274-b6b11d1b01d8/licenseDetails
2025-06-21 09:52:17,146 - d365 - ERROR - Failed to check D365 license for user 15a2858c-a61d-4922-b73a-8aafff70a942: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/15a2858c-a61d-4922-b73a-8aafff70a942/licenseDetails
2025-06-21 09:52:17,232 - d365 - ERROR - Failed to check D365 license for user 3811229c-4468-48f4-bd39-32d7093393c5: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3811229c-4468-48f4-bd39-32d7093393c5/licenseDetails
2025-06-21 09:52:17,345 - d365 - ERROR - Failed to check D365 license for user d1a75cf4-af78-4dc4-a044-88ebe74a06fa: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d1a75cf4-af78-4dc4-a044-88ebe74a06fa/licenseDetails
2025-06-21 09:52:17,440 - d365 - ERROR - Failed to check D365 license for user b1ce00f3-ac3e-46e6-814c-e0134f1f1d6d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b1ce00f3-ac3e-46e6-814c-e0134f1f1d6d/licenseDetails
2025-06-21 09:52:17,540 - d365 - ERROR - Failed to check D365 license for user 2178a9b4-8307-4ab1-83b9-93310a4c9728: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2178a9b4-8307-4ab1-83b9-93310a4c9728/licenseDetails
2025-06-21 09:52:17,628 - d365 - ERROR - Failed to check D365 license for user 25dacb82-5251-4c72-b169-969637d4b37f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/25dacb82-5251-4c72-b169-969637d4b37f/licenseDetails
2025-06-21 09:52:17,731 - d365 - ERROR - Failed to check D365 license for user a563a897-74e6-4b56-876a-b9b6364d9382: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a563a897-74e6-4b56-876a-b9b6364d9382/licenseDetails
2025-06-21 09:52:18,212 - d365 - ERROR - Failed to check D365 license for user b03e8130-a5ab-41f3-b530-df1629e5cb5e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b03e8130-a5ab-41f3-b530-df1629e5cb5e/licenseDetails
2025-06-21 09:52:18,321 - d365 - ERROR - Failed to check D365 license for user 81b83502-2d74-45da-a497-0c669d50ed6c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/81b83502-2d74-45da-a497-0c669d50ed6c/licenseDetails
2025-06-21 09:52:18,447 - d365 - ERROR - Failed to check D365 license for user 8c1295d9-be86-48b3-9237-710c271ee2f4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8c1295d9-be86-48b3-9237-710c271ee2f4/licenseDetails
2025-06-21 09:52:18,557 - d365 - ERROR - Failed to check D365 license for user ce4c4c5d-dc2c-40d7-a9c1-078ec91f9667: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ce4c4c5d-dc2c-40d7-a9c1-078ec91f9667/licenseDetails
2025-06-21 09:52:18,641 - d365 - ERROR - Failed to check D365 license for user 67b31ea7-a96a-4ef1-82ca-774102f3fa1b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/67b31ea7-a96a-4ef1-82ca-774102f3fa1b/licenseDetails
2025-06-21 09:52:18,714 - d365 - ERROR - Failed to check D365 license for user 46dab2ea-757a-4bc4-9752-9efdbe9d0f0f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/46dab2ea-757a-4bc4-9752-9efdbe9d0f0f/licenseDetails
2025-06-21 09:52:18,808 - d365 - ERROR - Failed to check D365 license for user 131fd735-a66e-4ae7-a119-9cf2ba8d9879: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/131fd735-a66e-4ae7-a119-9cf2ba8d9879/licenseDetails
2025-06-21 09:52:18,916 - d365 - ERROR - Failed to check D365 license for user d9c7ad73-0d33-40e8-a207-c6e4600c3ef0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d9c7ad73-0d33-40e8-a207-c6e4600c3ef0/licenseDetails
2025-06-21 09:52:19,026 - d365 - ERROR - Failed to check D365 license for user 16d0163e-104e-4cf7-9e7c-d35e3b8dca2a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/16d0163e-104e-4cf7-9e7c-d35e3b8dca2a/licenseDetails
2025-06-21 09:52:19,130 - d365 - ERROR - Failed to check D365 license for user 36860932-dfe6-4bef-ad58-3b2e3a146329: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/36860932-dfe6-4bef-ad58-3b2e3a146329/licenseDetails
2025-06-21 09:52:19,243 - d365 - ERROR - Failed to check D365 license for user 05c7e7f7-f7d4-43e5-ab0e-89d59b50bb72: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/05c7e7f7-f7d4-43e5-ab0e-89d59b50bb72/licenseDetails
2025-06-21 09:52:19,332 - d365 - ERROR - Failed to check D365 license for user 19f50817-8ea4-4a1b-849d-4bafbedea468: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/19f50817-8ea4-4a1b-849d-4bafbedea468/licenseDetails
2025-06-21 09:52:19,462 - d365 - ERROR - Failed to check D365 license for user 8c012a26-eca0-4760-89ac-51be633029ec: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8c012a26-eca0-4760-89ac-51be633029ec/licenseDetails
2025-06-21 09:52:19,567 - d365 - ERROR - Failed to check D365 license for user 0bcca894-f81a-43f3-892e-a5af3164d6f8: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0bcca894-f81a-43f3-892e-a5af3164d6f8/licenseDetails
2025-06-21 09:52:19,645 - d365 - ERROR - Failed to check D365 license for user cb92afa6-893c-46ac-8e26-e88140f0c773: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cb92afa6-893c-46ac-8e26-e88140f0c773/licenseDetails
2025-06-21 09:52:19,747 - d365 - ERROR - Failed to check D365 license for user 83d0d673-368f-43bc-9d07-18b35cc2ff92: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/83d0d673-368f-43bc-9d07-18b35cc2ff92/licenseDetails
2025-06-21 09:52:19,814 - d365 - ERROR - Failed to check D365 license for user 3ceba639-94a9-4a53-a2f8-b1b1942dfa65: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3ceba639-94a9-4a53-a2f8-b1b1942dfa65/licenseDetails
2025-06-21 09:52:19,933 - d365 - ERROR - Failed to check D365 license for user 7576ea68-6d4c-4d8b-8b9b-172506f65e3c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/7576ea68-6d4c-4d8b-8b9b-172506f65e3c/licenseDetails
2025-06-21 09:52:20,074 - d365 - ERROR - Failed to check D365 license for user a90e1fe0-1acf-484c-9db8-79d28024e4a4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a90e1fe0-1acf-484c-9db8-79d28024e4a4/licenseDetails
2025-06-21 09:52:20,168 - d365 - ERROR - Failed to check D365 license for user 6dca83d0-3b0b-4fac-bf43-1b25f00c18d9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6dca83d0-3b0b-4fac-bf43-1b25f00c18d9/licenseDetails
2025-06-21 09:52:20,254 - d365 - ERROR - Failed to check D365 license for user 2fcf52b7-c185-4801-8c0f-41f2ee786589: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2fcf52b7-c185-4801-8c0f-41f2ee786589/licenseDetails
2025-06-21 09:52:20,357 - d365 - ERROR - Failed to check D365 license for user ee7ab89d-7719-4787-bae3-623f27404cd8: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ee7ab89d-7719-4787-bae3-623f27404cd8/licenseDetails
2025-06-21 09:52:20,454 - d365 - ERROR - Failed to check D365 license for user cb2dc21e-4e14-4983-b7d6-5e35da0dccc0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cb2dc21e-4e14-4983-b7d6-5e35da0dccc0/licenseDetails
2025-06-21 09:52:20,549 - d365 - ERROR - Failed to check D365 license for user 3a6d7054-f8fe-4480-b6bf-0e79986f57c3: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3a6d7054-f8fe-4480-b6bf-0e79986f57c3/licenseDetails
2025-06-21 09:52:20,636 - d365 - ERROR - Failed to check D365 license for user 8d6d1d99-f8fd-42e7-b8fd-804539ab38ae: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8d6d1d99-f8fd-42e7-b8fd-804539ab38ae/licenseDetails
2025-06-21 09:52:20,709 - d365 - ERROR - Failed to check D365 license for user 083c7a0a-6aa0-49e5-bc2c-e46a8d9dd111: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/083c7a0a-6aa0-49e5-bc2c-e46a8d9dd111/licenseDetails
2025-06-21 09:52:20,875 - d365 - ERROR - Failed to check D365 license for user d69d65eb-1457-4ef0-880d-834f8c4e324e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d69d65eb-1457-4ef0-880d-834f8c4e324e/licenseDetails
2025-06-21 09:52:20,967 - d365 - ERROR - Failed to check D365 license for user 647aca87-2095-452e-a5bd-3a9222e490b4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/647aca87-2095-452e-a5bd-3a9222e490b4/licenseDetails
2025-06-21 09:52:21,051 - d365 - ERROR - Failed to check D365 license for user 37ccc0c0-5517-4a9f-9d02-329acdca435e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/37ccc0c0-5517-4a9f-9d02-329acdca435e/licenseDetails
2025-06-21 09:52:21,194 - d365 - ERROR - Failed to check D365 license for user ef86d3f1-c8ad-4542-a15e-404a6515b110: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ef86d3f1-c8ad-4542-a15e-404a6515b110/licenseDetails
2025-06-21 09:52:21,290 - d365 - ERROR - Failed to check D365 license for user 91186cd8-e562-43ff-966a-b80986b14579: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/91186cd8-e562-43ff-966a-b80986b14579/licenseDetails
2025-06-21 09:52:21,365 - d365 - ERROR - Failed to check D365 license for user 8eaef83f-594c-45d3-851f-b0ecbf9e2f40: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8eaef83f-594c-45d3-851f-b0ecbf9e2f40/licenseDetails
2025-06-21 09:52:21,498 - d365 - ERROR - Failed to check D365 license for user 16b6badb-39c8-4867-950a-1f3103a36038: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/16b6badb-39c8-4867-950a-1f3103a36038/licenseDetails
2025-06-21 09:52:21,588 - d365 - ERROR - Failed to check D365 license for user 57ad98b1-49de-42d6-aa67-55a2e1ab4ec1: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/57ad98b1-49de-42d6-aa67-55a2e1ab4ec1/licenseDetails
2025-06-21 09:52:21,752 - d365 - ERROR - Failed to check D365 license for user 0fd0c241-3758-4674-919d-2e9f856028a9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0fd0c241-3758-4674-919d-2e9f856028a9/licenseDetails
2025-06-21 09:52:21,859 - d365 - ERROR - Failed to check D365 license for user c4728a54-94cd-4103-a2a8-1cd7f4699819: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c4728a54-94cd-4103-a2a8-1cd7f4699819/licenseDetails
2025-06-21 09:52:21,961 - d365 - ERROR - Failed to check D365 license for user 736eaf82-522f-46eb-b54a-6ecfc69ac4bf: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/736eaf82-522f-46eb-b54a-6ecfc69ac4bf/licenseDetails
2025-06-21 09:52:22,066 - d365 - ERROR - Failed to check D365 license for user 3f812204-c019-4afc-a195-3c813e43686d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/3f812204-c019-4afc-a195-3c813e43686d/licenseDetails
2025-06-21 09:52:22,158 - d365 - ERROR - Failed to check D365 license for user 2749bfd4-6168-49ad-98a5-87783b0df4ff: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2749bfd4-6168-49ad-98a5-87783b0df4ff/licenseDetails
2025-06-21 09:52:22,257 - d365 - ERROR - Failed to check D365 license for user 03f22b03-c7f4-4759-a575-fb1220c2652e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/03f22b03-c7f4-4759-a575-fb1220c2652e/licenseDetails
2025-06-21 09:52:22,386 - d365 - ERROR - Failed to check D365 license for user eae9e88c-e9f1-4a2f-afde-d75c404f0c68: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/eae9e88c-e9f1-4a2f-afde-d75c404f0c68/licenseDetails
2025-06-21 09:52:22,463 - d365 - ERROR - Failed to check D365 license for user 8d7de8a8-bdc4-4bc8-8fac-c335481ec4b7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8d7de8a8-bdc4-4bc8-8fac-c335481ec4b7/licenseDetails
2025-06-21 09:52:22,568 - d365 - ERROR - Failed to check D365 license for user 0cbda44d-8c02-4793-a3de-a4f9256e8d84: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0cbda44d-8c02-4793-a3de-a4f9256e8d84/licenseDetails
2025-06-21 09:52:22,670 - d365 - ERROR - Failed to check D365 license for user 2e5645c8-aae7-4bae-afcb-eb8eb03eec3d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2e5645c8-aae7-4bae-afcb-eb8eb03eec3d/licenseDetails
2025-06-21 09:52:22,758 - d365 - ERROR - Failed to check D365 license for user 5ddd2dc0-1d04-4d84-93f3-e57fad74523e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5ddd2dc0-1d04-4d84-93f3-e57fad74523e/licenseDetails
2025-06-21 09:52:22,864 - d365 - ERROR - Failed to check D365 license for user 418d8b69-5b1c-4836-b9a6-479c20dfc1d2: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/418d8b69-5b1c-4836-b9a6-479c20dfc1d2/licenseDetails
2025-06-21 09:52:22,963 - d365 - ERROR - Failed to check D365 license for user b2baaa4f-d4a0-4e38-879d-1cc687249fba: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b2baaa4f-d4a0-4e38-879d-1cc687249fba/licenseDetails
2025-06-21 09:52:23,077 - d365 - ERROR - Failed to check D365 license for user fbfa6bbc-8a99-454c-ab9a-d7a849b0a106: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/fbfa6bbc-8a99-454c-ab9a-d7a849b0a106/licenseDetails
2025-06-21 09:52:23,173 - d365 - ERROR - Failed to check D365 license for user 04f7b184-2750-4893-8b0b-57014dcde179: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/04f7b184-2750-4893-8b0b-57014dcde179/licenseDetails
2025-06-21 09:52:23,273 - d365 - ERROR - Failed to check D365 license for user a7387f54-4dc8-416f-b2be-6cb77c249931: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a7387f54-4dc8-416f-b2be-6cb77c249931/licenseDetails
2025-06-21 09:52:23,391 - d365 - ERROR - Failed to check D365 license for user 34fbd7f6-e5dd-44d5-9567-42a75f3ae504: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/34fbd7f6-e5dd-44d5-9567-42a75f3ae504/licenseDetails
2025-06-21 09:52:23,476 - d365 - ERROR - Failed to check D365 license for user f9b17e12-934d-49fc-a7d0-0945511c61be: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f9b17e12-934d-49fc-a7d0-0945511c61be/licenseDetails
2025-06-21 09:52:23,597 - d365 - ERROR - Failed to check D365 license for user b4ed5518-211e-4a7a-a802-2c1cbea88137: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/b4ed5518-211e-4a7a-a802-2c1cbea88137/licenseDetails
2025-06-21 09:52:23,723 - d365 - ERROR - Failed to check D365 license for user 169a4569-cc18-43aa-ab8a-f1e9f119ddf2: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/169a4569-cc18-43aa-ab8a-f1e9f119ddf2/licenseDetails
2025-06-21 09:52:23,833 - d365 - ERROR - Failed to check D365 license for user 06a03590-45db-402c-9e61-0f32d40a17ed: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/06a03590-45db-402c-9e61-0f32d40a17ed/licenseDetails
2025-06-21 09:52:23,944 - d365 - ERROR - Failed to check D365 license for user 43a59832-e855-4adb-be7a-b7912cb49a15: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/43a59832-e855-4adb-be7a-b7912cb49a15/licenseDetails
2025-06-21 09:52:24,067 - d365 - ERROR - Failed to check D365 license for user 941c77d8-13f7-40a7-b656-5ebe45e16191: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/941c77d8-13f7-40a7-b656-5ebe45e16191/licenseDetails
2025-06-21 09:52:24,216 - d365 - ERROR - Failed to check D365 license for user 4952a6f9-19af-41a1-a8f4-b73850f0b020: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4952a6f9-19af-41a1-a8f4-b73850f0b020/licenseDetails
2025-06-21 09:52:24,309 - d365 - ERROR - Failed to check D365 license for user 77d49aa5-7b5f-4a0f-a8f4-6762dcde2d01: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/77d49aa5-7b5f-4a0f-a8f4-6762dcde2d01/licenseDetails
2025-06-21 09:52:24,436 - d365 - ERROR - Failed to check D365 license for user d716f427-0faf-4441-9cfa-96b8931e3bca: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d716f427-0faf-4441-9cfa-96b8931e3bca/licenseDetails
2025-06-21 09:52:24,798 - d365 - ERROR - Failed to check D365 license for user 22f074a3-f331-4ba5-a5c3-aa0e8af9b61e: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/22f074a3-f331-4ba5-a5c3-aa0e8af9b61e/licenseDetails
2025-06-21 09:52:24,897 - d365 - ERROR - Failed to check D365 license for user dd00d73f-1974-4492-a17e-22d6229098ed: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/dd00d73f-1974-4492-a17e-22d6229098ed/licenseDetails
2025-06-21 09:52:25,017 - d365 - ERROR - Failed to check D365 license for user 89bd5d92-b8b0-40d3-bc14-1bf0688cf563: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/89bd5d92-b8b0-40d3-bc14-1bf0688cf563/licenseDetails
2025-06-21 09:52:25,134 - d365 - ERROR - Failed to check D365 license for user cb41143a-ce9c-4ce3-83af-07a3f64a1b2c: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/cb41143a-ce9c-4ce3-83af-07a3f64a1b2c/licenseDetails
2025-06-21 09:52:25,253 - d365 - ERROR - Failed to check D365 license for user ce7e2d24-175d-46f0-9e7a-79f03388b27b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ce7e2d24-175d-46f0-9e7a-79f03388b27b/licenseDetails
2025-06-21 09:52:25,399 - d365 - ERROR - Failed to check D365 license for user 8d4d60a5-4e77-4cb2-86ba-dec3960e79dd: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8d4d60a5-4e77-4cb2-86ba-dec3960e79dd/licenseDetails
2025-06-21 09:52:25,527 - d365 - ERROR - Failed to check D365 license for user 1874f963-b9b0-4c2a-a30b-24974a648db4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1874f963-b9b0-4c2a-a30b-24974a648db4/licenseDetails
2025-06-21 09:52:25,631 - d365 - ERROR - Failed to check D365 license for user 27d30477-7bce-4433-b5f8-3769a8a906ca: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/27d30477-7bce-4433-b5f8-3769a8a906ca/licenseDetails
2025-06-21 09:52:25,742 - d365 - ERROR - Failed to check D365 license for user f5171746-0248-4d03-8228-86376434a4e2: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f5171746-0248-4d03-8228-86376434a4e2/licenseDetails
2025-06-21 09:52:25,874 - d365 - ERROR - Failed to check D365 license for user 46aee3ae-b46f-4737-a826-87ff31e6c3ff: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/46aee3ae-b46f-4737-a826-87ff31e6c3ff/licenseDetails
2025-06-21 09:52:25,992 - d365 - ERROR - Failed to check D365 license for user e619b096-6008-400f-8e23-2881d4027854: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e619b096-6008-400f-8e23-2881d4027854/licenseDetails
2025-06-21 09:52:26,080 - d365 - ERROR - Failed to check D365 license for user f1d67c0b-e900-4168-a8d2-6cbd79043fc6: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f1d67c0b-e900-4168-a8d2-6cbd79043fc6/licenseDetails
2025-06-21 09:52:26,202 - d365 - ERROR - Failed to check D365 license for user 972fb710-855b-4419-b3d7-8955aa74633f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/972fb710-855b-4419-b3d7-8955aa74633f/licenseDetails
2025-06-21 09:52:26,333 - d365 - ERROR - Failed to check D365 license for user 456a4348-1274-4f9f-af88-3b8a227260d9: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/456a4348-1274-4f9f-af88-3b8a227260d9/licenseDetails
2025-06-21 09:52:26,461 - d365 - ERROR - Failed to check D365 license for user 582cba2f-cca4-4682-9426-a90af57f6420: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/582cba2f-cca4-4682-9426-a90af57f6420/licenseDetails
2025-06-21 09:52:26,543 - d365 - ERROR - Failed to check D365 license for user 5a2146da-9585-449c-a023-332c966db3c0: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5a2146da-9585-449c-a023-332c966db3c0/licenseDetails
2025-06-21 09:52:26,655 - d365 - ERROR - Failed to check D365 license for user c987a838-985f-48f0-bbb0-dcf824cba0da: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c987a838-985f-48f0-bbb0-dcf824cba0da/licenseDetails
2025-06-21 09:52:26,757 - d365 - ERROR - Failed to check D365 license for user db40f433-fef5-42c3-a2fa-a6729ef6abe7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/db40f433-fef5-42c3-a2fa-a6729ef6abe7/licenseDetails
2025-06-21 09:52:26,901 - d365 - ERROR - Failed to check D365 license for user c654e45a-45bd-498a-8dc1-10c0f6785736: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/c654e45a-45bd-498a-8dc1-10c0f6785736/licenseDetails
2025-06-21 09:52:27,017 - d365 - ERROR - Failed to check D365 license for user 723fef2a-d465-4ff1-b2e9-2cd70e89a883: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/723fef2a-d465-4ff1-b2e9-2cd70e89a883/licenseDetails
2025-06-21 09:52:27,114 - d365 - ERROR - Failed to check D365 license for user 103a436c-9450-44ae-9d96-4ad840c2d58b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/103a436c-9450-44ae-9d96-4ad840c2d58b/licenseDetails
2025-06-21 09:52:27,255 - d365 - ERROR - Failed to check D365 license for user 1c895f73-b75c-4d4d-aec2-265ad6617765: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1c895f73-b75c-4d4d-aec2-265ad6617765/licenseDetails
2025-06-21 09:52:27,355 - d365 - ERROR - Failed to check D365 license for user 6d89205a-14dc-44bc-8c37-9f448dc639a7: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/6d89205a-14dc-44bc-8c37-9f448dc639a7/licenseDetails
2025-06-21 09:52:27,482 - d365 - ERROR - Failed to check D365 license for user 15b0c911-e4f5-4552-a731-ab5c870789ea: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/15b0c911-e4f5-4552-a731-ab5c870789ea/licenseDetails
2025-06-21 09:52:27,583 - d365 - ERROR - Failed to check D365 license for user ecf956c5-083e-4d52-86cd-a1876c58bead: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/ecf956c5-083e-4d52-86cd-a1876c58bead/licenseDetails
2025-06-21 09:52:27,715 - d365 - ERROR - Failed to check D365 license for user 38638d06-9c44-418f-8be6-2247be5924ec: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/38638d06-9c44-418f-8be6-2247be5924ec/licenseDetails
2025-06-21 09:52:27,836 - d365 - ERROR - Failed to check D365 license for user 987d39e4-ba98-48db-b25b-8ec0328c6b3b: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/987d39e4-ba98-48db-b25b-8ec0328c6b3b/licenseDetails
2025-06-21 09:52:27,970 - d365 - ERROR - Failed to check D365 license for user 68c8abf0-36f0-4372-b2c3-bb54b5e6c1f4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/68c8abf0-36f0-4372-b2c3-bb54b5e6c1f4/licenseDetails
2025-06-21 09:52:28,099 - d365 - ERROR - Failed to check D365 license for user a657e3e2-3fa1-4f19-b9eb-62683a767729: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/a657e3e2-3fa1-4f19-b9eb-62683a767729/licenseDetails
2025-06-21 09:52:28,197 - d365 - ERROR - Failed to check D365 license for user 0b8e5050-e927-44ff-9dc0-ffdc9bf63631: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/0b8e5050-e927-44ff-9dc0-ffdc9bf63631/licenseDetails
2025-06-21 09:52:28,307 - d365 - ERROR - Failed to check D365 license for user 5f0a60c0-f87e-49bb-8512-9cffc1997342: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5f0a60c0-f87e-49bb-8512-9cffc1997342/licenseDetails
2025-06-21 09:52:28,395 - d365 - ERROR - Failed to check D365 license for user 19062206-b008-4fa4-bd87-96be0f29f22a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/19062206-b008-4fa4-bd87-96be0f29f22a/licenseDetails
2025-06-21 09:52:28,502 - d365 - ERROR - Failed to check D365 license for user d1df6d9c-9e84-4709-b859-4c5da3a5b3ee: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/d1df6d9c-9e84-4709-b859-4c5da3a5b3ee/licenseDetails
2025-06-21 09:52:28,622 - d365 - ERROR - Failed to check D365 license for user 2f980501-13f4-47c2-aa23-996ff5c1b44d: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/2f980501-13f4-47c2-aa23-996ff5c1b44d/licenseDetails
2025-06-21 09:52:28,702 - d365 - ERROR - Failed to check D365 license for user 924dcc50-f117-44c7-928c-4d5dc33bd1c3: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/924dcc50-f117-44c7-928c-4d5dc33bd1c3/licenseDetails
2025-06-21 09:52:28,790 - d365 - ERROR - Failed to check D365 license for user e4c602ea-c238-4ca4-aef2-c85723f33fa1: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/e4c602ea-c238-4ca4-aef2-c85723f33fa1/licenseDetails
2025-06-21 09:52:28,896 - d365 - ERROR - Failed to check D365 license for user 4e17bb12-92c3-4986-a145-4904f902ed8f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/4e17bb12-92c3-4986-a145-4904f902ed8f/licenseDetails
2025-06-21 09:52:29,038 - d365 - ERROR - Failed to check D365 license for user 914db31b-1b41-43c3-92fe-079cb47d641f: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/914db31b-1b41-43c3-92fe-079cb47d641f/licenseDetails
2025-06-21 09:52:29,131 - d365 - ERROR - Failed to check D365 license for user 8a12f6ff-670c-4bc6-bc95-3e656a9be619: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8a12f6ff-670c-4bc6-bc95-3e656a9be619/licenseDetails
2025-06-21 09:52:29,247 - d365 - ERROR - Failed to check D365 license for user f6ce95a7-04df-4fd4-b625-679b216a4ab4: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/f6ce95a7-04df-4fd4-b625-679b216a4ab4/licenseDetails
2025-06-21 09:52:29,354 - d365 - ERROR - Failed to check D365 license for user 610e9191-b511-4cc9-9990-0836728761ee: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/610e9191-b511-4cc9-9990-0836728761ee/licenseDetails
2025-06-21 09:52:29,420 - d365 - ERROR - Failed to check D365 license for user 1ce1ccae-ba59-4d54-8450-26e55721c213: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1ce1ccae-ba59-4d54-8450-26e55721c213/licenseDetails
2025-06-21 09:52:29,510 - d365 - ERROR - Failed to check D365 license for user 5b13bd8c-aeb8-4a36-80a6-effca05ae94a: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/5b13bd8c-aeb8-4a36-80a6-effca05ae94a/licenseDetails
2025-06-21 09:52:29,617 - d365 - ERROR - Failed to check D365 license for user 8d5429c6-df27-449e-baca-523753e23005: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/8d5429c6-df27-449e-baca-523753e23005/licenseDetails
2025-06-21 09:52:29,910 - d365 - ERROR - Failed to check D365 license for user 1440a2d4-2117-4f77-b75a-81b4fba678db: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/1440a2d4-2117-4f77-b75a-81b4fba678db/licenseDetails
2025-06-21 09:52:30,006 - d365 - ERROR - Failed to check D365 license for user 55aaf4fc-cfa3-4de0-ae6f-40b17de4e574: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/55aaf4fc-cfa3-4de0-ae6f-40b17de4e574/licenseDetails
2025-06-21 09:52:30,008 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-21 09:52:30,008 - d365 - INFO - Filtered out 470 D365 users without a D365 license
2025-06-21 09:52:30,008 - d365 - INFO - Final user count after filtering: 49
2025-06-21 09:52:30,010 - d365 - INFO - Fetched 49 user details after filtering
2025-06-21 09:52:30,013 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-21 09:52:30,021 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-21 09:52:30,030 - d365 - INFO - Saved 470 users without D365 license to data/users_without_d365_license.csv
2025-06-21 09:52:30,032 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:52:30,162 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3df147f8-5800-4d0b-8758-b81cbb1d1f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:30 GMT'
    'Content-Length': '1753'
2025-06-21 09:52:30,164 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:52:30,324 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b8512124-e607-4c17-a25a-b88e28452600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:30 GMT'
    'Content-Length': '1648'
2025-06-21 09:52:30,326 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:52:30,326 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 09:52:31,891 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-21 09:52:31,898 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-21 09:52:31,900 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:52:32,135 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6e9f2954-9848-43d6-87ff-3d47130e1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:33 GMT'
    'Content-Length': '1753'
2025-06-21 09:52:32,137 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:52:32,264 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c817a0e3-bd4d-4b18-97a1-d7eed3491d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:33 GMT'
    'Content-Length': '1653'
2025-06-21 09:52:32,265 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:52:32,265 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 09:52:34,518 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-21 09:52:34,527 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-21 09:52:34,530 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:52:34,717 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6ae3b5a1-7b8d-4046-9c80-47ff1b121d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:35 GMT'
    'Content-Length': '1753'
2025-06-21 09:52:34,719 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:52:34,925 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6ae3b5a1-7b8d-4046-9c80-47ff22121d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:35 GMT'
    'Content-Length': '1995'
2025-06-21 09:52:34,926 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:52:34,927 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 09:52:37,641 - d365 - INFO - Fetched 35 conditional access policies
2025-06-21 09:52:37,647 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-21 09:52:37,648 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:52:37,856 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '94997a85-4017-4b21-8da8-64dd08002900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:38 GMT'
    'Content-Length': '1753'
2025-06-21 09:52:37,858 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:52:38,080 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8084fd52-6c39-4faa-bccf-46cece8e1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:22:38 GMT'
    'Content-Length': '1647'
2025-06-21 09:52:38,081 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:52:38,082 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 09:52:38,773 - d365 - INFO - Fetched 11 business units
2025-06-21 09:52:38,777 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-21 09:52:38,797 - d365 - INFO - D365 data loaded successfully
2025-06-21 09:52:38,828 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-21 09:52:38,829 - main - INFO - Loading data from CSV files
2025-06-21 09:52:38,950 - main - INFO - Loaded audit_logs with 32321 rows
2025-06-21 09:52:39,015 - main - INFO - Loaded signin_logs with 5448 rows
2025-06-21 09:52:39,058 - main - INFO - Loaded user_details with 49 rows
2025-06-21 09:52:39,069 - main - INFO - Loaded app_roles with 2112 rows
2025-06-21 09:52:39,117 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-21 09:52:39,278 - main - INFO - Created group_memberships with 834 rows
2025-06-21 09:52:39,324 - main - INFO - Created role_matrix with 2112 rows
2025-06-21 09:52:39,337 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-21 09:52:39,337 - main - WARNING - Found 75 users in signin_logs not present in user_details: ['ee7ab89d-7719-4787-bae3-623f27404cd8', 'e5f47082-e16b-4429-9d36-09d4b1354a24', 'd373c19a-2bb2-4488-94a2-db96409ca507', 'f777b683-9def-4137-98a3-06e33f07fcc7', 'ef1c2a87-16f1-4b8a-80ea-085461674495']...
2025-06-21 09:52:39,339 - main - WARNING - Found 319 users in app_role_assignments not present in user_details: ['eb1833bb-d023-ec11-b6e5-000d3adb194e', '69b5c94e-8533-ec11-b6e6-0022489bd51d', '94013bec-6bb7-ec11-9840-000d3a65f2bf', '3ce80ea6-76b4-eb11-8236-000d3ab6406f', '5ab4c94e-8533-ec11-b6e6-0022489bd51d']...
2025-06-21 09:52:39,339 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-21 09:52:39,346 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-21 09:52:39,347 - src.core.embeddings - INFO - Starting embedding generation
2025-06-21 09:52:39,347 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-21 09:52:39,348 - src.core.embeddings - INFO - Using batch_size=64
2025-06-21 09:52:39,349 - src.core.embeddings - INFO - Using device: cpu
2025-06-21 09:53:26,481 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-21 09:53:30,929 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-21 09:53:30,930 - src.core.embeddings - INFO - Embedding initialization took 51.58 seconds
2025-06-21 09:53:30,931 - src.core.embeddings - INFO - Memory usage: RSS=376.18 MB, VMS=2704.34 MB
2025-06-21 09:53:30,932 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-21 09:53:30,933 - src.core.embeddings - INFO - Using all logs: audit_logs=32321 rows, signin_logs=5448 rows
2025-06-21 09:53:30,940 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-21 09:53:30,973 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-21 09:53:31,738 - src.core.embeddings - INFO - Text generation took 0.81 seconds
2025-06-21 09:53:31,738 - src.core.embeddings - INFO - Memory usage: RSS=401.55 MB, VMS=2728.87 MB
2025-06-21 09:53:31,739 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-21 09:53:33,825 - src.core.embeddings - INFO - Total documents to embed: 37769
2025-06-21 09:53:33,826 - src.core.embeddings - INFO - Document conversion took 2.09 seconds
2025-06-21 09:53:33,826 - src.core.embeddings - INFO - Memory usage: RSS=431.23 MB, VMS=2758.93 MB
2025-06-21 09:53:33,826 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-21 09:53:33,829 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-21 09:53:45,836 - src.core.embeddings - INFO - Memory usage: RSS=598.07 MB, VMS=2943.80 MB
2025-06-21 09:53:45,836 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-21 09:54:00,520 - src.core.embeddings - INFO - Memory usage: RSS=672.86 MB, VMS=3016.84 MB
2025-06-21 09:54:00,521 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-21 09:54:10,953 - src.core.embeddings - INFO - Memory usage: RSS=748.03 MB, VMS=3091.79 MB
2025-06-21 09:54:10,954 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-21 09:54:22,693 - src.core.embeddings - INFO - Memory usage: RSS=822.04 MB, VMS=3166.37 MB
2025-06-21 09:54:22,693 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-21 09:54:34,053 - src.core.embeddings - INFO - Memory usage: RSS=886.57 MB, VMS=3241.29 MB
2025-06-21 09:54:34,053 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-21 09:54:46,204 - src.core.embeddings - INFO - Memory usage: RSS=960.12 MB, VMS=3315.36 MB
2025-06-21 09:54:46,205 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-21 09:55:14,242 - src.core.embeddings - INFO - Memory usage: RSS=1217.20 MB, VMS=3570.36 MB
2025-06-21 09:55:14,242 - src.core.embeddings - INFO - Embedding chunk 8/8 (2769 documents)
2025-06-21 09:55:34,159 - src.core.embeddings - INFO - Memory usage: RSS=1257.21 MB, VMS=3612.15 MB
2025-06-21 09:55:34,505 - src.core.embeddings - INFO - Embedding generation took 120.68 seconds
2025-06-21 09:55:34,506 - src.core.embeddings - INFO - Memory usage: RSS=1257.21 MB, VMS=3612.15 MB
2025-06-21 09:55:34,506 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-21 09:55:35,224 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37769 vectors
2025-06-21 09:55:36,211 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-21 09:55:36,224 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-21 09:55:36,224 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-21 09:55:36,225 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.72 seconds
2025-06-21 09:55:36,225 - src.core.embeddings - INFO - Memory usage: RSS=1460.10 MB, VMS=3949.61 MB
2025-06-21 09:55:36,237 - src.core.embeddings - INFO - Total embedding generation took 176.89 seconds
2025-06-21 09:55:36,267 - main - INFO - [analyze] Embeddings generated.
2025-06-21 09:55:36,268 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-21 09:55:36,268 - src.utils.config - INFO - Loading environment variables
2025-06-21 09:55:36,270 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-21 09:55:36,270 - src.core.analysis - INFO - Validating input DataFrames
2025-06-21 09:55:36,341 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-21 09:55:36,342 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-21 09:55:36,343 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-21 09:55:36,344 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-21 09:55:36,344 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-21 09:55:36,351 - src.core.analysis - INFO - User IDs from user_details: 49
2025-06-21 09:55:36,351 - src.core.analysis - INFO - User IDs from signin_logs: 75
2025-06-21 09:55:36,351 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-21 09:55:36,352 - src.core.analysis - INFO - User IDs from app_role_assignments: 335
2025-06-21 09:55:36,352 - src.core.analysis - INFO - Total unique user IDs: 444
2025-06-21 09:55:37,605 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-21 09:55:37,614 - d365 - INFO - Loading D365 data
2025-06-21 09:55:37,615 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:55:37,841 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '808691ea-abb5-496c-825b-31ee5c111d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:25:38 GMT'
    'Content-Length': '1753'
2025-06-21 09:55:37,843 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:55:38,053 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '813d525a-5a1e-4bd6-bb8e-6c8df62c1d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:25:38 GMT'
    'Content-Length': '1647'
2025-06-21 09:55:38,054 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:55:38,055 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 09:55:38,058 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-23T04:25:38Z)
2025-06-21 09:55:42,170 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-21 09:55:45,134 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-21 09:55:48,274 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-21 09:55:51,242 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-21 09:55:54,272 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-21 09:55:57,005 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-21 09:55:58,495 - d365 - INFO - Progress: Fetched 32139 audit logs after 7 pages
2025-06-21 09:55:58,517 - d365 - INFO - Fetched 32139 D365 audit logs via Dataverse
2025-06-21 09:55:58,568 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-21 09:55:58,571 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:55:58,767 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e6b8cca9-573d-4f76-bb85-95b2861f2800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:25:59 GMT'
    'Content-Length': '1753'
2025-06-21 09:55:58,768 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:55:59,058 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8df991b5-a339-4148-9504-0925a3022000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:25:59 GMT'
    'Content-Length': '1997'
2025-06-21 09:55:59,059 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:55:59,060 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 09:55:59,060 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-23T04:25:59Z)
2025-06-21 09:55:59,060 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-21 09:56:07,347 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 7.2 req/min | Time: 0:00:08
2025-06-21 09:56:17,014 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 6.7 req/min | Time: 0:00:17
2025-06-21 09:56:29,415 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.9 req/min | Time: 0:00:30
2025-06-21 09:56:41,787 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.6 req/min | Time: 0:00:42
2025-06-21 09:56:52,342 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.6 req/min | Time: 0:00:53
2025-06-21 09:56:56,886 - d365 - INFO - Progress: 5,513 records | Pages: 6 | Requests: 6 | Rate: 6.2 req/min | Time: 0:00:57
2025-06-21 09:56:57,387 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-22T04:26:13Z to 2025-06-21T03:00:45Z
2025-06-21 09:56:57,470 - d365 - INFO - Fetch completed: 5,513 records in 0:00:58
2025-06-21 09:56:57,470 - d365 - INFO - Total requests made: 6
2025-06-21 09:56:57,477 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:56:57,848 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b4d45764-f1c5-49ee-9f41-d5b140051f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:26:58 GMT'
    'Content-Length': '1753'
2025-06-21 09:56:57,851 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:56:58,053 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'fddd2e28-1000-4bdf-8771-c48179a72000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:26:59 GMT'
    'Content-Length': '1651'
2025-06-21 09:56:58,055 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:56:58,056 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 09:56:58,057 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:56:58,328 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '49f5e548-66bd-4531-82de-b6ab120f2800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:26:59 GMT'
    'Content-Length': '1753'
2025-06-21 09:56:58,329 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:56:58,593 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '877e33db-9e2c-46d7-b174-92e4615d1c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:26:59 GMT'
    'Content-Length': '1989'
2025-06-21 09:56:58,594 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:56:58,595 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 09:56:58,596 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 09:56:58,871 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a4daf6b3-bc96-4cc4-bd68-c02562941e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:26:58 GMT'
    'Content-Length': '1753'
2025-06-21 09:56:58,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 09:56:59,083 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '30849673-7c5d-4104-98f9-19e4e9171e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:27:00 GMT'
    'Content-Length': '1991'
2025-06-21 09:56:59,084 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 09:56:59,084 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 09:57:01,433 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-21 09:57:01,434 - d365 - INFO - Found 981 users in Entra ID
2025-06-21 09:57:02,592 - d365 - INFO - Fetched 936 user records from D365
2025-06-21 09:57:59,597 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-21 09:57:59,598 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-21 09:58:47,374 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 09:59:02,260 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 09:59:02,261 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 09:59:02,261 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 09:59:02,263 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 09:59:02,263 - main - INFO - FastAPI application started
2025-06-21 10:05:08,467 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:05:08,469 - main - INFO - FastAPI application shutdown
2025-06-21 10:05:27,314 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:05:41,392 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:05:41,392 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:05:41,393 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:05:41,394 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:05:41,395 - main - INFO - FastAPI application started
2025-06-21 10:05:44,007 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:05:44,008 - main - INFO - FastAPI application shutdown
2025-06-21 10:05:55,424 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:05:59,623 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:05:59,624 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:05:59,624 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:05:59,626 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:05:59,626 - main - INFO - FastAPI application started
2025-06-21 10:07:59,582 - d365 - INFO - Loading D365 data
2025-06-21 10:07:59,583 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:07:59,886 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '92559661-6bee-4ccd-9c21-1c7960ff2300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:38:00 GMT'
    'Content-Length': '1753'
2025-06-21 10:07:59,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:08:00,126 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '808691ea-abb5-496c-825b-31eea4321d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:38:00 GMT'
    'Content-Length': '1651'
2025-06-21 10:08:00,128 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:08:00,128 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:08:00,129 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-23T04:38:00Z)
2025-06-21 10:08:05,775 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-21 10:08:08,952 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-21 10:08:11,709 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-21 10:08:14,607 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-21 10:08:17,408 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-21 10:08:19,946 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-21 10:08:21,394 - d365 - INFO - Progress: Fetched 32139 audit logs after 7 pages
2025-06-21 10:08:21,436 - d365 - INFO - Fetched 32139 D365 audit logs via Dataverse
2025-06-21 10:08:21,568 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-21 10:08:21,576 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:08:21,803 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '89854361-4b45-43aa-a223-247d62952100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:38:22 GMT'
    'Content-Length': '1753'
2025-06-21 10:08:21,805 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:08:22,066 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '53fff2a5-6086-488d-97c9-5de466592100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:38:22 GMT'
    'Content-Length': '1991'
2025-06-21 10:08:22,067 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:08:22,068 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:08:22,068 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-23T04:38:22Z)
2025-06-21 10:08:22,069 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-21 10:08:29,877 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 7.7 req/min | Time: 0:00:07
2025-06-21 10:08:38,566 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 7.3 req/min | Time: 0:00:16
2025-06-21 10:08:59,086 - d365 - ERROR - Failed to fetch sign-in logs page https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-23T04%3a38%3a22Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=581f75349dcecfa30455a375c0a5d5b4e93f1436303ee841ee035112e052248a: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-21 10:08:59,086 - d365 - ERROR - Error fetching page for URL https://graph.microsoft.com/v1.0/auditLogs/signIns?$top=1000&$filter=createdDateTime+ge+2025-03-23T04%3a38%3a22Z+and+appId+eq+%27a8adde6c-aeb4-4fd6-9d8f-c2dfdecac60a%27&$skiptoken=581f75349dcecfa30455a375c0a5d5b4e93f1436303ee841ee035112e052248a: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-21 10:08:59,087 - d365 - ERROR - Failed to fetch sign-in logs: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=20)
2025-06-21 10:08:59,134 - d365 - INFO - Loaded 5513 sign-in logs from CSV
2025-06-21 10:08:59,137 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:08:59,437 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'cc52b4e3-cd7e-4b99-8a01-c1e2f64a1e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:38:59 GMT'
    'Content-Length': '1753'
2025-06-21 10:08:59,438 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:08:59,649 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ff7ed40f-3fb2-4cd3-90b3-fbc05da41f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:39:00 GMT'
    'Content-Length': '1651'
2025-06-21 10:08:59,650 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:08:59,650 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:08:59,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:08:59,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ab598f85-e058-45bd-b686-6602531a2500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:38:59 GMT'
    'Content-Length': '1753'
2025-06-21 10:08:59,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:09:00,134 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '950df1c2-323c-47c4-89a7-7d30bfd42000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:39:00 GMT'
    'Content-Length': '1996'
2025-06-21 10:09:00,134 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:09:00,135 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:09:00,135 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:09:00,431 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a25f8d49-b796-4447-b1e5-fa778b661b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:39:01 GMT'
    'Content-Length': '1753'
2025-06-21 10:09:00,433 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:09:00,662 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd5dba252-97e6-4f48-bc0f-619ce8531d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:39:01 GMT'
    'Content-Length': '1995'
2025-06-21 10:09:00,663 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:09:00,663 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:09:02,747 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-21 10:09:02,748 - d365 - INFO - Found 981 users in Entra ID
2025-06-21 10:09:03,885 - d365 - INFO - Fetched 936 user records from D365
2025-06-21 10:10:01,324 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-21 10:10:01,327 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-21 10:10:36,826 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-21 10:10:36,829 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-21 10:10:38,960 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-21 10:10:38,961 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-21 10:10:43,122 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-21 10:10:43,123 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-21 10:11:26,075 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-21 10:11:26,077 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-21 10:12:01,049 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:12:05,974 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:12:05,976 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:12:05,977 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:12:05,980 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:12:05,980 - main - INFO - FastAPI application started
2025-06-21 10:12:54,922 - d365 - INFO - Loading D365 data
2025-06-21 10:12:54,925 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:12:55,174 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6dc6f25f-4fe3-49a3-a580-74ab95261600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:42:55 GMT'
    'Content-Length': '1753'
2025-06-21 10:12:55,192 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:12:55,416 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3764747a-27bd-44dc-ac14-ac730bd90500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:42:56 GMT'
    'Content-Length': '1645'
2025-06-21 10:12:55,417 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:12:55,417 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:12:55,418 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-23T04:42:55Z)
2025-06-21 10:12:59,069 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-21 10:13:01,633 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-21 10:13:04,248 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-21 10:13:06,830 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-21 10:13:09,381 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-21 10:13:11,746 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-21 10:13:12,908 - d365 - INFO - Progress: Fetched 32138 audit logs after 7 pages
2025-06-21 10:13:12,967 - d365 - INFO - Fetched 32138 D365 audit logs via Dataverse
2025-06-21 10:13:13,078 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-21 10:13:13,084 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:13:13,353 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd0e6529f-f25c-49da-beca-8aebec961200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:43:14 GMT'
    'Content-Length': '1753'
2025-06-21 10:13:13,355 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:13:13,562 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f6d32829-d7fd-4dd8-adeb-c0d989081a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:43:14 GMT'
    'Content-Length': '1991'
2025-06-21 10:13:13,564 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:13:13,565 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:13:13,565 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-23T04:43:13Z)
2025-06-21 10:13:13,566 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-21 10:13:25,355 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 5.1 req/min | Time: 0:00:11
2025-06-21 10:13:35,212 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 5.5 req/min | Time: 0:00:21
2025-06-21 10:13:44,779 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 5.8 req/min | Time: 0:00:31
2025-06-21 10:13:56,709 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 5.6 req/min | Time: 0:00:43
2025-06-21 10:14:06,565 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 5.7 req/min | Time: 0:00:52
2025-06-21 10:14:11,576 - d365 - INFO - Progress: 5,500 records | Pages: 6 | Requests: 6 | Rate: 6.2 req/min | Time: 0:00:58
2025-06-21 10:14:12,077 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-22T04:53:26Z to 2025-06-21T04:38:46Z
2025-06-21 10:14:12,126 - d365 - INFO - Fetch completed: 5,500 records in 0:00:58
2025-06-21 10:14:12,127 - d365 - INFO - Total requests made: 6
2025-06-21 10:14:12,132 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:14:12,242 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '08dd70e3-531a-4f85-ad99-621203cb0900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:44:13 GMT'
    'Content-Length': '1753'
2025-06-21 10:14:12,243 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:14:12,451 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3626ded3-2f9b-47eb-95a4-a3aa9d071800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:44:13 GMT'
    'Content-Length': '1647'
2025-06-21 10:14:12,452 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:14:12,452 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:14:12,453 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:14:12,629 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c34da2fb-6cd2-4572-8b4b-fb79c0910100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:44:13 GMT'
    'Content-Length': '1753'
2025-06-21 10:14:12,630 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:14:12,795 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '304e3a9e-634c-4d8e-82dc-6a348c411c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:44:13 GMT'
    'Content-Length': '1992'
2025-06-21 10:14:12,796 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:14:12,796 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:14:12,797 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:14:13,006 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7821745a-da35-483d-af26-85bab6e41e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:44:13 GMT'
    'Content-Length': '1753'
2025-06-21 10:14:13,007 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:14:13,201 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6a28ace3-0379-4b25-af29-48a767c82000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:44:13 GMT'
    'Content-Length': '1991'
2025-06-21 10:14:13,202 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:14:13,202 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:14:15,208 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-21 10:14:15,209 - d365 - INFO - Found 981 users in Entra ID
2025-06-21 10:14:16,336 - d365 - INFO - Fetched 936 user records from D365
2025-06-21 10:15:13,753 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-21 10:15:13,754 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-21 10:15:50,076 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-21 10:15:50,077 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-21 10:15:52,222 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-21 10:15:52,224 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-21 10:15:56,631 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-21 10:15:56,632 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-21 10:16:39,105 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-21 10:16:39,106 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-21 10:17:03,333 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-21 10:17:03,334 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-21 10:17:17,358 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-21 10:17:17,360 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-21 10:17:53,431 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-21 10:17:53,431 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-21 10:17:53,432 - d365 - INFO - Final user count after filtering: 205
2025-06-21 10:17:53,433 - d365 - INFO - Fetched 205 user details after filtering
2025-06-21 10:17:53,447 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-21 10:17:53,456 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-21 10:17:53,460 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-21 10:17:53,465 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:17:53,761 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6d9d4ab5-0a46-4ac9-90ef-78a24a821b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:47:54 GMT'
    'Content-Length': '1753'
2025-06-21 10:17:53,762 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:17:53,915 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e54ed2d5-dd4d-4816-8f9a-1bb871a72200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:47:54 GMT'
    'Content-Length': '1653'
2025-06-21 10:17:53,916 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:17:53,916 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:17:55,151 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-21 10:17:55,155 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-21 10:17:55,156 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:17:55,354 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2fb9d674-483c-4184-a4a4-c4a36d762300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:47:55 GMT'
    'Content-Length': '1753'
2025-06-21 10:17:55,356 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:17:55,607 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0cdece48-6a84-417e-890d-e0f576032000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:47:55 GMT'
    'Content-Length': '1652'
2025-06-21 10:17:55,608 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:17:55,609 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:17:58,046 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-21 10:17:58,050 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-21 10:17:58,051 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:17:58,348 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b7238c37-9a01-4586-8c7e-8b41d1d11f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:47:58 GMT'
    'Content-Length': '1753'
2025-06-21 10:17:58,350 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:17:58,567 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ab6a6be7-47ef-45cf-94e3-31bb15af1f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:47:59 GMT'
    'Content-Length': '1995'
2025-06-21 10:17:58,568 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:17:58,568 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:18:02,243 - d365 - INFO - Fetched 35 conditional access policies
2025-06-21 10:18:02,245 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-21 10:18:02,246 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:18:02,494 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ff3047f2-3d76-465a-95ec-d82835912500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:48:03 GMT'
    'Content-Length': '1753'
2025-06-21 10:18:02,496 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:18:02,760 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7a48dea3-b0c8-452a-a5ac-0819c4162100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:48:03 GMT'
    'Content-Length': '1652'
2025-06-21 10:18:02,761 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:18:02,761 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:18:03,492 - d365 - INFO - Fetched 11 business units
2025-06-21 10:18:03,493 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-21 10:18:03,510 - d365 - INFO - D365 data loaded successfully
2025-06-21 10:18:03,521 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-21 10:18:03,522 - main - INFO - Loading data from CSV files
2025-06-21 10:18:03,572 - main - INFO - Loaded audit_logs with 32138 rows
2025-06-21 10:18:03,619 - main - INFO - Loaded signin_logs with 5500 rows
2025-06-21 10:18:03,663 - main - INFO - Loaded user_details with 205 rows
2025-06-21 10:18:03,669 - main - INFO - Loaded app_roles with 2112 rows
2025-06-21 10:18:03,703 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-21 10:18:03,830 - main - INFO - Created group_memberships with 3295 rows
2025-06-21 10:18:03,854 - main - INFO - Created role_matrix with 2112 rows
2025-06-21 10:18:03,862 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-21 10:18:03,863 - main - WARNING - Found 75 users in signin_logs not present in user_details: ['46aee3ae-b46f-4737-a826-87ff31e6c3ff', '00e5df59-0081-4e43-9ae0-7c9969f698dc', '6a8f9c80-2ebf-40f5-9d26-9036db205a49', 'f5171746-0248-4d03-8228-86376434a4e2', 'a657e3e2-3fa1-4f19-b9eb-62683a767729']...
2025-06-21 10:18:03,864 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['a239aad0-0aaa-eb11-8236-0022489b4c66', 'aaf634cd-69b8-ed11-9886-0022489b4de1', '6de80ea6-76b4-eb11-8236-000d3ab6406f', '5fa3a3a7-54d3-ef11-a72e-000d3ab500c7', '98029ad4-4c21-f011-998b-000d3a69167e']...
2025-06-21 10:18:03,865 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-21 10:18:03,867 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-21 10:18:03,868 - src.core.embeddings - INFO - Starting embedding generation
2025-06-21 10:18:03,868 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-21 10:18:03,868 - src.core.embeddings - INFO - Using batch_size=64
2025-06-21 10:18:03,869 - src.core.embeddings - INFO - Using device: cpu
2025-06-21 10:19:17,129 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-21 10:19:21,864 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-21 10:19:21,865 - src.core.embeddings - INFO - Embedding initialization took 78.00 seconds
2025-06-21 10:19:21,866 - src.core.embeddings - INFO - Memory usage: RSS=508.55 MB, VMS=2703.52 MB
2025-06-21 10:19:21,867 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-21 10:19:21,867 - src.core.embeddings - INFO - Using all logs: audit_logs=32138 rows, signin_logs=5500 rows
2025-06-21 10:19:21,874 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-21 10:19:21,902 - src.core.embeddings - INFO - Precomputed location history in 0.03 seconds
2025-06-21 10:19:22,442 - src.core.embeddings - INFO - Text generation took 0.58 seconds
2025-06-21 10:19:22,443 - src.core.embeddings - INFO - Memory usage: RSS=533.63 MB, VMS=2728.27 MB
2025-06-21 10:19:22,444 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-21 10:19:24,137 - src.core.embeddings - INFO - Total documents to embed: 37638
2025-06-21 10:19:24,138 - src.core.embeddings - INFO - Document conversion took 1.69 seconds
2025-06-21 10:19:24,139 - src.core.embeddings - INFO - Memory usage: RSS=563.23 MB, VMS=2758.33 MB
2025-06-21 10:19:24,139 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-21 10:19:24,141 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-21 10:19:36,788 - src.core.embeddings - INFO - Memory usage: RSS=729.53 MB, VMS=2942.50 MB
2025-06-21 10:19:36,789 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-21 10:19:50,389 - src.core.embeddings - INFO - Memory usage: RSS=804.68 MB, VMS=3017.09 MB
2025-06-21 10:19:50,390 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-21 10:20:05,441 - src.core.embeddings - INFO - Memory usage: RSS=879.55 MB, VMS=3091.67 MB
2025-06-21 10:20:05,443 - src.core.embeddings - INFO - Embedding chunk 4/8 (5000 documents)
2025-06-21 10:20:18,589 - src.core.embeddings - INFO - Memory usage: RSS=953.19 MB, VMS=3166.02 MB
2025-06-21 10:20:18,589 - src.core.embeddings - INFO - Embedding chunk 5/8 (5000 documents)
2025-06-21 10:20:31,400 - src.core.embeddings - INFO - Memory usage: RSS=1026.70 MB, VMS=3240.21 MB
2025-06-21 10:20:31,400 - src.core.embeddings - INFO - Embedding chunk 6/8 (5000 documents)
2025-06-21 10:20:43,761 - src.core.embeddings - INFO - Memory usage: RSS=1100.03 MB, VMS=3314.15 MB
2025-06-21 10:20:43,762 - src.core.embeddings - INFO - Embedding chunk 7/8 (5000 documents)
2025-06-21 10:21:10,052 - src.core.embeddings - INFO - Memory usage: RSS=1357.05 MB, VMS=3568.17 MB
2025-06-21 10:21:10,052 - src.core.embeddings - INFO - Embedding chunk 8/8 (2638 documents)
2025-06-21 10:21:30,216 - src.core.embeddings - INFO - Memory usage: RSS=1394.55 MB, VMS=3607.35 MB
2025-06-21 10:21:30,513 - src.core.embeddings - INFO - Embedding generation took 126.37 seconds
2025-06-21 10:21:30,513 - src.core.embeddings - INFO - Memory usage: RSS=1394.55 MB, VMS=3607.35 MB
2025-06-21 10:21:30,514 - src.core.embeddings - INFO - Generating FAISS vectorstore
2025-06-21 10:21:31,103 - src.core.embeddings - INFO - Using nlist=50 for FAISS IndexIVFFlat with 37638 vectors
2025-06-21 10:21:32,036 - src.core.embeddings - WARNING - Using SimpleDocstore as a fallback due to missing InMemoryDocstore
2025-06-21 10:21:32,050 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-06-21 10:21:32,051 - src.core.embeddings - INFO - Skipping saving vectorstore to disk.
2025-06-21 10:21:32,052 - src.core.embeddings - INFO - FAISS vectorstore creation took 1.54 seconds
2025-06-21 10:21:32,053 - src.core.embeddings - INFO - Memory usage: RSS=1592.32 MB, VMS=3941.14 MB
2025-06-21 10:21:32,064 - src.core.embeddings - INFO - Total embedding generation took 208.20 seconds
2025-06-21 10:21:32,101 - main - INFO - [analyze] Embeddings generated.
2025-06-21 10:21:32,102 - src.core.analysis - INFO - Initializing Azure OpenAI LLM
2025-06-21 10:21:32,103 - src.utils.config - INFO - Loading environment variables
2025-06-21 10:21:32,146 - src.utils.config - INFO - Environment variables loaded successfully
2025-06-21 10:21:32,147 - src.core.analysis - INFO - Validating input DataFrames
2025-06-21 10:21:32,222 - src.core.analysis - INFO - Columns in user_details: ['User ID', 'UserName', 'email', 'groupMemberships', 'businessUnitId', 'managerId', 'managerEmail', 'azureAdObjectId', 'Groups', 'Department']
2025-06-21 10:21:32,222 - src.core.analysis - INFO - Columns in signin_logs: ['id', 'userId', 'signInDateTime', 'appDisplayName', 'appId', 'locationCity', 'locationCountry', 'ipAddress', 'browser', 'operatingSystem', 'statusCode', 'statusMessage']
2025-06-21 10:21:32,223 - src.core.analysis - INFO - Columns in audit_logs: ['auditId', 'activityDateTime', 'actionCode', 'initiatedByUserId', 'targetRecordId']
2025-06-21 10:21:32,224 - src.core.analysis - INFO - Columns in app_role_assignments: ['userId', 'roleId', 'userName', 'email', 'businessUnitId', 'roleName', 'assignmentDate']
2025-06-21 10:21:32,224 - src.core.analysis - INFO - Columns in app_roles: ['roleId', 'roleName', 'componentState']
2025-06-21 10:21:32,231 - src.core.analysis - INFO - User IDs from user_details: 205
2025-06-21 10:21:32,232 - src.core.analysis - INFO - User IDs from signin_logs: 75
2025-06-21 10:21:32,232 - src.core.analysis - INFO - User IDs from audit_logs: 1
2025-06-21 10:21:32,232 - src.core.analysis - INFO - User IDs from app_role_assignments: 335
2025-06-21 10:21:32,233 - src.core.analysis - INFO - Total unique user IDs: 515
2025-06-21 10:21:33,718 - src.core.analysis - INFO - Retrieving relevant documents from vectorstore
2025-06-21 10:21:33,721 - d365 - INFO - Loading D365 data
2025-06-21 10:21:33,722 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:21:34,057 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd54206c9-73a1-4310-a8ca-d152be351a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:51:34 GMT'
    'Content-Length': '1753'
2025-06-21 10:21:34,058 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:21:34,225 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2717db01-e488-46a5-9a29-14088cb61e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:51:34 GMT'
    'Content-Length': '1652'
2025-06-21 10:21:34,226 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:21:34,226 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:21:34,227 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-23T04:51:34Z)
2025-06-21 10:21:37,599 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-21 10:21:40,031 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-21 10:21:42,463 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-21 10:21:45,000 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-21 10:21:47,440 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-21 10:21:49,583 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-21 10:21:50,816 - d365 - INFO - Progress: Fetched 32139 audit logs after 7 pages
2025-06-21 10:21:50,838 - d365 - INFO - Fetched 32139 D365 audit logs via Dataverse
2025-06-21 10:21:50,892 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-21 10:21:50,904 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:21:51,123 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2d4a21b1-aaae-488b-8944-63f213161900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:51:51 GMT'
    'Content-Length': '1753'
2025-06-21 10:21:51,124 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:21:51,280 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3c0f3e45-ec6b-4210-86f4-210ed4f91c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:51:51 GMT'
    'Content-Length': '1996'
2025-06-21 10:21:51,281 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:21:51,282 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:21:51,282 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-23T04:51:51Z)
2025-06-21 10:21:51,282 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-21 10:21:58,926 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 7.9 req/min | Time: 0:00:07
2025-06-21 10:22:06,394 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 7.9 req/min | Time: 0:00:15
2025-06-21 10:22:14,889 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 7.6 req/min | Time: 0:00:23
2025-06-21 10:22:25,577 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 7.0 req/min | Time: 0:00:34
2025-06-21 10:22:39,022 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 6.3 req/min | Time: 0:00:47
2025-06-21 10:22:44,924 - d365 - INFO - Progress: 5,502 records | Pages: 6 | Requests: 6 | Rate: 6.7 req/min | Time: 0:00:53
2025-06-21 10:22:45,425 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-22T04:53:26Z to 2025-06-21T04:44:45Z
2025-06-21 10:22:45,489 - d365 - INFO - Fetch completed: 5,502 records in 0:00:54
2025-06-21 10:22:45,491 - d365 - INFO - Total requests made: 6
2025-06-21 10:22:45,496 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:22:45,771 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0f7ee37e-3081-4af3-b866-2bd59f571d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:52:45 GMT'
    'Content-Length': '1753'
2025-06-21 10:22:45,772 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:22:45,898 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '60de46dd-80ed-4375-a197-1cf11a191f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:52:45 GMT'
    'Content-Length': '1653'
2025-06-21 10:22:45,899 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:22:45,900 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:22:45,901 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:22:46,080 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2d6462fe-b4d7-4662-a07d-eeba853b1e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:52:46 GMT'
    'Content-Length': '1753'
2025-06-21 10:22:46,082 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:22:46,297 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1692faf1-2f7d-4134-82a6-45d204421300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:52:47 GMT'
    'Content-Length': '1996'
2025-06-21 10:22:46,298 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:22:46,299 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:22:46,300 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:22:46,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ca3ddadc-0ad3-4923-bc1f-e16f84401800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:52:47 GMT'
    'Content-Length': '1753'
2025-06-21 10:22:46,543 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:22:46,763 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ff27b499-005d-4650-a195-48691a982400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:52:47 GMT'
    'Content-Length': '1995'
2025-06-21 10:22:46,764 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:22:46,765 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:22:48,850 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-21 10:22:48,851 - d365 - INFO - Found 981 users in Entra ID
2025-06-21 10:22:50,361 - d365 - INFO - Fetched 936 user records from D365
2025-06-21 10:23:51,407 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c
2025-06-21 10:23:51,408 - d365 - WARNING - No manager found for Azure AD ID f930eecf-94a2-492d-a317-ab8c86b0e56c via Dataverse or Graph API
2025-06-21 10:24:27,903 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de
2025-06-21 10:24:27,905 - d365 - WARNING - No manager found for Azure AD ID 17bcaa25-7d6a-425c-975d-3044cadf25de via Dataverse or Graph API
2025-06-21 10:24:30,088 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d
2025-06-21 10:24:30,090 - d365 - WARNING - No manager found for Azure AD ID 3a8a6e9c-63f1-42c2-88b1-cef3cdb7b92d via Dataverse or Graph API
2025-06-21 10:24:34,588 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188
2025-06-21 10:24:34,589 - d365 - WARNING - No manager found for Azure AD ID d63e98b9-8b5d-4b8a-9ebf-fe642c2c5188 via Dataverse or Graph API
2025-06-21 10:25:16,914 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d
2025-06-21 10:25:16,916 - d365 - WARNING - No manager found for Azure AD ID 8649e5cd-9b18-4b9e-8b4e-a1d0d0ae326d via Dataverse or Graph API
2025-06-21 10:25:41,517 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f
2025-06-21 10:25:41,518 - d365 - WARNING - No manager found for Azure AD ID 972af6ae-90d2-441e-8436-2860f812896f via Dataverse or Graph API
2025-06-21 10:25:55,094 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4
2025-06-21 10:25:55,095 - d365 - WARNING - No manager found for Azure AD ID a90e1fe0-1acf-484c-9db8-79d28024e4a4 via Dataverse or Graph API
2025-06-21 10:26:31,794 - d365 - INFO - Filtered out 417 D365 users not present in Entra ID
2025-06-21 10:26:31,795 - d365 - INFO - Filtered out 314 D365 users without a D365 license
2025-06-21 10:26:31,795 - d365 - INFO - Final user count after filtering: 205
2025-06-21 10:26:31,796 - d365 - INFO - Fetched 205 user details after filtering
2025-06-21 10:26:31,800 - d365 - INFO - Saved filtered user details to data/user_details.csv
2025-06-21 10:26:31,803 - d365 - INFO - Saved 417 users without Entra ID to data/users_without_entra_id.csv
2025-06-21 10:26:31,807 - d365 - INFO - Saved 314 users without D365 license to data/users_without_d365_license.csv
2025-06-21 10:26:31,810 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:26:32,173 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8d246ca2-56bb-4e5e-9057-cad222a10e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:32 GMT'
    'Content-Length': '1753'
2025-06-21 10:26:32,174 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:26:32,329 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8eca05a6-005d-4d13-ac87-08ceed4f1f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:32 GMT'
    'Content-Length': '1653'
2025-06-21 10:26:32,330 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:26:32,331 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:26:33,714 - d365 - INFO - Fetched 2112 D365 security roles
2025-06-21 10:26:33,719 - d365 - INFO - Saved security roles to data/app_roles.csv
2025-06-21 10:26:33,720 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:26:33,996 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4dd94618-dae4-4a62-ab5a-401ce22e1e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:34 GMT'
    'Content-Length': '1753'
2025-06-21 10:26:33,998 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:26:34,196 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9387282e-2088-483b-b763-90eef9d02000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:34 GMT'
    'Content-Length': '1648'
2025-06-21 10:26:34,197 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:26:34,197 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:26:36,730 - d365 - INFO - Fetched 687 D365 user role assignments
2025-06-21 10:26:36,734 - d365 - INFO - Saved user role assignments to data/app_role_assignments.csv
2025-06-21 10:26:36,736 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:26:37,001 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '404ced70-e4c9-4d97-879b-56d5a1441b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:37 GMT'
    'Content-Length': '1753'
2025-06-21 10:26:37,002 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:26:37,151 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd4f5924f-5110-426f-8646-5fb3e13c1f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:38 GMT'
    'Content-Length': '1996'
2025-06-21 10:26:37,152 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:26:37,152 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:26:40,007 - d365 - INFO - Fetched 35 conditional access policies
2025-06-21 10:26:40,009 - d365 - INFO - Saved conditional access policies to data/conditional_access_policies.csv
2025-06-21 10:26:40,011 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:26:40,314 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '57688525-244f-4133-a053-59904d8e2200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:41 GMT'
    'Content-Length': '1753'
2025-06-21 10:26:40,315 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:26:40,558 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8f40f699-5290-4fcd-ba2a-780ceb8d1d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 04:56:41 GMT'
    'Content-Length': '1647'
2025-06-21 10:26:40,558 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:26:40,559 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:26:41,259 - d365 - INFO - Fetched 11 business units
2025-06-21 10:26:41,261 - d365 - INFO - Saved business units to data/business_units.csv
2025-06-21 10:26:41,263 - d365 - INFO - D365 data loaded successfully
2025-06-21 10:26:41,273 - main - INFO - [analyze] Data fetched and saved successfully.
2025-06-21 10:26:41,273 - main - INFO - Loading data from CSV files
2025-06-21 10:26:41,338 - main - INFO - Loaded audit_logs with 32139 rows
2025-06-21 10:26:41,378 - main - INFO - Loaded signin_logs with 5502 rows
2025-06-21 10:26:41,418 - main - INFO - Loaded user_details with 205 rows
2025-06-21 10:26:41,426 - main - INFO - Loaded app_roles with 2112 rows
2025-06-21 10:26:41,466 - main - INFO - Loaded app_role_assignments with 687 rows
2025-06-21 10:26:41,621 - main - INFO - Created group_memberships with 3295 rows
2025-06-21 10:26:41,630 - main - INFO - Created role_matrix with 2112 rows
2025-06-21 10:26:41,636 - main - WARNING - Found 1 users in audit_logs not present in user_details: ['unknown']...
2025-06-21 10:26:41,637 - main - WARNING - Found 75 users in signin_logs not present in user_details: ['46aee3ae-b46f-4737-a826-87ff31e6c3ff', '00e5df59-0081-4e43-9ae0-7c9969f698dc', '6a8f9c80-2ebf-40f5-9d26-9036db205a49', 'f5171746-0248-4d03-8228-86376434a4e2', 'a657e3e2-3fa1-4f19-b9eb-62683a767729']...
2025-06-21 10:26:41,639 - main - WARNING - Found 234 users in app_role_assignments not present in user_details: ['a239aad0-0aaa-eb11-8236-0022489b4c66', 'aaf634cd-69b8-ed11-9886-0022489b4de1', '6de80ea6-76b4-eb11-8236-000d3ab6406f', '5fa3a3a7-54d3-ef11-a72e-000d3ab500c7', '98029ad4-4c21-f011-998b-000d3a69167e']...
2025-06-21 10:26:41,640 - main - INFO - Data loaded and preprocessed successfully from CSVs
2025-06-21 10:26:41,642 - main - INFO - [analyze] Data loaded from CSV files.
2025-06-21 10:26:41,643 - src.core.embeddings - INFO - Starting embedding generation
2025-06-21 10:26:41,643 - src.core.embeddings - INFO - Using sample_fraction=1.00 (100.0%)
2025-06-21 10:26:41,644 - src.core.embeddings - INFO - Using batch_size=64
2025-06-21 10:26:41,644 - src.core.embeddings - INFO - Using device: cpu
2025-06-21 10:26:41,645 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-MiniLM-L3-v2
2025-06-21 10:26:54,899 - src.core.embeddings - INFO - Initialized Hugging Face embeddings with batch_size=64
2025-06-21 10:26:54,900 - src.core.embeddings - INFO - Embedding initialization took 13.26 seconds
2025-06-21 10:26:54,901 - src.core.embeddings - INFO - Memory usage: RSS=1202.93 MB, VMS=3767.70 MB
2025-06-21 10:26:54,901 - src.core.embeddings - INFO - Creating embedding text for logs
2025-06-21 10:26:54,902 - src.core.embeddings - INFO - Using all logs: audit_logs=32139 rows, signin_logs=5502 rows
2025-06-21 10:26:54,908 - src.core.embeddings - INFO - Precomputing user location history for all users
2025-06-21 10:26:54,916 - src.core.embeddings - INFO - Precomputed location history in 0.01 seconds
2025-06-21 10:26:55,533 - src.core.embeddings - INFO - Text generation took 0.63 seconds
2025-06-21 10:26:55,534 - src.core.embeddings - INFO - Memory usage: RSS=1202.93 MB, VMS=3767.70 MB
2025-06-21 10:26:55,535 - src.core.embeddings - INFO - Converting DataFrames to documents
2025-06-21 10:26:57,305 - src.core.embeddings - INFO - Total documents to embed: 37641
2025-06-21 10:26:57,306 - src.core.embeddings - INFO - Document conversion took 1.77 seconds
2025-06-21 10:26:57,307 - src.core.embeddings - INFO - Memory usage: RSS=1223.88 MB, VMS=3788.73 MB
2025-06-21 10:26:57,307 - src.core.embeddings - INFO - Generating embeddings in chunks
2025-06-21 10:26:57,309 - src.core.embeddings - INFO - Embedding chunk 1/8 (5000 documents)
2025-06-21 10:27:11,218 - src.core.embeddings - INFO - Memory usage: RSS=1364.60 MB, VMS=3865.65 MB
2025-06-21 10:27:11,219 - src.core.embeddings - INFO - Embedding chunk 2/8 (5000 documents)
2025-06-21 10:27:24,911 - src.core.embeddings - INFO - Memory usage: RSS=1431.46 MB, VMS=3940.44 MB
2025-06-21 10:27:24,912 - src.core.embeddings - INFO - Embedding chunk 3/8 (5000 documents)
2025-06-21 10:28:10,288 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:28:23,957 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:28:23,958 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:28:23,959 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:28:23,961 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:28:23,962 - main - INFO - FastAPI application started
2025-06-21 10:32:03,139 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:32:03,140 - main - INFO - FastAPI application shutdown
2025-06-21 10:32:09,012 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:32:43,104 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:34:01,766 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:34:19,648 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:34:19,649 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:34:19,650 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:34:19,651 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:34:19,652 - main - INFO - FastAPI application started
2025-06-21 10:36:05,771 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:36:05,772 - main - INFO - FastAPI application shutdown
2025-06-21 10:36:10,948 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:38:34,350 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:38:37,411 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:38:37,411 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:38:37,411 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:38:37,413 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:38:37,413 - main - INFO - FastAPI application started
2025-06-21 10:41:27,069 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:41:27,070 - main - INFO - FastAPI application shutdown
2025-06-21 10:41:33,004 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:41:36,456 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:41:36,456 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:41:36,457 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:41:36,458 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:41:36,459 - main - INFO - FastAPI application started
2025-06-21 10:41:56,145 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:41:56,147 - main - INFO - FastAPI application shutdown
2025-06-21 10:42:01,816 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:42:05,138 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:42:05,138 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:42:05,139 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:42:05,140 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:42:05,140 - main - INFO - FastAPI application started
2025-06-21 10:42:40,649 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:42:40,650 - main - INFO - FastAPI application shutdown
2025-06-21 10:42:47,338 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:42:51,596 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:42:51,597 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:42:51,597 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:42:51,599 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:42:51,599 - main - INFO - FastAPI application started
2025-06-21 10:48:11,193 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:48:11,194 - main - INFO - FastAPI application shutdown
2025-06-21 10:48:17,555 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:48:21,200 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:48:21,201 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:48:21,201 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:48:21,203 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:48:21,203 - main - INFO - FastAPI application started
2025-06-21 10:50:27,116 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-21 10:50:27,118 - main - INFO - FastAPI application shutdown
2025-06-21 10:50:52,132 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:51:11,411 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:51:11,411 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:51:11,412 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:51:11,413 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:51:11,413 - main - INFO - FastAPI application started
2025-06-21 10:51:28,804 - d365 - INFO - Loading D365 data
2025-06-21 10:51:28,807 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:51:29,014 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fe455092-2b11-4058-8bf4-ba360dc21f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:21:29 GMT'
    'Content-Length': '1753'
2025-06-21 10:51:29,027 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:51:29,194 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c5a6b234-f00f-4e0c-9407-23dcb09c2900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:21:29 GMT'
    'Content-Length': '1647'
2025-06-21 10:51:29,195 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:51:29,196 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:51:29,197 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-23T05:21:29Z)
2025-06-21 10:51:32,981 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-21 10:51:35,668 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-21 10:51:38,507 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-21 10:51:41,091 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-21 10:51:43,641 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-21 10:51:46,183 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-21 10:51:47,459 - d365 - INFO - Progress: Fetched 32142 audit logs after 7 pages
2025-06-21 10:51:47,478 - d365 - INFO - Fetched 32142 D365 audit logs via Dataverse
2025-06-21 10:51:47,545 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-21 10:51:47,548 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:51:47,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c5cc19a0-8d73-4b21-b526-c54827b12100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:21:48 GMT'
    'Content-Length': '1753'
2025-06-21 10:51:47,753 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:51:47,954 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd2cbe4f0-03d0-42bd-bcd2-1adba7611f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:21:48 GMT'
    'Content-Length': '1996'
2025-06-21 10:51:47,956 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:51:47,956 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:51:47,957 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-23T05:21:47Z)
2025-06-21 10:51:47,957 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-21 10:51:55,491 - d365 - INFO - Progress: 1,000 records | Pages: 1 | Requests: 1 | Rate: 8.0 req/min | Time: 0:00:07
2025-06-21 10:52:04,291 - d365 - INFO - Progress: 2,000 records | Pages: 2 | Requests: 2 | Rate: 7.3 req/min | Time: 0:00:16
2025-06-21 10:52:13,856 - d365 - INFO - Progress: 3,000 records | Pages: 3 | Requests: 3 | Rate: 7.0 req/min | Time: 0:00:25
2025-06-21 10:52:23,669 - d365 - INFO - Progress: 4,000 records | Pages: 4 | Requests: 4 | Rate: 6.7 req/min | Time: 0:00:35
2025-06-21 10:52:31,976 - d365 - INFO - Progress: 5,000 records | Pages: 5 | Requests: 5 | Rate: 6.8 req/min | Time: 0:00:44
2025-06-21 10:52:36,043 - d365 - INFO - Progress: 5,492 records | Pages: 6 | Requests: 6 | Rate: 7.5 req/min | Time: 0:00:48
2025-06-21 10:52:36,545 - d365 - INFO - Date range of fetched sign-in logs: 2025-05-22T05:24:07Z to 2025-06-21T04:44:45Z
2025-06-21 10:52:36,606 - d365 - INFO - Fetch completed: 5,492 records in 0:00:48
2025-06-21 10:52:36,607 - d365 - INFO - Total requests made: 6
2025-06-21 10:52:36,612 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:52:36,799 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3158ff1e-4462-44d7-8a3f-4ef2c0332100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:22:37 GMT'
    'Content-Length': '1753'
2025-06-21 10:52:36,800 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:52:36,927 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e679ec3f-2130-401d-b879-728785431800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:22:37 GMT'
    'Content-Length': '1652'
2025-06-21 10:52:36,928 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:52:36,928 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:52:36,929 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:52:37,125 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6ae10cdc-d456-4022-b88c-bd6149f02100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:22:38 GMT'
    'Content-Length': '1753'
2025-06-21 10:52:37,126 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:52:37,312 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4a749e14-3c3a-4fd3-bed7-cad421ed2100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:22:38 GMT'
    'Content-Length': '1992'
2025-06-21 10:52:37,313 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:52:37,314 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:52:37,315 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:52:37,490 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5f6f55d2-43b0-433e-a892-ae6b573f2600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:22:38 GMT'
    'Content-Length': '1753'
2025-06-21 10:52:37,491 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:52:37,671 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6934bf33-fdde-4525-9cce-3958e6252300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:22:38 GMT'
    'Content-Length': '1991'
2025-06-21 10:52:37,672 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:52:37,673 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:52:39,978 - d365 - INFO - Fetched 981 users from Entra ID
2025-06-21 10:52:39,979 - d365 - INFO - Found 981 users in Entra ID
2025-06-21 10:52:41,107 - d365 - INFO - Fetched 936 user records from D365
2025-06-21 10:54:08,549 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:54:11,901 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:54:11,902 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:54:11,904 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:54:11,927 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:54:11,928 - main - INFO - FastAPI application started
2025-06-21 10:54:33,410 - d365 - INFO - Loading D365 data
2025-06-21 10:54:33,412 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:54:33,599 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b400ab26-dc07-4967-96f9-c5ee00351b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:24:33 GMT'
    'Content-Length': '1753'
2025-06-21 10:54:33,611 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:54:33,835 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd6cc468e-d9d2-4b3e-b1a5-6bb4a6401c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:24:33 GMT'
    'Content-Length': '1645'
2025-06-21 10:54:33,836 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:54:33,836 - d365 - INFO - Access token obtained for scope https://pcsuat1.crm4.dynamics.com/.default
2025-06-21 10:54:33,837 - d365 - INFO - Starting fast fetch of D365 audit logs for the last 90 days (since 2025-03-23T05:24:33Z)
2025-06-21 10:54:37,339 - d365 - INFO - Progress: Fetched 5000 audit logs after 1 pages
2025-06-21 10:54:39,912 - d365 - INFO - Progress: Fetched 10000 audit logs after 2 pages
2025-06-21 10:54:42,490 - d365 - INFO - Progress: Fetched 15000 audit logs after 3 pages
2025-06-21 10:54:44,959 - d365 - INFO - Progress: Fetched 20000 audit logs after 4 pages
2025-06-21 10:54:47,400 - d365 - INFO - Progress: Fetched 25000 audit logs after 5 pages
2025-06-21 10:54:49,637 - d365 - INFO - Progress: Fetched 30000 audit logs after 6 pages
2025-06-21 10:54:50,798 - d365 - INFO - Progress: Fetched 32142 audit logs after 7 pages
2025-06-21 10:54:50,832 - d365 - INFO - Fetched 32142 D365 audit logs via Dataverse
2025-06-21 10:54:50,951 - d365 - INFO - Saved audit logs to data/audit_logs.csv
2025-06-21 10:54:50,957 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-21 10:54:51,210 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '014b2d90-5802-4ccc-aada-9471a0491e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:24:52 GMT'
    'Content-Length': '1753'
2025-06-21 10:54:51,211 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-21 10:54:51,420 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ab6a6be7-47ef-45cf-94e3-31bbf46e2000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sat, 21 Jun 2025 05:24:52 GMT'
    'Content-Length': '1995'
2025-06-21 10:54:51,421 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-21 10:54:51,421 - d365 - INFO - Access token obtained for scope https://graph.microsoft.com/.default
2025-06-21 10:54:51,422 - d365 - INFO - Starting optimized fetch of Dynamics 365 sign-in logs for the last 90 days (since 2025-03-23T05:24:51Z)
2025-06-21 10:54:51,422 - d365 - INFO - Throttling limit: 1,000 requests per 10 minutes (~1.67 requests per second)
2025-06-21 10:56:36,980 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-21 10:56:40,341 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-21 10:56:40,342 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-21 10:56:40,342 - apscheduler.scheduler - INFO - Scheduler started
2025-06-21 10:56:40,343 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-21 10:56:40,344 - main - INFO - FastAPI application started
2025-06-23 11:20:06,566 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-23 11:20:06,600 - main - INFO - FastAPI application shutdown
2025-06-23 11:20:37,561 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-23 11:20:54,955 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-23 11:20:54,956 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-23 11:20:54,957 - apscheduler.scheduler - INFO - Scheduler started
2025-06-23 11:20:54,960 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-23 11:20:54,960 - main - INFO - FastAPI application started
2025-06-23 11:20:54,965 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-23 11:20:54,967 - main - INFO - FastAPI application shutdown
2025-06-23 11:21:01,856 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-23 11:21:08,161 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-23 11:21:08,162 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-23 11:21:08,163 - apscheduler.scheduler - INFO - Scheduler started
2025-06-23 11:21:08,165 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-23 11:21:08,165 - main - INFO - FastAPI application started
2025-06-23 11:39:13,019 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-23 11:39:13,022 - main - INFO - FastAPI application shutdown
2025-06-23 11:39:20,528 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-23 11:39:32,380 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-23 11:39:32,382 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-23 11:39:32,383 - apscheduler.scheduler - INFO - Scheduler started
2025-06-23 11:39:32,389 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-23 11:39:32,389 - main - INFO - FastAPI application started
2025-06-23 11:39:42,537 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-23 11:39:42,541 - main - INFO - FastAPI application shutdown
2025-06-23 11:39:47,310 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-23 11:39:51,926 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-23 11:39:51,927 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-23 11:39:51,928 - apscheduler.scheduler - INFO - Scheduler started
2025-06-23 11:39:51,929 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-23 11:39:51,930 - main - INFO - FastAPI application started
2025-06-23 11:40:38,404 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-23 11:40:38,656 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ecd38cd0-8d6d-4529-9a21-e41212ef5400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 06:10:38 GMT'
    'Content-Length': '1753'
2025-06-23 11:40:38,670 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-23 11:40:38,815 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8fc8316a-a776-41b4-9a2c-366fdc0b5200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 06:10:38 GMT'
    'Content-Length': '1653'
2025-06-23 11:40:38,816 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-23 11:40:38,817 - d365_role_manager - INFO - Fetching roles for user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:40:41,099 - d365_role_manager - INFO - Removing role cad52a75-568c-e611-80d4-00155d42a122 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:40:46,419 - d365_role_manager - INFO - Removed role cad52a75-568c-e611-80d4-00155d42a122 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:40:46,420 - d365_role_manager - INFO - Removing role 3dac4d9e-568c-e611-80d4-00155d42a122 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:40:47,360 - d365_role_manager - INFO - Removed role 3dac4d9e-568c-e611-80d4-00155d42a122 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:40:47,361 - d365_role_manager - INFO - Removing role 46cd56c8-00aa-eb11-8236-0022489b4c66 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:40:53,829 - d365_role_manager - INFO - Removed role 46cd56c8-00aa-eb11-8236-0022489b4c66 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:42:39,994 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-23 11:42:40,419 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ab598f85-e058-45bd-b686-660233744e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 06:12:39 GMT'
    'Content-Length': '1753'
2025-06-23 11:42:40,420 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-23 11:42:40,649 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '11681c87-9042-439c-abc8-2d9fc73f0500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 06:12:40 GMT'
    'Content-Length': '1648'
2025-06-23 11:42:40,650 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-23 11:42:40,654 - d365_role_manager - INFO - Fetching roles for user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:42:41,506 - d365_role_manager - INFO - Removing role 46cd56c8-00aa-eb11-8236-0022489b4c66 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:42:43,044 - d365_role_manager - INFO - Removed role 46cd56c8-00aa-eb11-8236-0022489b4c66 from user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 11:43:15,770 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-23 11:43:16,125 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9bac0d87-9255-4480-9c77-d9881c965700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 06:13:16 GMT'
    'Content-Length': '1753'
2025-06-23 11:43:16,127 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-23 11:43:16,293 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '96502409-15a7-468e-8b0c-b2e9301c4800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 06:13:16 GMT'
    'Content-Length': '1652'
2025-06-23 11:43:16,294 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-23 11:43:16,297 - d365_role_manager - INFO - Fetching roles for user b8a67aa0-9269-ef11-bfe2-000d3a668cd5
2025-06-23 12:17:10,904 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-23 12:17:10,907 - main - INFO - FastAPI application shutdown
2025-06-23 12:17:27,952 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-23 12:17:45,371 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-23 12:17:45,371 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-23 12:17:45,372 - apscheduler.scheduler - INFO - Scheduler started
2025-06-23 12:17:45,373 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-23 12:17:45,374 - main - INFO - FastAPI application started
2025-06-23 12:17:45,375 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-23 12:17:45,376 - main - INFO - FastAPI application shutdown
2025-06-23 12:17:50,288 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-23 12:17:52,929 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-23 12:17:52,930 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-23 12:17:52,931 - apscheduler.scheduler - INFO - Scheduler started
2025-06-23 12:17:52,932 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-23 12:17:52,932 - main - INFO - FastAPI application started
2025-06-23 12:35:05,276 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-06-23 12:35:05,282 - main - INFO - FastAPI application shutdown
2025-06-23 12:35:18,988 - src.core.embeddings - WARNING - Could not import InMemoryDocstore; using SimpleDocstore as fallback
2025-06-23 12:35:34,640 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-23 12:35:34,641 - apscheduler.scheduler - INFO - Added job "Run analysis every 12 hours" to job store "default"
2025-06-23 12:35:34,642 - apscheduler.scheduler - INFO - Scheduler started
2025-06-23 12:35:34,643 - main - INFO - Scheduler started - Analysis will run every 12 hours
2025-06-23 12:35:34,644 - main - INFO - FastAPI application started
2025-06-23 12:59:58,786 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-06-23 12:59:59,009 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'bbcbb697-c386-4915-b3f2-52da11954800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 07:29:59 GMT'
    'Content-Length': '1753'
2025-06-23 12:59:59,027 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/76d6f49a-7a26-4433-818f-55a47ae85a0c/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
A body is sent with the request
2025-06-23 12:59:59,228 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '151f3480-ecc8-4ea5-94e0-4b934cf25000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 23 Jun 2025 07:29:59 GMT'
    'Content-Length': '1645'
2025-06-23 12:59:59,229 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-06-23 12:59:59,230 - disable_d365_user_api - INFO - Disabling user 3e10e1f7-864a-ef11-bfe2-0022489cdeb6
2025-06-23 13:00:02,905 - disable_d365_user_api - INFO - User 3e10e1f7-864a-ef11-bfe2-0022489cdeb6 disabled successfully.
